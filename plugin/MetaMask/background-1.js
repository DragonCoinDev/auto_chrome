LavaPack.loadBundle([[151,{"../../../shared/constants/transaction":6270,lodash:5250},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e,t,r){return function(s){const o=(0,n.cloneDeep)(s);o.meta.version=e;try{const e=function(e,t,r){const n=e,{TransactionController:s}=n;if(s&&s.transactions){const{transactions:e}=s;n.TransactionController.transactions=e.map((e=>t(e)?(e.status=i.TRANSACTION_STATUSES.FAILED,e.err={message:r,note:`Tx automatically failed by migration because ${r}`},e):e))}return n}(o.data,r,t);o.data=e}catch(t){console.warn(`MetaMask Migration #${e}${t.stack}`)}return Promise.resolve(o)}};var n=e("lodash"),i=e("../../../shared/constants/transaction")}}},{package:"<root>",file:"/home/circleci/project/app/scripts/migrations/fail-tx.js"}],[33,{"@babel/runtime/helpers/defineProperty":189,"@babel/runtime/helpers/interopRequireDefault":195,"fast-json-patch":4373,lodash:5250},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.generateHistoryEntry=c,r.migrateFromSnapshotsToDiffs=function(e){return e.map(((t,r)=>0===r?t:c(e[r-1],t)))},r.replayHistory=function(e){return(0,o.cloneDeep)(e).reduce(((e,t)=>s.default.applyPatch(e,t).newDocument))},r.snapshotFromTxMeta=function(e){const t=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){(0,i.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},e);return delete t.history,(0,o.cloneDeep)(t)};var i=n(e("@babel/runtime/helpers/defineProperty")),s=n(e("fast-json-patch")),o=e("lodash");function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function c(e,t,r){const n=s.default.compare(e,t);return n[0]&&(r&&(n[0].note=r),n[0].timestamp=Date.now()),n}}}},{package:"<root>",file:"/home/circleci/project/app/scripts/controllers/transactions/lib/tx-state-history-helpers.js"}],[6019,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=function(e){if(e instanceof Int8Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray)return new DataView(e.buffer,e.byteOffset,e.byteLength);if(e instanceof ArrayBuffer)return new DataView(e);throw new TypeError("Expected `data` to be an ArrayBuffer, Buffer, Int8Array, Uint8Array or Uint8ClampedArray")}}}},{package:"to-data-view",file:"/home/circleci/project/node_modules/to-data-view/index.js"}],[51,{},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=[{constant:!0,inputs:[{name:"node",type:"bytes32"}],name:"resolver",outputs:[{name:"",type:"address"}],payable:!1,type:"function"},{constant:!0,inputs:[{name:"node",type:"bytes32"}],name:"owner",outputs:[{name:"",type:"address"}],payable:!1,type:"function"},{constant:!1,inputs:[{name:"node",type:"bytes32"},{name:"label",type:"bytes32"},{name:"owner",type:"address"}],name:"setSubnodeOwner",outputs:[],payable:!1,type:"function"},{constant:!1,inputs:[{name:"node",type:"bytes32"},{name:"ttl",type:"uint64"}],name:"setTTL",outputs:[],payable:!1,type:"function"},{constant:!0,inputs:[{name:"node",type:"bytes32"}],name:"ttl",outputs:[{name:"",type:"uint64"}],payable:!1,type:"function"},{constant:!1,inputs:[{name:"node",type:"bytes32"},{name:"resolver",type:"address"}],name:"setResolver",outputs:[],payable:!1,type:"function"},{constant:!1,inputs:[{name:"node",type:"bytes32"},{name:"owner",type:"address"}],name:"setOwner",outputs:[],payable:!1,type:"function"},{anonymous:!1,inputs:[{indexed:!0,name:"node",type:"bytes32"},{indexed:!1,name:"owner",type:"address"}],name:"Transfer",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"node",type:"bytes32"},{indexed:!0,name:"label",type:"bytes32"},{indexed:!1,name:"owner",type:"address"}],name:"NewOwner",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"node",type:"bytes32"},{indexed:!1,name:"resolver",type:"address"}],name:"NewResolver",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"node",type:"bytes32"},{indexed:!1,name:"ttl",type:"uint64"}],name:"NewTTL",type:"event"}];r.default=n}}},{package:"<root>",file:"/home/circleci/project/app/scripts/lib/ens-ipfs/contracts/registry.js"}],[52,{},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=[{constant:!1,inputs:[{name:"node",type:"bytes32"},{name:"hash",type:"bytes32"}],name:"setContent",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{name:"node",type:"bytes32"}],name:"content",outputs:[{name:"",type:"bytes32"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"interfaceID",type:"bytes4"}],name:"supportsInterface",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"pure",type:"function"},{constant:!1,inputs:[{name:"node",type:"bytes32"},{name:"key",type:"string"},{name:"value",type:"string"}],name:"setText",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{name:"node",type:"bytes32"},{name:"contentTypes",type:"uint256"}],name:"ABI",outputs:[{name:"contentType",type:"uint256"},{name:"data",type:"bytes"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"node",type:"bytes32"},{name:"x",type:"bytes32"},{name:"y",type:"bytes32"}],name:"setPubkey",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"node",type:"bytes32"},{name:"hash",type:"bytes"}],name:"setContenthash",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{name:"node",type:"bytes32"}],name:"addr",outputs:[{name:"",type:"address"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"node",type:"bytes32"},{name:"key",type:"string"}],name:"text",outputs:[{name:"",type:"string"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"node",type:"bytes32"},{name:"contentType",type:"uint256"},{name:"data",type:"bytes"}],name:"setABI",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{name:"node",type:"bytes32"}],name:"name",outputs:[{name:"",type:"string"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"node",type:"bytes32"},{name:"name",type:"string"}],name:"setName",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{name:"node",type:"bytes32"}],name:"contenthash",outputs:[{name:"",type:"bytes"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"node",type:"bytes32"}],name:"pubkey",outputs:[{name:"x",type:"bytes32"},{name:"y",type:"bytes32"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"node",type:"bytes32"},{name:"addr",type:"address"}],name:"setAddr",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{inputs:[{name:"ensAddr",type:"address"}],payable:!1,stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!0,name:"node",type:"bytes32"},{indexed:!1,name:"a",type:"address"}],name:"AddrChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"node",type:"bytes32"},{indexed:!1,name:"name",type:"string"}],name:"NameChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"node",type:"bytes32"},{indexed:!0,name:"contentType",type:"uint256"}],name:"ABIChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"node",type:"bytes32"},{indexed:!1,name:"x",type:"bytes32"},{indexed:!1,name:"y",type:"bytes32"}],name:"PubkeyChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"node",type:"bytes32"},{indexed:!1,name:"indexedKey",type:"string"},{indexed:!1,name:"key",type:"string"}],name:"TextChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"node",type:"bytes32"},{indexed:!1,name:"hash",type:"bytes"}],name:"ContenthashChanged",type:"event"}];r.default=n}}},{package:"<root>",file:"/home/circleci/project/app/scripts/lib/ens-ipfs/contracts/resolver.js"}],[264,{"./helpers":263,"./profiles":265,multicodec:249,multihashes:255},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("multicodec"),i=e("multihashes"),{hexStringToBuffer:s,profiles:o}=e("./profiles"),{cidForWeb:a,cidV0ToV1Base32:c}=e("./helpers");t.exports={helpers:{cidForWeb:a,cidV0ToV1Base32:c},decode:function(e){const t=s(e),r=n.getCodec(t),i=n.rmPrefix(t);let a=o[r];return a||(a=o.default),a.decode(i)},fromIpfs:function(e){return this.encode("ipfs-ns",e)},fromSkylink:function(e){return this.encode("skynet-ns",e)},fromSwarm:function(e){return this.encode("swarm-ns",e)},encode:function(e,t){let r=o[e];r||(r=o.default);const s=r.encode(t);return i.toHexString(n.addPrefix(e,s))},getCodec:function(e){let t=s(e);return n.getCodec(t)}}}}},{package:"@ensdomains/content-hash",file:"/home/circleci/project/node_modules/@ensdomains/content-hash/src/index.js"}],[4,{},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.SINGLE_CALL_BALANCES_ADDRESS_ROPSTEN=r.SINGLE_CALL_BALANCES_ADDRESS_RINKEBY=r.SINGLE_CALL_BALANCES_ADDRESS_KOVAN=r.SINGLE_CALL_BALANCES_ADDRESS=void 0;r.SINGLE_CALL_BALANCES_ADDRESS="0xb1f8e55c7f64d203c1400b9d8555d050f94adf39";r.SINGLE_CALL_BALANCES_ADDRESS_RINKEBY="0x9f510b19f1ad66f0dcf6e45559fab0d6752c1db7";r.SINGLE_CALL_BALANCES_ADDRESS_ROPSTEN="0xb8e671734ce5c8d7dfbbea5574fa4cf39f7a54a4";r.SINGLE_CALL_BALANCES_ADDRESS_KOVAN="0xb1d3fbb2f83aecd196f474c16ca5d9cffa0d0ffc"}}},{package:"<root>",file:"/home/circleci/project/app/scripts/constants/contracts.js"}],[10,{"@babel/runtime/helpers/interopRequireDefault":195,"ethereum-ens-network-map":2576,"ethjs-ens":2633},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=n(e("ethjs-ens")),s=n(e("ethereum-ens-network-map"));r.default=class{static getNetworkEnsSupport(e){return Boolean(s.default[e])}constructor({network:e,provider:t}={}){this._ethJsEns=new i.default({network:e,provider:t})}lookup(e){return this._ethJsEns.lookup(e)}reverse(e){return this._ethJsEns.reverse(e)}}}}},{package:"<root>",file:"/home/circleci/project/app/scripts/controllers/ens/ens.js"}],[24,{},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.WALLET_PREFIX=r.NOTIFICATION_NAMES=r.LOG_METHOD_TYPES=r.LOG_LIMIT=r.LOG_IGNORE_METHODS=void 0;r.WALLET_PREFIX="wallet_";r.NOTIFICATION_NAMES={accountsChanged:"metamask_accountsChanged",unlockStateChanged:"metamask_unlockStateChanged",chainChanged:"metamask_chainChanged"};r.LOG_IGNORE_METHODS=["wallet_registerOnboarding","wallet_watchAsset"];r.LOG_METHOD_TYPES={restricted:"restricted",internal:"internal"};r.LOG_LIMIT=100}}},{package:"<root>",file:"/home/circleci/project/app/scripts/controllers/permissions/enums.js"}],[27,{"../../../../shared/constants/permissions":6267,reselect:5807},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.getPermittedAccountsByOrigin=r.getChangedAccounts=void 0;var n=e("reselect"),i=e("../../../../shared/constants/permissions");const s=(0,n.createSelector)((e=>e.subjects),(e=>Object.values(e).reduce(((e,t)=>{var r,n;const s=null===(r=t.permissions)||void 0===r||null===(n=r.eth_accounts)||void 0===n?void 0:n.caveats.find((({type:e})=>e===i.CaveatTypes.restrictReturnedAccounts));return s&&e.set(t.origin,s.value),e}),new Map)));r.getPermittedAccountsByOrigin=s;r.getChangedAccounts=(e,t)=>{if(t===undefined)return e;const r=new Map;if(e===t)return r;const n=new Set([...e.keys()]);for(const s of t.keys()){var i;const o=null!==(i=e.get(s))&&void 0!==i?i:[];t.get(s)!==o&&r.set(s,o),n.delete(s)}for(const t of n.keys())r.set(t,e.get(t));return r}}}},{package:"<root>",file:"/home/circleci/project/app/scripts/controllers/permissions/selectors.js"}],[23,{"../../../../shared/constants/permissions":6267,"@metamask/controllers":1042},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.CaveatMutatorFactories=void 0;var n=e("@metamask/controllers");const i={[e("../../../../shared/constants/permissions").CaveatTypes.restrictReturnedAccounts]:{removeAccount:function(e,t){const r=t.filter((t=>t!==e));if(r.length===t.length)return{operation:n.CaveatMutatorOperation.noop};if(r.length>0)return{operation:n.CaveatMutatorOperation.updateValue,value:r};return{operation:n.CaveatMutatorOperation.revokePermission}}}};r.CaveatMutatorFactories=i}}},{package:"<root>",file:"/home/circleci/project/app/scripts/controllers/permissions/caveat-mutators.js"}],[22,{"../../../../shared/constants/permissions":6267,"@babel/runtime/helpers/interopRequireDefault":195,nanoid:5335},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.getPermissionBackgroundApiMethods=function(e){return{addPermittedAccount:(t,r)=>{const n=e.getCaveat(t,s.RestrictedMethods.eth_accounts,s.CaveatTypes.restrictReturnedAccounts);if(n.value.includes(r))throw new Error(`eth_accounts permission for origin "${t}" already permits account "${r}".`);e.updateCaveat(t,s.RestrictedMethods.eth_accounts,s.CaveatTypes.restrictReturnedAccounts,[...n.value,r])},removePermittedAccount:(t,r)=>{const n=e.getCaveat(t,s.RestrictedMethods.eth_accounts,s.CaveatTypes.restrictReturnedAccounts);if(!n.value.includes(r))throw new Error(`eth_accounts permission for origin "${t}" already does not permit account "${r}".`);const i=n.value.filter((e=>e!==r));0===i.length?e.revokePermission(t,s.RestrictedMethods.eth_accounts):e.updateCaveat(t,s.RestrictedMethods.eth_accounts,s.CaveatTypes.restrictReturnedAccounts,i)},requestAccountsPermissionWithId:async t=>{const r=(0,i.default)();return e.requestPermissions({origin:t},{eth_accounts:{}},{id:r}),r}}};var i=n(e("nanoid")),s=e("../../../../shared/constants/permissions")}}},{package:"<root>",file:"/home/circleci/project/app/scripts/controllers/permissions/background-api.js"}],[28,{"../../../../shared/constants/permissions":6267,"@babel/runtime/helpers/defineProperty":189,"@babel/runtime/helpers/interopRequireDefault":195,"@metamask/controllers":1042},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.unrestrictedMethods=r.getPermissionSpecifications=r.getCaveatSpecifications=void 0;var i=n(e("@babel/runtime/helpers/defineProperty")),s=e("@metamask/controllers"),o=e("../../../../shared/constants/permissions");function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){(0,i.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const u=Object.freeze(c({},o.RestrictedMethods)),l=Object.freeze({[o.CaveatTypes.restrictReturnedAccounts]:e=>({type:o.CaveatTypes.restrictReturnedAccounts,value:e})});r.getCaveatSpecifications=({getIdentities:e})=>({[o.CaveatTypes.restrictReturnedAccounts]:{type:o.CaveatTypes.restrictReturnedAccounts,decorator:(e,t)=>async r=>(await e(r)).filter((e=>t.value.includes(e))).slice(0,1),validator:(t,r,n)=>function(e,t){if(!Array.isArray(e)||0===e.length)throw new Error(`${u.eth_accounts} error: Expected non-empty array of Ethereum addresses.`);const r=t();e.forEach((e=>{if(!e||"string"!=typeof e)throw new Error(`${u.eth_accounts} error: Expected an array of Ethereum addresses. Received: "${e}".`);if(!r[e])throw new Error(`${u.eth_accounts} error: Received unrecognized address: "${e}".`)}))}(t.value,e)}});r.getPermissionSpecifications=({getAllAccounts:e,getIdentities:t,captureKeyringTypesWithMissingIdentities:r})=>({[u.eth_accounts]:{permissionType:s.PermissionType.RestrictedMethod,targetKey:u.eth_accounts,allowedCaveats:[o.CaveatTypes.restrictReturnedAccounts],factory:(e,t)=>{if(Array.isArray(e.caveats))throw new Error(`${u.eth_accounts} error: Received unexpected caveats. Any permitted caveats will be added automatically.`);if(!t.approvedAccounts)throw new Error(`${u.eth_accounts} error: No approved accounts specified.`);return(0,s.constructPermission)(c(c({},e),{},{caveats:[l[o.CaveatTypes.restrictReturnedAccounts](t.approvedAccounts)]}))},methodImplementation:async n=>{const i=await e(),s=t();return i.sort(((e,t)=>{if(!s[e])throw r(s,i),new Error(`Missing identity for address: "${e}".`);if(!s[t])throw r(s,i),new Error(`Missing identity for address: "${t}".`);return s[e].lastSelected===s[t].lastSelected?0:s[e].lastSelected===undefined?1:s[t].lastSelected===undefined?-1:s[t].lastSelected-s[e].lastSelected}))},validator:(e,t,r)=>{const{caveats:n}=e;if(!n||1!==n.length||n[0].type!==o.CaveatTypes.restrictReturnedAccounts)throw new Error(`${u.eth_accounts} error: Invalid caveats. There must be a single caveat of type "${o.CaveatTypes.restrictReturnedAccounts}".`)}}});const f=Object.freeze(["eth_blockNumber","eth_call","eth_chainId","eth_coinbase","eth_decrypt","eth_estimateGas","eth_feeHistory","eth_gasPrice","eth_getBalance","eth_getBlockByHash","eth_getBlockByNumber","eth_getBlockTransactionCountByHash","eth_getBlockTransactionCountByNumber","eth_getCode","eth_getEncryptionPublicKey","eth_getFilterChanges","eth_getFilterLogs","eth_getLogs","eth_getProof","eth_getStorageAt","eth_getTransactionByBlockHashAndIndex","eth_getTransactionByBlockNumberAndIndex","eth_getTransactionByHash","eth_getTransactionCount","eth_getTransactionReceipt","eth_getUncleByBlockHashAndIndex","eth_getUncleByBlockNumberAndIndex","eth_getUncleCountByBlockHash","eth_getUncleCountByBlockNumber","eth_getWork","eth_hashrate","eth_mining","eth_newBlockFilter","eth_newFilter","eth_newPendingTransactionFilter","eth_protocolVersion","eth_sendRawTransaction","eth_sendTransaction","eth_sign","eth_signTypedData","eth_signTypedData_v1","eth_signTypedData_v3","eth_signTypedData_v4","eth_submitHashrate","eth_submitWork","eth_syncing","eth_uninstallFilter","metamask_getProviderState","metamask_watchAsset","net_listening","net_peerCount","net_version","personal_ecRecover","personal_sign","wallet_watchAsset","web3_clientVersion","web3_sha3"]);r.unrestrictedMethods=f}}},{package:"<root>",file:"/home/circleci/project/app/scripts/controllers/permissions/specifications.js"}],[26,{"../../../../shared/constants/permissions":6267,"./enums":24,"@babel/runtime/helpers/defineProperty":189,"@babel/runtime/helpers/interopRequireDefault":195,"@metamask/obs-store":1193,"fast-safe-stringify":4377},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.PermissionLogController=void 0;var i=n(e("@babel/runtime/helpers/defineProperty")),s=e("@metamask/obs-store"),o=n(e("fast-safe-stringify")),a=e("../../../../shared/constants/permissions"),c=e("./enums");function u(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?u(Object(r),!0).forEach((function(t){(0,i.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):u(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function f(e,t){return e.reduce(((e,r)=>l(l({},e),{},{[r]:t})),{})}r.PermissionLogController=class{constructor({restrictedMethods:e,initState:t}){this.restrictedMethods=e,this.store=new s.ObservableStore(l({permissionHistory:{},permissionActivityLog:[]},t))}getActivityLog(){return this.store.getState().permissionActivityLog}updateActivityLog(e){this.store.updateState({permissionActivityLog:e})}getHistory(){return this.store.getState().permissionHistory}updateHistory(e){this.store.updateState({permissionHistory:e})}updateAccountsHistory(e,t){if(0===t.length)return;const r=f(t,Date.now());this.commitNewHistory(e,{eth_accounts:{accounts:r}})}createMiddleware(){return(e,t,r,n)=>{let i,s;const{origin:o,method:a}=e,u=a.startsWith(c.WALLET_PREFIX);if(c.LOG_IGNORE_METHODS.includes(a)||!u&&!this.restrictedMethods.has(a)){if("eth_requestAccounts"!==a)return void r();i=this.logRequest(e,u),s=["eth_accounts"]}else i=this.logRequest(e,u),a===`${c.WALLET_PREFIX}requestPermissions`&&(s=this.getRequestedMethods(e));r((e=>{const r=Date.now();this.logResponse(i,t,r),s&&!t.error&&t.result&&this.logPermissionsHistory(s,o,t.result,r,"eth_requestAccounts"===a),e()}))}}logRequest(e,t){const r={id:e.id,method:e.method,methodType:t?c.LOG_METHOD_TYPES.internal:c.LOG_METHOD_TYPES.restricted,origin:e.origin,request:(0,o.default)(e,null,2),requestTime:Date.now(),response:null,responseTime:null,success:null};return this.commitNewActivity(r),r}logResponse(e,t,r){e&&t&&(e.response=(0,o.default)(t,null,2),e.responseTime=r,e.success=!t.error)}commitNewActivity(e){const t=this.getActivityLog();t.push(e),t.length>c.LOG_LIMIT&&t.shift(),this.updateActivityLog(t)}logPermissionsHistory(e,t,r,n,i){let s,o;if(i){s=r;o={eth_accounts:{accounts:f(s,n),lastApproved:n}}}else o=r.map((e=>("eth_accounts"===e.parentCapability&&(s=this.getAccountsFromPermission(e)),e.parentCapability))).reduce(((t,r)=>{if(e.includes(r))if("eth_accounts"===r){const e=f(s,n);t[r]={lastApproved:n,accounts:e}}else t[r]={lastApproved:n};return t}),{});Object.keys(o).length>0&&this.commitNewHistory(t,o)}commitNewHistory(e,t){const r=this.getHistory(),n=l(l({},r[e]),t),i=r[e]&&r[e].eth_accounts,s=t.eth_accounts;if(i&&s){const e=s.lastApproved||i.lastApproved;n.eth_accounts={lastApproved:e,accounts:l(l({},i.accounts),s.accounts)}}r[e]=n,this.updateHistory(r)}getRequestedMethods(e){return e.params&&e.params[0]&&"object"==typeof e.params[0]&&!Array.isArray(e.params[0])?Object.keys(e.params[0]):null}getAccountsFromPermission(e){if("eth_accounts"!==e.parentCapability||!e.caveats)return[];const t=new Set;for(const r of e.caveats)if(r.type===a.CaveatTypes.restrictReturnedAccounts&&Array.isArray(r.value))for(const e of r.value)t.add(e);return[...t]}}}}},{package:"<root>",file:"/home/circleci/project/app/scripts/controllers/permissions/permission-log.js"}],[42,{},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e){let{name:t}=e;t=t===undefined?"Error":String(t);let r=e.message;r=r===undefined?"":String(r),""===t?e.stack=e.message:""===r?e.stack=e.name:e.stack||(e.stack=`${e.name}: ${e.message}`);return e}}}},{package:"<root>",file:"/home/circleci/project/app/scripts/lib/cleanErrorStack.js"}],[5374,{assert:1776,"await-semaphore":1857,"ethjs-query":2646},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("ethjs-query"),i=e("assert"),s=e("await-semaphore").Mutex;t.exports=class{constructor({provider:e,blockTracker:t,getPendingTransactions:r,getConfirmedTransactions:i}){this.provider=e,this.blockTracker=t,this.ethQuery=new n(e),this.getPendingTransactions=r,this.getConfirmedTransactions=i,this.lockMap={}}async getGlobalLock(){const e=this._lookupMutex("global");return{releaseLock:await e.acquire()}}async getNonceLock(e){await this._globalMutexFree();const t=await this._takeMutex(e);try{const r={},n=await this._getNetworkNextNonce(e),s=this._getHighestLocallyConfirmed(e),o=n.nonce,a=Math.max(o,s),c=this.getPendingTransactions(e),u=this._getHighestContinuousFrom(c,a)||0;r.params={highestLocallyConfirmed:s,highestSuggested:a,nextNetworkNonce:o},r.local=u,r.network=n;const l=Math.max(n.nonce,u.nonce);return i(Number.isInteger(l),`nonce-tracker - nextNonce is not an integer - got: (${typeof l}) "${l}"`),{nextNonce:l,nonceDetails:r,releaseLock:t}}catch(e){throw t(),e}}async _globalMutexFree(){const e=this._lookupMutex("global");(await e.acquire())()}async _takeMutex(e){const t=this._lookupMutex(e);return await t.acquire()}_lookupMutex(e){let t=this.lockMap[e];return t||(t=new s,this.lockMap[e]=t),t}async _getNetworkNextNonce(e){const t=await this.blockTracker.getLatestBlock(),r=(await this.ethQuery.getTransactionCount(e,t)).toNumber();i(Number.isInteger(r),`nonce-tracker - baseCount is not an integer - got: (${typeof r}) "${r}"`);return{name:"network",nonce:r,details:{blockNumber:t,baseCount:r}}}_getHighestLocallyConfirmed(e){const t=this.getConfirmedTransactions(e),r=this._getHighestNonce(t);return Number.isInteger(r)?r+1:0}_getHighestNonce(e){const t=e.map((e=>{const t=e.txParams.nonce;return i(typeof t,"string","nonces should be hex strings"),parseInt(t,16)}));return Math.max.apply(null,t)}_getHighestContinuousFrom(e,t){const r=e.map((e=>{const t=e.txParams.nonce;return i(typeof t,"string","nonces should be hex strings"),parseInt(t,16)}));let n=t;for(;r.includes(n);)n++;return{name:"local",nonce:n,details:{startPoint:t,highest:n}}}}}}},{package:"nonce-tracker",file:"/home/circleci/project/node_modules/nonce-tracker/index.js"}],[34,{"../../../../../shared/constants/transaction":6270,"../../../../../shared/modules/hexstring-utils":6276,"../../../../../shared/modules/transaction.utils":6282,"../../../lib/util":81,"eth-rpc-errors":2531},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.getFinalStates=function(){return[s.TRANSACTION_STATUSES.REJECTED,s.TRANSACTION_STATUSES.CONFIRMED,s.TRANSACTION_STATUSES.FAILED,s.TRANSACTION_STATUSES.DROPPED]},r.normalizeAndValidateTxParams=function(e,t=!0){const r=u(e,t);return h(r),r},r.normalizeTxParams=u,r.normalizeTxReceiptGasUsed=function(e){return"string"==typeof e?e:e.toString(16)},r.validateConfirmedExternalTransaction=void 0,r.validateFrom=p,r.validateRecipient=m,r.validateTxParams=h;var n=e("eth-rpc-errors"),i=e("../../../lib/util"),s=e("../../../../../shared/constants/transaction"),o=e("../../../../../shared/modules/transaction.utils"),a=e("../../../../../shared/modules/hexstring-utils");const c={from:i.addHexPrefix,to:(e,t)=>t?(0,i.addHexPrefix)(e).toLowerCase():(0,i.addHexPrefix)(e),nonce:i.addHexPrefix,value:i.addHexPrefix,data:i.addHexPrefix,gas:i.addHexPrefix,gasPrice:i.addHexPrefix,maxFeePerGas:i.addHexPrefix,maxPriorityFeePerGas:i.addHexPrefix,type:i.addHexPrefix,estimateSuggested:e=>e,estimateUsed:e=>e};function u(e,t=!0){const r={};for(const n in c)e[n]&&(r[n]=c[n](e[n],t));return r}function l(e,t,r){if(void 0!==e[r])throw n.ethErrors.rpc.invalidParams(`Invalid transaction params: specified ${t} but also included ${r}, these cannot be mixed`)}function f(e,t){if("string"!=typeof e[t])throw n.ethErrors.rpc.invalidParams(`Invalid transaction params: ${t} is not a string. got: (${e[t]})`)}function d(e,t){switch(t){case"maxFeePerGas":case"maxPriorityFeePerGas":if(e.type&&e.type!==s.TRANSACTION_ENVELOPE_TYPES.FEE_MARKET)throw n.ethErrors.rpc.invalidParams(`Invalid transaction envelope type: specified type "${e.type}" but including maxFeePerGas and maxPriorityFeePerGas requires type: "${s.TRANSACTION_ENVELOPE_TYPES.FEE_MARKET}"`);break;default:if(e.type&&e.type===s.TRANSACTION_ENVELOPE_TYPES.FEE_MARKET)throw n.ethErrors.rpc.invalidParams(`Invalid transaction envelope type: specified type "${e.type}" but included a gasPrice instead of maxFeePerGas and maxPriorityFeePerGas`)}}function h(e,t=!0){if(!e||"object"!=typeof e||Array.isArray(e))throw n.ethErrors.rpc.invalidParams("Invalid transaction params: must be an object.");if(!e.to&&!e.data)throw n.ethErrors.rpc.invalidParams('Invalid transaction params: must specify "data" for contract deployments, or "to" (and optionally "data") for all other types of transactions.');if((0,o.isEIP1559Transaction)({txParams:e})&&!t)throw n.ethErrors.rpc.invalidParams("Invalid transaction params: params specify an EIP-1559 transaction but the current network does not support EIP-1559");Object.entries(e).forEach((([t,r])=>{switch(t){case"from":p(e);break;case"to":m(e);break;case"gasPrice":d(e,"gasPrice"),l(e,"gasPrice","maxFeePerGas"),l(e,"gasPrice","maxPriorityFeePerGas"),f(e,"gasPrice");break;case"maxFeePerGas":d(e,"maxFeePerGas"),l(e,"maxFeePerGas","gasPrice"),f(e,"maxFeePerGas");break;case"maxPriorityFeePerGas":d(e,"maxPriorityFeePerGas"),l(e,"maxPriorityFeePerGas","gasPrice"),f(e,"maxPriorityFeePerGas");break;case"value":if(f(e,"value"),r.toString().includes("-"))throw n.ethErrors.rpc.invalidParams(`Invalid transaction value "${r}": not a positive number.`);if(r.toString().includes("."))throw n.ethErrors.rpc.invalidParams(`Invalid transaction value of "${r}": number must be in wei.`);if(!r.match(/^0x[a-fA-F0-9]+$/u))throw n.ethErrors.rpc.invalidParams(`Invalid transaction value of "${r}": not a valid hex string.`);break;case"chainId":if("number"!=typeof r&&"string"!=typeof r)throw n.ethErrors.rpc.invalidParams(`Invalid transaction params: ${t} is not a Number or hex string. got: (${r})`);break;default:f(e,t)}}))}function p(e){if("string"!=typeof e.from)throw n.ethErrors.rpc.invalidParams(`Invalid "from" address "${e.from}": not a string.`);if(!(0,a.isValidHexAddress)(e.from,{allowNonPrefixed:!1}))throw n.ethErrors.rpc.invalidParams('Invalid "from" address.')}function m(e){if("0x"===e.to||null===e.to){if(!e.data)throw n.ethErrors.rpc.invalidParams('Invalid "to" address.');delete e.to}else if(e.to!==undefined&&!(0,a.isValidHexAddress)(e.to,{allowNonPrefixed:!1}))throw n.ethErrors.rpc.invalidParams('Invalid "to" address.');return e}r.validateConfirmedExternalTransaction=({txMeta:e,pendingTransactions:t,confirmedTransactions:r}={})=>{if(!e||!e.txParams)throw n.ethErrors.rpc.invalidParams('"txMeta" or "txMeta.txParams" is missing');if(e.status!==s.TRANSACTION_STATUSES.CONFIRMED)throw n.ethErrors.rpc.invalidParams('External transaction status should be "confirmed"');const i=e.txParams.nonce;if(t&&t.length>0){if(t.find((e=>{var t;return(null===(t=e.txParams)||void 0===t?void 0:t.nonce)===i})))throw n.ethErrors.rpc.invalidParams("External transaction nonce should not be in pending txs")}if(r&&r.length>0){if(r.find((e=>{var t;return(null===(t=e.txParams)||void 0===t?void 0:t.nonce)===i})))throw n.ethErrors.rpc.invalidParams("External transaction nonce should not be in confirmed txs")}}}}},{package:"<root>",file:"/home/circleci/project/app/scripts/controllers/transactions/lib/util.js"}],[37,{"../../../../shared/constants/transaction":6270,"../../../../shared/modules/random-id":6278,"../../../../shared/modules/transaction.utils":6282,"../../metamask-controller":82,"./lib/tx-state-history-helpers":33,"./lib/util":34,"@babel/runtime/helpers/defineProperty":189,"@babel/runtime/helpers/interopRequireDefault":195,"@metamask/obs-store":1193,lodash:5250,loglevel:5260,"safe-event-emitter":5818},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=n(e("@babel/runtime/helpers/defineProperty")),s=n(e("safe-event-emitter")),o=e("@metamask/obs-store"),a=n(e("loglevel")),c=e("lodash"),u=n(e("../../../../shared/modules/random-id")),l=e("../../../../shared/constants/transaction"),f=e("../../metamask-controller"),d=e("../../../../shared/modules/transaction.utils"),h=e("./lib/tx-state-history-helpers"),p=e("./lib/util");function m(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function g(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?m(Object(r),!0).forEach((function(t){(0,i.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):m(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}class y extends s.default{constructor({initState:e,txHistoryLimit:t,getNetwork:r,getCurrentChainId:n}){super(),this.store=new o.ObservableStore(g({transactions:{}},e)),this.txHistoryLimit=t,this.getNetwork=r,this.getCurrentChainId=n}generateTxMeta(e={}){var t;const r=this.getNetwork(),n=this.getCurrentChainId();if("loading"===r)throw new Error("MetaMask is having trouble connecting to the network");let i=null;return e.txParams&&"string"==typeof e.origin&&"metamask"!==e.origin&&(void 0!==e.txParams.gasPrice?i={gasPrice:e.txParams.gasPrice}:void 0===e.txParams.maxFeePerGas&&void 0===e.txParams.maxPriorityFeePerGas||(i={maxPriorityFeePerGas:e.txParams.maxPriorityFeePerGas,maxFeePerGas:e.txParams.maxFeePerGas}),void 0!==e.txParams.gas&&(i=g(g({},i),{},{gas:e.txParams.gas}))),g({id:(0,u.default)(),time:(new Date).getTime(),status:l.TRANSACTION_STATUSES.UNAPPROVED,metamaskNetworkId:r,originalGasEstimate:null===(t=e.txParams)||void 0===t?void 0:t.gas,userEditedGasLimit:!1,chainId:n,loadingDefaults:!0,dappSuggestedGasFees:i},e)}getUnapprovedTxList(){const e=this.getCurrentChainId(),t=this.getNetwork();return(0,c.pickBy)(this.store.getState().transactions,(r=>r.status===l.TRANSACTION_STATUSES.UNAPPROVED&&(0,d.transactionMatchesNetwork)(r,e,t)))}getApprovedTransactions(e){const t={status:l.TRANSACTION_STATUSES.APPROVED};return e&&(t.from=e),this.getTransactions({searchCriteria:t})}getPendingTransactions(e){const t={status:l.TRANSACTION_STATUSES.SUBMITTED};return e&&(t.from=e),this.getTransactions({searchCriteria:t})}getConfirmedTransactions(e){const t={status:l.TRANSACTION_STATUSES.CONFIRMED};return e&&(t.from=e),this.getTransactions({searchCriteria:t})}addTransaction(e){e.txParams&&(e.txParams=(0,p.normalizeAndValidateTxParams)(e.txParams,!1)),this.once(`${e.id}:signed`,(()=>{this.removeAllListeners(`${e.id}:rejected`)})),this.once(`${e.id}:rejected`,(()=>{this.removeAllListeners(`${e.id}:signed`)})),e.history=[];const t=(0,h.snapshotFromTxMeta)(e);e.history.push(t);const r=this.getTransactions({filterToCurrentNetwork:!1}),{txHistoryLimit:n}=this,i=new Set,s=r.reverse().filter((e=>{const{nonce:t,from:r}=e.txParams,{chainId:s,metamaskNetworkId:o,status:a}=e,c=`${t}-${null!=s?s:o}-${r}`;return!i.has(c)&&(!(i.size<n-1||!1===(0,p.getFinalStates)().includes(a))||(i.add(c),!1))})).map((e=>e.id));return this._deleteTransactions(s),this._addTransactionsToState([e]),e}addExternalTransaction(e){var t;const r=null==e||null===(t=e.txParams)||void 0===t?void 0:t.from,n=this.getConfirmedTransactions(r),i=this.getPendingTransactions(r);return(0,p.validateConfirmedExternalTransaction)({txMeta:e,pendingTransactions:i,confirmedTransactions:n}),this._addTransactionsToState([e]),e}getTransaction(e){const{transactions:t}=this.store.getState();return t[e]}updateTransaction(e,t){e.txParams&&(e.txParams=(0,p.normalizeAndValidateTxParams)(e.txParams,!1));const r=(0,h.snapshotFromTxMeta)(e),n=(0,h.replayHistory)(e.history),i=(0,h.generateHistoryEntry)(n,r,t);i.length&&e.history.push(i);const s=e.id;this.store.updateState({transactions:g(g({},this.store.getState().transactions),{},{[s]:e})})}getTransactions({searchCriteria:e={},initialList:t,filterToCurrentNetwork:r=!0,limit:n}={}){const i=this.getCurrentChainId(),s=this.getNetwork(),o=(0,c.mapValues)(e,(e=>"function"==typeof e?e:t=>t===e)),a=t?(0,c.keyBy)(t,"id"):this.store.getState().transactions,u=(0,c.sortBy)((0,c.pickBy)(a,(e=>{if(r&&!1===(0,d.transactionMatchesNetwork)(e,i,s))return!1;for(const[t,r]of Object.entries(o))if(t in e.txParams){if(!1===r(e.txParams[t]))return!1}else if(!1===r(e[t]))return!1;return!0})),"time");if(n!==undefined){const e=new Set,t=[];for(let r=u.length-1;r>-1;r--){const i=u[r],{nonce:s}=i.txParams;if(!e.has(s)){if(!(e.size<n))continue;e.add(s)}t.unshift(i)}return t}return u}setTxStatusRejected(e){this._setTransactionStatus(e,l.TRANSACTION_STATUSES.REJECTED),this._deleteTransaction(e)}setTxStatusUnapproved(e){this._setTransactionStatus(e,l.TRANSACTION_STATUSES.UNAPPROVED)}setTxStatusApproved(e){this._setTransactionStatus(e,l.TRANSACTION_STATUSES.APPROVED)}setTxStatusSigned(e){this._setTransactionStatus(e,l.TRANSACTION_STATUSES.SIGNED)}setTxStatusSubmitted(e){const t=this.getTransaction(e);t.submittedTime=(new Date).getTime(),this.updateTransaction(t,"txStateManager - add submitted time stamp"),this._setTransactionStatus(e,l.TRANSACTION_STATUSES.SUBMITTED)}setTxStatusConfirmed(e){this._setTransactionStatus(e,l.TRANSACTION_STATUSES.CONFIRMED)}setTxStatusDropped(e){this._setTransactionStatus(e,l.TRANSACTION_STATUSES.DROPPED)}setTxStatusFailed(e,t){var r;const n=t||new Error("Internal metamask failure"),i=this.getTransaction(e);i.err={message:(null===(r=n.message)||void 0===r?void 0:r.toString())||n.toString(),rpc:n.value,stack:n.stack},this.updateTransaction(i,"transactions:tx-state-manager#fail - add error"),this._setTransactionStatus(e,l.TRANSACTION_STATUSES.FAILED)}wipeTransactions(e){const{transactions:t}=this.store.getState(),r=this.getNetwork(),n=this.getCurrentChainId();this.store.updateState({transactions:(0,c.omitBy)(t,(t=>t.txParams.from===e&&(0,d.transactionMatchesNetwork)(t,n,r)))})}clearUnapprovedTxs(){this.store.updateState({transactions:(0,c.omitBy)(this.store.getState().transactions,(e=>e.status===l.TRANSACTION_STATUSES.UNAPPROVED))})}_setTransactionStatus(e,t){const r=this.getTransaction(e);if(r){r.status=t;try{this.updateTransaction(r,`txStateManager: setting status to ${t}`),this.emit(`${r.id}:${t}`,e),this.emit("tx:status-update",e,t),[l.TRANSACTION_STATUSES.SUBMITTED,l.TRANSACTION_STATUSES.REJECTED,l.TRANSACTION_STATUSES.FAILED].includes(t)&&this.emit(`${r.id}:finished`,r),this.emit(f.METAMASK_CONTROLLER_EVENTS.UPDATE_BADGE)}catch(e){a.default.error(e)}}}_addTransactionsToState(e){this.store.updateState({transactions:e.reduce(((e,t)=>(e[t.id]=t,e)),this.store.getState().transactions)})}_deleteTransaction(e){const{transactions:t}=this.store.getState();delete t[e],this.store.updateState({transactions:t})}_deleteTransactions(e){const{transactions:t}=this.store.getState();e.forEach((e=>{delete t[e]})),this.store.updateState({transactions:t})}}r.default=y}}},{package:"<root>",file:"/home/circleci/project/app/scripts/controllers/transactions/tx-state-manager.js"}],[36,{"../../lib/util":81,"@babel/runtime/helpers/interopRequireDefault":195,"ethereumjs-util":2597,"ethjs-query":2646,lodash:5250,loglevel:5260},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=n(e("ethjs-query")),s=n(e("loglevel")),o=e("ethereumjs-util"),a=e("lodash"),c=e("../../lib/util");r.default=class{constructor(e){this.query=new i.default(e)}async analyzeGasUsage(e){const t=await this.query.getBlockByNumber("latest",!1),r=(0,c.hexToBn)(t.gasLimit),n=(0,c.BnMultiplyByFraction)(r,19,20);let i,o=(0,c.bnToHex)(n);try{o=await this.estimateTxGas(e)}catch(e){s.default.warn(e),i={reason:e.message,errorKey:e.errorKey,debug:{blockNumber:t.number,blockGasLimit:t.gasLimit}}}return{blockGasLimit:t.gasLimit,estimatedGasHex:o,simulationFails:i}}async estimateTxGas(e){const t=(0,a.cloneDeep)(e.txParams);return delete t.gasPrice,delete t.maxFeePerGas,delete t.maxPriorityFeePerGas,await this.query.estimateGas(t)}addGasBuffer(e,t,r=1.5){const n=(0,c.hexToBn)(e),i=(0,c.hexToBn)(t).muln(.9),s=n.muln(r);return n.gt(i)?(0,c.bnToHex)(n):s.lt(i)?(0,c.bnToHex)(s):(0,c.bnToHex)(i)}async getBufferedGasLimit(e,t){const{blockGasLimit:r,estimatedGasHex:n,simulationFails:i}=await this.analyzeGasUsage(e);return{gasLimit:this.addGasBuffer((0,o.addHexPrefix)(n),r,t),simulationFails:i}}}}}},{package:"<root>",file:"/home/circleci/project/app/scripts/controllers/transactions/tx-gas-utils.js"}],[35,{"../../../../shared/constants/transaction":6270,"@babel/runtime/helpers/defineProperty":189,"@babel/runtime/helpers/interopRequireDefault":195,"ethjs-query":2646,loglevel:5260,"safe-event-emitter":5818},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=n(e("@babel/runtime/helpers/defineProperty")),s=n(e("safe-event-emitter")),o=n(e("loglevel")),a=n(e("ethjs-query")),c=e("../../../../shared/constants/transaction");class u extends s.default{constructor(e){super(),(0,i.default)(this,"DROPPED_BUFFER_COUNT",3),(0,i.default)(this,"droppedBlocksBufferByHash",new Map),this.query=e.query||new a.default(e.provider),this.nonceTracker=e.nonceTracker,this.getPendingTransactions=e.getPendingTransactions,this.getCompletedTransactions=e.getCompletedTransactions,this.publishTransaction=e.publishTransaction,this.approveTransaction=e.approveTransaction,this.confirmTransaction=e.confirmTransaction}async updatePendingTxs(){const e=await this.nonceTracker.getGlobalLock();try{const e=this.getPendingTransactions();await Promise.all(e.map((e=>this._checkPendingTx(e))))}catch(e){o.default.error("PendingTransactionTracker - Error updating pending transactions"),o.default.error(e)}e.releaseLock()}async resubmitPendingTxs(e){const t=this.getPendingTransactions();if(t.length)for(const i of t)try{await this._resubmitTx(i,e)}catch(e){var r,n;const t=(null===(r=e.value)||void 0===r||null===(n=r.message)||void 0===n?void 0:n.toLowerCase())||e.message.toLowerCase();if(t.includes("replacement transaction underpriced")||t.includes("known transaction")||t.includes("gas price too low to replace")||t.includes("transaction with the same hash was already imported")||t.includes("gateway timeout")||t.includes("nonce too low"))return;i.warning={error:t,message:"There was an error when resubmitting this transaction."},this.emit("tx:warning",i,e)}}async _resubmitTx(e,t){e.firstRetryBlockNumber||this.emit("tx:block-update",e,t);const r=e.firstRetryBlockNumber||t,n=Number.parseInt(t,16)-Number.parseInt(r,16),i=e.retryCount||0;if(n<Math.min(50,Math.pow(2,i)))return undefined;if(!("rawTx"in e))return this.approveTransaction(e.id);const{rawTx:s}=e,o=await this.publishTransaction(s);return this.emit("tx:retry",e),o}async _checkPendingTx(e){const t=e.hash,r=e.id;if(e.status===c.TRANSACTION_STATUSES.SUBMITTED){if(!t){const e=new Error("We had an error while submitting this transaction, please try again.");return e.name="NoTxHashError",void this.emit("tx:failed",r,e)}if(await this._checkIfNonceIsTaken(e))this.emit("tx:dropped",r);else{try{const e=await this.query.getTransactionReceipt(t);if(null!=e&&e.blockNumber){const{baseFeePerGas:t,timestamp:n}=await this.query.getBlockByHash(null==e?void 0:e.blockHash,!1);return void this.emit("tx:confirmed",r,e,t,n)}}catch(t){return e.warning={error:t.message,message:"There was a problem loading this transaction."},void this.emit("tx:warning",e,t)}await this._checkIfTxWasDropped(e)&&this.emit("tx:dropped",r)}}}async _checkIfTxWasDropped(e){const{hash:t,txParams:{nonce:r,from:n}}=e,i=await this.query.getTransactionCount(n);if(parseInt(r,16)>=i.toNumber())return!1;this.droppedBlocksBufferByHash.has(t)||this.droppedBlocksBufferByHash.set(t,0);const s=this.droppedBlocksBufferByHash.get(t);return s<this.DROPPED_BUFFER_COUNT?(this.droppedBlocksBufferByHash.set(t,s+1),!1):(this.droppedBlocksBufferByHash.delete(t),!0)}async _checkIfNonceIsTaken(e){const t=e.txParams.from;return this.getCompletedTransactions(t).some((t=>!(t.id===e.id)&&t.txParams.nonce===e.txParams.nonce))}}r.default=u}}},{package:"<root>",file:"/home/circleci/project/app/scripts/controllers/transactions/pending-tx-tracker.js"}],[1753,{"./package.json":1757,"@segment/loosely-validate-event":1550,_process:5498,assert:1776,axios:1860,"axios-retry":1858,"lodash.isstring":5077,md5:5270,ms:5282,"remove-trailing-slash":5806,"uuid/v4":1756},function(){with(this)return function(){"use strict";return function(e,t,r){(function(r){(function(){const n=e("assert"),i=e("remove-trailing-slash"),s=e("@segment/loosely-validate-event"),o=e("axios"),a=e("axios-retry"),c=e("ms"),u=e("uuid/v4"),l=e("md5"),f=e("./package.json").version,d=e("lodash.isstring"),h=global.setImmediate||r.nextTick.bind(r),p=()=>{};t.exports=class{constructor(e,t){t=t||{},n(e,"You must pass your Segment project's write key."),this.queue=[],this.writeKey=e,this.host=i(t.host||"https://api.segment.io"),this.timeout=t.timeout||!1,this.flushAt=Math.max(t.flushAt,1)||20,this.flushInterval=t.flushInterval||1e4,this.flushed=!1,Object.defineProperty(this,"enable",{configurable:!1,writable:!1,enumerable:!0,value:"boolean"!=typeof t.enable||t.enable}),this.axiosClient=o.create(),a(this.axiosClient,{retries:t.retryCount||3,retryCondition:this._isErrorRetryable,retryDelay:a.exponentialDelay})}_validate(e,t){try{s(e,t)}catch(t){if("Your message must be < 32kb."===t.message)return void console.log("Your message must be < 32kb. This is currently surfaced as a warning to allow clients to update. Versions released after August 1, 2018 will throw an error instead. Please update your code before then.",e);throw t}}identify(e,t){return this._validate(e,"identify"),this.enqueue("identify",e,t),this}group(e,t){return this._validate(e,"group"),this.enqueue("group",e,t),this}track(e,t){return this._validate(e,"track"),this.enqueue("track",e,t),this}page(e,t){return this._validate(e,"page"),this.enqueue("page",e,t),this}screen(e,t){return this._validate(e,"screen"),this.enqueue("screen",e,t),this}alias(e,t){return this._validate(e,"alias"),this.enqueue("alias",e,t),this}enqueue(e,t,n){return n=n||p,this.enable?((t=Object.assign({},t)).type=e,t.context=Object.assign({library:{name:"analytics-node",version:f}},t.context),t._metadata=Object.assign({nodeVersion:r.versions.node},t._metadata),t.timestamp||(t.timestamp=new Date),t.messageId||(t.messageId=`node-${l(JSON.stringify(t))}-${u()}`),t.anonymousId&&!d(t.anonymousId)&&(t.anonymousId=JSON.stringify(t.anonymousId)),t.userId&&!d(t.userId)&&(t.userId=JSON.stringify(t.userId)),this.queue.push({message:t,callback:n}),this.flushed?(this.queue.length>=this.flushAt&&this.flush(),void(this.flushInterval&&!this.timer&&(this.timer=setTimeout(this.flush.bind(this),this.flushInterval)))):(this.flushed=!0,void this.flush())):h(n)}flush(e){if(e=e||p,!this.enable)return h(e);if(this.timer&&(clearTimeout(this.timer),this.timer=null),!this.queue.length)return h(e);const t=this.queue.splice(0,this.flushAt),r=t.map((e=>e.callback)),n={batch:t.map((e=>e.message)),timestamp:new Date,sentAt:new Date},i=t=>{r.forEach((e=>e(t))),e(t,n)},s={};"undefined"==typeof window&&(s["user-agent"]=`analytics-node/${f}`);const o={method:"POST",url:`${this.host}/v1/batch`,auth:{username:this.writeKey},data:n,headers:s};this.timeout&&(o.timeout="string"==typeof this.timeout?c(this.timeout):this.timeout),this.axiosClient(o).then((()=>i())).catch((e=>{if(e.response){const t=new Error(e.response.statusText);return i(t)}i(e)}))}_isErrorRetryable(e){return!!a.isNetworkError(e)||!!e.response&&(e.response.status>=500&&e.response.status<=599||429===e.response.status)}}}).call(this)}).call(this,e("_process"))}}},{package:"analytics-node",file:"/home/circleci/project/node_modules/analytics-node/index.js"}],[2618,{"./index.js":2603,"aes-js":1751,crypto:2267,"ethereumjs-util":2608,"safe-buffer":5817,scryptsy:5827,utf8:6085},function(){with(this)return function(){"use strict";return function(e,t,r){var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=e("./index.js"),s=e("ethereumjs-util"),o=e("crypto"),a=e("scryptsy"),c=e("utf8"),u=e("aes-js"),l=e("safe-buffer").Buffer;function f(e,t){if(!e)throw new Error(t||"Assertion failed")}var d={};d.fromEtherWallet=function(e,t){var r,s="object"===(void 0===e?"undefined":n(e))?e:JSON.parse(e);if(s.locked){if("string"!=typeof t)throw new Error("Password required");if(t.length<7)throw new Error("Password must be at least 7 characters");var a=s.encrypted?s.private.slice(0,128):s.private;if(a=function(e){var t=l.from(e,"base64");return"Salted__"===t.slice(0,8).toString()?{salt:t.slice(8,16),ciphertext:t.slice(16)}:{ciphertext:t}}(a),!a.salt)throw new Error("Unsupported EtherWallet key format");var u=function(e,t,r){function n(n){var i=o.createHash(r.digest||"md5");i.update(n),i.update(e),i.update(t),n=i.digest();for(var s=1;s<(r.count||1);s++)(i=o.createHash(r.digest||"md5")).update(n),n=i.digest();return n}for(var i=r.keysize||16,s=r.ivsize||16,a=[],c=0;l.concat(a).length<i+s;)a[c]=n(0===c?l.alloc(0):a[c-1]),c++;var u=l.concat(a);return{key:u.slice(0,i),iv:u.slice(i,i+s)}}(l.from(t),a.salt,{keysize:32,ivsize:16});r=function(e,t){return l.concat([e.update(t),e.final()])}(o.createDecipheriv("aes-256-cbc",u.key,u.iv),l.from(a.ciphertext)),r=l.from(c.decode(r.toString()),"hex")}else{if(64!==s.private.length)throw new Error("Invalid private key length");r=l.from(s.private,"hex")}var f=new i(r);if(f.getAddressString()!==s.address)throw new Error("Invalid private key or address");return f},d.fromEtherCamp=function(e){return new i(s.keccak256(l.from(e)))},d.fromKryptoKit=function(e,t){"#"===e[0]&&(e=e.slice(1));var r,n=e[0];if(e=e.slice(1),"d"===n)r=s.sha256(l.from(e));else{if("q"!==n)throw new Error("Unsupported or invalid entropy type");if("string"!=typeof t)throw new Error("Password required");var o=s.sha256(l.from(e.slice(0,30))),c=e.slice(30,46),f=function(e){function t(e){try{return decodeURIComponent(e)}catch(e){return String.fromCharCode(65533)}}for(var r="",n="",i=0;i<e.length;i++)e[i]<=127?(r+=t(n)+String.fromCharCode(e[i]),n=""):n+="%"+e[i].toString(16);return l.from(r+t(n))}(o),d=a(l.from(t,"utf8"),f,16384,8,1,32),h=new u.ModeOfOperation.ecb(d);if(r=l.concat([l.from(h.decrypt(o.slice(0,16))),l.from(h.decrypt(o.slice(16,32)))]),c.length>0&&c!==s.sha256(s.sha256(r)).slice(0,8).toString("hex"))throw new Error("Failed to decrypt input - possibly invalid passphrase")}return new i(r)},d.fromQuorumWallet=function(e,t){f(e.length>=10),f(t.length>=10);var r=e+t;return r=o.pbkdf2Sync(r,r,2e3,32,"sha256"),new i(r)},t.exports=d}}},{package:"ethereumjs-wallet",file:"/home/circleci/project/node_modules/ethereumjs-wallet/thirdparty.js"}],[2603,{bs58check:2166,crypto:2267,"ethereumjs-util":2608,randombytes:5632,"safe-buffer":5817,scryptsy:5827,"uuid/v4":2617},function(){with(this)return function(){"use strict";return function(e,t,r){var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=e("safe-buffer").Buffer,s=e("ethereumjs-util"),o=e("crypto"),a=e("randombytes"),c=e("scryptsy"),u=e("uuid/v4"),l=e("bs58check");function f(e,t){if(!e)throw new Error(t||"Assertion failed")}function d(e,t){return i.concat([e.update(t),e.final()])}var h=function(e,t){if(e&&t)throw new Error("Cannot supply both a private and a public key to the constructor");if(e&&!s.isValidPrivate(e))throw new Error("Private key does not satisfy the curve requirements (ie. it is invalid)");if(t&&!s.isValidPublic(t))throw new Error("Invalid public key");this._privKey=e,this._pubKey=t};Object.defineProperty(h.prototype,"privKey",{get:function(){return f(this._privKey,"This is a public key only wallet"),this._privKey}}),Object.defineProperty(h.prototype,"pubKey",{get:function(){return this._pubKey||(this._pubKey=s.privateToPublic(this.privKey)),this._pubKey}}),h.generate=function(e){if(!e)return new h(a(32));for(var t=new s.BN("088f924eeceeda7fe92e1f5b0fffffffffffffff",16);;){var r=a(32);if(new s.BN(s.privateToAddress(r)).lte(t))return new h(r)}},h.generateVanityAddress=function(e){for("object"!==(void 0===e?"undefined":n(e))&&(e=new RegExp(e));;){var t=a(32),r=s.privateToAddress(t);if(e.test(r.toString("hex")))return new h(t)}},h.prototype.getPrivateKey=function(){return this.privKey},h.prototype.getPrivateKeyString=function(){return s.bufferToHex(this.getPrivateKey())},h.prototype.getPublicKey=function(){return this.pubKey},h.prototype.getPublicKeyString=function(){return s.bufferToHex(this.getPublicKey())},h.prototype.getAddress=function(){return s.publicToAddress(this.pubKey)},h.prototype.getAddressString=function(){return s.bufferToHex(this.getAddress())},h.prototype.getChecksumAddressString=function(){return s.toChecksumAddress(this.getAddressString())},h.prototype.toV3=function(e,t){f(this._privKey,"This is a public key only wallet");var r,n=(t=t||{}).salt||a(32),l=t.iv||a(16),h=t.kdf||"scrypt",p={dklen:t.dklen||32,salt:n.toString("hex")};if("pbkdf2"===h)p.c=t.c||262144,p.prf="hmac-sha256",r=o.pbkdf2Sync(i.from(e),n,p.c,p.dklen,"sha256");else{if("scrypt"!==h)throw new Error("Unsupported kdf");p.n=t.n||262144,p.r=t.r||8,p.p=t.p||1,r=c(i.from(e),n,p.n,p.r,p.p,p.dklen)}var m=o.createCipheriv(t.cipher||"aes-128-ctr",r.slice(0,16),l);if(!m)throw new Error("Unsupported cipher");var g=d(m,this.privKey),y=s.keccak256(i.concat([r.slice(16,32),i.from(g,"hex")]));return{version:3,id:u({random:t.uuid||a(16)}),address:this.getAddress().toString("hex"),crypto:{ciphertext:g.toString("hex"),cipherparams:{iv:l.toString("hex")},cipher:t.cipher||"aes-128-ctr",kdf:h,kdfparams:p,mac:y.toString("hex")}}},h.prototype.getV3Filename=function(e){return["UTC--",(e?new Date(e):new Date).toJSON().replace(/:/g,"-"),"--",this.getAddress().toString("hex")].join("")},h.prototype.toV3String=function(e,t){return JSON.stringify(this.toV3(e,t))},h.fromPublicKey=function(e,t){return t&&(e=s.importPublic(e)),new h(null,e)},h.fromExtendedPublicKey=function(e){return f("xpub"===e.slice(0,4),"Not an extended public key"),e=l.decode(e).slice(45),h.fromPublicKey(e,!0)},h.fromPrivateKey=function(e){return new h(e)},h.fromExtendedPrivateKey=function(e){f("xprv"===e.slice(0,4),"Not an extended private key");var t=l.decode(e);return f(0===t[45],"Invalid extended private key"),h.fromPrivateKey(t.slice(46))},h.fromV1=function(e,t){f("string"==typeof t);var r="object"===(void 0===e?"undefined":n(e))?e:JSON.parse(e);if("1"!==r.Version)throw new Error("Not a V1 wallet");if("scrypt"!==r.Crypto.KeyHeader.Kdf)throw new Error("Unsupported key derivation scheme");var a=r.Crypto.KeyHeader.KdfParams,u=c(i.from(t),i.from(r.Crypto.Salt,"hex"),a.N,a.R,a.P,a.DkLen),l=i.from(r.Crypto.CipherText,"hex");if(s.keccak256(i.concat([u.slice(16,32),l])).toString("hex")!==r.Crypto.MAC)throw new Error("Key derivation failed - possibly wrong passphrase");var p=d(o.createDecipheriv("aes-128-cbc",s.keccak256(u.slice(0,16)).slice(0,16),i.from(r.Crypto.IV,"hex")),l);return new h(p)},h.fromV3=function(e,t,r){f("string"==typeof t);var a,u,l="object"===(void 0===e?"undefined":n(e))?e:JSON.parse(r?e.toLowerCase():e);if(3!==l.version)throw new Error("Not a V3 wallet");if("scrypt"===l.crypto.kdf)u=l.crypto.kdfparams,a=c(i.from(t),i.from(u.salt,"hex"),u.n,u.r,u.p,u.dklen);else{if("pbkdf2"!==l.crypto.kdf)throw new Error("Unsupported key derivation scheme");if("hmac-sha256"!==(u=l.crypto.kdfparams).prf)throw new Error("Unsupported parameters to PBKDF2");a=o.pbkdf2Sync(i.from(t),i.from(u.salt,"hex"),u.c,u.dklen,"sha256")}var p=i.from(l.crypto.ciphertext,"hex");if(s.keccak256(i.concat([a.slice(16,32),p])).toString("hex")!==l.crypto.mac)throw new Error("Key derivation failed - possibly wrong passphrase");var m=d(o.createDecipheriv(l.crypto.cipher,a.slice(0,16),i.from(l.crypto.cipherparams.iv,"hex")),p);return new h(m)},h.fromEthSale=function(e,t){f("string"==typeof t);var r="object"===(void 0===e?"undefined":n(e))?e:JSON.parse(e),a=i.from(r.encseed,"hex"),c=o.pbkdf2Sync(t,t,2e3,32,"sha256").slice(0,16),u=d(o.createDecipheriv("aes-128-cbc",c,a.slice(0,16)),a.slice(16)),l=new h(s.keccak256(u));if(l.getAddress().toString("hex")!==r.ethaddr)throw new Error("Decoded key mismatch - possibly wrong passphrase");return l},t.exports=h}}},{package:"ethereumjs-wallet",file:"/home/circleci/project/node_modules/ethereumjs-wallet/index.js"}],[19,{"../../../../shared/constants/network":6266,"../../../../shared/constants/time":6269,"../../../../shared/modules/fetch-with-timeout":6274,"../../../../shared/modules/network.utils":6277,"./createInfuraClient":14,"./createJsonRpcClient":15,"./createMetamaskMiddleware":16,"@babel/runtime/helpers/defineProperty":189,"@babel/runtime/helpers/interopRequireDefault":195,"@metamask/obs-store":1193,_process:5498,assert:1776,"eth-json-rpc-middleware":2482,"eth-query":2527,events:2158,"json-rpc-engine":4805,loglevel:5260,"swappable-obj-proxy":5988},function(){with(this)return function(){"use strict";return function(e,t,r){(function(t){(function(){var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=r.NETWORK_EVENTS=void 0;var i=n(e("@babel/runtime/helpers/defineProperty")),s=e("assert"),o=n(e("events")),a=e("@metamask/obs-store"),c=e("json-rpc-engine"),u=e("eth-json-rpc-middleware"),l=n(e("loglevel")),f=e("swappable-obj-proxy"),d=n(e("eth-query")),h=e("../../../../shared/constants/network"),p=e("../../../../shared/constants/time"),m=e("../../../../shared/modules/network.utils"),g=n(e("../../../../shared/modules/fetch-with-timeout")),y=n(e("./createMetamaskMiddleware")),b=n(e("./createInfuraClient")),v=n(e("./createJsonRpcClient"));function w(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?w(Object(r),!0).forEach((function(t){(0,i.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):w(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const E=t.env.METAMASK_ENV,k=(0,g.default)(30*p.SECOND);let S;S=t.env.IN_TEST?{type:h.NETWORK_TYPE_RPC,rpcUrl:"http://localhost:8545",chainId:"0x539",nickname:"Localhost 8545"}:t.env.METAMASK_DEBUG||"test"===E?{type:h.RINKEBY,chainId:h.RINKEBY_CHAIN_ID}:{type:h.MAINNET,chainId:h.MAINNET_CHAIN_ID};const A=_({ticker:"ETH"},S),T={EIPS:{1559:undefined}},I={NETWORK_DID_CHANGE:"networkDidChange",NETWORK_WILL_CHANGE:"networkWillChange",INFURA_IS_BLOCKED:"infuraIsBlocked",INFURA_IS_UNBLOCKED:"infuraIsUnblocked"};r.NETWORK_EVENTS=I;class C extends o.default{constructor(e={}){super(),this.providerStore=new a.ObservableStore(e.provider||_({},A)),this.previousProviderStore=new a.ObservableStore(this.providerStore.getState()),this.networkStore=new a.ObservableStore("loading"),this.networkDetails=new a.ObservableStore(e.networkDetails||_({},T)),this.store=new a.ComposedStore({provider:this.providerStore,previousProviderStore:this.previousProviderStore,network:this.networkStore,networkDetails:this.networkDetails}),this._provider=null,this._blockTracker=null,this._providerProxy=null,this._blockTrackerProxy=null,this.on(I.NETWORK_DID_CHANGE,this.lookupNetwork)}setInfuraProjectId(e){if(!e||"string"!=typeof e)throw new Error("Invalid Infura project ID");this._infuraProjectId=e}initializeProvider(e){this._baseProviderParams=e;const{type:t,rpcUrl:r,chainId:n}=this.getProviderConfig();this._configureProvider({type:t,rpcUrl:r,chainId:n}),this.lookupNetwork()}getProviderAndBlockTracker(){return{provider:this._providerProxy,blockTracker:this._blockTrackerProxy}}getLatestBlock(){return new Promise(((e,t)=>{const{provider:r}=this.getProviderAndBlockTracker();new d.default(r).sendAsync({method:"eth_getBlockByNumber",params:["latest",!1]},((r,n)=>r?t(r):e(n)))}))}async getEIP1559Compatibility(){const{EIPS:e}=this.networkDetails.getState();if(e[1559]!==undefined)return e[1559];const t=await this.getLatestBlock(),r=t&&t.baseFeePerGas!==undefined;return this.setNetworkEIPSupport(1559,r),r}verifyNetwork(){this.isNetworkLoading()&&this.lookupNetwork()}getNetworkState(){return this.networkStore.getState()}setNetworkState(e){this.networkStore.putState(e)}setNetworkEIPSupport(e,t){this.networkDetails.updateState({EIPS:{[e]:t}})}clearNetworkDetails(){this.networkDetails.putState(_({},T))}isNetworkLoading(){return"loading"===this.getNetworkState()}lookupNetwork(){if(!this._provider)return void l.default.warn("NetworkController - lookupNetwork aborted due to missing provider");if(!this.getCurrentChainId())return l.default.warn("NetworkController - lookupNetwork aborted due to missing chainId"),this.setNetworkState("loading"),void this.clearNetworkDetails();const e=new d.default(this._provider),t=this.getNetworkState(),{type:r}=this.getProviderConfig();h.INFURA_PROVIDER_TYPES.includes(r)?this._checkInfuraAvailability(r):this.emit(I.INFURA_IS_UNBLOCKED),e.sendAsync({method:"net_version"},((e,r)=>{const n=this.getNetworkState();if(t===n){if(e)return this.setNetworkState("loading"),void this.clearNetworkDetails();this.setNetworkState(r),this.getEIP1559Compatibility()}}))}getCurrentChainId(){var e;const{type:t,chainId:r}=this.getProviderConfig();return(null===(e=h.NETWORK_TYPE_TO_ID_MAP[t])||void 0===e?void 0:e.chainId)||r}setRpcTarget(e,t,r="ETH",n="",i){s.strict.ok((0,m.isPrefixedFormattedHexString)(t),`Invalid chain ID "${t}": invalid hex string.`),s.strict.ok((0,m.isSafeChainId)(parseInt(t,16)),`Invalid chain ID "${t}": numerical value greater than max safe value.`),this.setProviderConfig({type:h.NETWORK_TYPE_RPC,rpcUrl:e,chainId:t,ticker:r,nickname:n,rpcPrefs:i})}async setProviderType(e){s.strict.notStrictEqual(e,h.NETWORK_TYPE_RPC,`NetworkController - cannot call "setProviderType" with type "${h.NETWORK_TYPE_RPC}". Use "setRpcTarget"`),s.strict.ok(h.INFURA_PROVIDER_TYPES.includes(e),`Unknown Infura provider type "${e}".`);const{chainId:t}=h.NETWORK_TYPE_TO_ID_MAP[e];this.setProviderConfig({type:e,rpcUrl:"",chainId:t,ticker:"ETH",nickname:""})}resetConnection(){this.setProviderConfig(this.getProviderConfig())}setProviderConfig(e){this.previousProviderStore.updateState(this.getProviderConfig()),this.providerStore.updateState(e),this._switchNetwork(e)}rollbackToPreviousProvider(){const e=this.previousProviderStore.getState();this.providerStore.updateState(e),this._switchNetwork(e)}getProviderConfig(){return this.providerStore.getState()}getNetworkIdentifier(){const e=this.providerStore.getState();return e.type===h.NETWORK_TYPE_RPC?e.rpcUrl:e.type}async _checkInfuraAvailability(e){const t=`https://${e}.infura.io/v3/${this._infuraProjectId}`;let r=!1;this.once(I.NETWORK_DID_CHANGE,(()=>{r=!0}));try{const e=await k(t,{method:"POST",body:JSON.stringify({jsonrpc:"2.0",method:"eth_blockNumber",params:[],id:1})});if(r)return;if(e.ok)this.emit(I.INFURA_IS_UNBLOCKED);else{const t=await e.json();if(r)return;t.error===h.INFURA_BLOCKED_KEY&&this.emit(I.INFURA_IS_BLOCKED)}}catch(e){l.default.warn("MetaMask - Infura availability check failed",e)}}_switchNetwork(e){this.emit(I.NETWORK_WILL_CHANGE),this.setNetworkState("loading"),this.clearNetworkDetails(),this._configureProvider(e),this.emit(I.NETWORK_DID_CHANGE,e.type)}_configureProvider({type:e,rpcUrl:t,chainId:r}){if(h.INFURA_PROVIDER_TYPES.includes(e))this._configureInfuraProvider(e,this._infuraProjectId);else{if(e!==h.NETWORK_TYPE_RPC)throw new Error(`NetworkController - _configureProvider - unknown type "${e}"`);this._configureStandardProvider(t,r)}}_configureInfuraProvider(e,t){l.default.info("NetworkController - configureInfuraProvider",e);const r=(0,b.default)({network:e,projectId:t});this._setNetworkClient(r)}_configureStandardProvider(e,t){l.default.info("NetworkController - configureStandardProvider",e);const r=(0,v.default)({rpcUrl:e,chainId:t});this._setNetworkClient(r)}_setNetworkClient({networkMiddleware:e,blockTracker:t}){const r=(0,y.default)(this._baseProviderParams),n=new c.JsonRpcEngine;n.push(r),n.push(e);const i=(0,u.providerFromEngine)(n);this._setProviderAndBlockTracker({provider:i,blockTracker:t})}_setProviderAndBlockTracker({provider:e,blockTracker:t}){this._providerProxy?this._providerProxy.setTarget(e):this._providerProxy=(0,f.createSwappableProxy)(e),this._blockTrackerProxy?this._blockTrackerProxy.setTarget(t):this._blockTrackerProxy=(0,f.createEventEmitterProxy)(t,{eventFilter:"skipInternal"}),this._provider=e,this._blockTracker=t}}r.default=C}).call(this)}).call(this,e("_process"))}}},{package:"<root>",file:"/home/circleci/project/app/scripts/controllers/network/network.js"}],[1097,{assert:1776,coinstring:2201,crypto:2267,"safe-buffer":5817,secp256k1:1104},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("assert"),i=e("safe-buffer").Buffer,s=e("crypto"),o=e("coinstring"),a=e("secp256k1"),c=i.from("Bitcoin seed","utf8"),u=2147483648,l={private:76066276,public:76067358};function f(e){this.versions=e||l,this.depth=0,this.index=0,this._privateKey=null,this._publicKey=null,this.chainCode=null,this._fingerprint=0,this.parentFingerprint=0}function d(e,t,r){var n=i.allocUnsafe(78);n.writeUInt32BE(t,0),n.writeUInt8(e.depth,4);var s=e.depth?e.parentFingerprint:0;return n.writeUInt32BE(s,5),n.writeUInt32BE(e.index,9),e.chainCode.copy(n,13),r.copy(n,45),n}function h(e){var t=s.createHash("sha256").update(e).digest();return s.createHash("rmd160").update(t).digest()}Object.defineProperty(f.prototype,"fingerprint",{get:function(){return this._fingerprint}}),Object.defineProperty(f.prototype,"identifier",{get:function(){return this._identifier}}),Object.defineProperty(f.prototype,"pubKeyHash",{get:function(){return this.identifier}}),Object.defineProperty(f.prototype,"privateKey",{get:function(){return this._privateKey},set:function(e){n.equal(e.length,32,"Private key must be 32 bytes."),n(!0===a.privateKeyVerify(e),"Invalid private key"),this._privateKey=e,this._publicKey=a.publicKeyCreate(e,!0),this._identifier=h(this.publicKey),this._fingerprint=this._identifier.slice(0,4).readUInt32BE(0)}}),Object.defineProperty(f.prototype,"publicKey",{get:function(){return this._publicKey},set:function(e){n(33===e.length||65===e.length,"Public key must be 33 or 65 bytes."),n(!0===a.publicKeyVerify(e),"Invalid public key"),this._publicKey=a.publicKeyConvert(e,!0),this._identifier=h(this.publicKey),this._fingerprint=this._identifier.slice(0,4).readUInt32BE(0),this._privateKey=null}}),Object.defineProperty(f.prototype,"privateExtendedKey",{get:function(){return this._privateKey?o.encode(d(this,this.versions.private,i.concat([i.alloc(1,0),this.privateKey]))):null}}),Object.defineProperty(f.prototype,"publicExtendedKey",{get:function(){return o.encode(d(this,this.versions.public,this.publicKey))}}),f.prototype.derive=function(e){if("m"===e||"M"===e||"m'"===e||"M'"===e)return this;var t=e.split("/"),r=this;return t.forEach((function(e,t){if(0!==t){var i=e.length>1&&"'"===e[e.length-1],s=parseInt(e,10);n(s<u,"Invalid index"),i&&(s+=u),r=r.deriveChild(s)}else n(e,"m","Invalid path")})),r},f.prototype.deriveChild=function(e){var t,r=e>=u,o=i.allocUnsafe(4);if(o.writeUInt32BE(e,0),r){n(this.privateKey,"Could not derive hardened child key");var c=this.privateKey,l=i.alloc(1,0);c=i.concat([l,c]),t=i.concat([c,o])}else t=i.concat([this.publicKey,o]);var d=s.createHmac("sha512",this.chainCode).update(t).digest(),h=d.slice(0,32),p=d.slice(32),m=new f(this.versions);if(this.privateKey)try{m.privateKey=a.privateKeyTweakAdd(this.privateKey,h)}catch(t){return this.derive(e+1)}else try{m.publicKey=a.publicKeyTweakAdd(this.publicKey,h,!0)}catch(t){return this.derive(e+1,r)}return m.chainCode=p,m.depth=this.depth+1,m.parentFingerprint=this.fingerprint,m.index=e,m},f.prototype.sign=function(e){return a.sign(e,this.privateKey).signature},f.prototype.verify=function(e,t){return a.verify(e,t,this.publicKey)},f.prototype.toJSON=function(){return{xpriv:this.privateExtendedKey,xpub:this.publicExtendedKey}},f.fromMasterSeed=function(e,t){var r=s.createHmac("sha512",c).update(e).digest(),n=r.slice(0,32),i=r.slice(32),o=new f(t);return o.chainCode=i,o.privateKey=n,o},f.fromExtendedKey=function(e,t){var r=new f(t=t||l),i=o.decode(e),s=i.readUInt32BE(0);n(s===t.private||s===t.public,"Version mismatch: does not match private or public"),r.depth=i.readUInt8(4),r.parentFingerprint=i.readUInt32BE(5),r.index=i.readUInt32BE(9),r.chainCode=i.slice(13,45);var a=i.slice(45);return 0===a.readUInt8(0)?(n(s===t.private,"Version mismatch: version does not match private"),r.privateKey=a.slice(1)):(n(s===t.public,"Version mismatch: version does not match public"),r.publicKey=a),r},f.fromJSON=function(e){return f.fromExtendedKey(e.xpriv)},f.HARDENED_OFFSET=u,t.exports=f}}},{package:"hdkey",file:"/home/circleci/project/node_modules/@metamask/eth-ledger-bridge-keyring/node_modules/hdkey/lib/hdkey.js"}],[1094,{buffer:2157,"ethereumjs-abi":2577,"ethereumjs-util":1095,tweetnacl:6070,"tweetnacl-util":6069},function(){with(this)return function(){"use strict";return function(e,t,r){const{Buffer:n}=e("buffer"),i=e("ethereumjs-util"),s=e("ethereumjs-abi"),o=e("tweetnacl");o.util=e("tweetnacl-util");const a={type:"object",properties:{types:{type:"object",additionalProperties:{type:"array",items:{type:"object",properties:{name:{type:"string"},type:{type:"string"}},required:["name","type"]}}},primaryType:{type:"string"},domain:{type:"object"},message:{type:"object"}},required:["types","primaryType","domain","message"]},c={encodeData(e,t,r,o=!0){const a=["bytes32"],c=[this.hashType(e,r)];if(o){const u=(e,t,a)=>{if(r[t]!==undefined)return["bytes32",null===a||a===undefined?"0x0000000000000000000000000000000000000000000000000000000000000000":i.keccak(this.encodeData(t,a,r,o))];if(a===undefined)throw new Error(`missing value for field ${e} of type ${t}`);if("bytes"===t)return["bytes32",i.keccak(a)];if("string"===t)return"string"==typeof a&&(a=n.from(a,"utf8")),["bytes32",i.keccak(a)];if(t.lastIndexOf("]")===t.length-1){const r=t.slice(0,t.lastIndexOf("[")),n=a.map((t=>u(e,r,t)));return["bytes32",i.keccak(s.rawEncode(n.map((([e])=>e)),n.map((([,e])=>e))))]}return[t,a]};for(const n of r[e]){const[e,r]=u(n.name,n.type,t[n.name]);a.push(e),c.push(r)}}else for(const s of r[e]){let e=t[s.name];if(e!==undefined)if("bytes"===s.type)a.push("bytes32"),e=i.keccak(e),c.push(e);else if("string"===s.type)a.push("bytes32"),"string"==typeof e&&(e=n.from(e,"utf8")),e=i.keccak(e),c.push(e);else if(r[s.type]!==undefined)a.push("bytes32"),e=i.keccak(this.encodeData(s.type,e,r,o)),c.push(e);else{if(s.type.lastIndexOf("]")===s.type.length-1)throw new Error("Arrays currently unimplemented in encodeData");a.push(s.type),c.push(e)}}return s.rawEncode(a,c)},encodeType(e,t){let r="",n=this.findTypeDependencies(e,t).filter((t=>t!==e));n=[e].concat(n.sort());for(const e of n){if(!t[e])throw new Error(`No type definition specified: ${e}`);r+=`${e}(${t[e].map((({name:e,type:t})=>`${t} ${e}`)).join(",")})`}return r},findTypeDependencies(e,t,r=[]){const[n]=e.match(/^\w*/u);if(e=n,r.includes(e)||t[e]===undefined)return r;r.push(e);for(const n of t[e])for(const e of this.findTypeDependencies(n.type,t,r))!r.includes(e)&&r.push(e);return r},hashStruct(e,t,r,n=!0){return i.keccak(this.encodeData(e,t,r,n))},hashType(e,t){return i.keccak(this.encodeType(e,t))},sanitizeData(e){const t={};for(const r of Object.keys(a.properties))e[r]&&(t[r]=e[r]);return t.types&&(t.types={EIP712Domain:[],...t.types}),t},sign(e,t=!0){const r=this.sanitizeData(e),s=[n.from("1901","hex")];return s.push(this.hashStruct("EIP712Domain",r.domain,r.types,t)),"EIP712Domain"!==r.primaryType&&s.push(this.hashStruct(r.primaryType,r.message,r.types,t)),i.keccak(n.concat(s))}};function u(e){const t=new Error("Expect argument to be non-empty array");if("object"!=typeof e||!e.length)throw t;const r=e.map((function(e){return"bytes"===e.type?i.toBuffer(e.value):e.value})),n=e.map((function(e){return e.type})),o=e.map((function(e){if(!e.name)throw t;return`${e.type} ${e.name}`}));return s.soliditySHA3(["bytes32","bytes32"],[s.soliditySHA3(new Array(e.length).fill("string"),o),s.soliditySHA3(n,r)])}function l(e,t){const r=i.toBuffer(t),n=i.fromRpcSig(r);return i.ecrecover(e,n.v,n.r,n.s)}function f(e){const t=i.toBuffer(e.data);return l(i.hashPersonalMessage(t),e.sig)}function d(e,t){let r=`${e}`;for(;r.length<t;)r=`0${r}`;return r}function h(e){const t=n.from(e,"hex").toString("base64");return o.util.decodeBase64(t)}t.exports={TYPED_MESSAGE_SCHEMA:a,TypedDataUtils:c,concatSig(e,t,r){const n=i.fromSigned(t),s=i.fromSigned(r),o=i.bufferToInt(e),a=d(i.toUnsigned(n).toString("hex"),64),c=d(i.toUnsigned(s).toString("hex"),64),u=i.stripHexPrefix(i.intToHex(o));return i.addHexPrefix(a.concat(c,u)).toString("hex")},normalize(e){if(!e)return undefined;if("number"==typeof e){const t=i.toBuffer(e);e=i.bufferToHex(t)}if("string"!=typeof e){let t="eth-sig-util.normalize() requires hex string or integer input.";throw t+=` received ${typeof e}: ${e}`,new Error(t)}return i.addHexPrefix(e.toLowerCase())},personalSign(e,t){const r=i.toBuffer(t.data),n=i.hashPersonalMessage(r),s=i.ecsign(n,e);return i.bufferToHex(this.concatSig(s.v,s.r,s.s))},recoverPersonalSignature(e){const t=f(e),r=i.publicToAddress(t);return i.bufferToHex(r)},extractPublicKey:e=>`0x${f(e).toString("hex")}`,typedSignatureHash(e){const t=u(e);return i.bufferToHex(t)},signTypedDataLegacy(e,t){const r=u(t.data),n=i.ecsign(r,e);return i.bufferToHex(this.concatSig(n.v,n.r,n.s))},recoverTypedSignatureLegacy(e){const t=l(u(e.data),e.sig),r=i.publicToAddress(t);return i.bufferToHex(r)},encrypt(e,t,r){if("x25519-xsalsa20-poly1305"===r){if(void 0===t.data)throw new Error('Cannot detect secret message, message params should be of the form {data: "secret message"} ');const r=o.box.keyPair();let n;try{n=o.util.decodeBase64(e)}catch(e){throw new Error("Bad public key")}const i=o.util.decodeUTF8(t.data),s=o.randomBytes(o.box.nonceLength),a=o.box(i,s,n,r.secretKey);return{version:"x25519-xsalsa20-poly1305",nonce:o.util.encodeBase64(s),ephemPublicKey:o.util.encodeBase64(r.publicKey),ciphertext:o.util.encodeBase64(a)}}throw new Error("Encryption type/version not supported")},encryptSafely(e,t,r){const{data:i}=t;if(!i)throw new Error("Cannot encrypt empty msg.data");if("object"==typeof i&&i.toJSON)throw new Error("Cannot encrypt with toJSON property.  Please remove toJSON property");const s={data:i,padding:""},o=n.byteLength(JSON.stringify(s),"utf-8")%2048;let a=0;o>0&&(a=2048-o-16),s.padding="0".repeat(a);const c={data:JSON.stringify(s)};return this.encrypt(e,c,r)},decrypt(e,t){if("x25519-xsalsa20-poly1305"===e.version){const r=h(t),n=o.box.keyPair.fromSecretKey(r).secretKey,i=o.util.decodeBase64(e.nonce),s=o.util.decodeBase64(e.ciphertext),a=o.util.decodeBase64(e.ephemPublicKey),c=o.box.open(s,i,a,n);let u;try{u=o.util.encodeUTF8(c)}catch(e){throw new Error("Decryption failed.")}if(u)return u;throw new Error("Decryption failed.")}throw new Error("Encryption type/version not supported.")},decryptSafely(e,t){return JSON.parse(this.decrypt(e,t)).data},getEncryptionPublicKey(e){const t=h(e),r=o.box.keyPair.fromSecretKey(t).publicKey;return o.util.encodeBase64(r)},signTypedMessage(e,t,r="V4"){switch(r){case"V1":return this.signTypedDataLegacy(e,t);case"V3":return this.signTypedData(e,t);default:return this.signTypedData_v4(e,t)}},recoverTypedMessage(e,t="V4"){switch(t){case"V1":return this.recoverTypedSignatureLegacy(e);case"V3":return this.recoverTypedSignature(e);default:return this.recoverTypedSignature_v4(e)}},signTypedData(e,t){const r=c.sign(t.data,!1),n=i.ecsign(r,e);return i.bufferToHex(this.concatSig(n.v,n.r,n.s))},signTypedData_v4(e,t){const r=c.sign(t.data),n=i.ecsign(r,e);return i.bufferToHex(this.concatSig(n.v,n.r,n.s))},recoverTypedSignature(e){const t=l(c.sign(e.data,!1),e.sig),r=i.publicToAddress(t);return i.bufferToHex(r)},recoverTypedSignature_v4(e){const t=l(c.sign(e.data),e.sig),r=i.publicToAddress(t);return i.bufferToHex(r)}}}}},{package:"eth-sig-util",file:"/home/circleci/project/node_modules/@metamask/eth-ledger-bridge-keyring/node_modules/eth-sig-util/index.js"}],[2484,{},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.ethersProviderAsMiddleware=r.providerAsMiddleware=void 0,r.providerAsMiddleware=function(e){return(t,r,n,i)=>{e.sendAsync(t,((e,t)=>e?i(e):(Object.assign(r,t),i())))}},r.ethersProviderAsMiddleware=function(e){return(t,r,n,i)=>{e.send(t,((e,t)=>e?i(e):(Object.assign(r,t),i())))}}}}},{package:"eth-json-rpc-middleware",file:"/home/circleci/project/node_modules/eth-json-rpc-middleware/dist/providerAsMiddleware.js"}],[2480,{"json-rpc-engine":4805},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.createBlockTrackerInspectorMiddleware=void 0;const n=e("json-rpc-engine"),i=["eth_getTransactionByHash","eth_getTransactionReceipt"];r.createBlockTrackerInspectorMiddleware=function({blockTracker:e}){return(0,n.createAsyncMiddleware)((async(t,r,n)=>{var s;if(!i.includes(t.method))return n();if(await n(),!(null===(s=r.result)||void 0===s?void 0:s.blockNumber))return undefined;if("string"==typeof r.result.blockNumber){Number.parseInt(r.result.blockNumber,16)>Number.parseInt(e.getCurrentBlock(),16)&&await e.checkForLatestBlock()}return undefined}))}}}},{package:"eth-json-rpc-middleware",file:"/home/circleci/project/node_modules/eth-json-rpc-middleware/dist/block-tracker-inspector.js"}],[2481,{btoa:2156,"eth-rpc-errors":2531,"json-rpc-engine":4805,"node-fetch":2156},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.createFetchConfigFromReq=r.createFetchMiddleware=void 0;const n=e("json-rpc-engine"),i=e("eth-rpc-errors"),s=global.fetch||e("node-fetch"),o=global.btoa||e("btoa"),a=["Gateway timeout","ETIMEDOUT","failed to parse response body","Failed to fetch"];function c(e){switch(e.status){case 405:throw i.ethErrors.rpc.methodNotFound();case 418:throw i.ethErrors.rpc.internal({message:"Request is being rate limited."});case 503:case 504:throw function(){let e="Gateway timeout. The request took too long to process. ";return e+="This can happen when querying logs over too wide a block range.",i.ethErrors.rpc.internal({message:e})}()}}function u(e,t){if(200!==e.status)throw i.ethErrors.rpc.internal({message:`Non-200 status code: '${e.status}'`,data:t});if(t.error)throw i.ethErrors.rpc.internal({data:t.error});return t.result}function l({req:e,rpcUrl:t,originHttpHeaderKey:r}){const n=new URL(t),i=function(e){let t="";t+=e.protocol,t+=`//${e.hostname}`,e.port&&(t+=`:${e.port}`);return t+=`${e.pathname}`,t+=`${e.search}`,t}(n),s={id:e.id,jsonrpc:e.jsonrpc,method:e.method,params:e.params},a=e.origin,c={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(s)};if(n.username&&n.password){const e=`${n.username}:${n.password}`,t=o(e);c.headers.Authorization=`Basic ${t}`}return r&&a&&(c.headers[r]=a),{fetchUrl:i,fetchParams:c}}function f(e){return new Promise((t=>setTimeout(t,e)))}r.createFetchMiddleware=function({rpcUrl:e,originHttpHeaderKey:t}){return(0,n.createAsyncMiddleware)((async(r,n,i)=>{const{fetchUrl:o,fetchParams:d}=l({req:r,rpcUrl:e,originHttpHeaderKey:t});for(let e=0;e<5;e++){try{const e=await s(o,d);c(e);const t=await e.text();let r;try{r=JSON.parse(t)}catch(e){throw new Error(`FetchMiddleware - failed to parse response body: "${t}"`)}const i=u(e,r);return void(n.result=i)}catch(e){const t=e.toString();if(!a.some((e=>t.includes(e))))throw e}await f(1e3)}}))},r.createFetchConfigFromReq=l}}},{package:"eth-json-rpc-middleware",file:"/home/circleci/project/node_modules/eth-json-rpc-middleware/dist/fetch.js"}],[2477,{"./utils/cache":2488,"json-rpc-engine":4805},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.createBlockCacheMiddleware=void 0;const n=e("json-rpc-engine"),i=e("./utils/cache"),s=[undefined,null,"<nil>"];class o{constructor(){this.cache={}}getBlockCacheForPayload(e,t){const r=Number.parseInt(t,16);let n=this.cache[r];if(!n){const e={};this.cache[r]=e,n=e}return n}async get(e,t){const r=this.getBlockCacheForPayload(e,t),n=(0,i.cacheIdentifierForPayload)(e,!0);return n?r[n]:undefined}async set(e,t,r){if(!this.canCacheResult(e,r))return;const n=(0,i.cacheIdentifierForPayload)(e,!0);if(!n)return;this.getBlockCacheForPayload(e,t)[n]=r}canCacheRequest(e){if(!(0,i.canCache)(e))return!1;return"pending"!==(0,i.blockTagForPayload)(e)}canCacheResult(e,t){return!s.includes(t)&&!(e.method&&["eth_getTransactionByHash","eth_getTransactionReceipt"].includes(e.method)&&(!t||!t.blockHash||"0x0000000000000000000000000000000000000000000000000000000000000000"===t.blockHash))}clearBefore(e){const t=Number.parseInt(e,16);Object.keys(this.cache).map(Number).filter((e=>e<t)).forEach((e=>delete this.cache[e]))}}r.createBlockCacheMiddleware=function({blockTracker:e}={}){if(!e)throw new Error("createBlockCacheMiddleware - No PollingBlockTracker specified");const t=new o,r={perma:t,block:t,fork:t};return(0,n.createAsyncMiddleware)((async(n,s,o)=>{if(n.skipCache)return o();const a=(0,i.cacheTypeForPayload)(n),c=r[a];if(!c)return o();if(!c.canCacheRequest(n))return o();let u,l=(0,i.blockTagForPayload)(n);if(l||(l="latest"),"earliest"===l)u="0x00";else if("latest"===l){const r=await e.getLatestBlock();t.clearBefore(r),u=r}else u=l;const f=await c.get(n,u);return f===undefined?(await o(),await c.set(n,u,s.result)):s.result=f,undefined}))}}}},{package:"eth-json-rpc-middleware",file:"/home/circleci/project/node_modules/eth-json-rpc-middleware/dist/block-cache.js"}],[2483,{"./utils/cache":2488,clone:2199,"json-rpc-engine":4805},function(){with(this)return function(){"use strict";return function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.createInflightCacheMiddleware=void 0;const i=n(e("clone")),s=e("json-rpc-engine"),o=e("./utils/cache");r.createInflightCacheMiddleware=function(){const e={};return(0,s.createAsyncMiddleware)((async(t,r,n)=>{if(t.skipCache)return n();const s=(0,o.cacheIdentifierForPayload)(t);if(!s)return n();let a=e[s];return a?(await function(e,t){const{resolve:r,promise:n}=function(){let e;const t=new Promise((t=>{e=t}));return{resolve:e,promise:t}}();return t.push((t=>{e.result=(0,i.default)(t.result),e.error=(0,i.default)(t.error),r()})),n}(r,a),undefined):(a=[],e[s]=a,await n(),delete e[s],function(e,t){setTimeout((()=>{t.forEach((t=>{try{t(e)}catch(e){console.error(e)}}))}))}(r,a),undefined)}))}}}},{package:"eth-json-rpc-middleware",file:"/home/circleci/project/node_modules/eth-json-rpc-middleware/dist/inflight-cache.js"}],[2486,{"./providerFromEngine":2485,"json-rpc-engine":4805},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.providerFromMiddleware=void 0;const n=e("json-rpc-engine"),i=e("./providerFromEngine");r.providerFromMiddleware=function(e){const t=new n.JsonRpcEngine;return t.push(e),(0,i.providerFromEngine)(t)}}}},{package:"eth-json-rpc-middleware",file:"/home/circleci/project/node_modules/eth-json-rpc-middleware/dist/providerFromMiddleware.js"}],[2487,{"./utils/cache":2488,clone:2199,"json-rpc-engine":4805,pify:2511},function(){with(this)return function(){"use strict";return function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.createRetryOnEmptyMiddleware=void 0;const i=n(e("clone")),s=e("json-rpc-engine"),o=n(e("pify")),a=e("./utils/cache"),c=[undefined,null,"<nil>"];function u(e){return new Promise((t=>setTimeout(t,e)))}r.createRetryOnEmptyMiddleware=function({provider:e,blockTracker:t}={}){if(!e)throw Error('RetryOnEmptyMiddleware - mandatory "provider" option is missing.');if(!t)throw Error('RetryOnEmptyMiddleware - mandatory "blockTracker" option is missing.');return(0,s.createAsyncMiddleware)((async(r,n,s)=>{var l;const f=(0,a.blockTagParamIndex)(r);if(f===undefined)return s();let d=null===(l=r.params)||void 0===l?void 0:l[f];if(d===undefined&&(d="latest"),["latest","pending"].includes(d))return s();const h=Number.parseInt(d.slice(2),16);if(Number.isNaN(h))return s();const p=await t.getLatestBlock();if(h>Number.parseInt(p.slice(2),16))return s();const m=(0,i.default)(r),g=await async function(e,t){for(let r=0;r<e;r++)try{return await t()}catch(e){await u(1e3)}throw new Error("RetryOnEmptyMiddleware - retries exhausted")}(10,(async()=>{const t=await(0,o.default)(e.sendAsync).call(e,m);if(c.includes(t))throw new Error(`RetryOnEmptyMiddleware - empty response "${JSON.stringify(t)}" for request "${JSON.stringify(m)}"`);return t}));return n.result=g.result,n.error=g.error,s()}))}}}},{package:"eth-json-rpc-middleware",file:"/home/circleci/project/node_modules/eth-json-rpc-middleware/dist/retryOnEmpty.js"}],[2479,{"./utils/cache":2488,clone:2199,"json-rpc-engine":4805,pify:2511},function(){with(this)return function(){"use strict";return function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.createBlockRefMiddleware=void 0;const i=e("json-rpc-engine"),s=n(e("clone")),o=n(e("pify")),a=e("./utils/cache");r.createBlockRefMiddleware=function({provider:e,blockTracker:t}={}){if(!e)throw Error('BlockRefMiddleware - mandatory "provider" option is missing.');if(!t)throw Error('BlockRefMiddleware - mandatory "blockTracker" option is missing.');return(0,i.createAsyncMiddleware)((async(r,n,i)=>{var c;const u=(0,a.blockTagParamIndex)(r);if(u===undefined)return i();let l=null===(c=r.params)||void 0===c?void 0:c[u];if(l===undefined&&(l="latest"),"latest"!==l)return i();const f=await t.getLatestBlock(),d=(0,s.default)(r);d.params&&(d.params[u]=f);const h=await(0,o.default)(e.sendAsync).call(e,d);return n.result=h.result,n.error=h.error,i()}))}}}},{package:"eth-json-rpc-middleware",file:"/home/circleci/project/node_modules/eth-json-rpc-middleware/dist/block-ref.js"}],[2485,{"@metamask/safe-event-emitter":1315},function(){with(this)return function(){"use strict";return function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.providerFromEngine=void 0;const i=n(e("@metamask/safe-event-emitter"));r.providerFromEngine=function(e){const t=new i.default;return t.sendAsync=e.handle.bind(e),t.send=(t,r)=>{if("function"!=typeof r)throw new Error('Must provide callback to "send" method.');e.handle(t,r)},e.on&&e.on("notification",(e=>{t.emit("data",null,e)})),t}}}},{package:"eth-json-rpc-middleware",file:"/home/circleci/project/node_modules/eth-json-rpc-middleware/dist/providerFromEngine.js"}],[2478,{"./utils/cache":2488,"json-rpc-engine":4805},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.createBlockRefRewriteMiddleware=void 0;const n=e("json-rpc-engine"),i=e("./utils/cache");r.createBlockRefRewriteMiddleware=function({blockTracker:e}={}){if(!e)throw Error('BlockRefRewriteMiddleware - mandatory "blockTracker" option is missing.');return(0,n.createAsyncMiddleware)((async(t,r,n)=>{var s;const o=(0,i.blockTagParamIndex)(t);if(o===undefined)return n();let a=null===(s=t.params)||void 0===s?void 0:s[o];if(a===undefined&&(a="latest"),"latest"!==a)return n();const c=await e.getLatestBlock();return t.params&&(t.params[o]=c),n()}))}}}},{package:"eth-json-rpc-middleware",file:"/home/circleci/project/node_modules/eth-json-rpc-middleware/dist/block-ref-rewrite.js"}],[2489,{"eth-rpc-errors":2531,"eth-sig-util":2490,"json-rpc-engine":4805},function(){with(this)return function(){"use strict";return function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){n===undefined&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){n===undefined&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(r,"__esModule",{value:!0}),r.createWalletMiddleware=void 0;const o=e("json-rpc-engine"),a=s(e("eth-sig-util")),c=e("eth-rpc-errors");function u(e){return 42===e.length}r.createWalletMiddleware=function({getAccounts:e,processDecryptMessage:t,processEncryptionPublicKey:r,processEthSignMessage:n,processPersonalMessage:i,processTransaction:s,processSignTransaction:l,processTypedMessage:f,processTypedMessageV3:d,processTypedMessageV4:h}){if(!e)throw new Error("opts.getAccounts is required");return(0,o.createScaffoldMiddleware)({eth_accounts:(0,o.createAsyncMiddleware)((async function(t,r){r.result=await e(t)})),eth_coinbase:(0,o.createAsyncMiddleware)((async function(t,r){const n=await e(t);r.result=n[0]||null})),eth_sendTransaction:(0,o.createAsyncMiddleware)((async function(e,t){if(!s)throw c.ethErrors.rpc.methodNotSupported();const r=e.params[0]||{};r.from=await p(r.from,e),t.result=await s(r,e)})),eth_signTransaction:(0,o.createAsyncMiddleware)((async function(e,t){if(!l)throw c.ethErrors.rpc.methodNotSupported();const r=e.params[0]||{};r.from=await p(r.from,e),t.result=await l(r,e)})),eth_sign:(0,o.createAsyncMiddleware)((async function(e,t){if(!n)throw c.ethErrors.rpc.methodNotSupported();const r=await p(e.params[0],e),i=e.params[1],s=e.params[2]||{},o=Object.assign(Object.assign({},s),{from:r,data:i});t.result=await n(o,e)})),eth_signTypedData:(0,o.createAsyncMiddleware)((async function(e,t){if(!f)throw c.ethErrors.rpc.methodNotSupported();const r=e.params[0],n=await p(e.params[1],e),i=e.params[2]||{},s=Object.assign(Object.assign({},i),{from:n,data:r});t.result=await f(s,e,"V1")})),eth_signTypedData_v3:(0,o.createAsyncMiddleware)((async function(e,t){if(!d)throw c.ethErrors.rpc.methodNotSupported();const r=await p(e.params[0],e),n=e.params[1],i={data:n,from:r,version:"V3"};t.result=await d(i,e,"V3")})),eth_signTypedData_v4:(0,o.createAsyncMiddleware)((async function(e,t){if(!h)throw c.ethErrors.rpc.methodNotSupported();const r=await p(e.params[0],e),n=e.params[1],i={data:n,from:r,version:"V4"};t.result=await h(i,e,"V4")})),personal_sign:(0,o.createAsyncMiddleware)((async function(e,t){if(!i)throw c.ethErrors.rpc.methodNotSupported();const r=e.params[0],n=e.params[1],s=e.params[2]||{};let o,a;if(u(r)&&!u(n)){let e="The eth_personalSign method requires params ordered ";e+="[message, address]. This was previously handled incorrectly, ",e+="and has been corrected automatically. ",e+="Please switch this param order for smooth behavior in the future.",t.warning=e,o=r,a=n}else a=r,o=n;o=await p(o,e);const l=Object.assign(Object.assign({},s),{from:o,data:a});t.result=await i(l,e)})),eth_getEncryptionPublicKey:(0,o.createAsyncMiddleware)((async function(e,t){if(!r)throw c.ethErrors.rpc.methodNotSupported();const n=await p(e.params[0],e);t.result=await r(n,e)})),eth_decrypt:(0,o.createAsyncMiddleware)((async function(e,r){if(!t)throw c.ethErrors.rpc.methodNotSupported();const n=e.params[0],i=await p(e.params[1],e),s=e.params[2]||{},o=Object.assign(Object.assign({},s),{from:i,data:n});r.result=await t(o,e)})),personal_ecRecover:(0,o.createAsyncMiddleware)((async function(e,t){const r=e.params[0],n=e.params[1],i=e.params[2]||{},s=Object.assign(Object.assign({},i),{sig:n,data:r}),o=a.recoverPersonalSignature(s);t.result=o}))});async function p(t,r){if("string"==typeof t&&t.length>0){const n=(await e(r)).map((e=>e.toLowerCase())),i=t.toLowerCase();if(n.includes(i))return i}throw c.ethErrors.rpc.invalidParams({message:"Invalid parameters: must provide an Ethereum address."})}}}}},{package:"eth-json-rpc-middleware",file:"/home/circleci/project/node_modules/eth-json-rpc-middleware/dist/wallet.js"}],[2520,{buffer:2156},function(){with(this)return function(){"use strict";return function(e,t,r){!function(t,r){function n(e,t){if(!e)throw new Error(t||"Assertion failed")}function i(e,t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}function s(e,t,r){if(s.isBN(e))return e;this.negative=0,this.words=null,this.length=0,this.red=null,null!==e&&("le"!==t&&"be"!==t||(r=t,t=10),this._init(e||0,t||10,r||"be"))}var o;"object"==typeof t?t.exports=s:r.BN=s,s.BN=s,s.wordSize=26;try{o="undefined"!=typeof window&&void 0!==window.Buffer?window.Buffer:e("buffer").Buffer}catch(e){}function a(e,t){var r=e.charCodeAt(t);return r>=48&&r<=57?r-48:r>=65&&r<=70?r-55:r>=97&&r<=102?r-87:void n(!1,"Invalid character in "+e)}function c(e,t,r){var n=a(e,r);return r-1>=t&&(n|=a(e,r-1)<<4),n}function u(e,t,r,i){for(var s=0,o=0,a=Math.min(e.length,r),c=t;c<a;c++){var u=e.charCodeAt(c)-48;s*=i,o=u>=49?u-49+10:u>=17?u-17+10:u,n(u>=0&&o<i,"Invalid character"),s+=o}return s}function l(e,t){e.words=t.words,e.length=t.length,e.negative=t.negative,e.red=t.red}if(s.isBN=function(e){return e instanceof s||null!==e&&"object"==typeof e&&e.constructor.wordSize===s.wordSize&&Array.isArray(e.words)},s.max=function(e,t){return e.cmp(t)>0?e:t},s.min=function(e,t){return e.cmp(t)<0?e:t},s.prototype._init=function(e,t,r){if("number"==typeof e)return this._initNumber(e,t,r);if("object"==typeof e)return this._initArray(e,t,r);"hex"===t&&(t=16),n(t===(0|t)&&t>=2&&t<=36);var i=0;"-"===(e=e.toString().replace(/\s+/g,""))[0]&&(i++,this.negative=1),i<e.length&&(16===t?this._parseHex(e,i,r):(this._parseBase(e,t,i),"le"===r&&this._initArray(this.toArray(),t,r)))},s.prototype._initNumber=function(e,t,r){e<0&&(this.negative=1,e=-e),e<67108864?(this.words=[67108863&e],this.length=1):e<4503599627370496?(this.words=[67108863&e,e/67108864&67108863],this.length=2):(n(e<9007199254740992),this.words=[67108863&e,e/67108864&67108863,1],this.length=3),"le"===r&&this._initArray(this.toArray(),t,r)},s.prototype._initArray=function(e,t,r){if(n("number"==typeof e.length),e.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(e.length/3),this.words=new Array(this.length);for(var i=0;i<this.length;i++)this.words[i]=0;var s,o,a=0;if("be"===r)for(i=e.length-1,s=0;i>=0;i-=3)o=e[i]|e[i-1]<<8|e[i-2]<<16,this.words[s]|=o<<a&67108863,this.words[s+1]=o>>>26-a&67108863,(a+=24)>=26&&(a-=26,s++);else if("le"===r)for(i=0,s=0;i<e.length;i+=3)o=e[i]|e[i+1]<<8|e[i+2]<<16,this.words[s]|=o<<a&67108863,this.words[s+1]=o>>>26-a&67108863,(a+=24)>=26&&(a-=26,s++);return this._strip()},s.prototype._parseHex=function(e,t,r){this.length=Math.ceil((e.length-t)/6),this.words=new Array(this.length);for(var n=0;n<this.length;n++)this.words[n]=0;var i,s=0,o=0;if("be"===r)for(n=e.length-1;n>=t;n-=2)i=c(e,t,n)<<s,this.words[o]|=67108863&i,s>=18?(s-=18,o+=1,this.words[o]|=i>>>26):s+=8;else for(n=(e.length-t)%2==0?t+1:t;n<e.length;n+=2)i=c(e,t,n)<<s,this.words[o]|=67108863&i,s>=18?(s-=18,o+=1,this.words[o]|=i>>>26):s+=8;this._strip()},s.prototype._parseBase=function(e,t,r){this.words=[0],this.length=1;for(var n=0,i=1;i<=67108863;i*=t)n++;n--,i=i/t|0;for(var s=e.length-r,o=s%n,a=Math.min(s,s-o)+r,c=0,l=r;l<a;l+=n)c=u(e,l,l+n,t),this.imuln(i),this.words[0]+c<67108864?this.words[0]+=c:this._iaddn(c);if(0!==o){var f=1;for(c=u(e,l,e.length,t),l=0;l<o;l++)f*=t;this.imuln(f),this.words[0]+c<67108864?this.words[0]+=c:this._iaddn(c)}this._strip()},s.prototype.copy=function(e){e.words=new Array(this.length);for(var t=0;t<this.length;t++)e.words[t]=this.words[t];e.length=this.length,e.negative=this.negative,e.red=this.red},s.prototype._move=function(e){l(e,this)},s.prototype.clone=function(){var e=new s(null);return this.copy(e),e},s.prototype._expand=function(e){for(;this.length<e;)this.words[this.length++]=0;return this},s.prototype._strip=function(){for(;this.length>1&&0===this.words[this.length-1];)this.length--;return this._normSign()},s.prototype._normSign=function(){return 1===this.length&&0===this.words[0]&&(this.negative=0),this},"undefined"!=typeof Symbol&&"function"==typeof Symbol.for)try{s.prototype[Symbol.for("nodejs.util.inspect.custom")]=f}catch(e){s.prototype.inspect=f}else s.prototype.inspect=f;function f(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"}var d=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],h=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],p=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];s.prototype.toString=function(e,t){var r;if(t=0|t||1,16===(e=e||10)||"hex"===e){r="";for(var i=0,s=0,o=0;o<this.length;o++){var a=this.words[o],c=(16777215&(a<<i|s)).toString(16);r=0!==(s=a>>>24-i&16777215)||o!==this.length-1?d[6-c.length]+c+r:c+r,(i+=2)>=26&&(i-=26,o--)}for(0!==s&&(r=s.toString(16)+r);r.length%t!=0;)r="0"+r;return 0!==this.negative&&(r="-"+r),r}if(e===(0|e)&&e>=2&&e<=36){var u=h[e],l=p[e];r="";var f=this.clone();for(f.negative=0;!f.isZero();){var m=f.modrn(l).toString(e);r=(f=f.idivn(l)).isZero()?m+r:d[u-m.length]+m+r}for(this.isZero()&&(r="0"+r);r.length%t!=0;)r="0"+r;return 0!==this.negative&&(r="-"+r),r}n(!1,"Base should be between 2 and 36")},s.prototype.toNumber=function(){var e=this.words[0];return 2===this.length?e+=67108864*this.words[1]:3===this.length&&1===this.words[2]?e+=4503599627370496+67108864*this.words[1]:this.length>2&&n(!1,"Number can only safely store up to 53 bits"),0!==this.negative?-e:e},s.prototype.toJSON=function(){return this.toString(16,2)},o&&(s.prototype.toBuffer=function(e,t){return this.toArrayLike(o,e,t)}),s.prototype.toArray=function(e,t){return this.toArrayLike(Array,e,t)};function m(e,t,r){r.negative=t.negative^e.negative;var n=e.length+t.length|0;r.length=n,n=n-1|0;var i=0|e.words[0],s=0|t.words[0],o=i*s,a=67108863&o,c=o/67108864|0;r.words[0]=a;for(var u=1;u<n;u++){for(var l=c>>>26,f=67108863&c,d=Math.min(u,t.length-1),h=Math.max(0,u-e.length+1);h<=d;h++){var p=u-h|0;l+=(o=(i=0|e.words[p])*(s=0|t.words[h])+f)/67108864|0,f=67108863&o}r.words[u]=0|f,c=0|l}return 0!==c?r.words[u]=0|c:r.length--,r._strip()}s.prototype.toArrayLike=function(e,t,r){this._strip();var i=this.byteLength(),s=r||Math.max(1,i);n(i<=s,"byte array longer than desired length"),n(s>0,"Requested array length <= 0");var o=function(e,t){return e.allocUnsafe?e.allocUnsafe(t):new e(t)}(e,s);return this["_toArrayLike"+("le"===t?"LE":"BE")](o,i),o},s.prototype._toArrayLikeLE=function(e,t){for(var r=0,n=0,i=0,s=0;i<this.length;i++){var o=this.words[i]<<s|n;e[r++]=255&o,r<e.length&&(e[r++]=o>>8&255),r<e.length&&(e[r++]=o>>16&255),6===s?(r<e.length&&(e[r++]=o>>24&255),n=0,s=0):(n=o>>>24,s+=2)}if(r<e.length)for(e[r++]=n;r<e.length;)e[r++]=0},s.prototype._toArrayLikeBE=function(e,t){for(var r=e.length-1,n=0,i=0,s=0;i<this.length;i++){var o=this.words[i]<<s|n;e[r--]=255&o,r>=0&&(e[r--]=o>>8&255),r>=0&&(e[r--]=o>>16&255),6===s?(r>=0&&(e[r--]=o>>24&255),n=0,s=0):(n=o>>>24,s+=2)}if(r>=0)for(e[r--]=n;r>=0;)e[r--]=0},Math.clz32?s.prototype._countBits=function(e){return 32-Math.clz32(e)}:s.prototype._countBits=function(e){var t=e,r=0;return t>=4096&&(r+=13,t>>>=13),t>=64&&(r+=7,t>>>=7),t>=8&&(r+=4,t>>>=4),t>=2&&(r+=2,t>>>=2),r+t},s.prototype._zeroBits=function(e){if(0===e)return 26;var t=e,r=0;return 0==(8191&t)&&(r+=13,t>>>=13),0==(127&t)&&(r+=7,t>>>=7),0==(15&t)&&(r+=4,t>>>=4),0==(3&t)&&(r+=2,t>>>=2),0==(1&t)&&r++,r},s.prototype.bitLength=function(){var e=this.words[this.length-1],t=this._countBits(e);return 26*(this.length-1)+t},s.prototype.zeroBits=function(){if(this.isZero())return 0;for(var e=0,t=0;t<this.length;t++){var r=this._zeroBits(this.words[t]);if(e+=r,26!==r)break}return e},s.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},s.prototype.toTwos=function(e){return 0!==this.negative?this.abs().inotn(e).iaddn(1):this.clone()},s.prototype.fromTwos=function(e){return this.testn(e-1)?this.notn(e).iaddn(1).ineg():this.clone()},s.prototype.isNeg=function(){return 0!==this.negative},s.prototype.neg=function(){return this.clone().ineg()},s.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},s.prototype.iuor=function(e){for(;this.length<e.length;)this.words[this.length++]=0;for(var t=0;t<e.length;t++)this.words[t]=this.words[t]|e.words[t];return this._strip()},s.prototype.ior=function(e){return n(0==(this.negative|e.negative)),this.iuor(e)},s.prototype.or=function(e){return this.length>e.length?this.clone().ior(e):e.clone().ior(this)},s.prototype.uor=function(e){return this.length>e.length?this.clone().iuor(e):e.clone().iuor(this)},s.prototype.iuand=function(e){var t;t=this.length>e.length?e:this;for(var r=0;r<t.length;r++)this.words[r]=this.words[r]&e.words[r];return this.length=t.length,this._strip()},s.prototype.iand=function(e){return n(0==(this.negative|e.negative)),this.iuand(e)},s.prototype.and=function(e){return this.length>e.length?this.clone().iand(e):e.clone().iand(this)},s.prototype.uand=function(e){return this.length>e.length?this.clone().iuand(e):e.clone().iuand(this)},s.prototype.iuxor=function(e){var t,r;this.length>e.length?(t=this,r=e):(t=e,r=this);for(var n=0;n<r.length;n++)this.words[n]=t.words[n]^r.words[n];if(this!==t)for(;n<t.length;n++)this.words[n]=t.words[n];return this.length=t.length,this._strip()},s.prototype.ixor=function(e){return n(0==(this.negative|e.negative)),this.iuxor(e)},s.prototype.xor=function(e){return this.length>e.length?this.clone().ixor(e):e.clone().ixor(this)},s.prototype.uxor=function(e){return this.length>e.length?this.clone().iuxor(e):e.clone().iuxor(this)},s.prototype.inotn=function(e){n("number"==typeof e&&e>=0);var t=0|Math.ceil(e/26),r=e%26;this._expand(t),r>0&&t--;for(var i=0;i<t;i++)this.words[i]=67108863&~this.words[i];return r>0&&(this.words[i]=~this.words[i]&67108863>>26-r),this._strip()},s.prototype.notn=function(e){return this.clone().inotn(e)},s.prototype.setn=function(e,t){n("number"==typeof e&&e>=0);var r=e/26|0,i=e%26;return this._expand(r+1),this.words[r]=t?this.words[r]|1<<i:this.words[r]&~(1<<i),this._strip()},s.prototype.iadd=function(e){var t,r,n;if(0!==this.negative&&0===e.negative)return this.negative=0,t=this.isub(e),this.negative^=1,this._normSign();if(0===this.negative&&0!==e.negative)return e.negative=0,t=this.isub(e),e.negative=1,t._normSign();this.length>e.length?(r=this,n=e):(r=e,n=this);for(var i=0,s=0;s<n.length;s++)t=(0|r.words[s])+(0|n.words[s])+i,this.words[s]=67108863&t,i=t>>>26;for(;0!==i&&s<r.length;s++)t=(0|r.words[s])+i,this.words[s]=67108863&t,i=t>>>26;if(this.length=r.length,0!==i)this.words[this.length]=i,this.length++;else if(r!==this)for(;s<r.length;s++)this.words[s]=r.words[s];return this},s.prototype.add=function(e){var t;return 0!==e.negative&&0===this.negative?(e.negative=0,t=this.sub(e),e.negative^=1,t):0===e.negative&&0!==this.negative?(this.negative=0,t=e.sub(this),this.negative=1,t):this.length>e.length?this.clone().iadd(e):e.clone().iadd(this)},s.prototype.isub=function(e){if(0!==e.negative){e.negative=0;var t=this.iadd(e);return e.negative=1,t._normSign()}if(0!==this.negative)return this.negative=0,this.iadd(e),this.negative=1,this._normSign();var r,n,i=this.cmp(e);if(0===i)return this.negative=0,this.length=1,this.words[0]=0,this;i>0?(r=this,n=e):(r=e,n=this);for(var s=0,o=0;o<n.length;o++)s=(t=(0|r.words[o])-(0|n.words[o])+s)>>26,this.words[o]=67108863&t;for(;0!==s&&o<r.length;o++)s=(t=(0|r.words[o])+s)>>26,this.words[o]=67108863&t;if(0===s&&o<r.length&&r!==this)for(;o<r.length;o++)this.words[o]=r.words[o];return this.length=Math.max(this.length,o),r!==this&&(this.negative=1),this._strip()},s.prototype.sub=function(e){return this.clone().isub(e)};var g=function(e,t,r){var n,i,s,o=e.words,a=t.words,c=r.words,u=0,l=0|o[0],f=8191&l,d=l>>>13,h=0|o[1],p=8191&h,m=h>>>13,g=0|o[2],y=8191&g,b=g>>>13,v=0|o[3],w=8191&v,_=v>>>13,E=0|o[4],k=8191&E,S=E>>>13,A=0|o[5],T=8191&A,I=A>>>13,C=0|o[6],x=8191&C,P=C>>>13,O=0|o[7],R=8191&O,N=O>>>13,M=0|o[8],j=8191&M,L=M>>>13,D=0|o[9],B=8191&D,U=D>>>13,K=0|a[0],V=8191&K,H=K>>>13,F=0|a[1],G=8191&F,q=F>>>13,z=0|a[2],Y=8191&z,W=z>>>13,$=0|a[3],J=8191&$,Z=$>>>13,X=0|a[4],Q=8191&X,ee=X>>>13,te=0|a[5],re=8191&te,ne=te>>>13,ie=0|a[6],se=8191&ie,oe=ie>>>13,ae=0|a[7],ce=8191&ae,ue=ae>>>13,le=0|a[8],fe=8191&le,de=le>>>13,he=0|a[9],pe=8191&he,me=he>>>13;r.negative=e.negative^t.negative,r.length=19;var ge=(u+(n=Math.imul(f,V))|0)+((8191&(i=(i=Math.imul(f,H))+Math.imul(d,V)|0))<<13)|0;u=((s=Math.imul(d,H))+(i>>>13)|0)+(ge>>>26)|0,ge&=67108863,n=Math.imul(p,V),i=(i=Math.imul(p,H))+Math.imul(m,V)|0,s=Math.imul(m,H);var ye=(u+(n=n+Math.imul(f,G)|0)|0)+((8191&(i=(i=i+Math.imul(f,q)|0)+Math.imul(d,G)|0))<<13)|0;u=((s=s+Math.imul(d,q)|0)+(i>>>13)|0)+(ye>>>26)|0,ye&=67108863,n=Math.imul(y,V),i=(i=Math.imul(y,H))+Math.imul(b,V)|0,s=Math.imul(b,H),n=n+Math.imul(p,G)|0,i=(i=i+Math.imul(p,q)|0)+Math.imul(m,G)|0,s=s+Math.imul(m,q)|0;var be=(u+(n=n+Math.imul(f,Y)|0)|0)+((8191&(i=(i=i+Math.imul(f,W)|0)+Math.imul(d,Y)|0))<<13)|0;u=((s=s+Math.imul(d,W)|0)+(i>>>13)|0)+(be>>>26)|0,be&=67108863,n=Math.imul(w,V),i=(i=Math.imul(w,H))+Math.imul(_,V)|0,s=Math.imul(_,H),n=n+Math.imul(y,G)|0,i=(i=i+Math.imul(y,q)|0)+Math.imul(b,G)|0,s=s+Math.imul(b,q)|0,n=n+Math.imul(p,Y)|0,i=(i=i+Math.imul(p,W)|0)+Math.imul(m,Y)|0,s=s+Math.imul(m,W)|0;var ve=(u+(n=n+Math.imul(f,J)|0)|0)+((8191&(i=(i=i+Math.imul(f,Z)|0)+Math.imul(d,J)|0))<<13)|0;u=((s=s+Math.imul(d,Z)|0)+(i>>>13)|0)+(ve>>>26)|0,ve&=67108863,n=Math.imul(k,V),i=(i=Math.imul(k,H))+Math.imul(S,V)|0,s=Math.imul(S,H),n=n+Math.imul(w,G)|0,i=(i=i+Math.imul(w,q)|0)+Math.imul(_,G)|0,s=s+Math.imul(_,q)|0,n=n+Math.imul(y,Y)|0,i=(i=i+Math.imul(y,W)|0)+Math.imul(b,Y)|0,s=s+Math.imul(b,W)|0,n=n+Math.imul(p,J)|0,i=(i=i+Math.imul(p,Z)|0)+Math.imul(m,J)|0,s=s+Math.imul(m,Z)|0;var we=(u+(n=n+Math.imul(f,Q)|0)|0)+((8191&(i=(i=i+Math.imul(f,ee)|0)+Math.imul(d,Q)|0))<<13)|0;u=((s=s+Math.imul(d,ee)|0)+(i>>>13)|0)+(we>>>26)|0,we&=67108863,n=Math.imul(T,V),i=(i=Math.imul(T,H))+Math.imul(I,V)|0,s=Math.imul(I,H),n=n+Math.imul(k,G)|0,i=(i=i+Math.imul(k,q)|0)+Math.imul(S,G)|0,s=s+Math.imul(S,q)|0,n=n+Math.imul(w,Y)|0,i=(i=i+Math.imul(w,W)|0)+Math.imul(_,Y)|0,s=s+Math.imul(_,W)|0,n=n+Math.imul(y,J)|0,i=(i=i+Math.imul(y,Z)|0)+Math.imul(b,J)|0,s=s+Math.imul(b,Z)|0,n=n+Math.imul(p,Q)|0,i=(i=i+Math.imul(p,ee)|0)+Math.imul(m,Q)|0,s=s+Math.imul(m,ee)|0;var _e=(u+(n=n+Math.imul(f,re)|0)|0)+((8191&(i=(i=i+Math.imul(f,ne)|0)+Math.imul(d,re)|0))<<13)|0;u=((s=s+Math.imul(d,ne)|0)+(i>>>13)|0)+(_e>>>26)|0,_e&=67108863,n=Math.imul(x,V),i=(i=Math.imul(x,H))+Math.imul(P,V)|0,s=Math.imul(P,H),n=n+Math.imul(T,G)|0,i=(i=i+Math.imul(T,q)|0)+Math.imul(I,G)|0,s=s+Math.imul(I,q)|0,n=n+Math.imul(k,Y)|0,i=(i=i+Math.imul(k,W)|0)+Math.imul(S,Y)|0,s=s+Math.imul(S,W)|0,n=n+Math.imul(w,J)|0,i=(i=i+Math.imul(w,Z)|0)+Math.imul(_,J)|0,s=s+Math.imul(_,Z)|0,n=n+Math.imul(y,Q)|0,i=(i=i+Math.imul(y,ee)|0)+Math.imul(b,Q)|0,s=s+Math.imul(b,ee)|0,n=n+Math.imul(p,re)|0,i=(i=i+Math.imul(p,ne)|0)+Math.imul(m,re)|0,s=s+Math.imul(m,ne)|0;var Ee=(u+(n=n+Math.imul(f,se)|0)|0)+((8191&(i=(i=i+Math.imul(f,oe)|0)+Math.imul(d,se)|0))<<13)|0;u=((s=s+Math.imul(d,oe)|0)+(i>>>13)|0)+(Ee>>>26)|0,Ee&=67108863,n=Math.imul(R,V),i=(i=Math.imul(R,H))+Math.imul(N,V)|0,s=Math.imul(N,H),n=n+Math.imul(x,G)|0,i=(i=i+Math.imul(x,q)|0)+Math.imul(P,G)|0,s=s+Math.imul(P,q)|0,n=n+Math.imul(T,Y)|0,i=(i=i+Math.imul(T,W)|0)+Math.imul(I,Y)|0,s=s+Math.imul(I,W)|0,n=n+Math.imul(k,J)|0,i=(i=i+Math.imul(k,Z)|0)+Math.imul(S,J)|0,s=s+Math.imul(S,Z)|0,n=n+Math.imul(w,Q)|0,i=(i=i+Math.imul(w,ee)|0)+Math.imul(_,Q)|0,s=s+Math.imul(_,ee)|0,n=n+Math.imul(y,re)|0,i=(i=i+Math.imul(y,ne)|0)+Math.imul(b,re)|0,s=s+Math.imul(b,ne)|0,n=n+Math.imul(p,se)|0,i=(i=i+Math.imul(p,oe)|0)+Math.imul(m,se)|0,s=s+Math.imul(m,oe)|0;var ke=(u+(n=n+Math.imul(f,ce)|0)|0)+((8191&(i=(i=i+Math.imul(f,ue)|0)+Math.imul(d,ce)|0))<<13)|0;u=((s=s+Math.imul(d,ue)|0)+(i>>>13)|0)+(ke>>>26)|0,ke&=67108863,n=Math.imul(j,V),i=(i=Math.imul(j,H))+Math.imul(L,V)|0,s=Math.imul(L,H),n=n+Math.imul(R,G)|0,i=(i=i+Math.imul(R,q)|0)+Math.imul(N,G)|0,s=s+Math.imul(N,q)|0,n=n+Math.imul(x,Y)|0,i=(i=i+Math.imul(x,W)|0)+Math.imul(P,Y)|0,s=s+Math.imul(P,W)|0,n=n+Math.imul(T,J)|0,i=(i=i+Math.imul(T,Z)|0)+Math.imul(I,J)|0,s=s+Math.imul(I,Z)|0,n=n+Math.imul(k,Q)|0,i=(i=i+Math.imul(k,ee)|0)+Math.imul(S,Q)|0,s=s+Math.imul(S,ee)|0,n=n+Math.imul(w,re)|0,i=(i=i+Math.imul(w,ne)|0)+Math.imul(_,re)|0,s=s+Math.imul(_,ne)|0,n=n+Math.imul(y,se)|0,i=(i=i+Math.imul(y,oe)|0)+Math.imul(b,se)|0,s=s+Math.imul(b,oe)|0,n=n+Math.imul(p,ce)|0,i=(i=i+Math.imul(p,ue)|0)+Math.imul(m,ce)|0,s=s+Math.imul(m,ue)|0;var Se=(u+(n=n+Math.imul(f,fe)|0)|0)+((8191&(i=(i=i+Math.imul(f,de)|0)+Math.imul(d,fe)|0))<<13)|0;u=((s=s+Math.imul(d,de)|0)+(i>>>13)|0)+(Se>>>26)|0,Se&=67108863,n=Math.imul(B,V),i=(i=Math.imul(B,H))+Math.imul(U,V)|0,s=Math.imul(U,H),n=n+Math.imul(j,G)|0,i=(i=i+Math.imul(j,q)|0)+Math.imul(L,G)|0,s=s+Math.imul(L,q)|0,n=n+Math.imul(R,Y)|0,i=(i=i+Math.imul(R,W)|0)+Math.imul(N,Y)|0,s=s+Math.imul(N,W)|0,n=n+Math.imul(x,J)|0,i=(i=i+Math.imul(x,Z)|0)+Math.imul(P,J)|0,s=s+Math.imul(P,Z)|0,n=n+Math.imul(T,Q)|0,i=(i=i+Math.imul(T,ee)|0)+Math.imul(I,Q)|0,s=s+Math.imul(I,ee)|0,n=n+Math.imul(k,re)|0,i=(i=i+Math.imul(k,ne)|0)+Math.imul(S,re)|0,s=s+Math.imul(S,ne)|0,n=n+Math.imul(w,se)|0,i=(i=i+Math.imul(w,oe)|0)+Math.imul(_,se)|0,s=s+Math.imul(_,oe)|0,n=n+Math.imul(y,ce)|0,i=(i=i+Math.imul(y,ue)|0)+Math.imul(b,ce)|0,s=s+Math.imul(b,ue)|0,n=n+Math.imul(p,fe)|0,i=(i=i+Math.imul(p,de)|0)+Math.imul(m,fe)|0,s=s+Math.imul(m,de)|0;var Ae=(u+(n=n+Math.imul(f,pe)|0)|0)+((8191&(i=(i=i+Math.imul(f,me)|0)+Math.imul(d,pe)|0))<<13)|0;u=((s=s+Math.imul(d,me)|0)+(i>>>13)|0)+(Ae>>>26)|0,Ae&=67108863,n=Math.imul(B,G),i=(i=Math.imul(B,q))+Math.imul(U,G)|0,s=Math.imul(U,q),n=n+Math.imul(j,Y)|0,i=(i=i+Math.imul(j,W)|0)+Math.imul(L,Y)|0,s=s+Math.imul(L,W)|0,n=n+Math.imul(R,J)|0,i=(i=i+Math.imul(R,Z)|0)+Math.imul(N,J)|0,s=s+Math.imul(N,Z)|0,n=n+Math.imul(x,Q)|0,i=(i=i+Math.imul(x,ee)|0)+Math.imul(P,Q)|0,s=s+Math.imul(P,ee)|0,n=n+Math.imul(T,re)|0,i=(i=i+Math.imul(T,ne)|0)+Math.imul(I,re)|0,s=s+Math.imul(I,ne)|0,n=n+Math.imul(k,se)|0,i=(i=i+Math.imul(k,oe)|0)+Math.imul(S,se)|0,s=s+Math.imul(S,oe)|0,n=n+Math.imul(w,ce)|0,i=(i=i+Math.imul(w,ue)|0)+Math.imul(_,ce)|0,s=s+Math.imul(_,ue)|0,n=n+Math.imul(y,fe)|0,i=(i=i+Math.imul(y,de)|0)+Math.imul(b,fe)|0,s=s+Math.imul(b,de)|0;var Te=(u+(n=n+Math.imul(p,pe)|0)|0)+((8191&(i=(i=i+Math.imul(p,me)|0)+Math.imul(m,pe)|0))<<13)|0;u=((s=s+Math.imul(m,me)|0)+(i>>>13)|0)+(Te>>>26)|0,Te&=67108863,n=Math.imul(B,Y),i=(i=Math.imul(B,W))+Math.imul(U,Y)|0,s=Math.imul(U,W),n=n+Math.imul(j,J)|0,i=(i=i+Math.imul(j,Z)|0)+Math.imul(L,J)|0,s=s+Math.imul(L,Z)|0,n=n+Math.imul(R,Q)|0,i=(i=i+Math.imul(R,ee)|0)+Math.imul(N,Q)|0,s=s+Math.imul(N,ee)|0,n=n+Math.imul(x,re)|0,i=(i=i+Math.imul(x,ne)|0)+Math.imul(P,re)|0,s=s+Math.imul(P,ne)|0,n=n+Math.imul(T,se)|0,i=(i=i+Math.imul(T,oe)|0)+Math.imul(I,se)|0,s=s+Math.imul(I,oe)|0,n=n+Math.imul(k,ce)|0,i=(i=i+Math.imul(k,ue)|0)+Math.imul(S,ce)|0,s=s+Math.imul(S,ue)|0,n=n+Math.imul(w,fe)|0,i=(i=i+Math.imul(w,de)|0)+Math.imul(_,fe)|0,s=s+Math.imul(_,de)|0;var Ie=(u+(n=n+Math.imul(y,pe)|0)|0)+((8191&(i=(i=i+Math.imul(y,me)|0)+Math.imul(b,pe)|0))<<13)|0;u=((s=s+Math.imul(b,me)|0)+(i>>>13)|0)+(Ie>>>26)|0,Ie&=67108863,n=Math.imul(B,J),i=(i=Math.imul(B,Z))+Math.imul(U,J)|0,s=Math.imul(U,Z),n=n+Math.imul(j,Q)|0,i=(i=i+Math.imul(j,ee)|0)+Math.imul(L,Q)|0,s=s+Math.imul(L,ee)|0,n=n+Math.imul(R,re)|0,i=(i=i+Math.imul(R,ne)|0)+Math.imul(N,re)|0,s=s+Math.imul(N,ne)|0,n=n+Math.imul(x,se)|0,i=(i=i+Math.imul(x,oe)|0)+Math.imul(P,se)|0,s=s+Math.imul(P,oe)|0,n=n+Math.imul(T,ce)|0,i=(i=i+Math.imul(T,ue)|0)+Math.imul(I,ce)|0,s=s+Math.imul(I,ue)|0,n=n+Math.imul(k,fe)|0,i=(i=i+Math.imul(k,de)|0)+Math.imul(S,fe)|0,s=s+Math.imul(S,de)|0;var Ce=(u+(n=n+Math.imul(w,pe)|0)|0)+((8191&(i=(i=i+Math.imul(w,me)|0)+Math.imul(_,pe)|0))<<13)|0;u=((s=s+Math.imul(_,me)|0)+(i>>>13)|0)+(Ce>>>26)|0,Ce&=67108863,n=Math.imul(B,Q),i=(i=Math.imul(B,ee))+Math.imul(U,Q)|0,s=Math.imul(U,ee),n=n+Math.imul(j,re)|0,i=(i=i+Math.imul(j,ne)|0)+Math.imul(L,re)|0,s=s+Math.imul(L,ne)|0,n=n+Math.imul(R,se)|0,i=(i=i+Math.imul(R,oe)|0)+Math.imul(N,se)|0,s=s+Math.imul(N,oe)|0,n=n+Math.imul(x,ce)|0,i=(i=i+Math.imul(x,ue)|0)+Math.imul(P,ce)|0,s=s+Math.imul(P,ue)|0,n=n+Math.imul(T,fe)|0,i=(i=i+Math.imul(T,de)|0)+Math.imul(I,fe)|0,s=s+Math.imul(I,de)|0;var xe=(u+(n=n+Math.imul(k,pe)|0)|0)+((8191&(i=(i=i+Math.imul(k,me)|0)+Math.imul(S,pe)|0))<<13)|0;u=((s=s+Math.imul(S,me)|0)+(i>>>13)|0)+(xe>>>26)|0,xe&=67108863,n=Math.imul(B,re),i=(i=Math.imul(B,ne))+Math.imul(U,re)|0,s=Math.imul(U,ne),n=n+Math.imul(j,se)|0,i=(i=i+Math.imul(j,oe)|0)+Math.imul(L,se)|0,s=s+Math.imul(L,oe)|0,n=n+Math.imul(R,ce)|0,i=(i=i+Math.imul(R,ue)|0)+Math.imul(N,ce)|0,s=s+Math.imul(N,ue)|0,n=n+Math.imul(x,fe)|0,i=(i=i+Math.imul(x,de)|0)+Math.imul(P,fe)|0,s=s+Math.imul(P,de)|0;var Pe=(u+(n=n+Math.imul(T,pe)|0)|0)+((8191&(i=(i=i+Math.imul(T,me)|0)+Math.imul(I,pe)|0))<<13)|0;u=((s=s+Math.imul(I,me)|0)+(i>>>13)|0)+(Pe>>>26)|0,Pe&=67108863,n=Math.imul(B,se),i=(i=Math.imul(B,oe))+Math.imul(U,se)|0,s=Math.imul(U,oe),n=n+Math.imul(j,ce)|0,i=(i=i+Math.imul(j,ue)|0)+Math.imul(L,ce)|0,s=s+Math.imul(L,ue)|0,n=n+Math.imul(R,fe)|0,i=(i=i+Math.imul(R,de)|0)+Math.imul(N,fe)|0,s=s+Math.imul(N,de)|0;var Oe=(u+(n=n+Math.imul(x,pe)|0)|0)+((8191&(i=(i=i+Math.imul(x,me)|0)+Math.imul(P,pe)|0))<<13)|0;u=((s=s+Math.imul(P,me)|0)+(i>>>13)|0)+(Oe>>>26)|0,Oe&=67108863,n=Math.imul(B,ce),i=(i=Math.imul(B,ue))+Math.imul(U,ce)|0,s=Math.imul(U,ue),n=n+Math.imul(j,fe)|0,i=(i=i+Math.imul(j,de)|0)+Math.imul(L,fe)|0,s=s+Math.imul(L,de)|0;var Re=(u+(n=n+Math.imul(R,pe)|0)|0)+((8191&(i=(i=i+Math.imul(R,me)|0)+Math.imul(N,pe)|0))<<13)|0;u=((s=s+Math.imul(N,me)|0)+(i>>>13)|0)+(Re>>>26)|0,Re&=67108863,n=Math.imul(B,fe),i=(i=Math.imul(B,de))+Math.imul(U,fe)|0,s=Math.imul(U,de);var Ne=(u+(n=n+Math.imul(j,pe)|0)|0)+((8191&(i=(i=i+Math.imul(j,me)|0)+Math.imul(L,pe)|0))<<13)|0;u=((s=s+Math.imul(L,me)|0)+(i>>>13)|0)+(Ne>>>26)|0,Ne&=67108863;var Me=(u+(n=Math.imul(B,pe))|0)+((8191&(i=(i=Math.imul(B,me))+Math.imul(U,pe)|0))<<13)|0;return u=((s=Math.imul(U,me))+(i>>>13)|0)+(Me>>>26)|0,Me&=67108863,c[0]=ge,c[1]=ye,c[2]=be,c[3]=ve,c[4]=we,c[5]=_e,c[6]=Ee,c[7]=ke,c[8]=Se,c[9]=Ae,c[10]=Te,c[11]=Ie,c[12]=Ce,c[13]=xe,c[14]=Pe,c[15]=Oe,c[16]=Re,c[17]=Ne,c[18]=Me,0!==u&&(c[19]=u,r.length++),r};function y(e,t,r){r.negative=t.negative^e.negative,r.length=e.length+t.length;for(var n=0,i=0,s=0;s<r.length-1;s++){var o=i;i=0;for(var a=67108863&n,c=Math.min(s,t.length-1),u=Math.max(0,s-e.length+1);u<=c;u++){var l=s-u,f=(0|e.words[l])*(0|t.words[u]),d=67108863&f;a=67108863&(d=d+a|0),i+=(o=(o=o+(f/67108864|0)|0)+(d>>>26)|0)>>>26,o&=67108863}r.words[s]=a,n=o,o=i}return 0!==n?r.words[s]=n:r.length--,r._strip()}function b(e,t,r){return y(e,t,r)}function v(e,t){this.x=e,this.y=t}Math.imul||(g=m),s.prototype.mulTo=function(e,t){var r=this.length+e.length;return 10===this.length&&10===e.length?g(this,e,t):r<63?m(this,e,t):r<1024?y(this,e,t):b(this,e,t)},v.prototype.makeRBT=function(e){for(var t=new Array(e),r=s.prototype._countBits(e)-1,n=0;n<e;n++)t[n]=this.revBin(n,r,e);return t},v.prototype.revBin=function(e,t,r){if(0===e||e===r-1)return e;for(var n=0,i=0;i<t;i++)n|=(1&e)<<t-i-1,e>>=1;return n},v.prototype.permute=function(e,t,r,n,i,s){for(var o=0;o<s;o++)n[o]=t[e[o]],i[o]=r[e[o]]},v.prototype.transform=function(e,t,r,n,i,s){this.permute(s,e,t,r,n,i);for(var o=1;o<i;o<<=1)for(var a=o<<1,c=Math.cos(2*Math.PI/a),u=Math.sin(2*Math.PI/a),l=0;l<i;l+=a)for(var f=c,d=u,h=0;h<o;h++){var p=r[l+h],m=n[l+h],g=r[l+h+o],y=n[l+h+o],b=f*g-d*y;y=f*y+d*g,g=b,r[l+h]=p+g,n[l+h]=m+y,r[l+h+o]=p-g,n[l+h+o]=m-y,h!==a&&(b=c*f-u*d,d=c*d+u*f,f=b)}},v.prototype.guessLen13b=function(e,t){var r=1|Math.max(t,e),n=1&r,i=0;for(r=r/2|0;r;r>>>=1)i++;return 1<<i+1+n},v.prototype.conjugate=function(e,t,r){if(!(r<=1))for(var n=0;n<r/2;n++){var i=e[n];e[n]=e[r-n-1],e[r-n-1]=i,i=t[n],t[n]=-t[r-n-1],t[r-n-1]=-i}},v.prototype.normalize13b=function(e,t){for(var r=0,n=0;n<t/2;n++){var i=8192*Math.round(e[2*n+1]/t)+Math.round(e[2*n]/t)+r;e[n]=67108863&i,r=i<67108864?0:i/67108864|0}return e},v.prototype.convert13b=function(e,t,r,i){for(var s=0,o=0;o<t;o++)s+=0|e[o],r[2*o]=8191&s,s>>>=13,r[2*o+1]=8191&s,s>>>=13;for(o=2*t;o<i;++o)r[o]=0;n(0===s),n(0==(-8192&s))},v.prototype.stub=function(e){for(var t=new Array(e),r=0;r<e;r++)t[r]=0;return t},v.prototype.mulp=function(e,t,r){var n=2*this.guessLen13b(e.length,t.length),i=this.makeRBT(n),s=this.stub(n),o=new Array(n),a=new Array(n),c=new Array(n),u=new Array(n),l=new Array(n),f=new Array(n),d=r.words;d.length=n,this.convert13b(e.words,e.length,o,n),this.convert13b(t.words,t.length,u,n),this.transform(o,s,a,c,n,i),this.transform(u,s,l,f,n,i);for(var h=0;h<n;h++){var p=a[h]*l[h]-c[h]*f[h];c[h]=a[h]*f[h]+c[h]*l[h],a[h]=p}return this.conjugate(a,c,n),this.transform(a,c,d,s,n,i),this.conjugate(d,s,n),this.normalize13b(d,n),r.negative=e.negative^t.negative,r.length=e.length+t.length,r._strip()},s.prototype.mul=function(e){var t=new s(null);return t.words=new Array(this.length+e.length),this.mulTo(e,t)},s.prototype.mulf=function(e){var t=new s(null);return t.words=new Array(this.length+e.length),b(this,e,t)},s.prototype.imul=function(e){return this.clone().mulTo(e,this)},s.prototype.imuln=function(e){var t=e<0;t&&(e=-e),n("number"==typeof e),n(e<67108864);for(var r=0,i=0;i<this.length;i++){var s=(0|this.words[i])*e,o=(67108863&s)+(67108863&r);r>>=26,r+=s/67108864|0,r+=o>>>26,this.words[i]=67108863&o}return 0!==r&&(this.words[i]=r,this.length++),t?this.ineg():this},s.prototype.muln=function(e){return this.clone().imuln(e)},s.prototype.sqr=function(){return this.mul(this)},s.prototype.isqr=function(){return this.imul(this.clone())},s.prototype.pow=function(e){var t=function(e){for(var t=new Array(e.bitLength()),r=0;r<t.length;r++){var n=r/26|0,i=r%26;t[r]=e.words[n]>>>i&1}return t}(e);if(0===t.length)return new s(1);for(var r=this,n=0;n<t.length&&0===t[n];n++,r=r.sqr());if(++n<t.length)for(var i=r.sqr();n<t.length;n++,i=i.sqr())0!==t[n]&&(r=r.mul(i));return r},s.prototype.iushln=function(e){n("number"==typeof e&&e>=0);var t,r=e%26,i=(e-r)/26,s=67108863>>>26-r<<26-r;if(0!==r){var o=0;for(t=0;t<this.length;t++){var a=this.words[t]&s,c=(0|this.words[t])-a<<r;this.words[t]=c|o,o=a>>>26-r}o&&(this.words[t]=o,this.length++)}if(0!==i){for(t=this.length-1;t>=0;t--)this.words[t+i]=this.words[t];for(t=0;t<i;t++)this.words[t]=0;this.length+=i}return this._strip()},s.prototype.ishln=function(e){return n(0===this.negative),this.iushln(e)},s.prototype.iushrn=function(e,t,r){var i;n("number"==typeof e&&e>=0),i=t?(t-t%26)/26:0;var s=e%26,o=Math.min((e-s)/26,this.length),a=67108863^67108863>>>s<<s,c=r;if(i-=o,i=Math.max(0,i),c){for(var u=0;u<o;u++)c.words[u]=this.words[u];c.length=o}if(0===o);else if(this.length>o)for(this.length-=o,u=0;u<this.length;u++)this.words[u]=this.words[u+o];else this.words[0]=0,this.length=1;var l=0;for(u=this.length-1;u>=0&&(0!==l||u>=i);u--){var f=0|this.words[u];this.words[u]=l<<26-s|f>>>s,l=f&a}return c&&0!==l&&(c.words[c.length++]=l),0===this.length&&(this.words[0]=0,this.length=1),this._strip()},s.prototype.ishrn=function(e,t,r){return n(0===this.negative),this.iushrn(e,t,r)},s.prototype.shln=function(e){return this.clone().ishln(e)},s.prototype.ushln=function(e){return this.clone().iushln(e)},s.prototype.shrn=function(e){return this.clone().ishrn(e)},s.prototype.ushrn=function(e){return this.clone().iushrn(e)},s.prototype.testn=function(e){n("number"==typeof e&&e>=0);var t=e%26,r=(e-t)/26,i=1<<t;return!(this.length<=r)&&!!(this.words[r]&i)},s.prototype.imaskn=function(e){n("number"==typeof e&&e>=0);var t=e%26,r=(e-t)/26;if(n(0===this.negative,"imaskn works only with positive numbers"),this.length<=r)return this;if(0!==t&&r++,this.length=Math.min(r,this.length),0!==t){var i=67108863^67108863>>>t<<t;this.words[this.length-1]&=i}return this._strip()},s.prototype.maskn=function(e){return this.clone().imaskn(e)},s.prototype.iaddn=function(e){return n("number"==typeof e),n(e<67108864),e<0?this.isubn(-e):0!==this.negative?1===this.length&&(0|this.words[0])<=e?(this.words[0]=e-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(e),this.negative=1,this):this._iaddn(e)},s.prototype._iaddn=function(e){this.words[0]+=e;for(var t=0;t<this.length&&this.words[t]>=67108864;t++)this.words[t]-=67108864,t===this.length-1?this.words[t+1]=1:this.words[t+1]++;return this.length=Math.max(this.length,t+1),this},s.prototype.isubn=function(e){if(n("number"==typeof e),n(e<67108864),e<0)return this.iaddn(-e);if(0!==this.negative)return this.negative=0,this.iaddn(e),this.negative=1,this;if(this.words[0]-=e,1===this.length&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var t=0;t<this.length&&this.words[t]<0;t++)this.words[t]+=67108864,this.words[t+1]-=1;return this._strip()},s.prototype.addn=function(e){return this.clone().iaddn(e)},s.prototype.subn=function(e){return this.clone().isubn(e)},s.prototype.iabs=function(){return this.negative=0,this},s.prototype.abs=function(){return this.clone().iabs()},s.prototype._ishlnsubmul=function(e,t,r){var i,s,o=e.length+r;this._expand(o);var a=0;for(i=0;i<e.length;i++){s=(0|this.words[i+r])+a;var c=(0|e.words[i])*t;a=((s-=67108863&c)>>26)-(c/67108864|0),this.words[i+r]=67108863&s}for(;i<this.length-r;i++)a=(s=(0|this.words[i+r])+a)>>26,this.words[i+r]=67108863&s;if(0===a)return this._strip();for(n(-1===a),a=0,i=0;i<this.length;i++)a=(s=-(0|this.words[i])+a)>>26,this.words[i]=67108863&s;return this.negative=1,this._strip()},s.prototype._wordDiv=function(e,t){var r=(this.length,e.length),n=this.clone(),i=e,o=0|i.words[i.length-1];0!==(r=26-this._countBits(o))&&(i=i.ushln(r),n.iushln(r),o=0|i.words[i.length-1]);var a,c=n.length-i.length;if("mod"!==t){(a=new s(null)).length=c+1,a.words=new Array(a.length);for(var u=0;u<a.length;u++)a.words[u]=0}var l=n.clone()._ishlnsubmul(i,1,c);0===l.negative&&(n=l,a&&(a.words[c]=1));for(var f=c-1;f>=0;f--){var d=67108864*(0|n.words[i.length+f])+(0|n.words[i.length+f-1]);for(d=Math.min(d/o|0,67108863),n._ishlnsubmul(i,d,f);0!==n.negative;)d--,n.negative=0,n._ishlnsubmul(i,1,f),n.isZero()||(n.negative^=1);a&&(a.words[f]=d)}return a&&a._strip(),n._strip(),"div"!==t&&0!==r&&n.iushrn(r),{div:a||null,mod:n}},s.prototype.divmod=function(e,t,r){return n(!e.isZero()),this.isZero()?{div:new s(0),mod:new s(0)}:0!==this.negative&&0===e.negative?(a=this.neg().divmod(e,t),"mod"!==t&&(i=a.div.neg()),"div"!==t&&(o=a.mod.neg(),r&&0!==o.negative&&o.iadd(e)),{div:i,mod:o}):0===this.negative&&0!==e.negative?(a=this.divmod(e.neg(),t),"mod"!==t&&(i=a.div.neg()),{div:i,mod:a.mod}):0!=(this.negative&e.negative)?(a=this.neg().divmod(e.neg(),t),"div"!==t&&(o=a.mod.neg(),r&&0!==o.negative&&o.isub(e)),{div:a.div,mod:o}):e.length>this.length||this.cmp(e)<0?{div:new s(0),mod:this}:1===e.length?"div"===t?{div:this.divn(e.words[0]),mod:null}:"mod"===t?{div:null,mod:new s(this.modrn(e.words[0]))}:{div:this.divn(e.words[0]),mod:new s(this.modrn(e.words[0]))}:this._wordDiv(e,t);var i,o,a},s.prototype.div=function(e){return this.divmod(e,"div",!1).div},s.prototype.mod=function(e){return this.divmod(e,"mod",!1).mod},s.prototype.umod=function(e){return this.divmod(e,"mod",!0).mod},s.prototype.divRound=function(e){var t=this.divmod(e);if(t.mod.isZero())return t.div;var r=0!==t.div.negative?t.mod.isub(e):t.mod,n=e.ushrn(1),i=e.andln(1),s=r.cmp(n);return s<0||1===i&&0===s?t.div:0!==t.div.negative?t.div.isubn(1):t.div.iaddn(1)},s.prototype.modrn=function(e){var t=e<0;t&&(e=-e),n(e<=67108863);for(var r=(1<<26)%e,i=0,s=this.length-1;s>=0;s--)i=(r*i+(0|this.words[s]))%e;return t?-i:i},s.prototype.modn=function(e){return this.modrn(e)},s.prototype.idivn=function(e){var t=e<0;t&&(e=-e),n(e<=67108863);for(var r=0,i=this.length-1;i>=0;i--){var s=(0|this.words[i])+67108864*r;this.words[i]=s/e|0,r=s%e}return this._strip(),t?this.ineg():this},s.prototype.divn=function(e){return this.clone().idivn(e)},s.prototype.egcd=function(e){n(0===e.negative),n(!e.isZero());var t=this,r=e.clone();t=0!==t.negative?t.umod(e):t.clone();for(var i=new s(1),o=new s(0),a=new s(0),c=new s(1),u=0;t.isEven()&&r.isEven();)t.iushrn(1),r.iushrn(1),++u;for(var l=r.clone(),f=t.clone();!t.isZero();){for(var d=0,h=1;0==(t.words[0]&h)&&d<26;++d,h<<=1);if(d>0)for(t.iushrn(d);d-- >0;)(i.isOdd()||o.isOdd())&&(i.iadd(l),o.isub(f)),i.iushrn(1),o.iushrn(1);for(var p=0,m=1;0==(r.words[0]&m)&&p<26;++p,m<<=1);if(p>0)for(r.iushrn(p);p-- >0;)(a.isOdd()||c.isOdd())&&(a.iadd(l),c.isub(f)),a.iushrn(1),c.iushrn(1);t.cmp(r)>=0?(t.isub(r),i.isub(a),o.isub(c)):(r.isub(t),a.isub(i),c.isub(o))}return{a:a,b:c,gcd:r.iushln(u)}},s.prototype._invmp=function(e){n(0===e.negative),n(!e.isZero());var t=this,r=e.clone();t=0!==t.negative?t.umod(e):t.clone();for(var i,o=new s(1),a=new s(0),c=r.clone();t.cmpn(1)>0&&r.cmpn(1)>0;){for(var u=0,l=1;0==(t.words[0]&l)&&u<26;++u,l<<=1);if(u>0)for(t.iushrn(u);u-- >0;)o.isOdd()&&o.iadd(c),o.iushrn(1);for(var f=0,d=1;0==(r.words[0]&d)&&f<26;++f,d<<=1);if(f>0)for(r.iushrn(f);f-- >0;)a.isOdd()&&a.iadd(c),a.iushrn(1);t.cmp(r)>=0?(t.isub(r),o.isub(a)):(r.isub(t),a.isub(o))}return(i=0===t.cmpn(1)?o:a).cmpn(0)<0&&i.iadd(e),i},s.prototype.gcd=function(e){if(this.isZero())return e.abs();if(e.isZero())return this.abs();var t=this.clone(),r=e.clone();t.negative=0,r.negative=0;for(var n=0;t.isEven()&&r.isEven();n++)t.iushrn(1),r.iushrn(1);for(;;){for(;t.isEven();)t.iushrn(1);for(;r.isEven();)r.iushrn(1);var i=t.cmp(r);if(i<0){var s=t;t=r,r=s}else if(0===i||0===r.cmpn(1))break;t.isub(r)}return r.iushln(n)},s.prototype.invm=function(e){return this.egcd(e).a.umod(e)},s.prototype.isEven=function(){return 0==(1&this.words[0])},s.prototype.isOdd=function(){return 1==(1&this.words[0])},s.prototype.andln=function(e){return this.words[0]&e},s.prototype.bincn=function(e){n("number"==typeof e);var t=e%26,r=(e-t)/26,i=1<<t;if(this.length<=r)return this._expand(r+1),this.words[r]|=i,this;for(var s=i,o=r;0!==s&&o<this.length;o++){var a=0|this.words[o];s=(a+=s)>>>26,a&=67108863,this.words[o]=a}return 0!==s&&(this.words[o]=s,this.length++),this},s.prototype.isZero=function(){return 1===this.length&&0===this.words[0]},s.prototype.cmpn=function(e){var t,r=e<0;if(0!==this.negative&&!r)return-1;if(0===this.negative&&r)return 1;if(this._strip(),this.length>1)t=1;else{r&&(e=-e),n(e<=67108863,"Number is too big");var i=0|this.words[0];t=i===e?0:i<e?-1:1}return 0!==this.negative?0|-t:t},s.prototype.cmp=function(e){if(0!==this.negative&&0===e.negative)return-1;if(0===this.negative&&0!==e.negative)return 1;var t=this.ucmp(e);return 0!==this.negative?0|-t:t},s.prototype.ucmp=function(e){if(this.length>e.length)return 1;if(this.length<e.length)return-1;for(var t=0,r=this.length-1;r>=0;r--){var n=0|this.words[r],i=0|e.words[r];if(n!==i){n<i?t=-1:n>i&&(t=1);break}}return t},s.prototype.gtn=function(e){return 1===this.cmpn(e)},s.prototype.gt=function(e){return 1===this.cmp(e)},s.prototype.gten=function(e){return this.cmpn(e)>=0},s.prototype.gte=function(e){return this.cmp(e)>=0},s.prototype.ltn=function(e){return-1===this.cmpn(e)},s.prototype.lt=function(e){return-1===this.cmp(e)},s.prototype.lten=function(e){return this.cmpn(e)<=0},s.prototype.lte=function(e){return this.cmp(e)<=0},s.prototype.eqn=function(e){return 0===this.cmpn(e)},s.prototype.eq=function(e){return 0===this.cmp(e)},s.red=function(e){return new T(e)},s.prototype.toRed=function(e){return n(!this.red,"Already a number in reduction context"),n(0===this.negative,"red works only with positives"),e.convertTo(this)._forceRed(e)},s.prototype.fromRed=function(){return n(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},s.prototype._forceRed=function(e){return this.red=e,this},s.prototype.forceRed=function(e){return n(!this.red,"Already a number in reduction context"),this._forceRed(e)},s.prototype.redAdd=function(e){return n(this.red,"redAdd works only with red numbers"),this.red.add(this,e)},s.prototype.redIAdd=function(e){return n(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,e)},s.prototype.redSub=function(e){return n(this.red,"redSub works only with red numbers"),this.red.sub(this,e)},s.prototype.redISub=function(e){return n(this.red,"redISub works only with red numbers"),this.red.isub(this,e)},s.prototype.redShl=function(e){return n(this.red,"redShl works only with red numbers"),this.red.shl(this,e)},s.prototype.redMul=function(e){return n(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.mul(this,e)},s.prototype.redIMul=function(e){return n(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.imul(this,e)},s.prototype.redSqr=function(){return n(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},s.prototype.redISqr=function(){return n(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},s.prototype.redSqrt=function(){return n(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},s.prototype.redInvm=function(){return n(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},s.prototype.redNeg=function(){return n(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},s.prototype.redPow=function(e){return n(this.red&&!e.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,e)};var w={k256:null,p224:null,p192:null,p25519:null};function _(e,t){this.name=e,this.p=new s(t,16),this.n=this.p.bitLength(),this.k=new s(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function E(){_.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function k(){_.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function S(){_.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function A(){_.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function T(e){if("string"==typeof e){var t=s._prime(e);this.m=t.p,this.prime=t}else n(e.gtn(1),"modulus must be greater than 1"),this.m=e,this.prime=null}function I(e){T.call(this,e),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new s(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}_.prototype._tmp=function(){var e=new s(null);return e.words=new Array(Math.ceil(this.n/13)),e},_.prototype.ireduce=function(e){var t,r=e;do{this.split(r,this.tmp),t=(r=(r=this.imulK(r)).iadd(this.tmp)).bitLength()}while(t>this.n);var n=t<this.n?-1:r.ucmp(this.p);return 0===n?(r.words[0]=0,r.length=1):n>0?r.isub(this.p):r.strip!==undefined?r.strip():r._strip(),r},_.prototype.split=function(e,t){e.iushrn(this.n,0,t)},_.prototype.imulK=function(e){return e.imul(this.k)},i(E,_),E.prototype.split=function(e,t){for(var r=4194303,n=Math.min(e.length,9),i=0;i<n;i++)t.words[i]=e.words[i];if(t.length=n,e.length<=9)return e.words[0]=0,void(e.length=1);var s=e.words[9];for(t.words[t.length++]=s&r,i=10;i<e.length;i++){var o=0|e.words[i];e.words[i-10]=(o&r)<<4|s>>>22,s=o}s>>>=22,e.words[i-10]=s,0===s&&e.length>10?e.length-=10:e.length-=9},E.prototype.imulK=function(e){e.words[e.length]=0,e.words[e.length+1]=0,e.length+=2;for(var t=0,r=0;r<e.length;r++){var n=0|e.words[r];t+=977*n,e.words[r]=67108863&t,t=64*n+(t/67108864|0)}return 0===e.words[e.length-1]&&(e.length--,0===e.words[e.length-1]&&e.length--),e},i(k,_),i(S,_),i(A,_),A.prototype.imulK=function(e){for(var t=0,r=0;r<e.length;r++){var n=19*(0|e.words[r])+t,i=67108863&n;n>>>=26,e.words[r]=i,t=n}return 0!==t&&(e.words[e.length++]=t),e},s._prime=function(e){if(w[e])return w[e];var t;if("k256"===e)t=new E;else if("p224"===e)t=new k;else if("p192"===e)t=new S;else{if("p25519"!==e)throw new Error("Unknown prime "+e);t=new A}return w[e]=t,t},T.prototype._verify1=function(e){n(0===e.negative,"red works only with positives"),n(e.red,"red works only with red numbers")},T.prototype._verify2=function(e,t){n(0==(e.negative|t.negative),"red works only with positives"),n(e.red&&e.red===t.red,"red works only with red numbers")},T.prototype.imod=function(e){return this.prime?this.prime.ireduce(e)._forceRed(this):(l(e,e.umod(this.m)._forceRed(this)),e)},T.prototype.neg=function(e){return e.isZero()?e.clone():this.m.sub(e)._forceRed(this)},T.prototype.add=function(e,t){this._verify2(e,t);var r=e.add(t);return r.cmp(this.m)>=0&&r.isub(this.m),r._forceRed(this)},T.prototype.iadd=function(e,t){this._verify2(e,t);var r=e.iadd(t);return r.cmp(this.m)>=0&&r.isub(this.m),r},T.prototype.sub=function(e,t){this._verify2(e,t);var r=e.sub(t);return r.cmpn(0)<0&&r.iadd(this.m),r._forceRed(this)},T.prototype.isub=function(e,t){this._verify2(e,t);var r=e.isub(t);return r.cmpn(0)<0&&r.iadd(this.m),r},T.prototype.shl=function(e,t){return this._verify1(e),this.imod(e.ushln(t))},T.prototype.imul=function(e,t){return this._verify2(e,t),this.imod(e.imul(t))},T.prototype.mul=function(e,t){return this._verify2(e,t),this.imod(e.mul(t))},T.prototype.isqr=function(e){return this.imul(e,e.clone())},T.prototype.sqr=function(e){return this.mul(e,e)},T.prototype.sqrt=function(e){if(e.isZero())return e.clone();var t=this.m.andln(3);if(n(t%2==1),3===t){var r=this.m.add(new s(1)).iushrn(2);return this.pow(e,r)}for(var i=this.m.subn(1),o=0;!i.isZero()&&0===i.andln(1);)o++,i.iushrn(1);n(!i.isZero());var a=new s(1).toRed(this),c=a.redNeg(),u=this.m.subn(1).iushrn(1),l=this.m.bitLength();for(l=new s(2*l*l).toRed(this);0!==this.pow(l,u).cmp(c);)l.redIAdd(c);for(var f=this.pow(l,i),d=this.pow(e,i.addn(1).iushrn(1)),h=this.pow(e,i),p=o;0!==h.cmp(a);){for(var m=h,g=0;0!==m.cmp(a);g++)m=m.redSqr();n(g<p);var y=this.pow(f,new s(1).iushln(p-g-1));d=d.redMul(y),f=y.redSqr(),h=h.redMul(f),p=g}return d},T.prototype.invm=function(e){var t=e._invmp(this.m);return 0!==t.negative?(t.negative=0,this.imod(t).redNeg()):this.imod(t)},T.prototype.pow=function(e,t){if(t.isZero())return new s(1).toRed(this);if(0===t.cmpn(1))return e.clone();var r=new Array(16);r[0]=new s(1).toRed(this),r[1]=e;for(var n=2;n<r.length;n++)r[n]=this.mul(r[n-1],e);var i=r[0],o=0,a=0,c=t.bitLength()%26;for(0===c&&(c=26),n=t.length-1;n>=0;n--){for(var u=t.words[n],l=c-1;l>=0;l--){var f=u>>l&1;i!==r[0]&&(i=this.sqr(i)),0!==f||0!==o?(o<<=1,o|=f,(4===++a||0===n&&0===l)&&(i=this.mul(i,r[o]),a=0,o=0)):a=0}c=26}return i},T.prototype.convertTo=function(e){var t=e.umod(this.m);return t===e?t.clone():t},T.prototype.convertFrom=function(e){var t=e.clone();return t.red=null,t},s.mont=function(e){return new I(e)},i(I,T),I.prototype.convertTo=function(e){return this.imod(e.ushln(this.shift))},I.prototype.convertFrom=function(e){var t=this.imod(e.mul(this.rinv));return t.red=null,t},I.prototype.imul=function(e,t){if(e.isZero()||t.isZero())return e.words[0]=0,e.length=1,e;var r=e.imul(t),n=r.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),i=r.isub(n).iushrn(this.shift),s=i;return i.cmp(this.m)>=0?s=i.isub(this.m):i.cmpn(0)<0&&(s=i.iadd(this.m)),s._forceRed(this)},I.prototype.mul=function(e,t){if(e.isZero()||t.isZero())return new s(0)._forceRed(this);var r=e.mul(t),n=r.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),i=r.isub(n).iushrn(this.shift),o=i;return i.cmp(this.m)>=0?o=i.isub(this.m):i.cmpn(0)<0&&(o=i.iadd(this.m)),o._forceRed(this)},I.prototype.invm=function(e){return this.imod(e._invmp(this.m).mul(this.r2))._forceRed(this)}}(void 0===t||t,this)}}},{package:"bn.js",file:"/home/circleci/project/node_modules/eth-lattice-keyring/node_modules/bn.js/lib/bn.js"}],[4405,{"./client":4400,"./constants":4401},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.Constants=r.Client=void 0;var n=e("./client");Object.defineProperty(r,"Client",{enumerable:!0,get:function(){return n.Client}});var i=e("./constants");Object.defineProperty(r,"Constants",{enumerable:!0,get:function(){return i.EXTERNAL}})}}},{package:"gridplus-sdk",file:"/home/circleci/project/node_modules/gridplus-sdk/dist/index.js"}],[2556,{assert:1776,coinstring:2201,crypto:2267,"safe-buffer":5817,secp256k1:2557},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("assert"),i=e("safe-buffer").Buffer,s=e("crypto"),o=e("coinstring"),a=e("secp256k1"),c=i.from("Bitcoin seed","utf8"),u=2147483648,l={private:76066276,public:76067358};function f(e){this.versions=e||l,this.depth=0,this.index=0,this._privateKey=null,this._publicKey=null,this.chainCode=null,this._fingerprint=0,this.parentFingerprint=0}function d(e,t,r){var n=i.allocUnsafe(78);n.writeUInt32BE(t,0),n.writeUInt8(e.depth,4);var s=e.depth?e.parentFingerprint:0;return n.writeUInt32BE(s,5),n.writeUInt32BE(e.index,9),e.chainCode.copy(n,13),r.copy(n,45),n}function h(e){var t=s.createHash("sha256").update(e).digest();return s.createHash("rmd160").update(t).digest()}Object.defineProperty(f.prototype,"fingerprint",{get:function(){return this._fingerprint}}),Object.defineProperty(f.prototype,"identifier",{get:function(){return this._identifier}}),Object.defineProperty(f.prototype,"pubKeyHash",{get:function(){return this.identifier}}),Object.defineProperty(f.prototype,"privateKey",{get:function(){return this._privateKey},set:function(e){n.equal(e.length,32,"Private key must be 32 bytes."),n(!0===a.privateKeyVerify(e),"Invalid private key"),this._privateKey=e,this._publicKey=a.publicKeyCreate(e,!0),this._identifier=h(this.publicKey),this._fingerprint=this._identifier.slice(0,4).readUInt32BE(0)}}),Object.defineProperty(f.prototype,"publicKey",{get:function(){return this._publicKey},set:function(e){n(33===e.length||65===e.length,"Public key must be 33 or 65 bytes."),n(!0===a.publicKeyVerify(e),"Invalid public key"),this._publicKey=a.publicKeyConvert(e,!0),this._identifier=h(this.publicKey),this._fingerprint=this._identifier.slice(0,4).readUInt32BE(0),this._privateKey=null}}),Object.defineProperty(f.prototype,"privateExtendedKey",{get:function(){return this._privateKey?o.encode(d(this,this.versions.private,i.concat([i.alloc(1,0),this.privateKey]))):null}}),Object.defineProperty(f.prototype,"publicExtendedKey",{get:function(){return o.encode(d(this,this.versions.public,this.publicKey))}}),f.prototype.derive=function(e){if("m"===e||"M"===e||"m'"===e||"M'"===e)return this;var t=e.split("/"),r=this;return t.forEach((function(e,t){if(0!==t){var i=e.length>1&&"'"===e[e.length-1],s=parseInt(e,10);n(s<u,"Invalid index"),i&&(s+=u),r=r.deriveChild(s)}else n(e,"m","Invalid path")})),r},f.prototype.deriveChild=function(e){var t,r=e>=u,o=i.allocUnsafe(4);if(o.writeUInt32BE(e,0),r){n(this.privateKey,"Could not derive hardened child key");var c=this.privateKey,l=i.alloc(1,0);c=i.concat([l,c]),t=i.concat([c,o])}else t=i.concat([this.publicKey,o]);var d=s.createHmac("sha512",this.chainCode).update(t).digest(),h=d.slice(0,32),p=d.slice(32),m=new f(this.versions);if(this.privateKey)try{m.privateKey=a.privateKeyTweakAdd(this.privateKey,h)}catch(t){return this.derive(e+1)}else try{m.publicKey=a.publicKeyTweakAdd(this.publicKey,h,!0)}catch(t){return this.derive(e+1,r)}return m.chainCode=p,m.depth=this.depth+1,m.parentFingerprint=this.fingerprint,m.index=e,m},f.prototype.sign=function(e){return a.sign(e,this.privateKey).signature},f.prototype.verify=function(e,t){return a.verify(e,t,this.publicKey)},f.prototype.toJSON=function(){return{xpriv:this.privateExtendedKey,xpub:this.publicExtendedKey}},f.fromMasterSeed=function(e,t){var r=s.createHmac("sha512",c).update(e).digest(),n=r.slice(0,32),i=r.slice(32),o=new f(t);return o.chainCode=i,o.privateKey=n,o},f.fromExtendedKey=function(e,t){var r=new f(t=t||l),i=o.decode(e),s=i.readUInt32BE(0);n(s===t.private||s===t.public,"Version mismatch: does not match private or public"),r.depth=i.readUInt8(4),r.parentFingerprint=i.readUInt32BE(5),r.index=i.readUInt32BE(9),r.chainCode=i.slice(13,45);var a=i.slice(45);return 0===a.readUInt8(0)?(n(s===t.private,"Version mismatch: version does not match private"),r.privateKey=a.slice(1)):(n(s===t.public,"Version mismatch: version does not match public"),r.publicKey=a),r},f.fromJSON=function(e){return f.fromExtendedKey(e.xpriv)},f.HARDENED_OFFSET=u,t.exports=f}}},{package:"hdkey",file:"/home/circleci/project/node_modules/eth-trezor-keyring/node_modules/hdkey/lib/hdkey.js"}],[6036,{"./constants":6026,"./env/node":6032,"./types":6047,"@babel/runtime/helpers/defineProperty":189,"@babel/runtime/helpers/interopRequireDefault":195},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault");r.__esModule=!0;var i={};r.default=void 0;var s=n(e("@babel/runtime/helpers/defineProperty")),o=e("./constants");Object.keys(o).forEach((function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(i,e)||e in r&&r[e]===o[e]||(r[e]=o[e]))}));var a=e("./env/node"),c=e("./types");function u(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?u(Object(r),!0).forEach((function(t){(0,s.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):u(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}Object.keys(c).forEach((function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(i,e)||e in r&&r[e]===c[e]||(r[e]=c[e]))}));var f={manifest:a.manifest,init:a.init,getSettings:a.getSettings,on:function(e,t){a.eventEmitter.on(e,t)},off:function(e,t){a.eventEmitter.removeListener(e,t)},removeAllListeners:function(){a.eventEmitter.removeAllListeners()},uiResponse:a.uiResponse,blockchainGetAccountBalanceHistory:function(e){return(0,a.call)(l({method:"blockchainGetAccountBalanceHistory"},e))},blockchainGetCurrentFiatRates:function(e){return(0,a.call)(l({method:"blockchainGetCurrentFiatRates"},e))},blockchainGetFiatRatesForTimestamps:function(e){return(0,a.call)(l({method:"blockchainGetFiatRatesForTimestamps"},e))},blockchainDisconnect:function(e){return(0,a.call)(l({method:"blockchainDisconnect"},e))},blockchainEstimateFee:function(e){return(0,a.call)(l({method:"blockchainEstimateFee"},e))},blockchainGetTransactions:function(e){return(0,a.call)(l({method:"blockchainGetTransactions"},e))},blockchainSetCustomBackend:function(e){return(0,a.call)(l({method:"blockchainSetCustomBackend"},e))},blockchainSubscribe:function(e){return(0,a.call)(l({method:"blockchainSubscribe"},e))},blockchainSubscribeFiatRates:function(e){return(0,a.call)(l({method:"blockchainSubscribeFiatRates"},e))},blockchainUnsubscribe:function(e){return(0,a.call)(l({method:"blockchainUnsubscribe"},e))},blockchainUnsubscribeFiatRates:function(e){return(0,a.call)(l({method:"blockchainUnsubscribeFiatRates"},e))},customMessage:function(e){return(0,a.customMessage)(e)},requestLogin:function(e){return(0,a.requestLogin)(e)},cardanoGetAddress:function(e){var t=a.eventEmitter.listenerCount(o.UI.ADDRESS_VALIDATION)>0;return(0,a.call)(l(l({method:"cardanoGetAddress"},e),{},{useEventListener:t}))},cardanoGetNativeScriptHash:function(e){return(0,a.call)(l({method:"cardanoGetNativeScriptHash"},e))},cardanoGetPublicKey:function(e){return(0,a.call)(l({method:"cardanoGetPublicKey"},e))},cardanoSignTransaction:function(e){return(0,a.call)(l({method:"cardanoSignTransaction"},e))},cipherKeyValue:function(e){return(0,a.call)(l({method:"cipherKeyValue"},e))},composeTransaction:function(e){return(0,a.call)(l({method:"composeTransaction"},e))},ethereumGetAddress:function(e){var t=a.eventEmitter.listenerCount(o.UI.ADDRESS_VALIDATION)>0;return(0,a.call)(l(l({method:"ethereumGetAddress"},e),{},{useEventListener:t}))},ethereumGetPublicKey:function(e){return(0,a.call)(l({method:"ethereumGetPublicKey"},e))},ethereumSignMessage:function(e){return(0,a.call)(l({method:"ethereumSignMessage"},e))},ethereumSignTransaction:function(e){return(0,a.call)(l({method:"ethereumSignTransaction"},e))},ethereumSignTypedData:function(e){return(0,a.call)(l({method:"ethereumSignTypedData"},e))},ethereumVerifyMessage:function(e){return(0,a.call)(l({method:"ethereumVerifyMessage"},e))},getAccountInfo:function(e){return(0,a.call)(l({method:"getAccountInfo"},e))},getAddress:function(e){var t=a.eventEmitter.listenerCount(o.UI.ADDRESS_VALIDATION)>0;return(0,a.call)(l(l({method:"getAddress"},e),{},{useEventListener:t}))},getDeviceState:function(e){return(0,a.call)(l({method:"getDeviceState"},e))},getFeatures:function(e){return(0,a.call)(l({method:"getFeatures"},e))},getPublicKey:function(e){return(0,a.call)(l({method:"getPublicKey"},e))},liskGetAddress:function(){return(0,a.call)({method:"liskDeprecated"})},liskGetPublicKey:function(){return(0,a.call)({method:"liskDeprecated"})},liskSignMessage:function(){return(0,a.call)({method:"liskDeprecated"})},liskSignTransaction:function(){return(0,a.call)({method:"liskDeprecated"})},liskVerifyMessage:function(){return(0,a.call)({method:"liskDeprecated"})},nemGetAddress:function(e){var t=a.eventEmitter.listenerCount(o.UI.ADDRESS_VALIDATION)>0;return(0,a.call)(l(l({method:"nemGetAddress"},e),{},{useEventListener:t}))},nemSignTransaction:function(e){return(0,a.call)(l({method:"nemSignTransaction"},e))},pushTransaction:function(e){return(0,a.call)(l({method:"pushTransaction"},e))},rippleGetAddress:function(e){var t=a.eventEmitter.listenerCount(o.UI.ADDRESS_VALIDATION)>0;return(0,a.call)(l(l({method:"rippleGetAddress"},e),{},{useEventListener:t}))},rippleSignTransaction:function(e){return(0,a.call)(l({method:"rippleSignTransaction"},e))},signMessage:function(e){return(0,a.call)(l({method:"signMessage"},e))},signTransaction:function(e){return(0,a.call)(l({method:"signTransaction"},e))},stellarGetAddress:function(e){var t=a.eventEmitter.listenerCount(o.UI.ADDRESS_VALIDATION)>0;return(0,a.call)(l(l({method:"stellarGetAddress"},e),{},{useEventListener:t}))},stellarSignTransaction:function(e){return(0,a.call)(l({method:"stellarSignTransaction"},e))},tezosGetAddress:function(e){var t=a.eventEmitter.listenerCount(o.UI.ADDRESS_VALIDATION)>0;return(0,a.call)(l(l({method:"tezosGetAddress"},e),{},{useEventListener:t}))},tezosGetPublicKey:function(e){return(0,a.call)(l({method:"tezosGetPublicKey"},e))},tezosSignTransaction:function(e){return(0,a.call)(l({method:"tezosSignTransaction"},e))},eosGetPublicKey:function(e){return(0,a.call)(l({method:"eosGetPublicKey"},e))},eosSignTransaction:function(e){return(0,a.call)(l({method:"eosSignTransaction"},e))},binanceGetAddress:function(e){var t=a.eventEmitter.listenerCount(o.UI.ADDRESS_VALIDATION)>0;return(0,a.call)(l(l({method:"binanceGetAddress"},e),{},{useEventListener:t}))},binanceGetPublicKey:function(e){return(0,a.call)(l({method:"binanceGetPublicKey"},e))},binanceSignTransaction:function(e){return(0,a.call)(l({method:"binanceSignTransaction"},e))},verifyMessage:function(e){return(0,a.call)(l({method:"verifyMessage"},e))},resetDevice:function(e){return(0,a.call)(l({method:"resetDevice"},e))},wipeDevice:function(e){return(0,a.call)(l({method:"wipeDevice"},e))},applyFlags:function(e){return(0,a.call)(l({method:"applyFlags"},e))},applySettings:function(e){return(0,a.call)(l({method:"applySettings"},e))},backupDevice:function(e){return(0,a.call)(l({method:"backupDevice"},e))},changePin:function(e){return(0,a.call)(l({method:"changePin"},e))},firmwareUpdate:function(e){return(0,a.call)(l({method:"firmwareUpdate"},e))},recoveryDevice:function(e){return(0,a.call)(l({method:"recoveryDevice"},e))},getCoinInfo:function(e){return(0,a.call)(l({method:"getCoinInfo"},e))},rebootToBootloader:function(e){return(0,a.call)(l({method:"rebootToBootloader"},e))},dispose:a.dispose,cancel:a.cancel,renderWebUSBButton:a.renderWebUSBButton,disableWebUSB:a.disableWebUSB};r.default=f}}},{package:"trezor-connect",file:"/home/circleci/project/node_modules/trezor-connect/lib/index.js"}],[6039,{"@babel/runtime/helpers/defineProperty":189,"@babel/runtime/helpers/interopRequireDefault":195,"@metamask/eth-sig-util":1111},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault")(e("@babel/runtime/helpers/defineProperty"));function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}var s=e("@metamask/eth-sig-util");function o(e){switch(Object.prototype.toString.call(e)){case"[object Object]":var t=Object.keys(e).map((function(t){return[t,o(e[t])]}));return Object.fromEntries(t);case"[object Array]":return e.map((function(e){return o(e)}));case"[object BigInt]":return e.toString();default:return e}}t.exports=function(e,t){if(!t)throw new Error("Trezor: Only version 4 of typed data signing is supported");var r=s.SignTypedDataVersion.V4,a=s.TypedDataUtils.sanitizeData(e),c=a.types,u=a.primaryType,l=a.domain,f=a.message;return function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){(0,n.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({domain_separator_hash:s.TypedDataUtils.hashStruct("EIP712Domain",o(l),c,r).toString("hex"),message_hash:s.TypedDataUtils.hashStruct(u,o(f),c,r).toString("hex")},e)}}}},{package:"trezor-connect",file:"/home/circleci/project/node_modules/trezor-connect/lib/plugins/ethereum/typedData.js"}],[1317,{"./constants":1318,"./types":1320,"./utils":1321,"@metamask/controllers":1358,"bignumber.js":1375,ethers:2621,"lodash/cloneDeep":5226,"lodash/mapValues":5251},function(){with(this)return function(){"use strict";return function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.CANCELLABLE_INTERVAL=r.DEFAULT_INTERVAL=void 0;const i=e("@metamask/controllers"),s=e("bignumber.js"),o=e("ethers"),a=n(e("lodash/mapValues")),c=n(e("lodash/cloneDeep")),u=e("./types"),l=e("./utils"),f=e("./constants"),{safelyExecute:d}=i.util;r.DEFAULT_INTERVAL=1e4,r.CANCELLABLE_INTERVAL=6e4;class h extends i.BaseController{constructor({onNetworkStateChange:e,getNonceLock:t,getNetwork:n,provider:i,confirmExternalTransaction:s,trackMetaMetricsEvent:a},c,u){super(c,u),this.defaultConfig={interval:r.DEFAULT_INTERVAL,chainId:f.CHAIN_IDS.ETHEREUM,clientId:"default",supportedChainIds:[f.CHAIN_IDS.ETHEREUM,f.CHAIN_IDS.RINKEBY]},this.defaultState={smartTransactionsState:{smartTransactions:{},userOptIn:undefined,fees:undefined,liveness:!0,estimatedGas:{txData:undefined,approvalTxData:undefined}}},this.getNonceLock=t,this.getNetwork=n,this.ethersProvider=new o.ethers.providers.Web3Provider(i),this.confirmExternalTransaction=s,this.trackMetaMetricsEvent=a,this.initialize(),this.initializeSmartTransactionsForChainId(),e((({provider:e})=>{const{chainId:t}=e;this.configure({chainId:t}),this.initializeSmartTransactionsForChainId(),this.checkPoll(this.state),this.ethersProvider=new o.ethers.providers.Web3Provider(i)})),this.subscribe((e=>this.checkPoll(e)))}async fetch(e,t){const{clientId:r}=this.config,n=Object.assign(Object.assign({},t),{headers:Object.assign({"Content-Type":"application/json"},r&&{"X-Client-Id":r})});return l.handleFetch(e,n)}checkPoll(e){const{smartTransactions:t}=e.smartTransactionsState,r=t[this.config.chainId],n=null==r?void 0:r.filter(l.isSmartTransactionPending);!this.timeoutHandle&&(null==n?void 0:n.length)>0?this.poll():this.timeoutHandle&&0===(null==n?void 0:n.length)&&this.stop()}initializeSmartTransactionsForChainId(){var e;if(this.config.supportedChainIds.includes(this.config.chainId)){const{smartTransactionsState:t}=this.state;this.update({smartTransactionsState:Object.assign(Object.assign({},t),{smartTransactions:Object.assign(Object.assign({},t.smartTransactions),{[this.config.chainId]:null!==(e=t.smartTransactions[this.config.chainId])&&void 0!==e?e:[]})})})}}async poll(e){const{chainId:t,supportedChainIds:r}=this.config;e&&this.configure({interval:e},!1,!1),this.timeoutHandle&&clearInterval(this.timeoutHandle),r.includes(t)&&(await d((()=>this.updateSmartTransactions())),this.timeoutHandle=setInterval((()=>{d((()=>this.updateSmartTransactions()))}),this.config.interval))}async stop(){this.timeoutHandle&&clearInterval(this.timeoutHandle),this.timeoutHandle=undefined}setOptInState(e){this.update({smartTransactionsState:Object.assign(Object.assign({},this.state.smartTransactionsState),{userOptIn:e})})}trackStxStatusChange(e,t){var r,n;if(!t)return;let i=c.default(e);if(i=Object.assign(Object.assign({},c.default(t)),i),!i.swapMetaData||i.status===t.status&&t.swapMetaData)return;const s={stx_status:i.status,token_from_address:null===(r=i.txParams)||void 0===r?void 0:r.from,token_from_symbol:i.sourceTokenSymbol,token_to_address:null===(n=i.txParams)||void 0===n?void 0:n.to,token_to_symbol:i.destinationTokenSymbol,processing_time:l.getStxProcessingTime(i.time),stx_enabled:!0,stx_user_opt_in:!0};this.trackMetaMetricsEvent({event:"STX Status Updated",category:"swaps",sensitiveProperties:s})}isNewSmartTransaction(e){const{chainId:t}=this.config,{smartTransactionsState:r}=this.state,{smartTransactions:n}=r,i=n[t],s=null==i?void 0:i.findIndex((t=>t.uuid===e));return-1===s||s===undefined}updateSmartTransaction(e){const{chainId:t}=this.config,{smartTransactionsState:r}=this.state,{smartTransactions:n}=r,i=n[t],s=null==i?void 0:i.findIndex((t=>t.uuid===e.uuid)),o=this.isNewSmartTransaction(e.uuid);if(this.trackStxStatusChange(e,o?undefined:i[s]),o){const n=i.findIndex((t=>{var r,n,i;return(null===(r=t.txParams)||void 0===r?void 0:r.nonce)===(null===(n=e.txParams)||void 0===n?void 0:n.nonce)&&(null===(i=t.status)||void 0===i?void 0:i.startsWith("cancelled"))})),s=[c.default(e)],o=Object.assign(Object.assign({},e),{history:s}),a=n>-1?i.slice(0,n).concat(i.slice(n+1)).concat(o):i.concat(o);this.update({smartTransactionsState:Object.assign(Object.assign({},r),{smartTransactions:Object.assign(Object.assign({},r.smartTransactions),{[t]:a})})})}else{if((e.status===u.SmartTransactionStatuses.SUCCESS||e.status===u.SmartTransactionStatuses.REVERTED)&&!e.confirmed){const t=i[s],r=Object.assign(Object.assign({},t),e);this.confirmSmartTransaction(r)}this.update({smartTransactionsState:Object.assign(Object.assign({},r),{smartTransactions:Object.assign(Object.assign({},r.smartTransactions),{[t]:r.smartTransactions[t].map(((t,r)=>r===s?Object.assign(Object.assign({},t),e):t))})})})}}async updateSmartTransactions(){const{smartTransactions:e}=this.state.smartTransactionsState,{chainId:t}=this.config,r=(null==e?void 0:e[t]).filter(l.isSmartTransactionPending).map((e=>e.uuid));r.length>0&&this.fetchSmartTransactionsStatus(r)}async confirmSmartTransaction(e){var t,r,n;const i=null===(t=e.statusMetadata)||void 0===t?void 0:t.minedHash;try{const t=await this.ethersProvider.getTransactionReceipt(i),s=await this.ethersProvider.getTransaction(i),c=null===(r=s.maxFeePerGas)||void 0===r?void 0:r.toHexString(),u=null===(n=s.maxPriorityFeePerGas)||void 0===n?void 0:n.toHexString();if(null==t?void 0:t.blockNumber){const r=await this.ethersProvider.getBlock(null==t?void 0:t.blockNumber,!1),n=null==r?void 0:r.baseFeePerGas.toHexString(),s=a.default(t,(e=>e instanceof o.ethers.BigNumber?e.toHexString():e)),f=Object.assign(Object.assign({},e.txParams),{maxFeePerGas:c,maxPriorityFeePerGas:u}),d=Object.assign(Object.assign({},e),{id:e.uuid,status:"confirmed",hash:i,txParams:f}),h=l.snapshotFromTxMeta(d),p=l.replayHistory(d.history),m=l.generateHistoryEntry(p,h,"txStateManager: setting status to confirmed"),g=m.length>0?Object.assign(Object.assign({},d),{history:d.history.concat(m)}):d;this.confirmExternalTransaction(g,s,n),this.trackMetaMetricsEvent({event:"STX Confirmed",category:"swaps"}),this.updateSmartTransaction(Object.assign(Object.assign({},e),{confirmed:!0}))}}catch(e){this.trackMetaMetricsEvent({event:"STX Confirmation Failed",category:"swaps"}),console.error("confirm error",e)}}async fetchSmartTransactionsStatus(e){const{chainId:t}=this.config,r=new URLSearchParams({uuids:e.join(",")}),n=`${l.getAPIRequestURL(u.APIType.BATCH_STATUS,t)}?${r.toString()}`,i=await this.fetch(n);return Object.entries(i).forEach((([e,t])=>{this.updateSmartTransaction({statusMetadata:t,status:l.calculateStatus(t),uuid:e})})),i}async addNonceToTransaction(e){const t=await this.getNonceLock(e.from),r=t.nextNonce;return t.releaseLock(),Object.assign(Object.assign({},e),{nonce:`0x${r.toString(16)}`})}async getFees(e){const{chainId:t}=this.config,r=await this.addNonceToTransaction(e),n=await this.fetch(l.getAPIRequestURL(u.APIType.GET_FEES,t),{method:"POST",body:JSON.stringify({tx:r})});return this.update({smartTransactionsState:Object.assign(Object.assign({},this.state.smartTransactionsState),{fees:n})}),n}async estimateGas(e,t){const{chainId:r}=this.config;let n;if(t){const e=await this.addNonceToTransaction(t);n=await this.fetch(l.getAPIRequestURL(u.APIType.ESTIMATE_GAS,r),{method:"POST",body:JSON.stringify({tx:e})})}const i=await this.addNonceToTransaction(e),s=await this.fetch(l.getAPIRequestURL(u.APIType.ESTIMATE_GAS,r),{method:"POST",body:JSON.stringify(Object.assign({tx:i},t&&{pending_txs:[t]}))});return this.update({smartTransactionsState:Object.assign(Object.assign({},this.state.smartTransactionsState),{estimatedGas:{txData:s,approvalTxData:n}})}),s}async submitSignedTransactions({txParams:e,signedTransactions:t,signedCanceledTransactions:n}){const{chainId:i}=this.config,a=await this.fetch(l.getAPIRequestURL(u.APIType.SUBMIT_TRANSACTIONS,i),{method:"POST",body:JSON.stringify({rawTxs:t,rawCancelTxs:n})}),c=Date.now(),f=this.getNetwork();let d;try{const t=await this.ethersProvider.getBalance(null==e?void 0:e.from);d=new s.BigNumber(t.toHexString()).toString(16)}catch(e){console.error("ethers error",e)}const h=await this.getNonceLock(null==e?void 0:e.from),p=o.ethers.utils.hexlify(h.nextNonce);e&&!(null==e?void 0:e.nonce)&&(e.nonce=p);const{nonceDetails:m}=h;return this.updateSmartTransaction({chainId:i,nonceDetails:m,metamaskNetworkId:f,preTxBalance:d,status:u.SmartTransactionStatuses.PENDING,time:c,txParams:e,uuid:a.uuid,cancellable:!0}),setTimeout((()=>{this.isNewSmartTransaction(a.uuid)||this.updateSmartTransaction({uuid:a.uuid,cancellable:!1})}),r.CANCELLABLE_INTERVAL),h.releaseLock(),a}async cancelSmartTransaction(e){const{chainId:t}=this.config;await this.fetch(l.getAPIRequestURL(u.APIType.CANCEL,t),{method:"POST",body:JSON.stringify({uuid:e})}),this.updateSmartTransaction({uuid:e,status:u.SmartTransactionStatuses.CANCELLED_USER_CANCELLED})}async fetchLiveness(){const{chainId:e}=this.config;let t=!1;try{const r=await this.fetch(l.getAPIRequestURL(u.APIType.LIVENESS,e));t=Boolean(r.lastBlock)}catch(e){console.log('"fetchLiveness" API call failed')}return this.update({smartTransactionsState:Object.assign(Object.assign({},this.state.smartTransactionsState),{liveness:t})}),t}async setStatusRefreshInterval(e){e!==this.config.interval&&this.configure({interval:e},!1,!1)}getTransactions({addressFrom:e,status:t}){const{smartTransactions:r}=this.state.smartTransactionsState,{chainId:n}=this.config,i=null==r?void 0:r[n];return i&&0!==i.length?i.filter((r=>{var n;return r.status===t&&(null===(n=r.txParams)||void 0===n?void 0:n.from)===e})):[]}}r.default=h}}},{package:"@metamask/smart-transactions-controller",file:"/home/circleci/project/node_modules/@metamask/smart-transactions-controller/dist/SmartTransactionsController.js"}],[573,{"@ethereumjs/tx":405,"@keystonehq/base-eth-keyring":542,"@keystonehq/bc-ur-registry-eth":577,"@metamask/obs-store":582,buffer:2157,events:2158,rlp:5815,uuid:6087},function(){with(this)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0});var n,i=e("@keystonehq/base-eth-keyring"),s=e("events"),o=e("@metamask/obs-store"),a=e("@keystonehq/bc-ur-registry-eth"),c=e("uuid"),u=e("@ethereumjs/tx"),l=(n=e("rlp"))&&"object"==typeof n&&"default"in n?n.default:n;class f extends s.EventEmitter{constructor(){if(super(),this.readCryptoHDKeyOrCryptoAccount=()=>new Promise(((e,r)=>{this.memStore.updateState({sync:{reading:!0}}),this.on("keystone-sync_success-hdkey",(r=>{const n=a.CryptoHDKey.fromCBOR(t.from(r,"hex"));this.resetState(),e(n)})),this.on("keystone-sync_success-account",(r=>{const n=a.CryptoAccount.fromCBOR(t.from(r,"hex"));this.resetState(),e(n)})),this.on("keystone-sync_cancel",(()=>{this.resetState(),r(new Error("KeystoneError#sync_cancel. Sync process canceled, please retry"))}))})),this.submitCryptoHDKey=e=>{this.emit("keystone-sync_success-hdkey",e)},this.submitCryptoAccount=e=>{this.emit("keystone-sync_success-account",e)},this.cancelSync=()=>{this.emit("keystone-sync_cancel")},this.requestSignature=(e,r,n)=>new Promise(((i,s)=>{const o=e.toUR(),u=e.getRequestId(),l=c.stringify(u),f={requestId:l,payload:{type:o.type,cbor:o.cbor.toString("hex")},title:r,description:n};this.memStore.updateState({sign:{request:f}}),this.once(`${l}-signed`,(e=>{const r=a.ETHSignature.fromCBOR(t.from(e,"hex"));this.resetState(),i(r)})),this.once(`${l}-canceled`,(()=>{this.resetState(),s(new Error("KeystoneError#Tx_canceled. Signing canceled, please retry"))}))})),this.submitSignature=(e,t)=>{this.emit(`${e}-signed`,t)},this.cancelRequestSignature=()=>{const e=this.memStore.getState().sign.request;if(e){const{requestId:t}=e;this.memStore.updateState({sign:{}}),this.emit(`${t}-canceled`)}},this.resetState=()=>{this.memStore.updateState({sync:{reading:!1},sign:{}})},f.instance)return f.instance;this.memStore=new o.ObservableStore({sync:{reading:!1},sign:{},_version:1}),f.instance=this}}class d extends i.BaseKeyring{constructor(e){if(super(e),this.getInteraction=()=>new f,this.getMemStore=()=>this.getInteraction().memStore,this.removeAccount=e=>{if(!this.accounts.map((e=>e.toLowerCase())).includes(e.toLowerCase()))throw new Error(`Address ${e} not found in this keyring`);this.accounts=this.accounts.filter((t=>t.toLowerCase()!==e.toLowerCase()))},this.forgetDevice=()=>{this.page=0,this.perPage=5,this.accounts=[],this.currentAccount=0,this.name="QR Hardware",this.initialized=!1,this.xfp="",this.xpub="",this.hdPath="",this.indexes={},this.hdk=undefined,this.paths={}},this.submitCryptoHDKey=this.getInteraction().submitCryptoHDKey,this.submitCryptoAccount=this.getInteraction().submitCryptoAccount,this.submitSignature=this.getInteraction().submitSignature,this.cancelSync=this.getInteraction().cancelSync,this.cancelSignRequest=this.getInteraction().cancelRequestSignature,d.instance)return d.instance.deserialize(e),d.instance;d.instance=this}async signTransaction(e,t){const r=0===t.type?a.DataType.transaction:a.DataType.typedTransaction;let n;n=0===t.type?l.encode(t.getMessageToSign(!1)):t.getMessageToSign(!1);const i=await this._pathFromAddress(e),s=t.common.chainId(),o=c.v4(),f=a.EthSignRequest.constructETHRequest(n,r,i,this.xfp,o,s),{r:d,s:h,v:p}=await this.requestSignature(o,f,"Scan with your Keystone",'After your Keystone has signed the transaction, click on "Scan Keystone" to receive the signature'),m=t.toJSON();m.v=p,m.s=h,m.r=d,m.type=t.type;return u.TransactionFactory.fromTxData(m,{common:t.common})}}d.type=i.BaseKeyring.type,r.MetaMaskKeyring=d}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@keystonehq/metamask-airgapped-keyring",file:"/home/circleci/project/node_modules/@keystonehq/metamask-airgapped-keyring/dist/metamask-airgapped-keyring.cjs.development.js"}],[574,{"@ethereumjs/tx":405,"@keystonehq/base-eth-keyring":542,"@keystonehq/bc-ur-registry-eth":577,"@metamask/obs-store":582,buffer:2157,events:2158,rlp:5815,uuid:6087},function(){with(this)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0});var n,i=e("@keystonehq/base-eth-keyring"),s=e("events"),o=e("@metamask/obs-store"),a=e("@keystonehq/bc-ur-registry-eth"),c=e("uuid"),u=e("@ethereumjs/tx"),l=(n=e("rlp"))&&"object"==typeof n&&"default"in n?n.default:n;class f extends s.EventEmitter{constructor(){if(super(),this.readCryptoHDKeyOrCryptoAccount=()=>new Promise(((e,r)=>{this.memStore.updateState({sync:{reading:!0}}),this.on("keystone-sync_success-hdkey",(r=>{const n=a.CryptoHDKey.fromCBOR(t.from(r,"hex"));this.resetState(),e(n)})),this.on("keystone-sync_success-account",(r=>{const n=a.CryptoAccount.fromCBOR(t.from(r,"hex"));this.resetState(),e(n)})),this.on("keystone-sync_cancel",(()=>{this.resetState(),r(new Error("KeystoneError#sync_cancel. Sync process canceled, please retry"))}))})),this.submitCryptoHDKey=e=>{this.emit("keystone-sync_success-hdkey",e)},this.submitCryptoAccount=e=>{this.emit("keystone-sync_success-account",e)},this.cancelSync=()=>{this.emit("keystone-sync_cancel")},this.requestSignature=(e,r,n)=>new Promise(((i,s)=>{const o=e.toUR(),u=e.getRequestId(),l=c.stringify(u),f={requestId:l,payload:{type:o.type,cbor:o.cbor.toString("hex")},title:r,description:n};this.memStore.updateState({sign:{request:f}}),this.once(l+"-signed",(e=>{const r=a.ETHSignature.fromCBOR(t.from(e,"hex"));this.resetState(),i(r)})),this.once(l+"-canceled",(()=>{this.resetState(),s(new Error("KeystoneError#Tx_canceled. Signing canceled, please retry"))}))})),this.submitSignature=(e,t)=>{this.emit(e+"-signed",t)},this.cancelRequestSignature=()=>{const e=this.memStore.getState().sign.request;if(e){const{requestId:t}=e;this.memStore.updateState({sign:{}}),this.emit(t+"-canceled")}},this.resetState=()=>{this.memStore.updateState({sync:{reading:!1},sign:{}})},f.instance)return f.instance;this.memStore=new o.ObservableStore({sync:{reading:!1},sign:{},_version:1}),f.instance=this}}class d extends i.BaseKeyring{constructor(e){if(super(e),this.getInteraction=()=>new f,this.getMemStore=()=>this.getInteraction().memStore,this.removeAccount=e=>{if(!this.accounts.map((e=>e.toLowerCase())).includes(e.toLowerCase()))throw new Error(`Address ${e} not found in this keyring`);this.accounts=this.accounts.filter((t=>t.toLowerCase()!==e.toLowerCase()))},this.forgetDevice=()=>{this.page=0,this.perPage=5,this.accounts=[],this.currentAccount=0,this.name="QR Hardware",this.initialized=!1,this.xfp="",this.xpub="",this.hdPath="",this.indexes={},this.hdk=void 0,this.paths={}},this.submitCryptoHDKey=this.getInteraction().submitCryptoHDKey,this.submitCryptoAccount=this.getInteraction().submitCryptoAccount,this.submitSignature=this.getInteraction().submitSignature,this.cancelSync=this.getInteraction().cancelSync,this.cancelSignRequest=this.getInteraction().cancelRequestSignature,d.instance)return d.instance.deserialize(e),d.instance;d.instance=this}async signTransaction(e,t){const r=0===t.type?a.DataType.transaction:a.DataType.typedTransaction;let n;n=0===t.type?l.encode(t.getMessageToSign(!1)):t.getMessageToSign(!1);const i=await this._pathFromAddress(e),s=t.common.chainId(),o=c.v4(),f=a.EthSignRequest.constructETHRequest(n,r,i,this.xfp,o,s),{r:d,s:h,v:p}=await this.requestSignature(o,f,"Scan with your Keystone",'After your Keystone has signed the transaction, click on "Scan Keystone" to receive the signature'),m=t.toJSON();return m.v=p,m.s=h,m.r=d,m.type=t.type,u.TransactionFactory.fromTxData(m,{common:t.common})}}d.type=i.BaseKeyring.type,r.MetaMaskKeyring=d}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@keystonehq/metamask-airgapped-keyring",file:"/home/circleci/project/node_modules/@keystonehq/metamask-airgapped-keyring/dist/metamask-airgapped-keyring.cjs.production.min.js"}],[156,{},function(){with(this)return function(){"use strict";return function(e,t,r){function n(e){return new Promise((t=>setTimeout(t,e)))}async function i(e){const t=await window.fetch(`http://localhost:8889?key=${e}`),r=await t.text();return r.length?JSON.parse(r):null}t.exports=class{static openBox(e){return this.address=e,Promise.resolve({onSyncDone:e=>{setTimeout(e,200)},openSpace:async(e,t)=>{const{onSyncDone:r}=t;return this.spaceName=e,setTimeout(r,150),await n(50),{private:{get:async e=>{await n(50);return await i(`${this.address}-${this.spaceName}-${e}`)},set:async(e,t)=>(await async function(e,t){return(await window.fetch("http://localhost:8889",{method:"POST",body:JSON.stringify({key:e,data:t})})).text()}(`${this.address}-${this.spaceName}-${e}`,t),await n(50),null)}}},logout:()=>undefined})}static async getConfig(e){return await i(`${e}-metamask-metamaskBackup`)?{spaces:{metamask:{}}}:{}}}}}},{package:"<root>",file:"/home/circleci/project/development/mock-3box.js"}],[16,{"./middleware/pending":18,"eth-json-rpc-middleware":2482,"json-rpc-engine":4805},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=function({version:e,getAccounts:t,processTransaction:r,processEthSignMessage:o,processTypedMessage:a,processTypedMessageV3:c,processTypedMessageV4:u,processPersonalMessage:l,processDecryptMessage:f,processEncryptionPublicKey:d,getPendingNonce:h,getPendingTransactionByHash:p}){return(0,n.mergeMiddleware)([(0,n.createScaffoldMiddleware)({eth_syncing:!1,web3_clientVersion:`MetaMask/v${e}`}),(0,i.createWalletMiddleware)({getAccounts:t,processTransaction:r,processEthSignMessage:o,processTypedMessage:a,processTypedMessageV3:c,processTypedMessageV4:u,processPersonalMessage:l,processDecryptMessage:f,processEncryptionPublicKey:d}),(0,s.createPendingNonceMiddleware)({getPendingNonce:h}),(0,s.createPendingTxMiddleware)({getPendingTransactionByHash:p})])};var n=e("json-rpc-engine"),i=e("eth-json-rpc-middleware"),s=e("./middleware/pending")}}},{package:"<root>",file:"/home/circleci/project/app/scripts/controllers/network/createMetamaskMiddleware.js"}],[162,{"./3id":163,"./api":165,"./config.js":166,"./privateStore":168,"./publicStore":169,"./space":170,"./utils/id":172,"./utils/index":173,"./verified":175,"3box-orbitdb-plugins":157,"@babel/runtime/helpers/asyncToGenerator":185,"@babel/runtime/helpers/classCallCheck":186,"@babel/runtime/helpers/createClass":188,"@babel/runtime/helpers/defineProperty":189,"@babel/runtime/helpers/interopRequireDefault":195,"@babel/runtime/helpers/slicedToArray":208,"@babel/runtime/regenerator":215,ipfs:4716,"orbit-db":5435,"orbit-db-access-controllers":5386,"orbit-db-pubsub":5428,store:5942},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault"),i=n(e("@babel/runtime/helpers/slicedToArray")),s=n(e("@babel/runtime/regenerator")),o=n(e("@babel/runtime/helpers/defineProperty")),a=n(e("@babel/runtime/helpers/asyncToGenerator")),c=n(e("@babel/runtime/helpers/classCallCheck")),u=n(e("@babel/runtime/helpers/createClass"));function l(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function f(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?l(r,!0).forEach((function(t){(0,o.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(r).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var d=e("store"),h=e("ipfs"),p=e("orbit-db"),m=e("orbit-db-pubsub"),g=e("orbit-db-access-controllers"),y=e("3box-orbitdb-plugins"),b=y.LegacyIPFS3BoxAccessController,v=y.ThreadAccessController,w=y.ModeratorAccessController;g.addAccessController({AccessController:b}),g.addAccessController({AccessController:v}),g.addAccessController({AccessController:w});var _,E,k=e("./3id"),S=e("./publicStore"),A=e("./privateStore"),T=e("./verified"),I=e("./space"),C=e("./utils/index"),x=e("./utils/id"),P=e("./config.js"),O=e("./api"),R="ethereum-eoa",N=P.address_server_url,M=P.pinning_node,j=P.pinning_room,L=P.ipfs_options,D=P.orbitdb_options,B=function(){function e(t,r,n){var i=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{};(0,c.default)(this,e),this._3id=t,this._web3provider=r,this._ipfs=n,this._serverUrl=i.addressServer||N,this._onSyncDoneCB=function(){},this._boxSynced=!1,this.public=null,this.private=null,this.verified=new T(this),this.spaces={},this.spacesPubSubMessages={}}var t,r,n,o,l,h,g,y,b,v,w,P,L,B,K,V,H,F,G,q,z,Y,W,$,J,Z,X,Q,ee,te;return(0,u.default)(e,[{key:"_load",value:(te=(0,a.default)(s.default.mark((function e(){var t,r,n,o,c,u,l,d,h,g,y,b,v,w,_=this,k=arguments;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=k.length>0&&k[0]!==undefined?k[0]:{},r=this._3id.muportFingerprint+".root",this.pinningNode=t.pinningNode||M,this._ipfs.swarm.connect(this.pinningNode,(function(){})),e.t0=p,e.t1=this._ipfs,e.t2=t.orbitPath,e.next=9,this._3id.getOdbId();case 9:return e.t3=e.sent,e.t4={directory:e.t2,identity:e.t3},e.next=13,e.t0.createInstance.call(e.t0,e.t1,e.t4);case 13:return this._orbitdb=e.sent,E=this._orbitdb,n=this._3id.getKeyringBySpaceName(r).getPublicKeys(!0).signingKey,e.next=18,this._orbitdb.feed(r,f({},D,{format:"dag-pb",accessController:{write:[n],type:"legacy-ipfs-3box",skipManifest:!0}}));case 18:return this._rootStore=e.sent,o=this._rootStore.address.toString(),e.t5=m,e.t6=this._ipfs,e.next=24,this._ipfs.id();case 24:return e.t7=e.sent.id,this._pubsub=new e.t5(e.t6,e.t7),c=function(){var e=(0,a.default)(s.default.mark((function e(t,r){return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r===_.pinningNode.split("/").pop()&&_._pubsub.publish(j,{type:"PIN_DB",odbAddress:o,did:_.DID});case 1:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),this.public=new S(this._orbitdb,this._3id.muportFingerprint+".public",this._linkProfile.bind(this),this._ensurePinningNodeConnected.bind(this),this._3id),this.private=new A(this._orbitdb,this._3id.muportFingerprint+".private",this._ensurePinningNodeConnected.bind(this),this._3id),e.next=31,Promise.all([this.public._load(),this.private._load()]);case 31:return u=e.sent,l=(0,i.default)(u,2),d=l[0],h=l[1],g=[],y={},b=!0,v=!1,w=function(){var e=(0,a.default)(s.default.mark((function e(t,r){var n;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(v||(v=!0,setTimeout((function(){b=!1}),3e3)),"HAS_ENTRIES"!==r.type){e.next=12;break}if(r.odbAddress!==h||y[h]||(g.push(_.private._sync(r.numEntries)),y[h]=!0),r.odbAddress!==d||y[d]||(g.push(_.public._sync(r.numEntries)),y[d]=!0),b&&!0===r.odbAddress.includes("space")&&(_.spacesPubSubMessages[r.odbAddress]=r),2!==g.length){e.next=12;break}return n=g,g=[],e.next=10,Promise.all(n);case 10:_._boxSynced=!0,_._onSyncDoneCB();case 12:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),this._pubsub.subscribe(j,w,c),e.next=43,this._createRootStore(o,h,d,this.pinningNode);case 43:case"end":return e.stop()}}),e,this)}))),function(){return te.apply(this,arguments)})},{key:"_createRootStore",value:(ee=(0,a.default)(s.default.mark((function e(t,r,n){var i,o,c=this;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._rootStore.load();case 2:return e.next=4,this._rootStore.iterator({limit:-1}).collect();case 4:if((i=e.sent).find((function(e){return e.payload.value.odbAddress===n}))){e.next=8;break}return e.next=8,this._rootStore.add({odbAddress:n});case 8:if(i.find((function(e){return e.payload.value.odbAddress===r}))){e.next=11;break}return e.next=11,this._rootStore.add({odbAddress:r});case 11:this._publishRootStore(t),o=function(){var e=(0,a.default)(s.default.mark((function e(){return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i.filter((function(e){return"address-link"===e.payload.value.type})).map((function(e){c._ipfs.dag.get(e.payload.value.data)}));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),o();case 14:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return ee.apply(this,arguments)})},{key:"openSpace",value:(Q=(0,a.default)(s.default.mark((function e(t){var r,n=arguments;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.length>1&&n[1]!==undefined?n[1]:{},this.spaces[t]){e.next=23;break}return this.spaces[t]=new I(t,this._3id,this._orbitdb,this._rootStore,this._ensurePinningNodeConnected.bind(this)),e.prev=3,r=Object.assign({numEntriesMessages:this.spacesPubSubMessages},r),e.next=7,this.spaces[t].open(r);case 7:return e.next=9,this.isAddressLinked();case 9:if(e.sent){e.next=11;break}this.linkAddress();case 11:e.next=21;break;case 13:if(e.prev=13,e.t0=e.catch(3),delete this.spaces[t],!e.t0.message.includes("User denied message signature.")){e.next=20;break}throw new Error("User denied space consent.");case 20:throw new Error("An error occured while opening space: ",e.t0.message);case 21:e.next=24;break;case 23:r.onSyncDone&&r.onSyncDone();case 24:return e.abrupt("return",this.spaces[t]);case 25:case"end":return e.stop()}}),e,this,[[3,13]])}))),function(e){return Q.apply(this,arguments)})},{key:"onSyncDone",value:function(e){this._onSyncDoneCB=e,this._boxSynced&&this._onSyncDoneCB()}},{key:"_publishRootStore",value:(X=(0,a.default)(s.default.mark((function e(t){var r;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._3id.signJWT({rootStoreAddress:t});case 2:return r=e.sent,e.prev=3,e.next=6,C.fetchJson(this._serverUrl+"/odbAddress",{address_token:r});case 6:e.next=12;break;case 8:if(e.prev=8,e.t0=e.catch(3),e.t0.statusCode){e.next=12;break}throw new Error(e.t0);case 12:return e.abrupt("return",!0);case 13:case"end":return e.stop()}}),e,this,[[3,8]])}))),function(e){return X.apply(this,arguments)})},{key:"linkAddress",value:(Z=(0,a.default)(s.default.mark((function e(){var t,r=arguments;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=r.length>0&&r[0]!==undefined?r[0]:{}).proof){e.next=5;break}return e.next=4,this._writeAddressLink(t.proof);case 4:return e.abrupt("return");case 5:if(t.type&&t.type!==R){e.next=8;break}return e.next=8,this._linkProfile();case 8:case"end":return e.stop()}}),e,this)}))),function(){return Z.apply(this,arguments)})},{key:"linkAccount",value:(J=(0,a.default)(s.default.mark((function e(){var t,r=arguments;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.length>0&&r[0]!==undefined?r[0]:R,console.warn("linkAccount: deprecated, please use linkAddress going forward"),e.next=4,this.linkAddress(t);case 4:case"end":return e.stop()}}),e,this)}))),function(){return J.apply(this,arguments)})},{key:"removeAddressLink",value:($=(0,a.default)(s.default.mark((function e(t){var r,n;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=t.toLowerCase(),e.next=3,this.isAddressLinked({address:t});case 3:if(e.sent){e.next=6;break}throw new Error("removeAddressLink: link for given address does not exist");case 6:return r={address:t,type:"delete-address-link"},e.next=10,this._3id.signJWT(r,{expiresIn:3600});case 10:return n=e.sent,e.prev=11,e.next=14,C.fetchJson(this._serverUrl+"/linkdelete",{delete_token:n});case 14:e.next=20;break;case 16:if(e.prev=16,e.t0=e.catch(11),e.t0.statusCode){e.next=20;break}throw new Error(e.t0);case 20:return e.next=22,this._deleteAddressLink(t);case 22:return e.abrupt("return",!0);case 23:case"end":return e.stop()}}),e,this,[[11,16]])}))),function(e){return $.apply(this,arguments)})},{key:"isAddressLinked",value:(W=(0,a.default)(s.default.mark((function e(){var t,r,n,i=arguments;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=i.length>0&&i[0]!==undefined?i[0]:{}).address&&(t.address=t.address.toLowerCase()),e.next=4,this._readAddressLinks();case 4:return r=e.sent,n=r.find((function(e){var r=!t.address||e.address===t.address;return t.type?r&&e.type===t.type:r})),e.abrupt("return",Boolean(n));case 7:case"end":return e.stop()}}),e,this)}))),function(){return W.apply(this,arguments)})},{key:"isAccountLinked",value:(Y=(0,a.default)(s.default.mark((function e(){var t,r=arguments;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.length>0&&r[0]!==undefined?r[0]:R,console.warn("isAccountLinked: deprecated, please use isAddressLinked going forward"),e.abrupt("return",this.isAddressLinked(t));case 3:case"end":return e.stop()}}),e,this)}))),function(){return Y.apply(this,arguments)})},{key:"listAddressLinks",value:(z=(0,a.default)(s.default.mark((function e(){var t;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._readAddressLinks();case 2:return t=e.sent,e.abrupt("return",t.reduce((function(e,t){var r=Object.assign({},t);return r.linkId=r.entry.hash,delete r.entry,r}),[]));case 4:case"end":return e.stop()}}),e,this)}))),function(){return z.apply(this,arguments)})},{key:"_linkProfile",value:(q=(0,a.default)(s.default.mark((function e(){var t,r,n,i;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this._3id.managementAddress,e.next=3,this._readAddressLink(t);case 3:if(r=e.sent){e.next=19;break}return n=this.DID,e.prev=6,e.next=9,C.getLinkConsent(t,n,this._web3provider);case 9:i=e.sent,e.next=16;break;case 12:throw e.prev=12,e.t0=e.catch(6),console.log(e.t0),new Error("Link consent message must be signed before adding data, to link address to store");case 16:return r={version:1,type:R,message:i.msg,signature:i.sig,timestamp:i.timestamp},e.next=19,this._writeAddressLink(r);case 19:return e.next=21,this.public.get("proof_did");case 21:if(e.sent){e.next=29;break}return e.t1=this.public,e.next=25,this._3id.signJWT();case 25:return e.t2=e.sent,e.t3={noLink:!0},e.next=29,e.t1.set.call(e.t1,"proof_did",e.t2,e.t3);case 29:C.fetchJson(this._serverUrl+"/link",r).catch(console.error);case 30:case"end":return e.stop()}}),e,this,[[6,12]])}))),function(){return q.apply(this,arguments)})},{key:"_writeAddressLink",value:(G=(0,a.default)(s.default.mark((function e(t){var r,n;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._ipfs.dag.put(t);case 2:return r=e.sent.toBaseEncodedString(),e.next=5,this._linkCIDExists(r);case 5:if(!e.sent){e.next=8;break}return e.abrupt("return");case 8:return n={type:"address-link",data:r},e.next=11,this._rootStore.add(n);case 11:case"end":return e.stop()}}),e,this)}))),function(e){return G.apply(this,arguments)})},{key:"_linkCIDExists",value:(F=(0,a.default)(s.default.mark((function e(t){var r,n;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._rootStore.iterator({limit:-1}).collect();case 2:return r=e.sent,n=r.filter((function(e){return"address-link"===e.payload.value.type})),e.abrupt("return",n.find((function(e){return e.data===t})));case 5:case"end":return e.stop()}}),e,this)}))),function(e){return F.apply(this,arguments)})},{key:"_deleteAddressLink",value:(H=(0,a.default)(s.default.mark((function e(t){var r;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=t.toLowerCase(),e.next=3,this._readAddressLink(t);case 3:if(r=e.sent){e.next=6;break}throw new Error("_deleteAddressLink: link for given address does not exist");case 6:return e.abrupt("return",this._rootStore.remove(r.entry.hash));case 7:case"end":return e.stop()}}),e,this)}))),function(e){return H.apply(this,arguments)})},{key:"_readAddressLinks",value:(V=(0,a.default)(s.default.mark((function e(){var t,r,n,i=this;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._rootStore.iterator({limit:-1}).collect();case 2:return t=e.sent,r=t.filter((function(e){return"address-link"===e.payload.value.type})),n=r.map(function(){var e=(0,a.default)(s.default.mark((function e(t){var r;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i._ipfs.dag.get(t.payload.value.data);case 2:if((r=e.sent.value).address){e.next=7;break}return e.next=6,C.recoverPersonalSign(r.message,r.signature);case 6:r.address=e.sent;case 7:return r.entry=t,e.abrupt("return",r);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.abrupt("return",Promise.all(n));case 6:case"end":return e.stop()}}),e,this)}))),function(){return V.apply(this,arguments)})},{key:"_readAddressLink",value:(K=(0,a.default)(s.default.mark((function e(t){var r;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=t.toLowerCase(),e.next=3,this._readAddressLinks();case 3:return r=e.sent,e.abrupt("return",r.find((function(e){return e.address.toLowerCase()===t})));case 5:case"end":return e.stop()}}),e,this)}))),function(e){return K.apply(this,arguments)})},{key:"_ensurePinningNodeConnected",value:(B=(0,a.default)(s.default.mark((function e(t,r){var n,i=this;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._ipfs.pubsub.peers(t);case 2:e.sent.find((function(e){return e===i.pinningNode.split("/").pop()}))||(this._ipfs.swarm.connect(this.pinningNode,(function(){})),n=this._rootStore.address.toString(),r?this._pubsub.publish(j,{type:"SYNC_DB",odbAddress:t,thread:!0}):this._pubsub.publish(j,{type:"PIN_DB",odbAddress:n}));case 4:case"end":return e.stop()}}),e,this)}))),function(e,t){return B.apply(this,arguments)})},{key:"close",value:(L=(0,a.default)(s.default.mark((function e(){return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._orbitdb.stop();case 2:return e.next=4,this._pubsub.disconnect();case 4:E=null;case 5:case"end":return e.stop()}}),e,this)}))),function(){return L.apply(this,arguments)})},{key:"logout",value:(P=(0,a.default)(s.default.mark((function e(){var t;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.close();case 2:this._3id.logout(),t=this._3id.managementAddress,d.remove("linkConsent_"+t);case 5:case"end":return e.stop()}}),e,this)}))),function(){return P.apply(this,arguments)})},{key:"DID",get:function(){return this._3id.muportDID}}],[{key:"getProfile",value:(w=(0,a.default)(s.default.mark((function e(t){var r,n,i,o,a=arguments;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=a.length>1&&a[1]!==undefined?a[1]:{},n=r.metadata,!(r=Object.assign({useCacheService:!0},r)).useCacheService){e.next=9;break}return e.next=6,O.getProfile(t,r.profileServer,{metadata:n});case 6:i=e.sent,e.next=15;break;case 9:if(!n){e.next=11;break}throw new Error("getting metadata is not yet supported outside of the API");case 11:return o=t.toLowerCase(),e.next=14,this._getProfileOrbit(o,r);case 14:i=e.sent;case 15:return e.abrupt("return",i);case 16:case"end":return e.stop()}}),e,this)}))),function(e){return w.apply(this,arguments)})},{key:"getProfiles",value:(v=(0,a.default)(s.default.mark((function e(t){var r,n=arguments;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.length>1&&n[1]!==undefined?n[1]:{},e.abrupt("return",O.getProfiles(t,r));case 2:case"end":return e.stop()}}),e)}))),function(e){return v.apply(this,arguments)})},{key:"getSpace",value:(b=(0,a.default)(s.default.mark((function e(t,r){var n,i=arguments;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.length>2&&i[2]!==undefined?i[2]:{},e.abrupt("return",O.getSpace(t,r,n.profileServer,n));case 2:case"end":return e.stop()}}),e)}))),function(e,t){return b.apply(this,arguments)})},{key:"getThread",value:(y=(0,a.default)(s.default.mark((function e(t,r,n,i){var o,a=arguments;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=a.length>4&&a[4]!==undefined?a[4]:{},e.abrupt("return",O.getThread(t,r,n,i,o));case 2:case"end":return e.stop()}}),e)}))),function(e,t,r,n){return y.apply(this,arguments)})},{key:"getThreadByAddress",value:(g=(0,a.default)(s.default.mark((function e(t){var r,n=arguments;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.length>1&&n[1]!==undefined?n[1]:{},e.abrupt("return",O.getThreadByAddress(t,r));case 2:case"end":return e.stop()}}),e)}))),function(e){return g.apply(this,arguments)})},{key:"getConfig",value:(h=(0,a.default)(s.default.mark((function e(t){var r,n=arguments;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.length>1&&n[1]!==undefined?n[1]:{},e.abrupt("return",O.getConfig(t,r));case 2:case"end":return e.stop()}}),e)}))),function(e){return h.apply(this,arguments)})},{key:"listSpaces",value:(l=(0,a.default)(s.default.mark((function e(t){var r,n=arguments;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.length>1&&n[1]!==undefined?n[1]:{},e.abrupt("return",O.listSpaces(t,r.profileServer));case 2:case"end":return e.stop()}}),e)}))),function(e){return l.apply(this,arguments)})},{key:"_getProfileOrbit",value:(o=(0,a.default)(s.default.mark((function e(t){var r,n,i,o,c,u,l,f,d,h,m,g,y=arguments;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=y.length>1&&y[1]!==undefined?y[1]:{},!x.isMuportDID(t)){e.next=3;break}throw new Error("DID are supported in the cached version only");case 3:return e.next=5,O.getRootStoreAddress(t.toLowerCase(),r.addressServer);case 5:if(n=e.sent,!_){e.next=12;break}i=_,e.next=15;break;case 12:return e.next=14,U(r.ipfs,r.iframeStore,r.ipfsOptions);case 14:i=e.sent;case 15:if(E?o=E:(c=null,o=new p(i,r.orbitPath,{cache:c})),u=r.pinningNode||M,i.swarm.connect(u,(function(){})),l=new S(o),!n){e.next=41;break}return e.next=22,o.open(n);case 22:return f=e.sent,d=new Promise((function(e,t){f.events.on("ready",e)})),f.load(),e.next=27,d;case 27:if(f.iterator({limit:-1}).collect().length){e.next=30;break}return e.next=30,new Promise((function(e,t){f.events.on("replicate.progress",(function(t,r,n,i,s){i===s&&f.events.on("replicated",e)}))}));case 30:return h=f.iterator({limit:-1}).collect().find((function(e){return"public"===e.payload.value.odbAddress.split(".")[1]})),e.next=33,l._load(h.payload.value.odbAddress);case 33:return e.next=35,l._sync();case 35:return m=l.all(),g=function(){var e=(0,a.default)(s.default.mark((function e(){return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.close();case 2:return e.next=4,l.close();case 4:case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),g(),e.abrupt("return",m);case 41:return e.abrupt("return",null);case 42:case"end":return e.stop()}}),e)}))),function(e){return o.apply(this,arguments)})},{key:"profileGraphQL",value:(n=(0,a.default)(s.default.mark((function e(t){var r,n=arguments;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.length>1&&n[1]!==undefined?n[1]:{},e.abrupt("return",O.profileGraphQL(t,r.graphqlServer));case 2:case"end":return e.stop()}}),e)}))),function(e){return n.apply(this,arguments)})},{key:"getVerifiedAccounts",value:(r=(0,a.default)(s.default.mark((function e(t){return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",O.getVerifiedAccounts(t));case 1:case"end":return e.stop()}}),e)}))),function(e){return r.apply(this,arguments)})},{key:"openBox",value:(t=(0,a.default)(s.default.mark((function t(r,n){var i,o,a,c,u=arguments;return s.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=u.length>2&&u[2]!==undefined?u[2]:{},t.t0=_,t.t0){t.next=6;break}return t.next=5,U(i.ipfs,i.iframeStore,i.ipfsOptions);case 5:t.t0=t.sent;case 6:return o=t.t0,_=o,t.next=10,k.getIdFromEthAddress(r,n,o,i);case 10:return a=t.sent,c=new e(a,n,o,i),t.next=14,c._load(i);case 14:return t.abrupt("return",c);case 15:case"end":return t.stop()}}),t)}))),function(e,r){return t.apply(this,arguments)})},{key:"isLoggedIn",value:function(e){return k.isLoggedIn(e)}}]),e}();function U(e,t,r){return K.apply(this,arguments)}function K(){return(K=(0,a.default)(s.default.mark((function e(t,r,n){return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&r&&console.log("Warning: iframeStore true, orbit db cache in iframe, but the given ipfs object is being used, and may not be running in same iframe."),!t){e.next=5;break}return e.abrupt("return",t);case 5:return e.abrupt("return",new Promise((function(e,r){(t=new h(n||L)).on("error",(function(e){console.error(e),r(e)})),t.on("ready",(function(){return e(t)}))})));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}B.idUtils=x,t.exports=B}}},{package:"3box",file:"/home/circleci/project/node_modules/3box/lib/3box.js"}],[65,{"../../../../shared/constants/network":6266,"./handlers":69,"@babel/runtime/helpers/interopRequireDefault":195,"@metamask/controllers":1042,"@metamask/rpc-methods":1213,"eth-rpc-errors":2531,lodash:5250},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.createMethodMiddleware=function(e){const t=f.filter((t=>!Object.hasOwnProperty.call(e,t)));if(t.length>0)throw new Error(`Missing expected hooks:\n\n${t.join("\n")}\n`);return async function(t,r,n,i){if(c.UNSUPPORTED_RPC_METHODS.has(t.method))return i(o.ethErrors.rpc.methodNotSupported());const a=l.get(t.method);if(a){const{implementation:o,hookNames:c}=a;try{return await o(t,r,n,i,(0,s.selectHooks)(e,c))}catch(e){return console.error(e),i(e)}}return n()}};var i=e("@metamask/controllers"),s=e("@metamask/rpc-methods"),o=e("eth-rpc-errors"),a=e("lodash"),c=e("../../../../shared/constants/network");const u=[...n(e("./handlers")).default,...i.permissionRpcMethods.handlers],l=u.reduce(((e,t)=>{for(const r of t.methodNames)e.set(r,t);return e}),new Map),f=Array.from(new Set((0,a.flatten)(u.map((({hookNames:e})=>Object.keys(e))))).values())}}},{package:"<root>",file:"/home/circleci/project/app/scripts/lib/rpc-method-middleware/createMethodMiddleware.js"}],[4373,{"./core":4372,"./helpers":4374},function(){with(this)return function(){"use strict";return function(e,t,r){var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},n.apply(this,arguments)};Object.defineProperty(r,"__esModule",{value:!0});
/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017 Joachim Wester
 * MIT license
 */
var i=e("./helpers"),s=e("./core"),o=e("./core");r.applyOperation=o.applyOperation,r.applyPatch=o.applyPatch,r.applyReducer=o.applyReducer,r.getValueByPointer=o.getValueByPointer,r.validate=o.validate,r.validator=o.validator;var a=e("./helpers");r.JsonPatchError=a.PatchError,r.deepClone=a._deepClone,r.escapePathComponent=a.escapePathComponent,r.unescapePathComponent=a.unescapePathComponent;var c=new WeakMap,u=function(e){this.observers=new Map,this.obj=e},l=function(e,t){this.callback=e,this.observer=t};function f(e,t){t.unobserve()}function d(e,t){var r,n=function(e){return c.get(e)}(e);if(n){var s=function(e,t){return e.observers.get(t)}(n,t);r=s&&s.observer}else n=new u(e),c.set(e,n);if(r)return r;if(r={},n.value=i._deepClone(e),t){r.callback=t,r.next=null;var o=function(){h(r)},a=function(){clearTimeout(r.next),r.next=setTimeout(o)};"undefined"!=typeof window&&(window.addEventListener("mouseup",a),window.addEventListener("keyup",a),window.addEventListener("mousedown",a),window.addEventListener("keydown",a),window.addEventListener("change",a))}return r.patches=[],r.object=e,r.unobserve=function(){h(r),clearTimeout(r.next),function(e,t){e.observers.delete(t.callback)}(n,r),"undefined"!=typeof window&&(window.removeEventListener("mouseup",a),window.removeEventListener("keyup",a),window.removeEventListener("mousedown",a),window.removeEventListener("keydown",a),window.removeEventListener("change",a))},n.observers.set(t,new l(t,r)),r}function h(e,t){void 0===t&&(t=!1);var r=c.get(e.object);p(r.value,e.object,e.patches,"",t),e.patches.length&&s.applyPatch(r.value,e.patches);var n=e.patches;return n.length>0&&(e.patches=[],e.callback&&e.callback(n)),n}function p(e,t,r,n,s){if(t!==e){"function"==typeof t.toJSON&&(t=t.toJSON());for(var o=i._objectKeys(t),a=i._objectKeys(e),c=!1,u=a.length-1;u>=0;u--){var l=e[d=a[u]];if(!i.hasOwnProperty(t,d)||t[d]===undefined&&l!==undefined&&!1===Array.isArray(t))Array.isArray(e)===Array.isArray(t)?(s&&r.push({op:"test",path:n+"/"+i.escapePathComponent(d),value:i._deepClone(l)}),r.push({op:"remove",path:n+"/"+i.escapePathComponent(d)}),c=!0):(s&&r.push({op:"test",path:n,value:e}),r.push({op:"replace",path:n,value:t}),!0);else{var f=t[d];"object"==typeof l&&null!=l&&"object"==typeof f&&null!=f?p(l,f,r,n+"/"+i.escapePathComponent(d),s):l!==f&&(!0,s&&r.push({op:"test",path:n+"/"+i.escapePathComponent(d),value:i._deepClone(l)}),r.push({op:"replace",path:n+"/"+i.escapePathComponent(d),value:i._deepClone(f)}))}}if(c||o.length!=a.length)for(u=0;u<o.length;u++){var d=o[u];i.hasOwnProperty(e,d)||t[d]===undefined||r.push({op:"add",path:n+"/"+i.escapePathComponent(d),value:i._deepClone(t[d])})}}}function m(e,t,r){void 0===r&&(r=!1);var n=[];return p(e,t,n,"",r),n}r.unobserve=f,r.observe=d,r.generate=h,r.compare=m;var g=e("./core"),y=e("./helpers");r.default=n({},g,{unobserve:f,observe:d,generate:h,compare:m,JsonPatchError:y.PatchError,deepClone:i._deepClone,escapePathComponent:i.escapePathComponent,unescapePathComponent:y.unescapePathComponent})}}},{package:"fast-json-patch",file:"/home/circleci/project/node_modules/fast-json-patch/lib/duplex.js"}],[265,{buffer:2157,cids:237,"js-base64":4795,multihashes:255},function(){with(this)return function(){"use strict";return function(e,t,r){(function(t){(function(){const n=e("cids"),i=e("multihashes"),s=e("js-base64"),o=e=>{let t=e.slice(0,2),r=e.slice(2),n="";return n="0x"===t?r:e,i.fromHexString(n)},a=e=>{try{const{multihash:t}=e;if(t.length<38){const e=i.decode(t);if("identity"===e.name&&e.length<36)return!1}return!0}catch(e){return!1}return!1},c={skynet:e=>s.toUint8Array(e),swarm:e=>{const t=i.encode(o(e),"keccak-256");return new n(1,"swarm-manifest",t).bytes},ipfs:e=>new n(e).toV1().bytes,ipns:e=>{const t=new n(e);if(!a(t))throw Error("ipns-ns allows only valid cryptographic libp2p-key identifiers, try using ED25519 pubkey instead");return new n(1,"libp2p-key",t.multihash).bytes},utf8:e=>t.from(e,"utf8")},u={hexMultiHash:e=>{const t=new n(e);return i.decode(t.multihash).digest.toString("hex")},ipfs:e=>{const t=new n(e).toV1();return t.toString("libp2p-key"===t.codec?"base36":"base32")},ipns:e=>{const t=new n(e).toV1();return a(t)?t.toString("base36"):(console.warn("[ensdomains/content-hash] use of non-cryptographic identifiers in ipns-ns is deprecated and will be removed, migrate to ED25519 libp2p-key"),String(i.decode(new n(e).multihash).digest))},utf8:e=>e.toString("utf8"),base64:e=>s.fromUint8Array(e,!0)},l={"skynet-ns":{encode:c.skynet,decode:u.base64},"swarm-ns":{encode:c.swarm,decode:u.hexMultiHash},"ipfs-ns":{encode:c.ipfs,decode:u.ipfs},"ipns-ns":{encode:c.ipns,decode:u.ipns},default:{encode:c.utf8,decode:u.utf8}};r.hexStringToBuffer=o,r.profiles=l}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@ensdomains/content-hash",file:"/home/circleci/project/node_modules/@ensdomains/content-hash/src/profiles.js"}],[255,{"./constants":254,buffer:2157,multibase:240,varint:6109,"web-encoding":6113},function(){with(this)return function(){"use strict";return function(e,t,r){const{Buffer:n}=e("buffer"),i=e("multibase"),s=e("varint"),{names:o}=e("./constants"),{TextDecoder:a}=e("web-encoding"),c=new a,u={};for(const e in o)u[o[e]]=e;function l(e){r.decode(e)}r.names=o,r.codes=Object.freeze(u),r.toHexString=function(e){if(!(e instanceof Uint8Array))throw new Error("must be passed a Uint8Array");return(n.isBuffer(e)?e:n.from(e.buffer,e.byteOffset,e.byteLength)).toString("hex")},r.fromHexString=function(e){return n.from(e,"hex")},r.toB58String=function(e){if(!(e instanceof Uint8Array))throw new Error("must be passed a Uint8Array");return c.decode(i.encode("base58btc",e)).slice(1)},r.fromB58String=function(e){const t=e instanceof Uint8Array?c.decode(e):e;return i.decode("z"+t)},r.decode=function(e){if(!(e instanceof Uint8Array))throw new Error("multihash must be a Uint8Array");let t=n.isBuffer(e)?e:n.from(e.buffer,e.byteOffset,e.byteLength);if(t.length<2)throw new Error("multihash too short. must be > 2 bytes.");const i=s.decode(t);if(!r.isValidCode(i))throw new Error(`multihash unknown function code: 0x${i.toString(16)}`);t=t.slice(s.decode.bytes);const o=s.decode(t);if(o<0)throw new Error(`multihash invalid length: ${o}`);if(t=t.slice(s.decode.bytes),t.length!==o)throw new Error(`multihash length inconsistent: 0x${t.toString("hex")}`);return{code:i,name:u[i],length:o,digest:t}},r.encode=function(e,t,i){if(!e||t===undefined)throw new Error("multihash encode requires at least two args: digest, code");const o=r.coerceCode(t);if(!(e instanceof Uint8Array))throw new Error("digest should be a Uint8Array");if(null==i&&(i=e.length),i&&e.length!==i)throw new Error("digest length should be equal to specified length.");const a=s.encode(o),c=s.encode(i),u=n.alloc(a.length+c.length+e.length);return u.set(a,0),u.set(c,a.length),u.set(e,a.length+c.length),u},r.coerceCode=function(e){let t=e;if("string"==typeof e){if(o[e]===undefined)throw new Error(`Unrecognized hash function named: ${e}`);t=o[e]}if("number"!=typeof t)throw new Error(`Hash function code should be a number. Got: ${t}`);if(u[t]===undefined&&!r.isAppCode(t))throw new Error(`Unrecognized function code: ${t}`);return t},r.isAppCode=function(e){return e>0&&e<16},r.isValidCode=function(e){return!!r.isAppCode(e)||!!u[e]},r.validate=l,r.prefix=function(e){return l(e),n.from(e.buffer,e.byteOffset,2)}}}},{package:"multihashes",file:"/home/circleci/project/node_modules/@ensdomains/content-hash/node_modules/multihashes/src/index.js"}],[263,{cids:237},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("cids");r.cidForWeb=e=>{let t=new n(e);0===t.version&&(t=t.toV1());let r=t.toString("base32");if(r.length>63){const e=t.toString("base36");if(e.length<=63)return e;throw new TypeError("CID is longer than DNS limit of 63 characters and is not compatible with public gateways")}return r};r.cidV0ToV1Base32=e=>{let t=new n(e);return 0===t.version&&(t=t.toV1()),t.toString("base32")}}}},{package:"@ensdomains/content-hash",file:"/home/circleci/project/node_modules/@ensdomains/content-hash/src/helpers.js"}],[249,{"./constants":248,"./int-table":250,"./print":251,"./util":252,"./varint-table":253,"uint8arrays/concat":256,varint:245},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("varint"),i=e("./int-table"),s=e("./varint-table"),o=e("./util"),a=e("uint8arrays/concat");const c=e("./constants"),u=e("./print");t.exports={addPrefix:function(e,t){let r;if(e instanceof Uint8Array)r=o.varintUint8ArrayEncode(e);else{if(!s[e])throw new Error("multicodec not recognized");r=s[e]}return a([r,t],r.length+t.length)},rmPrefix:function(e){return n.decode(e),e.slice(n.decode.bytes)},getCodec:function(e){const t=n.decode(e),r=i.get(t);if(r===undefined)throw new Error(`Code ${t} not found`);return r},getName:function(e){return i.get(e)},getNumber:function(e){const t=s[e];if(t===undefined)throw new Error("Codec `"+e+"` not found");return n.decode(t)},getCode:function(e){return n.decode(e)},getCodeVarint:function(e){const t=s[e];if(t===undefined)throw new Error("Codec `"+e+"` not found");return t},getVarint:function(e){return n.encode(e)},print:u,...c}}}},{package:"multicodec",file:"/home/circleci/project/node_modules/@ensdomains/content-hash/node_modules/multicodec/src/index.js"}],[1757,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports={name:"analytics-node",version:"3.4.0-beta.3",description:"The hassle-free way to integrate analytics into any Node.js application",license:"MIT",repository:"segmentio/analytics-node",author:{name:"Segment",email:"tools+npm@segment.com",url:"https://segment.com"},engines:{node:">=4"},"size-limit":[{limit:"25 KB",path:"index.js"}],scripts:{"circle-lint":".buildscript/circle.sh",dependencies:"yarn",size:"size-limit",test:"standard && nyc ava --timeout=20s&& .buildscript/e2e.sh","report-coverage":"nyc report --reporter=lcov > coverage.lcov && codecov",np:"np --no-publish",release:"yarn run np"},files:["index.js"],keywords:["analytics","stats","segment.io","segmentio","segment","client","driver"],dependencies:{"@segment/loosely-validate-event":"^2.0.0",axios:"^0.19.2","axios-retry":"^3.0.2","lodash.isstring":"^4.0.1",md5:"^2.2.1",ms:"^2.0.0","remove-trailing-slash":"^0.1.0",uuid:"^3.2.1"},devDependencies:{ava:"^0.25.0","basic-auth":"^2.0.1","body-parser":"^1.17.1",codecov:"^3.0.0",commander:"^2.9.0",delay:"^4.2.0",express:"^4.15.2",husky:"^3.0.4",nyc:"^14.1.1",pify:"^4.0.1",sinon:"^7.3.2","size-limit":"^1.3.5",snyk:"^1.171.1",standard:"^12.0.1"}}}}},{package:"analytics-node",file:"/home/circleci/project/node_modules/analytics-node/package.json"}],[5806,{},function(){with(this)return function(){"use strict";return function(e,t,r){(r=t.exports=function(e){return String(e).replace(r.expr,"")}).expr=/\/+$/}}},{package:"remove-trailing-slash",file:"/home/circleci/project/node_modules/remove-trailing-slash/index.js"}],[5282,{},function(){with(this)return function(){"use strict";return function(e,t,r){var n=1e3,i=60*n,s=60*i,o=24*s,a=7*o,c=365.25*o;function u(e,t,r,n){var i=t>=1.5*r;return Math.round(e/r)+" "+n+(i?"s":"")}t.exports=function(e,t){t=t||{};var r=typeof e;if("string"===r&&e.length>0)return function(e){if((e=String(e)).length>100)return;var t=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(!t)return;var r=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return r*c;case"weeks":case"week":case"w":return r*a;case"days":case"day":case"d":return r*o;case"hours":case"hour":case"hrs":case"hr":case"h":return r*s;case"minutes":case"minute":case"mins":case"min":case"m":return r*i;case"seconds":case"second":case"secs":case"sec":case"s":return r*n;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return undefined}}(e);if("number"===r&&isFinite(e))return t.long?function(e){var t=Math.abs(e);if(t>=o)return u(e,t,o,"day");if(t>=s)return u(e,t,s,"hour");if(t>=i)return u(e,t,i,"minute");if(t>=n)return u(e,t,n,"second");return e+" ms"}(e):function(e){var t=Math.abs(e);if(t>=o)return Math.round(e/o)+"d";if(t>=s)return Math.round(e/s)+"h";if(t>=i)return Math.round(e/i)+"m";if(t>=n)return Math.round(e/n)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}}}},{package:"ms",file:"/home/circleci/project/node_modules/ms/index.js"}],[5077,{},function(){with(this)return function(){"use strict";return function(e,t,r){var n=Object.prototype.toString,i=Array.isArray;t.exports=function(e){return"string"==typeof e||!i(e)&&function(e){return!!e&&"object"==typeof e}(e)&&"[object String]"==n.call(e)}}}},{package:"lodash.isstring",file:"/home/circleci/project/node_modules/lodash.isstring/index.js"}],[1756,{"./lib/bytesToUuid":1754,"./lib/rng":1755},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("./lib/rng"),i=e("./lib/bytesToUuid");t.exports=function(e,t,r){var s=t&&r||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var o=(e=e||{}).random||(e.rng||n)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,t)for(var a=0;a<16;++a)t[s+a]=o[a];return t||i(o)}}}},{package:"uuid",file:"/home/circleci/project/node_modules/analytics-node/node_modules/uuid/v4.js"}],[5270,{charenc:2193,crypt:2266,"is-buffer":4764},function(){with(this)return function(){"use strict";return function(e,t,r){var n,i,s,o,a;n=e("crypt"),i=e("charenc").utf8,s=e("is-buffer"),o=e("charenc").bin,(a=function(e,t){e.constructor==String?e=t&&"binary"===t.encoding?o.stringToBytes(e):i.stringToBytes(e):s(e)?e=Array.prototype.slice.call(e,0):Array.isArray(e)||e.constructor===Uint8Array||(e=e.toString());for(var r=n.bytesToWords(e),c=8*e.length,u=1732584193,l=-271733879,f=-1732584194,d=271733878,h=0;h<r.length;h++)r[h]=16711935&(r[h]<<8|r[h]>>>24)|4278255360&(r[h]<<24|r[h]>>>8);r[c>>>5]|=128<<c%32,r[14+(c+64>>>9<<4)]=c;var p=a._ff,m=a._gg,g=a._hh,y=a._ii;for(h=0;h<r.length;h+=16){var b=u,v=l,w=f,_=d;u=p(u,l,f,d,r[h+0],7,-680876936),d=p(d,u,l,f,r[h+1],12,-389564586),f=p(f,d,u,l,r[h+2],17,606105819),l=p(l,f,d,u,r[h+3],22,-1044525330),u=p(u,l,f,d,r[h+4],7,-176418897),d=p(d,u,l,f,r[h+5],12,1200080426),f=p(f,d,u,l,r[h+6],17,-1473231341),l=p(l,f,d,u,r[h+7],22,-45705983),u=p(u,l,f,d,r[h+8],7,1770035416),d=p(d,u,l,f,r[h+9],12,-1958414417),f=p(f,d,u,l,r[h+10],17,-42063),l=p(l,f,d,u,r[h+11],22,-1990404162),u=p(u,l,f,d,r[h+12],7,1804603682),d=p(d,u,l,f,r[h+13],12,-40341101),f=p(f,d,u,l,r[h+14],17,-1502002290),u=m(u,l=p(l,f,d,u,r[h+15],22,1236535329),f,d,r[h+1],5,-165796510),d=m(d,u,l,f,r[h+6],9,-1069501632),f=m(f,d,u,l,r[h+11],14,643717713),l=m(l,f,d,u,r[h+0],20,-373897302),u=m(u,l,f,d,r[h+5],5,-701558691),d=m(d,u,l,f,r[h+10],9,38016083),f=m(f,d,u,l,r[h+15],14,-660478335),l=m(l,f,d,u,r[h+4],20,-405537848),u=m(u,l,f,d,r[h+9],5,568446438),d=m(d,u,l,f,r[h+14],9,-1019803690),f=m(f,d,u,l,r[h+3],14,-187363961),l=m(l,f,d,u,r[h+8],20,1163531501),u=m(u,l,f,d,r[h+13],5,-1444681467),d=m(d,u,l,f,r[h+2],9,-51403784),f=m(f,d,u,l,r[h+7],14,1735328473),u=g(u,l=m(l,f,d,u,r[h+12],20,-1926607734),f,d,r[h+5],4,-378558),d=g(d,u,l,f,r[h+8],11,-2022574463),f=g(f,d,u,l,r[h+11],16,1839030562),l=g(l,f,d,u,r[h+14],23,-35309556),u=g(u,l,f,d,r[h+1],4,-1530992060),d=g(d,u,l,f,r[h+4],11,1272893353),f=g(f,d,u,l,r[h+7],16,-155497632),l=g(l,f,d,u,r[h+10],23,-1094730640),u=g(u,l,f,d,r[h+13],4,681279174),d=g(d,u,l,f,r[h+0],11,-358537222),f=g(f,d,u,l,r[h+3],16,-722521979),l=g(l,f,d,u,r[h+6],23,76029189),u=g(u,l,f,d,r[h+9],4,-640364487),d=g(d,u,l,f,r[h+12],11,-421815835),f=g(f,d,u,l,r[h+15],16,530742520),u=y(u,l=g(l,f,d,u,r[h+2],23,-995338651),f,d,r[h+0],6,-198630844),d=y(d,u,l,f,r[h+7],10,1126891415),f=y(f,d,u,l,r[h+14],15,-1416354905),l=y(l,f,d,u,r[h+5],21,-57434055),u=y(u,l,f,d,r[h+12],6,1700485571),d=y(d,u,l,f,r[h+3],10,-1894986606),f=y(f,d,u,l,r[h+10],15,-1051523),l=y(l,f,d,u,r[h+1],21,-2054922799),u=y(u,l,f,d,r[h+8],6,1873313359),d=y(d,u,l,f,r[h+15],10,-30611744),f=y(f,d,u,l,r[h+6],15,-1560198380),l=y(l,f,d,u,r[h+13],21,1309151649),u=y(u,l,f,d,r[h+4],6,-145523070),d=y(d,u,l,f,r[h+11],10,-1120210379),f=y(f,d,u,l,r[h+2],15,718787259),l=y(l,f,d,u,r[h+9],21,-343485551),u=u+b>>>0,l=l+v>>>0,f=f+w>>>0,d=d+_>>>0}return n.endian([u,l,f,d])})._ff=function(e,t,r,n,i,s,o){var a=e+(t&r|~t&n)+(i>>>0)+o;return(a<<s|a>>>32-s)+t},a._gg=function(e,t,r,n,i,s,o){var a=e+(t&n|r&~n)+(i>>>0)+o;return(a<<s|a>>>32-s)+t},a._hh=function(e,t,r,n,i,s,o){var a=e+(t^r^n)+(i>>>0)+o;return(a<<s|a>>>32-s)+t},a._ii=function(e,t,r,n,i,s,o){var a=e+(r^(t|~n))+(i>>>0)+o;return(a<<s|a>>>32-s)+t},a._blocksize=16,a._digestsize=16,t.exports=function(e,t){if(e===undefined||null===e)throw new Error("Illegal argument "+e);var r=n.wordsToBytes(a(e,t));return t&&t.asBytes?r:t&&t.asString?o.bytesToString(r):n.bytesToHex(r)}}}},{package:"md5",file:"/home/circleci/project/node_modules/md5/md5.js"}],[1550,{assert:1776,buffer:2157,"component-type":2226,"join-component":4794},function(){with(this)return function(){"use strict";return function(e,t,r){(function(r){(function(){var n=e("component-type"),i=e("join-component"),s=e("assert");t.exports=function(e,t){switch(a(e),t=t||e.type,s(t,"You must pass an event type."),t){case"track":return function(e){s(e.anonymousId||e.userId,'You must pass either an "anonymousId" or a "userId".'),s(e.event,'You must pass an "event".')}(e);case"group":return function(e){s(e.anonymousId||e.userId,'You must pass either an "anonymousId" or a "userId".'),s(e.groupId,'You must pass a "groupId".')}(e);case"identify":case"page":case"screen":return function(e){s(e.anonymousId||e.userId,'You must pass either an "anonymousId" or a "userId".')}(e);case"alias":return function(e){s(e.userId,'You must pass a "userId".'),s(e.previousId,'You must pass a "previousId".')}(e);default:s(0,'Invalid event type: "'+t+'"')}};var o={anonymousId:["string","number"],category:"string",context:"object",event:"string",groupId:["string","number"],integrations:"object",name:"string",previousId:["string","number"],timestamp:"date",userId:["string","number"],type:"string"};function a(e){s("object"===n(e),"You must pass a message object.");var t=JSON.stringify(e);for(var a in s(r.byteLength(t,"utf8")<32768,"Your message must be < 32kb."),o){var c=e[a];if(c){var u=o[a];"array"!==n(u)&&(u=[u]);var l="object"===u[0]?"an":"a";s(u.some((function(e){return n(c)===e})),'"'+a+'" must be '+l+" "+i(u,"or")+".")}}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@segment/loosely-validate-event",file:"/home/circleci/project/node_modules/@segment/loosely-validate-event/index.js"}],[1858,{"./lib/index":1859},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=e("./lib/index").default}}},{package:"axios-retry",file:"/home/circleci/project/node_modules/axios-retry/index.js"}],[1860,{"./lib/axios":1862},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=e("./lib/axios")}}},{package:"axios",file:"/home/circleci/project/node_modules/axios/index.js"}],[2608,{"./account":2604,"./bytes":2605,"./constants":2606,"./hash":2607,"./object":2609,"./secp256k1v3-adapter":2610,"./signature":2613,"bn.js":2113,"ethjs-util":2614,rlp:5815},function(){with(this)return function(){"use strict";return function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){n===undefined&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){n===undefined&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||t.hasOwnProperty(r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),r.secp256k1=r.rlp=r.BN=void 0;var s=e("./secp256k1v3-adapter");r.secp256k1=s;var o=e("ethjs-util"),a=e("bn.js");r.BN=a;var c=e("rlp");r.rlp=c,Object.assign(r,o),i(e("./constants"),r),i(e("./account"),r),i(e("./hash"),r),i(e("./signature"),r),i(e("./bytes"),r),i(e("./object"),r)}}},{package:"ethereumjs-util",file:"/home/circleci/project/node_modules/ethereumjs-wallet/node_modules/ethereumjs-util/dist/index.js"}],[5827,{buffer:2157,pbkdf2:5478},function(){with(this)return function(){"use strict";return function(e,t,r){(function(r){(function(){var n=e("pbkdf2").pbkdf2Sync,i=2147483647;function s(e,t,n,i,s){if(r.isBuffer(e)&&r.isBuffer(n))e.copy(n,i,t,t+s);else for(;s--;)n[i++]=e[t++]}t.exports=function(e,t,o,a,c,u,l){if(0===o||0!=(o&o-1))throw Error("N must be > 0 and a power of 2");if(o>i/128/a)throw Error("Parameter N is too large");if(a>i/128/c)throw Error("Parameter r is too large");var f,d=new r(256*a),h=new r(128*a*o),p=new Int32Array(16),m=new Int32Array(16),g=new r(64),y=n(e,t,1,128*c*a,"sha256");if(l){var b=c*o*2,v=0;f=function(){++v%1e3==0&&l({current:v,total:b,percent:v/b*100})}}for(var w=0;w<c;w++)_(y,128*w*a,a,o,h,d);return n(e,y,1,u,"sha256");function _(e,t,r,n,i,s){var o,a=128*r;for(e.copy(s,0,t,t+a),o=0;o<n;o++)s.copy(i,o*a,0,0+a),E(s,0,a,r),f&&f();for(o=0;o<n;o++){var c=0+64*(2*r-1);A(i,(s.readUInt32LE(c)&n-1)*a,s,0,a),E(s,0,a,r),f&&f()}s.copy(e,t,0,0+a)}function E(e,t,r,n){var i;for(s(e,t+64*(2*n-1),g,0,64),i=0;i<2*n;i++)A(e,64*i,g,0,64),S(g),s(g,0,e,r+64*i,64);for(i=0;i<n;i++)s(e,r+2*i*64,e,t+64*i,64);for(i=0;i<n;i++)s(e,r+64*(2*i+1),e,t+64*(i+n),64)}function k(e,t){return e<<t|e>>>32-t}function S(e){var t;for(t=0;t<16;t++)p[t]=(255&e[4*t+0])<<0,p[t]|=(255&e[4*t+1])<<8,p[t]|=(255&e[4*t+2])<<16,p[t]|=(255&e[4*t+3])<<24;for(s(p,0,m,0,16),t=8;t>0;t-=2)m[4]^=k(m[0]+m[12],7),m[8]^=k(m[4]+m[0],9),m[12]^=k(m[8]+m[4],13),m[0]^=k(m[12]+m[8],18),m[9]^=k(m[5]+m[1],7),m[13]^=k(m[9]+m[5],9),m[1]^=k(m[13]+m[9],13),m[5]^=k(m[1]+m[13],18),m[14]^=k(m[10]+m[6],7),m[2]^=k(m[14]+m[10],9),m[6]^=k(m[2]+m[14],13),m[10]^=k(m[6]+m[2],18),m[3]^=k(m[15]+m[11],7),m[7]^=k(m[3]+m[15],9),m[11]^=k(m[7]+m[3],13),m[15]^=k(m[11]+m[7],18),m[1]^=k(m[0]+m[3],7),m[2]^=k(m[1]+m[0],9),m[3]^=k(m[2]+m[1],13),m[0]^=k(m[3]+m[2],18),m[6]^=k(m[5]+m[4],7),m[7]^=k(m[6]+m[5],9),m[4]^=k(m[7]+m[6],13),m[5]^=k(m[4]+m[7],18),m[11]^=k(m[10]+m[9],7),m[8]^=k(m[11]+m[10],9),m[9]^=k(m[8]+m[11],13),m[10]^=k(m[9]+m[8],18),m[12]^=k(m[15]+m[14],7),m[13]^=k(m[12]+m[15],9),m[14]^=k(m[13]+m[12],13),m[15]^=k(m[14]+m[13],18);for(t=0;t<16;++t)p[t]=m[t]+p[t];for(t=0;t<16;t++){var r=4*t;e[r+0]=p[t]>>0&255,e[r+1]=p[t]>>8&255,e[r+2]=p[t]>>16&255,e[r+3]=p[t]>>24&255}}function A(e,t,r,n,i){for(var s=0;s<i;s++)r[n+s]^=e[t+s]}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"scryptsy",file:"/home/circleci/project/node_modules/scryptsy/lib/scrypt.js"}],[2617,{"./lib/bytesToUuid":2615,"./lib/rng":2616},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("./lib/rng"),i=e("./lib/bytesToUuid");t.exports=function(e,t,r){var s=t&&r||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var o=(e=e||{}).random||(e.rng||n)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,t)for(var a=0;a<16;++a)t[s+a]=o[a];return t||i(o)}}}},{package:"uuid",file:"/home/circleci/project/node_modules/ethereumjs-wallet/node_modules/uuid/v4.js"}],[5988,{"./createEventEmitterProxy":5986,"./createSwappableProxy":5987},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("./createSwappableProxy"),i=e("./createEventEmitterProxy");t.exports={createSwappableProxy:n,createEventEmitterProxy:i}}}},{package:"swappable-obj-proxy",file:"/home/circleci/project/node_modules/swappable-obj-proxy/src/index.js"}],[15,{"../../../../shared/constants/time":6269,"@babel/runtime/helpers/defineProperty":189,"@babel/runtime/helpers/interopRequireDefault":195,_process:5498,"eth-block-tracker":2437,"eth-json-rpc-middleware":2482,"json-rpc-engine":4805},function(){with(this)return function(){"use strict";return function(e,t,r){(function(t){(function(){var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=function({rpcUrl:e,chainId:t}){const r=(0,o.createFetchMiddleware)({rpcUrl:e}),n=(0,o.providerFromMiddleware)(r),i=new a.PollingBlockTracker(l(l({},d),{},{provider:n}));return{networkMiddleware:(0,s.mergeMiddleware)([...f?[(0,s.createAsyncMiddleware)((async(e,t,r)=>("eth_estimateGas"===e.method&&await new Promise((e=>setTimeout(e,2*c.SECOND))),r())))]:[],h(t),(0,o.createBlockRefRewriteMiddleware)({blockTracker:i}),(0,o.createBlockCacheMiddleware)({blockTracker:i}),(0,o.createInflightCacheMiddleware)(),(0,o.createBlockTrackerInspectorMiddleware)({blockTracker:i}),r]),blockTracker:i}};var i=n(e("@babel/runtime/helpers/defineProperty")),s=e("json-rpc-engine"),o=e("eth-json-rpc-middleware"),a=e("eth-block-tracker"),c=e("../../../../shared/constants/time");function u(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?u(Object(r),!0).forEach((function(t){(0,i.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):u(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const f=t.env.IN_TEST,d=f?{pollingInterval:c.SECOND}:{};function h(e){return(t,r,n,i)=>"eth_chainId"===t.method?(r.result=e,i()):n()}}).call(this)}).call(this,e("_process"))}}},{package:"<root>",file:"/home/circleci/project/app/scripts/controllers/network/createJsonRpcClient.js"}],[14,{"../../../../shared/constants/network":6266,"@babel/runtime/helpers/interopRequireDefault":195,"eth-block-tracker":2437,"eth-json-rpc-infura":2476,"eth-json-rpc-middleware":2482,"json-rpc-engine":4805},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=function({network:e,projectId:t}){const r=(0,o.default)({network:e,projectId:t,maxAttempts:5,source:"metamask"}),n=(0,s.providerFromMiddleware)(r),c=new a.PollingBlockTracker({provider:n});return{networkMiddleware:(0,i.mergeMiddleware)([u({network:e}),(0,s.createBlockCacheMiddleware)({blockTracker:c}),(0,s.createInflightCacheMiddleware)(),(0,s.createBlockRefMiddleware)({blockTracker:c,provider:n}),(0,s.createRetryOnEmptyMiddleware)({blockTracker:c,provider:n}),(0,s.createBlockTrackerInspectorMiddleware)({blockTracker:c}),r]),blockTracker:c}};var i=e("json-rpc-engine"),s=e("eth-json-rpc-middleware"),o=n(e("eth-json-rpc-infura")),a=e("eth-block-tracker"),c=e("../../../../shared/constants/network");function u({network:e}){if(!c.NETWORK_TYPE_TO_ID_MAP[e])throw new Error(`createInfuraClient - unknown network "${e}"`);const{chainId:t,networkId:r}=c.NETWORK_TYPE_TO_ID_MAP[e];return(0,i.createScaffoldMiddleware)({eth_chainId:t,net_version:r})}}}},{package:"<root>",file:"/home/circleci/project/app/scripts/controllers/network/createInfuraClient.js"}],[2201,{bs58:2202,buffer:2157,"create-hash":2261},function(){with(this)return function(){"use strict";return function(e,t,r){(function(r){(function(){var n=e("bs58"),i=e("create-hash");function s(e,t){var i;(Array.isArray(e)||e instanceof Uint8Array)&&(e=new r(e)),null!=t?("number"==typeof t&&(t=new r([t])),i=r.concat([t,e])):i=e;var s=c(i).slice(0,4),o=r.concat([i,s]);return n.encode(o)}function o(e,t){var i,s=n.decode(e),o=new r(s);if(null==t)i=0;else if("number"==typeof t&&(t=new r([t])),i=t.length,o.slice(0,i).toString("hex")!==t.toString("hex"))throw new Error("Invalid version");var a=o.slice(-4),u=o.length-4,l=o.slice(0,u),f=c(l).slice(0,4);if(a.toString("hex")!==f.toString("hex"))throw new Error("Invalid checksum");return l.slice(i)}function a(e,t){try{o(e,t)}catch(e){return!1}return!0}function c(e){var t=i("sha256").update(e).digest();return i("sha256").update(t).digest()}t.exports={encode:s,decode:o,isValid:a,createEncoder:function(e){return function(t){return s(t,e)}},createDecoder:function(e){return function(t){return o(t,e)}},createValidator:function(e){return function(t){return a(t,e)}}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"coinstring",file:"/home/circleci/project/node_modules/coinstring/lib/coinstring.js"}],[1104,{"./lib":1108,"./lib/elliptic":1107},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=e("./lib")(e("./lib/elliptic"))}}},{package:"secp256k1",file:"/home/circleci/project/node_modules/@metamask/eth-ledger-bridge-keyring/node_modules/secp256k1/elliptic.js"}],[1095,{assert:1776,"bn.js":2113,"create-hash":2261,"ethjs-util":1096,keccak:1098,rlp:5815,"safe-buffer":5817,secp256k1:1104},function(){with(this)return function(){"use strict";return function(e,t,r){var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=e("keccak"),s=e("secp256k1"),o=e("assert"),a=e("rlp"),c=e("bn.js"),u=e("create-hash"),l=e("safe-buffer").Buffer;Object.assign(r,e("ethjs-util")),r.MAX_INTEGER=new c("ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff",16),r.TWO_POW256=new c("10000000000000000000000000000000000000000000000000000000000000000",16),r.KECCAK256_NULL_S="c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470",r.SHA3_NULL_S=r.KECCAK256_NULL_S,r.KECCAK256_NULL=l.from(r.KECCAK256_NULL_S,"hex"),r.SHA3_NULL=r.KECCAK256_NULL,r.KECCAK256_RLP_ARRAY_S="1dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347",r.SHA3_RLP_ARRAY_S=r.KECCAK256_RLP_ARRAY_S,r.KECCAK256_RLP_ARRAY=l.from(r.KECCAK256_RLP_ARRAY_S,"hex"),r.SHA3_RLP_ARRAY=r.KECCAK256_RLP_ARRAY,r.KECCAK256_RLP_S="56e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421",r.SHA3_RLP_S=r.KECCAK256_RLP_S,r.KECCAK256_RLP=l.from(r.KECCAK256_RLP_S,"hex"),r.SHA3_RLP=r.KECCAK256_RLP,r.BN=c,r.rlp=a,r.secp256k1=s,r.zeros=function(e){return l.allocUnsafe(e).fill(0)},r.zeroAddress=function(){var e=r.zeros(20);return r.bufferToHex(e)},r.setLengthLeft=r.setLength=function(e,t,n){var i=r.zeros(t);return e=r.toBuffer(e),n?e.length<t?(e.copy(i),i):e.slice(0,t):e.length<t?(e.copy(i,t-e.length),i):e.slice(-t)},r.setLengthRight=function(e,t){return r.setLength(e,t,!0)},r.unpad=r.stripZeros=function(e){for(var t=(e=r.stripHexPrefix(e))[0];e.length>0&&"0"===t.toString();)t=(e=e.slice(1))[0];return e},r.toBuffer=function(e){if(!l.isBuffer(e))if(Array.isArray(e))e=l.from(e);else if("string"==typeof e)e=r.isHexString(e)?l.from(r.padToEven(r.stripHexPrefix(e)),"hex"):l.from(e);else if("number"==typeof e)e=r.intToBuffer(e);else if(null===e||e===undefined)e=l.allocUnsafe(0);else if(c.isBN(e))e=e.toArrayLike(l);else{if(!e.toArray)throw new Error("invalid type");e=l.from(e.toArray())}return e},r.bufferToInt=function(e){return new c(r.toBuffer(e)).toNumber()},r.bufferToHex=function(e){return"0x"+(e=r.toBuffer(e)).toString("hex")},r.fromSigned=function(e){return new c(e).fromTwos(256)},r.toUnsigned=function(e){return l.from(e.toTwos(256).toArray())},r.keccak=function(e,t){return e=r.toBuffer(e),t||(t=256),i("keccak"+t).update(e).digest()},r.keccak256=function(e){return r.keccak(e)},r.sha3=r.keccak,r.sha256=function(e){return e=r.toBuffer(e),u("sha256").update(e).digest()},r.ripemd160=function(e,t){e=r.toBuffer(e);var n=u("rmd160").update(e).digest();return!0===t?r.setLength(n,32):n},r.rlphash=function(e){return r.keccak(a.encode(e))},r.isValidPrivate=function(e){return s.privateKeyVerify(e)},r.isValidPublic=function(e,t){return 64===e.length?s.publicKeyVerify(l.concat([l.from([4]),e])):!!t&&s.publicKeyVerify(e)},r.pubToAddress=r.publicToAddress=function(e,t){return e=r.toBuffer(e),t&&64!==e.length&&(e=s.publicKeyConvert(e,!1).slice(1)),o(64===e.length),r.keccak(e).slice(-20)};var f=r.privateToPublic=function(e){return e=r.toBuffer(e),s.publicKeyCreate(e,!1).slice(1)};r.importPublic=function(e){return 64!==(e=r.toBuffer(e)).length&&(e=s.publicKeyConvert(e,!1).slice(1)),e},r.ecsign=function(e,t){var r=s.sign(e,t),n={};return n.r=r.signature.slice(0,32),n.s=r.signature.slice(32,64),n.v=r.recovery+27,n},r.hashPersonalMessage=function(e){var t=r.toBuffer("Ethereum Signed Message:\n"+e.length.toString());return r.keccak(l.concat([t,e]))},r.ecrecover=function(e,t,n,i){var o=l.concat([r.setLength(n,32),r.setLength(i,32)],64),a=t-27;if(0!==a&&1!==a)throw new Error("Invalid signature v value");var c=s.recover(e,o,a);return s.publicKeyConvert(c,!1).slice(1)},r.toRpcSig=function(e,t,n){if(27!==e&&28!==e)throw new Error("Invalid recovery id");return r.bufferToHex(l.concat([r.setLengthLeft(t,32),r.setLengthLeft(n,32),r.toBuffer(e-27)]))},r.fromRpcSig=function(e){if(65!==(e=r.toBuffer(e)).length)throw new Error("Invalid signature length");var t=e[64];return t<27&&(t+=27),{v:t,r:e.slice(0,32),s:e.slice(32,64)}},r.privateToAddress=function(e){return r.publicToAddress(f(e))},r.isValidAddress=function(e){return/^0x[0-9a-fA-F]{40}$/.test(e)},r.isZeroAddress=function(e){return r.zeroAddress()===r.addHexPrefix(e)},r.toChecksumAddress=function(e){e=r.stripHexPrefix(e).toLowerCase();for(var t=r.keccak(e).toString("hex"),n="0x",i=0;i<e.length;i++)parseInt(t[i],16)>=8?n+=e[i].toUpperCase():n+=e[i];return n},r.isValidChecksumAddress=function(e){return r.isValidAddress(e)&&r.toChecksumAddress(e)===e},r.generateAddress=function(e,t){return e=r.toBuffer(e),t=(t=new c(t)).isZero()?null:l.from(t.toArray()),r.rlphash([e,t]).slice(-20)},r.isPrecompiled=function(e){var t=r.unpad(e);return 1===t.length&&t[0]>=1&&t[0]<=8},r.addHexPrefix=function(e){return"string"!=typeof e||r.isHexPrefixed(e)?e:"0x"+e},r.isValidSignature=function(e,t,r,n){var i=new c("7fffffffffffffffffffffffffffffff5d576e7357a4501ddfe92f46681b20a0",16),s=new c("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141",16);return 32===t.length&&32===r.length&&((27===e||28===e)&&(t=new c(t),r=new c(r),!(t.isZero()||t.gt(s)||r.isZero()||r.gt(s))&&(!1!==n||1!==new c(r).cmp(i))))},r.baToJSON=function(e){if(l.isBuffer(e))return"0x"+e.toString("hex");if(e instanceof Array){for(var t=[],n=0;n<e.length;n++)t.push(r.baToJSON(e[n]));return t}},r.defineProperties=function(e,t,i){if(e.raw=[],e._fields=[],e.toJSON=function(t){if(t){var n={};return e._fields.forEach((function(t){n[t]="0x"+e[t].toString("hex")})),n}return r.baToJSON(this.raw)},e.serialize=function(){return a.encode(e.raw)},t.forEach((function(t,n){function i(){return e.raw[n]}function s(i){"00"!==(i=r.toBuffer(i)).toString("hex")||t.allowZero||(i=l.allocUnsafe(0)),t.allowLess&&t.length?(i=r.stripZeros(i),o(t.length>=i.length,"The field "+t.name+" must not have more "+t.length+" bytes")):t.allowZero&&0===i.length||!t.length||o(t.length===i.length,"The field "+t.name+" must have byte length of "+t.length),e.raw[n]=i}e._fields.push(t.name),Object.defineProperty(e,t.name,{enumerable:!0,configurable:!0,get:i,set:s}),t.default&&(e[t.name]=t.default),t.alias&&Object.defineProperty(e,t.alias,{enumerable:!1,configurable:!0,set:s,get:i})})),i)if("string"==typeof i&&(i=l.from(r.stripHexPrefix(i),"hex")),l.isBuffer(i)&&(i=a.decode(i)),Array.isArray(i)){if(i.length>e._fields.length)throw new Error("wrong number of fields in data");i.forEach((function(t,n){e[e._fields[n]]=r.toBuffer(t)}))}else{if("object"!==(void 0===i?"undefined":n(i)))throw new Error("invalid data");var s=Object.keys(i);t.forEach((function(t){-1!==s.indexOf(t.name)&&(e[t.name]=i[t.name]),-1!==s.indexOf(t.alias)&&(e[t.alias]=i[t.alias])}))}}}}},{package:"ethereumjs-util",file:"/home/circleci/project/node_modules/@metamask/eth-ledger-bridge-keyring/node_modules/eth-sig-util/node_modules/ethereumjs-util/dist/index.js"}],[2488,{"json-stable-stringify":4809},function(){with(this)return function(){"use strict";return function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.cacheTypeForPayload=r.blockTagParamIndex=r.paramsWithoutBlockTag=r.blockTagForPayload=r.canCache=r.cacheIdentifierForPayload=void 0;const i=n(e("json-stable-stringify"));function s(e){return"never"!==c(e)}function o(e){if(!e.params)return[];const t=a(e);return t===undefined||t>=e.params.length?e.params:"eth_getBlockByNumber"===e.method?e.params.slice(1):e.params.slice(0,t)}function a(e){switch(e.method){case"eth_getStorageAt":return 2;case"eth_getBalance":case"eth_getCode":case"eth_getTransactionCount":case"eth_call":return 1;case"eth_getBlockByNumber":return 0;default:return undefined}}function c(e){switch(e.method){case"web3_clientVersion":case"web3_sha3":case"eth_protocolVersion":case"eth_getBlockTransactionCountByHash":case"eth_getUncleCountByBlockHash":case"eth_getCode":case"eth_getBlockByHash":case"eth_getTransactionByHash":case"eth_getTransactionByBlockHashAndIndex":case"eth_getTransactionReceipt":case"eth_getUncleByBlockHashAndIndex":case"eth_getCompilers":case"eth_compileLLL":case"eth_compileSolidity":case"eth_compileSerpent":case"shh_version":case"test_permaCache":return"perma";case"eth_getBlockByNumber":case"eth_getBlockTransactionCountByNumber":case"eth_getUncleCountByBlockNumber":case"eth_getTransactionByBlockNumberAndIndex":case"eth_getUncleByBlockNumberAndIndex":case"test_forkCache":return"fork";case"eth_gasPrice":case"eth_blockNumber":case"eth_getBalance":case"eth_getStorageAt":case"eth_getTransactionCount":case"eth_call":case"eth_estimateGas":case"eth_getFilterLogs":case"eth_getLogs":case"test_blockCache":return"block";default:return"never"}}r.cacheIdentifierForPayload=function(e,t){var r;const n=t?o(e):null!==(r=e.params)&&void 0!==r?r:[];return s(e)?`${e.method}:${(0,i.default)(n)}`:null},r.canCache=s,r.blockTagForPayload=function(e){if(!e.params)return undefined;const t=a(e);return t===undefined||t>=e.params.length?undefined:e.params[t]},r.paramsWithoutBlockTag=o,r.blockTagParamIndex=a,r.cacheTypeForPayload=c}}},{package:"eth-json-rpc-middleware",file:"/home/circleci/project/node_modules/eth-json-rpc-middleware/dist/utils/cache.js"}],[2511,{},function(){with(this)return function(){"use strict";return function(e,t,r){const n=(e,t)=>function(){const r=t.promiseModule,n=new Array(arguments.length);for(let e=0;e<arguments.length;e++)n[e]=arguments[e];return new r(((r,i)=>{t.errorFirst?n.push((function(e,n){if(t.multiArgs){const t=new Array(arguments.length-1);for(let e=1;e<arguments.length;e++)t[e-1]=arguments[e];e?(t.unshift(e),i(t)):r(t)}else e?i(e):r(n)})):n.push((function(e){if(t.multiArgs){const e=new Array(arguments.length-1);for(let t=0;t<arguments.length;t++)e[t]=arguments[t];r(e)}else r(e)})),e.apply(this,n)}))};t.exports=(e,t)=>{t=Object.assign({exclude:[/.+(Sync|Stream)$/],errorFirst:!0,promiseModule:Promise},t);const r=e=>{const r=t=>"string"==typeof t?e===t:t.test(e);return t.include?t.include.some(r):!t.exclude.some(r)};let i;i="function"==typeof e?function(){return t.excludeMain?e.apply(this,arguments):n(e,t).apply(this,arguments)}:Object.create(Object.getPrototypeOf(e));for(const s in e){const o=e[s];i[s]="function"==typeof o&&r(s)?n(o,t):o}return i}}}},{package:"pify",file:"/home/circleci/project/node_modules/eth-json-rpc-middleware/node_modules/pify/index.js"}],[2490,{"ethereumjs-abi":2491,"ethereumjs-util":2503},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("ethereumjs-util"),i=e("ethereumjs-abi");function s(e){const t=new Error("Expect argument to be non-empty array");if("object"!=typeof e||!e.length)throw t;const r=e.map((function(e){return"bytes"===e.type?n.toBuffer(e.value):e.value})),s=e.map((function(e){return e.type})),o=e.map((function(e){if(!e.name)throw t;return e.type+" "+e.name}));return i.soliditySHA3(["bytes32","bytes32"],[i.soliditySHA3(new Array(e.length).fill("string"),o),i.soliditySHA3(s,r)])}function o(e,t){const r=n.toBuffer(t),i=n.fromRpcSig(r);return n.ecrecover(e,i.v,i.r,i.s)}function a(e){const t=n.toBuffer(e.data);return o(n.hashPersonalMessage(t),e.sig)}function c(e,t){for(var r=""+e;r.length<t;)r="0"+r;return r}t.exports={concatSig:function(e,t,r){const i=n.fromSigned(t),s=n.fromSigned(r),o=n.bufferToInt(e),a=c(n.toUnsigned(i).toString("hex"),64),u=c(n.toUnsigned(s).toString("hex"),64),l=n.stripHexPrefix(n.intToHex(o));return n.addHexPrefix(a.concat(u,l)).toString("hex")},normalize:function(e){if(e){if("number"==typeof e){const t=n.toBuffer(e);e=n.bufferToHex(t)}if("string"!=typeof e){var t="eth-sig-util.normalize() requires hex string or integer input.";throw new Error(t+=" received "+typeof e+": "+e)}return n.addHexPrefix(e.toLowerCase())}},personalSign:function(e,t){var r=n.toBuffer(t.data),i=n.hashPersonalMessage(r),s=n.ecsign(i,e);return n.bufferToHex(this.concatSig(s.v,s.r,s.s))},recoverPersonalSignature:function(e){const t=a(e),r=n.publicToAddress(t);return n.bufferToHex(r)},extractPublicKey:function(e){return"0x"+a(e).toString("hex")},typedSignatureHash:function(e){const t=s(e);return n.bufferToHex(t)},signTypedData:function(e,t){const r=s(t.data),i=n.ecsign(r,e);return n.bufferToHex(this.concatSig(i.v,i.r,i.s))},recoverTypedSignature:function(e){const t=o(s(e.data),e.sig),r=n.publicToAddress(t);return n.bufferToHex(r)}}}}},{package:"eth-sig-util",file:"/home/circleci/project/node_modules/eth-json-rpc-middleware/node_modules/eth-sig-util/index.js"}],[4401,{},function(){with(this)return function(){"use strict";return function(e,t,r){var n,i=this&&this.__assign||function(){return i=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},i.apply(this,arguments)};Object.defineProperty(r,"__esModule",{value:!0}),r.ETH_ABI_LATTICE_FW_TYPE_MAP=r.MAX_CHAIN_ID_BYTES=r.HANDLE_LARGER_CHAIN_ID=r.HARDENED_OFFSET=r.VERSION_BYTE=r.REQUEST_TYPE_BYTE=r.signingSchema=r.responseMsgs=r.responseCodes=r.messageConstants=r.ethMsgProtocol=r.encReqCodes=r.deviceCodes=r.decResLengths=r.addressSizes=r.ENC_MSG_LEN=r.BASE_URL=r.BIP_CONSTANTS=r.AES_IV=r.ADDR_STR_LEN=r.getFwVersionConst=r.ASCII_REGEX=r.EXTERNAL=void 0;r.AES_IV=[109,121,115,101,99,114,101,116,112,97,115,115,119,111,114,100];r.ADDR_STR_LEN=129;var s={empty:0,getAddresses:1290,sign:1090,getWallets:142,addAbiDefs:8,getKvRecords:1395,getAbiRecords:1215,removeAbiRecords:1,test:1646};r.decResLengths=s;var o=0;r.ENC_MSG_LEN=o,Object.keys(s).forEach((function(e){s[e]+82>o&&(r.ENC_MSG_LEN=o=s[e]+82)}));r.deviceCodes={CONNECT:1,ENCRYPTED_REQUEST:2};r.encReqCodes={FINALIZE_PAIRING:0,GET_ADDRESSES:1,ADD_PERMISSION:2,SIGN_TRANSACTION:3,GET_WALLETS:4,ADD_PERMISSION_V0:5,ADD_ABI_DEFS:6,GET_KV_RECORDS:7,ADD_KV_RECORDS:8,REMOVE_KV_RECORDS:9,GET_ABI_RECORDS:10,REMOVE_ABI_RECORDS:11,TEST:12};r.messageConstants={NOT_PAIRED:0,PAIRED:1};r.addressSizes={BTC:20,ETH:20};var a={RESP_SUCCESS:0,RESP_ERR_INVALID_MSG:128,RESP_ERR_UNSUPPORTED_VER:129,RESP_ERR_DEV_BUSY:130,RESP_ERR_USER_TIMEOUT:131,RESP_ERR_USER_DECLINED:132,RESP_ERR_PAIR_FAIL:133,RESP_ERR_PAIR_DISABLED:134,RESP_ERR_PERMISSION_DISABLED:135,RESP_ERR_INTERNAL:136,RESP_ERR_GCE_TIMEOUT:137,RESP_ERR_WRONG_WALLET:138,RESP_ERR_DEV_LOCKED:139,RESP_ERR_DISABLED:140,RESP_ERR_ALREADY:141,RESP_ERR_INVALID_EPHEM_ID:142};r.responseCodes=a;var c=((n={})[a.RESP_SUCCESS]=0,n[a.RESP_ERR_INVALID_MSG]="Invalid request",n[a.RESP_ERR_UNSUPPORTED_VER]="Unsupported version",n[a.RESP_ERR_DEV_BUSY]="Device busy",n[a.RESP_ERR_USER_TIMEOUT]="Timeout waiting for user",n[a.RESP_ERR_USER_DECLINED]="Request declined by user",n[a.RESP_ERR_PAIR_FAIL]="Pairing failed",n[a.RESP_ERR_PAIR_DISABLED]="Pairing is currently disabled",n[a.RESP_ERR_PERMISSION_DISABLED]="Automated signing is currently disabled",n[a.RESP_ERR_INTERNAL]="Device error",n[a.RESP_ERR_GCE_TIMEOUT]="Timeout",n[a.RESP_ERR_WRONG_WALLET]="Active wallet does not match request",n[a.RESP_ERR_DEV_LOCKED]="Device locked",n[a.RESP_ERR_DISABLED]="Disabled",n[a.RESP_ERR_ALREADY]="Record already exists. You must first remove it on your device.",n[a.RESP_ERR_INVALID_EPHEM_ID]="Could not find requester. Please reconnect.",n);r.responseMsgs=c;r.signingSchema={BTC_TRANSFER:0,ETH_TRANSFER:1,ERC20_TRANSFER:2,ETH_MSG:3,EXTRA_DATA:4,GENERAL_SIGNING:5};var u=2147483648;r.HARDENED_OFFSET=u;var l={PURPOSES:{ETH:2147483692,BTC_LEGACY:2147483692,BTC_WRAPPED_SEGWIT:2147483697,BTC_SEGWIT:2147483732},COINS:{ETH:2147483708,BTC:u,BTC_TESTNET:2147483649}};r.BIP_CONSTANTS=l;r.REQUEST_TYPE_BYTE=2;r.VERSION_BYTE=1;r.HANDLE_LARGER_CHAIN_ID=255;r.MAX_CHAIN_ID_BYTES=8;r.BASE_URL="https://signing.gridpl.us";var f={address:1,bool:2,uint8:3,uint16:4,uint24:5,uint32:6,uint40:7,uint48:8,uint56:9,uint64:10,uint72:11,uint80:12,uint88:13,uint96:14,uint104:15,uint112:16,uint120:17,uint128:18,uint136:19,uint144:20,uint152:21,uint160:22,uint168:23,uint176:24,uint184:25,uint192:26,uint200:27,uint208:28,uint216:29,uint224:30,uint232:31,uint240:32,uint248:33,uint256:34,int8:35,int16:36,int24:37,int32:38,int40:39,int48:40,int56:41,int64:42,int72:43,int80:44,int88:45,int96:46,int104:47,int112:48,int120:49,int128:50,int136:51,int144:52,int152:53,int160:54,int168:55,int176:56,int184:57,int192:58,int200:59,int208:60,int216:61,int224:62,int232:63,int240:64,int248:65,int256:66,uint:67,bytes1:69,bytes2:70,bytes3:71,bytes4:72,bytes5:73,bytes6:74,bytes7:75,bytes8:76,bytes9:77,bytes10:78,bytes11:79,bytes12:80,bytes13:81,bytes14:82,bytes15:83,bytes16:84,bytes17:85,bytes18:86,bytes19:87,bytes20:88,bytes21:89,bytes22:90,bytes23:91,bytes24:92,bytes25:93,bytes26:94,bytes27:95,bytes28:96,bytes29:97,bytes30:98,bytes31:99,bytes32:100,bytes:101,string:102},d=i(i({},f),{tuple1:103,tuple2:104,tuple3:105,tuple4:106,tuple5:107,tuple6:108,tuple7:109,tuple8:110,tuple9:111,tuple10:112,tuple11:113,tuple12:114,tuple13:115,tuple14:116,tuple15:117,tuple16:118,tuple17:119});r.ETH_ABI_LATTICE_FW_TYPE_MAP=d;var h={SIGN_PERSONAL:{str:"signPersonal",enumIdx:0},TYPED_DATA:{str:"typedData",enumIdx:1,rawDataMaxLen:1629,typeCodes:f}};r.ethMsgProtocol=h,r.EXTERNAL={GET_ADDR_FLAGS:{SECP256K1_PUB:3,ED25519_PUB:4},SIGNING:{HASHES:{NONE:0,KECCAK256:1,SHA256:2},CURVES:{SECP256K1:0,ED25519:1},ENCODINGS:{NONE:1,SOLANA:2,TERRA:3,EVM:4}}},r.getFwVersionConst=function(e){var t={extraDataFrameSz:0,extraDataMaxFrames:0,genericSigning:{}};function n(e,t){return e[2]>t[0]||e[2]===t[0]&&e[1]>t[1]||e[2]===t[0]&&e[1]===t[1]&&e[0]>t[2]||e[2]===t[0]&&e[1]===t[1]&&e[0]===t[2]}var i=0===e.length;return!i&&n(e,[0,10,4])||!i&&n(e,[0,10,0])?(t.reqMaxDataSz=1678,t.ethMaxGasPrice=2e13,t.addrFlagsAllowed=!0):(t.reqMaxDataSz=1152,t.ethMaxGasPrice=5e11,t.addrFlagsAllowed=!1),t.ethMaxDataSz=t.reqMaxDataSz-128,t.ethMaxMsgSz=t.ethMaxDataSz,t.eip712MaxTypeParams=18,!i&&n(e,[0,10,4])&&(t.extraDataFrameSz=1500,t.extraDataMaxFrames=1),!i&&n(e,[0,10,5])&&(t.varAddrPathSzAllowed=!0,t.eip712Supported=!0),!i&&n(e,[0,10,8])&&(t.prehashAllowed=!0),!i&&n(e,[0,10,10])&&(t.ethMsgPreHashAllowed=!0),!i&&n(e,[0,11,0])&&(t.allowedEthTxTypes=[1,2],t.ethMaxDataSz-=10,t.ethMaxMsgSz=t.ethMaxDataSz),!i&&n(e,[0,11,2])&&(t.personalSignHeaderSz=72),!i&&n(e,[0,12,0])&&(t.kvActionsAllowed=!0,t.kvKeyMaxStrSz=63,t.kvValMaxStrSz=63,t.kvActionMaxNum=10,t.kvRemoveMaxNum=100),!i&&n(e,[0,13,0])&&(t.allowBtcLegacyAndSegwitAddrs=!0,t.contractDeployKey="0x08002e0fec8e6acf00835f43c9764f7364fa3f42"),!i&&n(e,[0,14,0])&&(t.abiCategorySz=32,t.abiMaxRmv=200,t.genericSigning.baseReqSz=1552,t.genericSigning.baseDataSz=1519,t.genericSigning.hashTypes=r.EXTERNAL.SIGNING.HASHES,t.genericSigning.curveTypes=r.EXTERNAL.SIGNING.CURVES,t.genericSigning.encodingTypes={NONE:r.EXTERNAL.SIGNING.ENCODINGS.NONE,SOLANA:r.EXTERNAL.SIGNING.ENCODINGS.SOLANA},t.getAddressFlags=[r.EXTERNAL.GET_ADDR_FLAGS.ED25519_PUB,r.EXTERNAL.GET_ADDR_FLAGS.SECP256K1_PUB],t.eip712MaxTypeParams=36),!i&&n(e,[0,14,1])&&(t.genericSigning.encodingTypes.TERRA=r.EXTERNAL.SIGNING.ENCODINGS.TERRA),!i&&n(e,[0,15,0])&&(t.genericSigning.encodingTypes.EVM=r.EXTERNAL.SIGNING.ENCODINGS.EVM,t.ethMaxDataSz=1519),t};r.ASCII_REGEX=/^[\x00-\x7F]+$/}}},{package:"gridplus-sdk",file:"/home/circleci/project/node_modules/gridplus-sdk/dist/constants.js"}],[4400,{"./bitcoin":4399,"./constants":4401,"./ethereum":4402,"./ethereumAbi":4403,"./genericSigning":4404,"./index":4405,"./util":4406,bitwise:2081,"buffer/":2172,"hash.js/lib/hash/sha":4444,superagent:5979},function(){with(this)return function(){"use strict";return function(e,t,r){var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},n.apply(this,arguments)},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.Client=void 0;var s=i(e("bitwise")),o=e("buffer/"),a=i(e("superagent")),c=i(e("./bitcoin")),u=e("hash.js/lib/hash/sha"),l=e("./index"),f=e("./constants"),d=i(e("./ethereum")),h=e("./ethereumAbi"),p=e("./genericSigning"),m=e("./util"),g=o.Buffer.alloc(32),y=function(){function e(e){var t=e.baseUrl,r=e.name,n=e.privKey,i=e.stateData,s=e.timeout,o=e.retryCount,a=e.skipRetryOnWrongWallet;if(this.ephemeralPub=null,this.deviceId=null,this.isPaired=!1,this.activeWallets={internal:{uid:g,name:null,capabilities:null,external:!1},external:{uid:g,name:null,capabilities:null,external:!0}},this.skipRetryOnWrongWallet=a||!1,i)this._unpackAndApplyStateData(i);else{if(this.baseUrl=t||f.BASE_URL,r&&(r.length<5||r.length>24))throw new Error("`name` must be 5-24 characters");this.name=r||"Unknown",this.privKey=n||(0,m.randomBytes)(32),this.key=(0,m.getP256KeyPair)(this.privKey),this.retryCount=o||3,this.timeout=s||6e4}}return e.prototype.getStateData=function(){return this._packStateData()},e.prototype.getFwVersion=function(){return this.fwVersion&&this.fwVersion.length>=3?{fix:this.fwVersion[0],minor:this.fwVersion[1],major:this.fwVersion[2]}:null},e.prototype.connect=function(e,t){var r=this;return new Promise((function(n,i){var s=(0,m.promisifyCb)(n,i,t);if("function"==typeof e){if(!r.deviceId)return s("No device ID has been stored. Please connect with your device ID first.");s=e}else r.deviceId=e;var o=r._buildRequest(f.deviceCodes.CONNECT,r.pubKeyBytes());r._request(o,null,(function(e,t){return e?s(e):(r.isPaired=r._handleConnect(t)||!1,!r.isPaired||r._fwVersionGTE(0,14,1)?s(e,r.isPaired):void r.fetchActiveWallet((function(e){return s(e,r.isPaired)})))}))}))},e.prototype.pair=function(e,t){var r=this;return new Promise((function(n,i){var s=(0,m.promisifyCb)(n,i,t),a=r.pubKeyBytes(),c=o.Buffer.alloc(25);if(r.name.length<5||r.name.length>24)return s("Invalid length for name provided. Must be 5-24 characters.");e.length>0&&c.write(r.name);var l=o.Buffer.concat([a,c,o.Buffer.from(e)]),f=o.Buffer.from((0,u.sha256)().update(l).digest("hex"),"hex"),d=r.key.sign(f),h=(0,m.toPaddedDER)(d),p=o.Buffer.concat([c,h]);r._request(p,"FINALIZE_PAIRING",(function(e,t){if(e)return s(e);var n=r._handlePair(t);if(n)return s(n);r.fetchActiveWallet((function(e){return e?s(e):s(null,r.hasActiveWallet())}))}))}))},e.prototype.test=function(e,t){var r=this;return new Promise((function(n,i){var s=(0,m.promisifyCb)(n,i,t);if(!e.payload)return s("First argument must contain `testID` and `payload` fields.");var a=o.Buffer.alloc(506);a.writeUInt32BE(e.testID,0),a.writeUInt16BE(e.payload.length,4),e.payload.copy(a,6),r._request(a,"TEST",(function(e,t){if(e)return s(e);var n=r._handleEncResponse(t,f.decResLengths.test);return null!==n.err?s(n.err):s(null,n.data.slice(65))}))}))},e.prototype.getAddresses=function(e,t){var r=this;return new Promise((function(n,i){var a=(0,m.promisifyCb)(n,i,t),c=e.startPath,u=e.n,l=e.flag,d=void 0===l?0:l;if(c===undefined||u===undefined)return a("Please provide `startPath` and `n` options");if(c.length<2||c.length>5)return a("Path must include between 2 and 5 indices");if(u>10)return a("You may only request ".concat(10," addresses at once."));var h=(0,f.getFwVersionConst)(r.fwVersion);if(!(0,m.isValidAssetPath)(c,h))return a("Parent derivation path is not supported");var p=53;if(h.varAddrPathSzAllowed)p+=1;else if(5!==c.length)return a("Your Lattice firmware only supports derivation paths with 5 indices. Please upgrade.");var g=o.Buffer.alloc(p),y=0,b=r.getActiveWallet();if(null===b)return a("No active wallet.");b.uid.copy(g,y),y+=32,h.varAddrPathSzAllowed&&(g.writeUInt8(c.length,y),y+=1);for(var v=0;v<5;v++)v<=c.length&&g.writeUInt32BE(c[v],y),y+=4;var w,_=0;if(h.addrFlagsAllowed){_=h.getAddressFlags&&h.getAddressFlags.indexOf(d)>-1?d:0;var E=s.default.nibble.read(_),k=s.default.nibble.read(u);w=s.default.byte.write(E.concat(k))}else w=u;return g.writeUInt8(w,y),y++,r._request(g,"GET_ADDRESSES",(function(e,t){if(e)return a(e);var n=r._handleGetAddresses(t,_);return n.err?a(n.err):a(null,n.data)}))}))},e.prototype.sign=function(e,t,r,i){var s=this;return void 0===r&&(r=null),void 0===i&&(i=null),new Promise((function(a,u){var l=(0,m.promisifyCb)(a,u,t),h=e.data;if(!h)return l("You must provide `data`");var g,y,b,v=(0,f.getFwVersionConst)(s.fwVersion);h=n({fwConstants:v},h);var w=null;if(null!==r&&null!==i)w=r.currency,g=r,y=o.Buffer.concat([i,g.extraDataPayloads.shift()]),b=f.signingSchema.EXTRA_DATA;else{w=e.currency;try{var _=v.genericSigning&&v.genericSigning.encodingTypes&&v.genericSigning.encodingTypes.EVM;if("ETH"===w&&_){var E;console.warn("Using the legacy ETH signing path. This will soon be deprecated. "+"Please switch to general signing request.");try{E=d.default.ethConvertLegacyToGenericReq(h)}catch(e){return l("Could not convert legacy request. Please switch to a general signing "+"request. See gridplus-sdk docs for more information.")}h={fwConstants:v,encodingType:f.EXTERNAL.SIGNING.ENCODINGS.EVM,curveType:f.EXTERNAL.SIGNING.CURVES.SECP256K1,hashType:f.EXTERNAL.SIGNING.HASHES.KECCAK256,signerPath:h.signerPath,payload:E},w=null}g="ETH"===w?d.default.buildEthereumTxRequest(h):"ETH_MSG"===w?d.default.buildEthereumMsgRequest(h):"BTC"===w?c.default.buildBitcoinTxRequest(h):(0,p.buildGenericSigningMsgRequest)(h)}catch(e){return l("Error building signing request: ".concat(e.message))}if(g.err!==undefined)return l(g.err);if(g.payload.length>v.reqMaxDataSz)return l("Transaction is too large");y=g.payload,b=g.schema}var k=o.Buffer.alloc(2+v.reqMaxDataSz),S=0,A=g.extraDataPayloads&&Number(g.extraDataPayloads.length>0);k.writeUInt8(A,S),S+=1,k.writeUInt8(b,S),S+=1;var T=s.getActiveWallet();return null===T?l("No active wallet."):(T.uid.copy(k,S),S+=T.uid.length,y.copy(k,S),s._request(k,"SIGN_TRANSACTION",(function(t,n){if(t){if(t)return l(t)}else{if(A){var o=s._handleEncResponse(n,f.decResLengths.sign);return i=o.data.slice(65,73),r||((r=g).currency=w),s.sign(e,l,r,i)}try{var a=s._handleSign(n,w,g);return l(null,a)}catch(t){return l(t.message)}}})))}))},e.prototype.addAbiDefs=function(e,t,r){var n=this;return void 0===r&&(r=null),new Promise((function(i,s){var a,c=(0,m.promisifyCb)(i,s,t),u=e.slice(0,h.MAX_ABI_DEFS);e=e.slice(h.MAX_ABI_DEFS);try{a=(0,h.buildAddAbiPayload)(u)}catch(e){return c(e)}var l=o.Buffer.alloc(a.length+10);return l.writeUInt16LE(e.length,0),null!==r&&r.copy(l,2),a.copy(l,10),n._request(l,"ADD_ABI_DEFS",(function(t,i,s){if(s&&s!==f.responseCodes.RESP_SUCCESS)return c("Error making request.");if(t)return c(t);var o=n._handleEncResponse(i,f.decResLengths.addAbiDefs);if(r=o.data.slice(65,73),0===e.length)return c(null);n.addAbiDefs(e,c,r)}))}))},e.prototype.getAbiRecords=function(e,t,r){var n=this;return new Promise((function(i,s){var a=(0,m.promisifyCb)(i,s,t),c=e.n,u=void 0===c?1:c,l=e.startIdx,d=void 0===l?0:l,p=e.category,g=void 0===p?"":p,y=(0,f.getFwVersionConst)(n.fwVersion);if(u<1)return a("Must request at least one record (n=0)");if(u<0||d<0)return a("Both `n` and `startIdx` must be >=0");if(!y.abiCategorySz)return a("Outdated Lattice firmware. Please update.");if(g.length>=y.abiCategorySz)return a("category must be <".concat(y.abiCategorySz-1," characters, got ").concat(g.length));r||(r={startIdx:d,numRemaining:null,numFetched:null,records:[]});var b=o.Buffer.alloc(4+y.abiCategorySz);return b.writeUInt16LE(d,0),b.writeUInt16LE(u,2),o.Buffer.from(g).copy(b,4),n._request(b,"GET_ABI_RECORDS",(function(t,i){if(t)return a(t);var s=n._handleEncResponse(i,f.decResLengths.getAbiRecords);if(s.err)return a(s.err);var o=65,c=s.data.readUInt32LE(o);o+=4;var u=s.data.readUInt8(o);o+=1,r.numRemaining=c,r.records||(r.records=[]);for(var l=0;l<u;l++){var d=s.data.slice(o,o+h.ABI_DEF_SZ);o+=h.ABI_DEF_SZ,r.records.push((0,h.unpackAbiDef)(d))}return e.n-=u,e.n<1||u<1?(r.numFetched=r.records.length,a(null,r)):(e.startIdx+=u,n.getAbiRecords(e,a,r))}))}))},e.prototype.removeAbiRecords=function(e,t,r){var n=this;return void 0===r&&(r={numRemoved:0,numTried:0}),new Promise((function(i,s){var a=(0,m.promisifyCb)(i,s,t),c=e.sigs,u=(0,f.getFwVersionConst)(n.fwVersion);if(!u.abiMaxRmv)return a("Outdated Lattice firmware. Please update.");if(0===c.length)return a("At least one signature in `sigs` must be provided.");var l=c.slice(r.numTried,r.numTried+u.abiMaxRmv),h=o.Buffer.alloc(1+4*u.abiMaxRmv),p=0;return h.writeUInt8(l.length,p),p+=1,l.forEach((function(e){try{var t=d.default.ensureHexBuffer(e);if(4!==t.length)return a("Signatures must be 4 bytes.");t.copy(h,p),p+=4}catch(e){return a("Error writing signature: ".concat(e.message))}})),n._request(h,"REMOVE_ABI_RECORDS",(function(t,i){if(t)return a(t);var s=n._handleEncResponse(i,f.decResLengths.removeAbiRecords);if(s.err)return a(s.err);var o=65,c=s.data.readUInt8(o);return o+=1,r.numRemoved+=c,r.numTried+=l.length,r.numTried>=e.sigs.length?a(null,r):n.removeAbiRecords(e,a,r)}))}))},e.prototype.addPermissionV0=function(e,t){var r=this;return new Promise((function(n,i){var s=(0,m.promisifyCb)(n,i,t),a=e.currency,c=e.timeWindow,u=e.limit,l=e.decimals,h=e.asset;if(!a||c===undefined||u===undefined||l===undefined||null===c||null===u||null===l)return s("currency, timeWindow, decimals, and limit are all required options.");if(0===c||0===u)return s("Time window and spending limit must be positive.");var p=a;h&&(p+="_".concat(h));var g=o.Buffer.alloc(293);if(o.Buffer.from(p).length>255)return s("Asset name too long.");o.Buffer.from(p).copy(g,0);var y=d.default.ensureHexBuffer(u);return y.length>32?s("Limit too large."):(y.copy(g,32-y.length+256),g.writeUInt32BE(c,288),g.writeUInt8(l,292),r._request(g,"ADD_PERMISSION_V0",(function(e,t){if(!e){var n=r._handleEncResponse(t,f.decResLengths.empty);return n.err?s(n.err):s(null)}if(e)return s(e)})))}))},e.prototype.getKvRecords=function(e,t){var r=this;return new Promise((function(n,i){var s=(0,m.promisifyCb)(n,i,t),a=e.type,c=void 0===a?0:a,u=e.n,l=void 0===u?1:u,d=e.start,h=void 0===d?0:d,p=(0,f.getFwVersionConst)(r.fwVersion);if(!p.kvActionsAllowed)return s("Unsupported. Please update firmware.");if(l<1)return s("You must request at least one record.");if(l>p.kvActionMaxNum)return s("You may only request up to ".concat(p.kvActionMaxNum," records at once."));var g=o.Buffer.alloc(9);return g.writeUInt32LE(c,0),g.writeUInt8(l,4),g.writeUInt32LE(h,5),r._request(g,"GET_KV_RECORDS",(function(e,t){if(!e){var n=r._handleEncResponse(t,f.decResLengths.getKvRecords);if(n.err)return s(n.err);var i=65,o=parseInt(n.data.slice(i,i+4).toString("hex"),16);i+=4;var a=parseInt(n.data.slice(i,i+1).toString("hex"),16);if(i+=1,a>p.kvActionMaxNum)return s("Too many records fetched. Firmware error.");for(var c=[],u=0;u<a;u++){var l={};l.id=parseInt(n.data.slice(i,i+4).toString("hex"),16),i+=4,l.type=parseInt(n.data.slice(i,i+4).toString("hex"),16),i+=4,l.caseSensitive=1===parseInt(n.data.slice(i,i+1).toString("hex"),16),i+=1;var d=parseInt(n.data.slice(i,i+1).toString("hex"),16);i+=1,l.key=n.data.slice(i,i+d-1).toString(),i+=p.kvKeyMaxStrSz+1;var h=parseInt(n.data.slice(i,i+1).toString("hex"),16);i+=1,l.val=n.data.slice(i,i+h-1).toString(),i+=p.kvValMaxStrSz+1,c.push(l)}return s(null,{records:c,total:o,fetched:a})}if(e)return s(e)}))}))},e.prototype.addKvRecords=function(e,t){var r=this;return new Promise((function(n,i){var s=(0,m.promisifyCb)(n,i,t),a=e.type,c=void 0===a?0:a,u=e.records,l=void 0===u?{}:u,d=e.caseSensitive,h=void 0!==d&&d,p=(0,f.getFwVersionConst)(r.fwVersion);if(!p.kvActionsAllowed)return s("Unsupported. Please update firmware.");if("object"!=typeof l||0===Object.keys(l).length)return s("One or more key-value mapping must be provided in `records` param.");if(Object.keys(l).length>p.kvActionMaxNum)return s("Too many keys provided. Please only provide up to ".concat(p.kvActionMaxNum,"."));if(Object.keys(l).length<1)return s("You must provide at least one key to add.");var g=o.Buffer.alloc(1+139*p.kvActionMaxNum);g.writeUInt8(Object.keys(l).length,0);var y=1;try{Object.keys(l).forEach((function(e){if("string"!=typeof e||String(e).length>p.kvKeyMaxStrSz)throw new Error("Key ".concat(e," too large. Must be <=").concat(p.kvKeyMaxStrSz," characters."));if("string"!=typeof l[e]||String(l[e]).length>p.kvValMaxStrSz)throw new Error("Value ".concat(l[e]," too large. Must be <=").concat(p.kvValMaxStrSz," characters."));if(0===String(e).length||0===String(l[e]).length)throw new Error("Keys and values must be >0 characters.");if(!f.ASCII_REGEX.test(e)||!f.ASCII_REGEX.test(l[e]))throw new Error("Unicode characters are not supported.");g.writeUInt32LE(0,y),y+=4,g.writeUInt32LE(c,y),y+=4,g.writeUInt8(h?1:0,y),y+=1,g.writeUInt8(String(e).length+1,y),y+=1,o.Buffer.from(String(e)).copy(g,y),y+=p.kvKeyMaxStrSz+1,g.writeUInt8(String(l[e]).length+1,y),y+=1,o.Buffer.from(String(l[e])).copy(g,y),y+=p.kvValMaxStrSz+1}))}catch(e){return s("Error building request: ".concat(e.message))}return r._request(g,"ADD_KV_RECORDS",(function(e,t){if(!e){var n=r._handleEncResponse(t,f.decResLengths.empty);return n.err?s(n.err):s(null)}if(e)return s(e)}))}))},e.prototype.removeKvRecords=function(e,t){var r=this;return new Promise((function(n,i){var s=(0,m.promisifyCb)(n,i,t),a=e.type,c=void 0===a?0:a,u=e.ids,l=void 0===u?[]:u,d=(0,f.getFwVersionConst)(r.fwVersion);if(!d.kvActionsAllowed)return s("Unsupported. Please update firmware.");if(!Array.isArray(l)||l.length<1)return s("You must include one or more `ids` to removed.");if(l.length>d.kvRemoveMaxNum)return s("Only up to ".concat(d.kvRemoveMaxNum," records may be removed at once."));var h=o.Buffer.alloc(5+4*d.kvRemoveMaxNum);h.writeUInt32LE(c,0),h.writeUInt8(l.length,4);for(var p=0;p<l.length;p++)h.writeUInt32LE(l[p],5+4*p);return r._request(h,"REMOVE_KV_RECORDS",(function(e,t){if(!e){var n=r._handleEncResponse(t,f.decResLengths.empty);return n.err?s(n.err):s(null)}if(e)return s(e)}))}))},e.prototype.fetchActiveWallet=function(e){var t=this;return new Promise((function(r,n){var i=(0,m.promisifyCb)(r,n,e),s=o.Buffer.alloc(0);return t._request(s,"GET_WALLETS",(function(e,r){return e?(t._resetActiveWallets(),i(e)):i(t._handleGetWallets(r))}))}))},e.prototype._getSharedSecret=function(){return o.Buffer.from(this.key.derive(this.ephemeralPub.getPublic()).toArray("be",32))},e.prototype._getEphemId=function(){if(null===this.ephemeralPub)return null;var e=this._getSharedSecret();return o.Buffer.from((0,u.sha256)().update(e).digest("hex"),"hex").slice(0,4)},e.prototype._buildEncRequest=function(e,t){var r=parseInt(this._getEphemId().toString("hex"),16),n=o.Buffer.concat([o.Buffer.from([e]),t]),i=(0,m.checksum)(n),s=o.Buffer.alloc(n.length+4);n.copy(s,0),s.writeUInt32LE(i,n.length);var a=this._getSharedSecret(),c=(0,m.aes256_encrypt)(s,a),u=o.Buffer.alloc(f.ENC_MSG_LEN+4);return u.writeUInt32LE(r,0),c.copy(u,4),this._buildRequest(f.deviceCodes.ENCRYPTED_REQUEST,u)},e.prototype._buildRequest=function(e,t){var r=t&&o.Buffer.isBuffer(t)?t.length+1:1;e===f.deviceCodes.ENCRYPTED_REQUEST&&(r=1+t.length);var n=0,i=o.Buffer.alloc(r+8);n=i.writeUInt8(f.VERSION_BYTE,n),n=i.writeUInt8(f.REQUEST_TYPE_BYTE,n);var s=(0,m.randomBytes)(4);n=i.writeUInt32BE(parseInt("0x".concat(s.toString("hex"))),n),n=i.writeUInt16BE(r,n),n=i.writeUInt8(e,n),r>1&&(n=t.copy(i,n));var a=(0,m.checksum)(i),c=o.Buffer.alloc(i.length+4);return n=i.copy(c),c.writeUInt32BE(a,n),c},e.prototype._request=function(e,t,r,n){var i=this;if(void 0===n&&(n=this.retryCount),!this.deviceId)return r("Device ID is not set. Please set it and try again.");if(t&&f.encReqCodes[t]===undefined)return r("Unknown encrypted request code.");var s=t?this._buildEncRequest(f.encReqCodes[t],e):e,o="".concat(this.baseUrl,"/").concat(this.deviceId);a.default.post(o).timeout(this.timeout).send({data:s}).then((function(s){if(!s||!s.body)return r("Invalid response: ".concat(s));if(200!==s.body.status)return r("Error code ".concat(s.body.status,": ").concat(s.body.message));var o=(0,m.parseLattice1Response)(s.body.message),a=o.responseCode===f.responseCodes.RESP_ERR_DEV_BUSY||o.responseCode===f.responseCodes.RESP_ERR_GCE_TIMEOUT,c=o.responseCode===f.responseCodes.RESP_ERR_WRONG_WALLET,u=o.responseCode===f.responseCodes.RESP_ERR_INVALID_EPHEM_ID,l=n>0;if(l&&a)setTimeout((function(){i._request(e,t,r,n-1)}),3e3);else if(l&&u)i.connect(i.deviceId,(function(s,o){return s?r(s):o?void i._request(e,t,r,n-1):r("Not paired to device.")}));else if(l&&c&&!i.skipRetryOnWrongWallet)i._resetActiveWallets(),i.fetchActiveWallet().then((function(){if(!(e=i._replaceWalletUID(t,e)))return r("Wrong wallet. Failed to switch. Please reconnect.");i._request(e,t,r,0)})).catch((function(e){return r(e)}));else if(o.responseCode||o.err){if(o.err)return r(o.err);r(f.responseMsgs[o.responseCode]||"Unknown request failure")}else r(null,o.data,o.responseCode)})).catch((function(e){var t="ECONNABORTED"===e.code&&"ETIME"===e.errno;return r(t?"Timeout waiting for device. Please ensure it is connected to the internet and try again in a minute.":"Failed to make request to device: ".concat(e.message))}))},e.prototype._handleConnect=function(e){var t=0,r=e.readUInt8(t)===f.messageConstants.PAIRED;t++;var n=e.slice(t,t+65).toString("hex");if(t+=65,this.fwVersion=e.slice(t,t+4),t+=4,this.ephemeralPub=(0,m.getP256KeyPairFromPub)(n),r&&this._fwVersionGTE(0,14,1)){var i=e.slice(t,t+160);t+=160;var s=this._getSharedSecret(),o=(0,m.aes256_decrypt)(i,s);if(0!==o[o.length-2]||0!==o[o.length-1])throw new Error("Failed to connect to Lattice.");this._parseAndAddWallets(o)}return r},e.prototype._handleEncResponse=function(e,t){var r=this._getSharedSecret(),n=e.slice(0,f.ENC_MSG_LEN),i=(0,m.aes256_decrypt)(n,r);t+=65;var s=i.slice(0,t),o=parseInt("0x".concat(i.slice(t,t+4).toString("hex"))),a=(0,m.checksum)(s);if(o!==a)return{err:"Checksum mismatch in response from Lattice (calculated ".concat(a,", wanted ").concat(o,")")};var c=i.slice(0,65).toString("hex");try{return this.ephemeralPub=(0,m.getP256KeyPairFromPub)(c),{err:null,data:i}}catch(e){return{err:"Error handling getAddresses response: ".concat(e.toString())}}},e.prototype._handlePair=function(e){var t=this._handleEncResponse(e,f.decResLengths.empty);return t.err?t.err:(this.isPaired=!0,null)},e.prototype._handleGetAddresses=function(e,t){var r=this._handleEncResponse(e,f.decResLengths.getAddresses);if(null!==r.err)return r;var n=r.data,i=65,s=[],o=l.Constants.GET_ADDR_FLAGS,a=o.ED25519_PUB,c=o.SECP256K1_PUB,u=t===a||t===c;for(u&&(i+=1);i+4<f.decResLengths.getAddresses;)if(u){var d=n.slice(i,i+65),h=d.every((function(e){return 0===e}));h||t!==a?h||s.push(d):s.push(d.slice(0,32)),i+=65}else{var p=n.slice(i,i+f.ADDR_STR_LEN);i+=f.ADDR_STR_LEN;var m=p.indexOf(0);m>0&&s.push(p.slice(0,m).toString())}return{data:s,err:null}},e.prototype._handleGetWallets=function(e){var t=this._handleEncResponse(e,f.decResLengths.getWallets);if(null!==t.err)return t;var r=t.data;return this._parseAndAddWallets(r.slice(65)),this.activeWallets.internal.uid.equals(g)&&this.activeWallets.external.uid.equals(g)?"No active wallet.":null},e.prototype._parseAndAddWallets=function(e){var t=0;this.activeWallets.internal.uid=e.slice(t,t+32),this.activeWallets.internal.capabilities=e.readUInt32BE(t+32),this.activeWallets.internal.name=e.slice(t+36,t+71),t+=71,this.activeWallets.external.uid=e.slice(t,t+32),this.activeWallets.external.capabilities=e.readUInt32BE(t+32),this.activeWallets.external.name=e.slice(t+36,t+71)},e.prototype._handleSign=function(e,t,r){void 0===r&&(r=null);var n=this._handleEncResponse(e,f.decResLengths.sign);if(null!==n.err)return{err:n.err};var i,s=65,a=n.data;if("BTC"===t){var l=c.default.getAddressFormat(r.origData.changePath),h=a.slice(s,s+20);s+=20,i=c.default.getBitcoinAddress(h,l)}if("BTC"===t){for(var g=[],y=[],b=0;s<a.length&&48===a[s];){var v=s,w=s+2+a[s+1];y.push(a.slice(v,w));var _=33*b+825,E=33*(b+1)+825;g.push(a.slice(_,E)),s+=74,b+=1}var k={inputs:[],outputs:[]};k.outputs.push({value:r.origData.value,recipient:r.origData.recipient}),r.changeData.value>0&&k.outputs.push({value:r.changeData.value,recipient:i});for(var S=0;S<y.length;S++)k.inputs.push({hash:r.origData.prevOuts[S].txHash,index:r.origData.prevOuts[S].index,sig:y[S],pubkey:g[S],signerPath:r.origData.prevOuts[S].signerPath});var A=c.default.serializeTx(k),T=A,I=o.Buffer.from((0,u.sha256)().update(o.Buffer.from(T,"hex")).digest("hex"),"hex");return{tx:A,txHash:(0,u.sha256)().update(I).digest("hex"),changeRecipient:i,sigs:y}}if("ETH"===t){var C=(0,m.parseDER)(a.slice(s,s+2+a[s+1]));s+=74;var x=a.slice(s,s+20),P=d.default.buildEthRawTx(r,C,x),O=P.rawTx,R=P.sigWithV;return{tx:"0x".concat(O),txHash:"0x".concat(d.default.hashTransaction(O)),sig:{v:R.v,r:R.r.toString("hex"),s:R.s.toString("hex")},signer:x}}if("ETH_MSG"===t){C=(0,m.parseDER)(a.slice(s,s+2+a[s+1]));s+=74;var N=a.slice(s,s+20),M=d.default.validateEthereumMsgResponse({signer:N,sig:C},r);return{sig:{v:M.v,r:M.r.toString("hex"),s:M.s.toString("hex")},signer:N}}return(0,p.parseGenericSigningResponse)(a,s,r.curveType,r.omitPubkey)},e.prototype._resetActiveWallets=function(){this.activeWallets.internal.uid=g,this.activeWallets.internal.name=null,this.activeWallets.internal.capabilities=null,this.activeWallets.external.uid=g,this.activeWallets.external.name=null,this.activeWallets.external.capabilities=null},e.prototype._replaceWalletUID=function(e,t){var r=this.getActiveWallet();return r?"GET_ADDRESSES"===e?(r.uid.copy(t,0),t):"SIGN_TRANSACTION"===e?(r.uid.copy(t,2),t):null:null},e.prototype._packStateData=function(){try{var e={activeWallets:{internal:{uid:this.activeWallets.internal.uid.toString("hex"),name:this.activeWallets.internal.name.toString(),capabilities:this.activeWallets.internal.capabilities},external:{uid:this.activeWallets.external.uid.toString("hex"),name:this.activeWallets.external.name.toString(),capabilities:this.activeWallets.external.capabilities}},ephemeralPub:this.ephemeralPub.getPublic().encode("hex"),fwVersion:this.fwVersion.toString("hex"),deviceId:this.deviceId,name:this.name,baseUrl:this.baseUrl,privKey:this.privKey.toString("hex"),retryCount:this.retryCount,timeout:this.timeout};return JSON.stringify(e)}catch(e){return console.warn("Could not pack state data."),null}},e.prototype._unpackAndApplyStateData=function(e){try{var t=JSON.parse(e),r={uid:o.Buffer.from(t.activeWallets.internal.uid,"hex"),name:o.Buffer.from(t.activeWallets.internal.name),capabilities:t.activeWallets.internal.capabilities,external:!1},n={uid:o.Buffer.from(t.activeWallets.external.uid,"hex"),name:o.Buffer.from(t.activeWallets.external.name),capabilities:t.activeWallets.external.capabilities,external:!0},i=o.Buffer.from(t.ephemeralPub,"hex"),s=o.Buffer.from(t.fwVersion,"hex"),a=o.Buffer.from(t.privKey,"hex");this.activeWallets.internal=r,this.activeWallets.external=n,this.ephemeralPub=(0,m.getP256KeyPairFromPub)(i),this.fwVersion=s,this.deviceId=t.deviceId,this.name=t.name,this.baseUrl=t.baseUrl,this.privKey=a,this.key=(0,m.getP256KeyPair)(this.privKey),this.retryCount=t.retryCount,this.timeout=t.timeout}catch(e){console.warn("Could not apply state data.")}},e.prototype._fwVersionGTE=function(e,t,r){var n=this.getFwVersion(),i=n.major,s=n.minor,o=n.fix;return i>e||i>=e&&s>t||i>=e&&s>=t&&o>=r},e.prototype.getActiveWallet=function(){return g.equals(this.activeWallets.external.uid)?g.equals(this.activeWallets.internal.uid)?null:this.activeWallets.internal:this.activeWallets.external},e.prototype.hasActiveWallet=function(){return null!==this.getActiveWallet()},e.prototype.pubKeyBytes=function(e){void 0===e&&(e=!1);var t=this.key.getPublic().encode("hex"),r=o.Buffer.from(t,"hex");if(!0===e){var n=r.slice(1,33).reverse(),i=r.slice(33,65).reverse();return o.Buffer.concat([r[0],n,i])}return r},e.prototype.parseAbi=function(e,t,r){return void 0===r&&(r=!1),"etherscan"===e?h.abiParsers[e](t,r):{err:"No ".concat(e," parser available.")}},e}();r.Client=y}}},{package:"gridplus-sdk",file:"/home/circleci/project/node_modules/gridplus-sdk/dist/client.js"}],[2557,{"./lib":2561,"./lib/elliptic":2560},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=e("./lib")(e("./lib/elliptic"))}}},{package:"secp256k1",file:"/home/circleci/project/node_modules/eth-trezor-keyring/node_modules/secp256k1/elliptic.js"}],[6047,{"./account":6042,"./api":6043,"./backend/blockchain":6044,"./backend/transactions":6045,"./events":6046,"./misc":6048,"./networks/binance":6049,"./networks/bitcoin":6050,"./networks/cardano":6051,"./networks/coinInfo":6052,"./networks/eos":6053,"./networks/ethereum":6054,"./networks/nem":6055,"./networks/ripple":6056,"./networks/stellar":6057,"./networks/tezos":6058,"./params":6059,"./trezor/device":6060,"./trezor/management":6061},function(){with(this)return function(){"use strict";return function(e,t,r){r.__esModule=!0;var n=e("./api");Object.keys(n).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in r&&r[e]===n[e]||(r[e]=n[e]))}));var i=e("./events");Object.keys(i).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in r&&r[e]===i[e]||(r[e]=i[e]))}));var s=e("./misc");Object.keys(s).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in r&&r[e]===s[e]||(r[e]=s[e]))}));var o=e("./params");Object.keys(o).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in r&&r[e]===o[e]||(r[e]=o[e]))}));var a=e("./account");Object.keys(a).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in r&&r[e]===a[e]||(r[e]=a[e]))}));var c=e("./trezor/device");Object.keys(c).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in r&&r[e]===c[e]||(r[e]=c[e]))}));var u=e("./trezor/management");Object.keys(u).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in r&&r[e]===u[e]||(r[e]=u[e]))}));var l=e("./networks/bitcoin");Object.keys(l).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in r&&r[e]===l[e]||(r[e]=l[e]))}));var f=e("./networks/binance");Object.keys(f).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in r&&r[e]===f[e]||(r[e]=f[e]))}));var d=e("./networks/cardano");Object.keys(d).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in r&&r[e]===d[e]||(r[e]=d[e]))}));var h=e("./networks/coinInfo");Object.keys(h).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in r&&r[e]===h[e]||(r[e]=h[e]))}));var p=e("./networks/eos");Object.keys(p).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in r&&r[e]===p[e]||(r[e]=p[e]))}));var m=e("./networks/ethereum");Object.keys(m).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in r&&r[e]===m[e]||(r[e]=m[e]))}));var g=e("./networks/nem");Object.keys(g).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in r&&r[e]===g[e]||(r[e]=g[e]))}));var y=e("./networks/ripple");Object.keys(y).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in r&&r[e]===y[e]||(r[e]=y[e]))}));var b=e("./networks/stellar");Object.keys(b).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in r&&r[e]===b[e]||(r[e]=b[e]))}));var v=e("./networks/tezos");Object.keys(v).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in r&&r[e]===v[e]||(r[e]=v[e]))}));var w=e("./backend/blockchain");Object.keys(w).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in r&&r[e]===w[e]||(r[e]=w[e]))}));var _=e("./backend/transactions");Object.keys(_).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in r&&r[e]===_[e]||(r[e]=_[e]))}))}}},{package:"trezor-connect",file:"/home/circleci/project/node_modules/trezor-connect/lib/types/index.js"}],[6026,{"./blockchain":6021,"./cardano":6022,"./device":6023,"./errors":6024,"./iframe":6025,"./network":6027,"./popup":6028,"./transport":6029,"./ui":6030},function(){with(this)return function(){"use strict";return function(e,t,r){r.__esModule=!0,r.CARDANO=r.UI=r.TRANSPORT=r.POPUP=r.NETWORK=r.IFRAME=r.ERRORS=r.DEVICE=r.BLOCKCHAIN=r.BLOCKCHAIN_EVENT=r.RESPONSE_EVENT=r.TRANSPORT_EVENT=r.DEVICE_EVENT=r.UI_EVENT=r.CORE_EVENT=void 0;var n=h(e("./blockchain"));r.BLOCKCHAIN=n;var i=h(e("./device"));r.DEVICE=i;var s=h(e("./errors"));r.ERRORS=s;var o=h(e("./iframe"));r.IFRAME=o;var a=h(e("./network"));r.NETWORK=a;var c=h(e("./popup"));r.POPUP=c;var u=h(e("./transport"));r.TRANSPORT=u;var l=h(e("./ui"));r.UI=l;var f=h(e("./cardano"));function d(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(d=function(e){return e?r:t})(e)}function h(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=d(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if("default"!==s&&Object.prototype.hasOwnProperty.call(e,s)){var o=i?Object.getOwnPropertyDescriptor(e,s):null;o&&(o.get||o.set)?Object.defineProperty(n,s,o):n[s]=e[s]}return n.default=e,r&&r.set(e,n),n}r.CARDANO=f;r.CORE_EVENT="CORE_EVENT";r.UI_EVENT="UI_EVENT";r.DEVICE_EVENT="DEVICE_EVENT";r.TRANSPORT_EVENT="TRANSPORT_EVENT";r.RESPONSE_EVENT="RESPONSE_EVENT";r.BLOCKCHAIN_EVENT="BLOCKCHAIN_EVENT"}}},{package:"trezor-connect",file:"/home/circleci/project/node_modules/trezor-connect/lib/constants/index.js"}],[6032,{"../../constants":6026,"../../data/ConnectSettings":6031,"../../iframe/builder":6034,"../../message":6038,"../../message/builder":6037,"../../popup/PopupManager":6040,"../../types":6047,"../../utils/debug":6063,"../../webusb/button":6065,"@babel/runtime/helpers/asyncToGenerator":185,"@babel/runtime/helpers/defineProperty":189,"@babel/runtime/helpers/interopRequireDefault":195,"@babel/runtime/regenerator":215,events:2158},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault");r.__esModule=!0,r.disableWebUSB=r.requestLogin=r.customMessage=r.getSettings=r.renderWebUSBButton=r.uiResponse=r.call=r.init=r.cancel=r.dispose=r.manifest=r.eventEmitter=void 0;var i=n(e("@babel/runtime/regenerator")),s=n(e("@babel/runtime/helpers/defineProperty")),o=n(e("@babel/runtime/helpers/asyncToGenerator")),a=n(e("events")),c=n(e("../../popup/PopupManager")),u=y(e("../../iframe/builder")),l=n(e("../../webusb/button")),f=e("../../message"),d=e("../../message/builder"),h=e("../../data/ConnectSettings"),p=e("../../utils/debug"),m=e("../../constants");y(e("../../types"));function g(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(g=function(e){return e?r:t})(e)}function y(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=g(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if("default"!==s&&Object.prototype.hasOwnProperty.call(e,s)){var o=i?Object.getOwnPropertyDescriptor(e,s):null;o&&(o.get||o.set)?Object.defineProperty(n,s,o):n[s]=e[s]}return n.default=e,r&&r.set(e,n),n}function b(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function v(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?b(Object(r),!0).forEach((function(t){(0,s.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):b(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var w=new a.default;r.eventEmitter=w;var _,E,k=(0,p.initLog)("[trezor-connect.js]"),S=function(){var e=new c.default(_);return e.on(m.POPUP.CLOSED,(function(e){u.postMessage({type:m.POPUP.CLOSED,payload:e?{error:e}:null},!1)})),e};r.manifest=function(e){_=(0,h.parse)({manifest:e})};var A=function(){w.removeAllListeners(),u.dispose(),E&&E.close()};r.dispose=A;r.cancel=function(e){E&&E.emit(m.POPUP.CLOSED,e)};var T=function(e){if(e.origin===u.origin){var t=(0,f.parseMessage)(e.data),r=t.event,n=t.type,i=t.payload,s=t.id||0;switch(k.log("handleMessage",t),r){case m.RESPONSE_EVENT:u.messagePromises[s]?(u.messagePromises[s].resolve({id:s,success:t.success,payload:i}),delete u.messagePromises[s]):k.warn("Unknown message id "+s);break;case m.DEVICE_EVENT:case m.TRANSPORT_EVENT:case m.BLOCKCHAIN_EVENT:w.emit(r,t),w.emit(n,i);break;case m.UI_EVENT:if(n===m.IFRAME.BOOTSTRAP){u.clearTimeout();break}n===m.IFRAME.LOADED&&u.initPromise.resolve(),n===m.IFRAME.ERROR&&u.initPromise.reject(i.error),w.emit(r,t),w.emit(n,i);break;default:k.log("Undefined message",r,e)}}},I=function(){var e=(0,o.default)(i.default.mark((function e(t){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===t&&(t={}),!u.instance){e.next=3;break}throw m.ERRORS.TypedError("Init_AlreadyInitialized");case 3:if(_||(_=(0,h.parse)(t)),_.manifest){e.next=6;break}throw m.ERRORS.TypedError("Init_ManifestMissing");case 6:if(!_.lazyLoad){e.next=9;break}return _.lazyLoad=!1,e.abrupt("return");case 9:return E||(E=S()),k.enabled=!!_.debug,window.addEventListener("message",T),window.addEventListener("unload",A),e.next=15,u.init(_);case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();r.init=I;var C=function(){var e=(0,o.default)(i.default.mark((function e(t){var r;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u.instance||u.timeout){e.next=15;break}if((_=(0,h.parse)(_)).manifest){e.next=4;break}return e.abrupt("return",(0,f.errorMessage)(m.ERRORS.TypedError("Init_ManifestMissing")));case 4:return E||(E=S()),E.request(!0),e.prev=6,e.next=9,I(_);case 9:e.next=15;break;case 11:return e.prev=11,e.t0=e.catch(6),E&&(["Init_IframeBlocked","Init_IframeTimeout"].includes(e.t0.code)?E.postMessage((0,d.UiMessage)(m.UI.IFRAME_FAILURE)):E.close()),e.abrupt("return",(0,f.errorMessage)(e.t0));case 15:if(!u.timeout){e.next=17;break}return e.abrupt("return",(0,f.errorMessage)(m.ERRORS.TypedError("Init_ManifestMissing")));case 17:if(!u.error){e.next=19;break}return e.abrupt("return",(0,f.errorMessage)(u.error));case 19:return _.popup&&E&&E.request(),e.prev=20,e.next=23,u.postMessage({type:m.IFRAME.CALL,payload:t});case 23:if(!(r=e.sent)){e.next=27;break}return!r.success&&"Device_CallInProgress"!==r.payload.code&&E&&E.unlock(),e.abrupt("return",r);case 27:return E&&E.unlock(),e.abrupt("return",(0,f.errorMessage)(m.ERRORS.TypedError("Method_NoResponse")));case 31:return e.prev=31,e.t1=e.catch(20),k.error("__call error",e.t1),E&&E.close(),e.abrupt("return",(0,f.errorMessage)(e.t1));case 36:case"end":return e.stop()}}),e,null,[[6,11],[20,31]])})));return function(t){return e.apply(this,arguments)}}();r.call=C;var x=function(e){u.postMessage({event:m.UI_EVENT,type:m.UI.CUSTOM_MESSAGE_RESPONSE,payload:e})};r.uiResponse=function(e){var t=e.type,r=e.payload;u.postMessage({event:m.UI_EVENT,type:t,payload:r})};r.renderWebUSBButton=function(e){(0,l.default)(e,_.webusbSrc,u.origin)};r.getSettings=function(){return u.instance?C({method:"getSettings"}):Promise.resolve((0,f.errorMessage)(m.ERRORS.TypedError("Init_NotInitialized")))};var P=function(){var e=(0,o.default)(i.default.mark((function e(t){var r,n,s;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("function"==typeof t.callback){e.next=2;break}return e.abrupt("return",(0,f.errorMessage)(m.ERRORS.TypedError("Method_CustomMessage_Callback")));case 2:return r=t.callback,n=function(){var e=(0,o.default)(i.default.mark((function e(t){var n,s;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=t.data)||n.type!==m.UI.CUSTOM_MESSAGE_REQUEST){e.next=6;break}return e.next=4,r(n.payload);case 4:s=e.sent,x(s||{message:"release"});case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),window.addEventListener("message",n,!1),e.next=7,C(v(v({method:"customMessage"},t),{},{callback:null}));case 7:return s=e.sent,window.removeEventListener("message",n),e.abrupt("return",s);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();r.customMessage=P;var O=function(){var e=(0,o.default)(i.default.mark((function e(t){var r,n,s;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("function"!=typeof t.callback){e.next=9;break}return r=t.callback,n=function(){var e=(0,o.default)(i.default.mark((function e(t){var n,s;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=t.data)||n.type!==m.UI.LOGIN_CHALLENGE_REQUEST){e.next=12;break}return e.prev=2,e.next=5,r();case 5:s=e.sent,u.postMessage({event:m.UI_EVENT,type:m.UI.LOGIN_CHALLENGE_RESPONSE,payload:s}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),u.postMessage({event:m.UI_EVENT,type:m.UI.LOGIN_CHALLENGE_RESPONSE,payload:e.t0.message});case 12:case"end":return e.stop()}}),e,null,[[2,9]])})));return function(t){return e.apply(this,arguments)}}(),window.addEventListener("message",n,!1),e.next=6,C(v(v({method:"requestLogin"},t),{},{asyncChallenge:!0,callback:null}));case 6:return s=e.sent,window.removeEventListener("message",n),e.abrupt("return",s);case 9:return e.abrupt("return",C(v({method:"requestLogin"},t)));case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();r.requestLogin=O;r.disableWebUSB=function(){u.postMessage({event:m.UI_EVENT,type:m.TRANSPORT.DISABLE_WEBUSB})}}}},{package:"trezor-connect",file:"/home/circleci/project/node_modules/trezor-connect/lib/env/browser/index.js"}],[1111,{"./encryption":1110,"./personal-sign":1112,"./sign-typed-data":1113,"./utils":1114},function(){with(this)return function(){"use strict";return function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){n===undefined&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){n===undefined&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),r.normalize=r.concatSig=void 0,i(e("./personal-sign"),r),i(e("./sign-typed-data"),r),i(e("./encryption"),r);var s=e("./utils");Object.defineProperty(r,"concatSig",{enumerable:!0,get:function(){return s.concatSig}}),Object.defineProperty(r,"normalize",{enumerable:!0,get:function(){return s.normalize}})}}},{package:"@metamask/eth-sig-util",file:"/home/circleci/project/node_modules/@metamask/eth-sig-util/dist/index.js"}],[1320,{},function(){with(this)return function(){"use strict";return function(e,t,r){var n,i;Object.defineProperty(r,"__esModule",{value:!0}),r.cancellationReasonToStatusMap=r.SmartTransactionStatuses=r.SmartTransactionCancellationReason=r.SmartTransactionMinedTx=r.APIType=void 0,function(e){e[e.GET_FEES=0]="GET_FEES",e[e.ESTIMATE_GAS=1]="ESTIMATE_GAS",e[e.SUBMIT_TRANSACTIONS=2]="SUBMIT_TRANSACTIONS",e[e.CANCEL=3]="CANCEL",e[e.BATCH_STATUS=4]="BATCH_STATUS",e[e.LIVENESS=5]="LIVENESS"}(r.APIType||(r.APIType={})),function(e){e.NOT_MINED="not_mined",e.SUCCESS="success",e.CANCELLED="cancelled",e.REVERTED="reverted",e.UNKNOWN="unknown"}(r.SmartTransactionMinedTx||(r.SmartTransactionMinedTx={})),function(e){e.WOULD_REVERT="would_revert",e.TOO_CHEAP="too_cheap",e.DEADLINE_MISSED="deadline_missed",e.INVALID_NONCE="invalid_nonce",e.USER_CANCELLED="user_cancelled",e.NOT_CANCELLED="not_cancelled"}(n=r.SmartTransactionCancellationReason||(r.SmartTransactionCancellationReason={})),function(e){e.PENDING="pending",e.SUCCESS="success",e.REVERTED="reverted",e.UNKNOWN="unknown",e.CANCELLED_WOULD_REVERT="cancelled_would_revert",e.CANCELLED_TOO_CHEAP="cancelled_too_cheap",e.CANCELLED_DEADLINE_MISSED="cancelled_deadline_missed",e.CANCELLED_INVALID_NONCE="cancelled_invalid_nonce",e.CANCELLED_USER_CANCELLED="cancelled_user_cancelled",e.RESOLVED="resolved"}(i=r.SmartTransactionStatuses||(r.SmartTransactionStatuses={})),r.cancellationReasonToStatusMap={[n.WOULD_REVERT]:i.CANCELLED_WOULD_REVERT,[n.TOO_CHEAP]:i.CANCELLED_TOO_CHEAP,[n.DEADLINE_MISSED]:i.CANCELLED_DEADLINE_MISSED,[n.INVALID_NONCE]:i.CANCELLED_INVALID_NONCE,[n.USER_CANCELLED]:i.CANCELLED_USER_CANCELLED}}}},{package:"@metamask/smart-transactions-controller",file:"/home/circleci/project/node_modules/@metamask/smart-transactions-controller/dist/types.js"}],[1318,{},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.CHAIN_IDS=r.API_BASE_URL=void 0,r.API_BASE_URL="https://transaction.metaswap.codefi.network",r.CHAIN_IDS={ETHEREUM:"0x1",RINKEBY:"0x4",BSC:"0x38"}}}},{package:"@metamask/smart-transactions-controller",file:"/home/circleci/project/node_modules/@metamask/smart-transactions-controller/dist/constants.js"}],[1375,{},function(){with(this)return function(){"use strict";return function(e,t,r){!function(e){var r,n=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,i=Math.ceil,s=Math.floor,o="[BigNumber Error] ",a=o+"Number primitive has more than 15 significant digits: ",c=1e14,u=14,l=9007199254740991,f=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],d=1e7,h=1e9;function p(e){var t=0|e;return e>0||e===t?t:t-1}function m(e){for(var t,r,n=1,i=e.length,s=e[0]+"";n<i;){for(t=e[n++]+"",r=u-t.length;r--;t="0"+t);s+=t}for(i=s.length;48===s.charCodeAt(--i););return s.slice(0,i+1||1)}function g(e,t){var r,n,i=e.c,s=t.c,o=e.s,a=t.s,c=e.e,u=t.e;if(!o||!a)return null;if(r=i&&!i[0],n=s&&!s[0],r||n)return r?n?0:-a:o;if(o!=a)return o;if(r=o<0,n=c==u,!i||!s)return n?0:!i^r?1:-1;if(!n)return c>u^r?1:-1;for(a=(c=i.length)<(u=s.length)?c:u,o=0;o<a;o++)if(i[o]!=s[o])return i[o]>s[o]^r?1:-1;return c==u?0:c>u^r?1:-1}function y(e,t,r,n){if(e<t||e>r||e!==s(e))throw Error(o+(n||"Argument")+("number"==typeof e?e<t||e>r?" out of range: ":" not an integer: ":" not a primitive number: ")+String(e))}function b(e){var t=e.c.length-1;return p(e.e/u)==t&&e.c[t]%2!=0}function v(e,t){return(e.length>1?e.charAt(0)+"."+e.slice(1):e)+(t<0?"e":"e+")+t}function w(e,t,r){var n,i;if(t<0){for(i=r+".";++t;i+=r);e=i+e}else if(++t>(n=e.length)){for(i=r,t-=n;--t;i+=r);e+=i}else t<n&&(e=e.slice(0,t)+"."+e.slice(t));return e}r=function e(t){var r,_,E,k,S,A,T,I,C,x,P=F.prototype={constructor:F,toString:null,valueOf:null},O=new F(1),R=20,N=4,M=-7,j=21,L=-1e7,D=1e7,B=!1,U=1,K=0,V={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},H="0123456789abcdefghijklmnopqrstuvwxyz";function F(e,t){var r,i,o,c,f,d,h,p,m=this;if(!(m instanceof F))return new F(e,t);if(null==t){if(e&&!0===e._isBigNumber)return m.s=e.s,void(!e.c||e.e>D?m.c=m.e=null:e.e<L?m.c=[m.e=0]:(m.e=e.e,m.c=e.c.slice()));if((d="number"==typeof e)&&0*e==0){if(m.s=1/e<0?(e=-e,-1):1,e===~~e){for(c=0,f=e;f>=10;f/=10,c++);return void(c>D?m.c=m.e=null:(m.e=c,m.c=[e]))}p=String(e)}else{if(!n.test(p=String(e)))return E(m,p,d);m.s=45==p.charCodeAt(0)?(p=p.slice(1),-1):1}(c=p.indexOf("."))>-1&&(p=p.replace(".","")),(f=p.search(/e/i))>0?(c<0&&(c=f),c+=+p.slice(f+1),p=p.substring(0,f)):c<0&&(c=p.length)}else{if(y(t,2,H.length,"Base"),10==t)return Y(m=new F(e),R+m.e+1,N);if(p=String(e),d="number"==typeof e){if(0*e!=0)return E(m,p,d,t);if(m.s=1/e<0?(p=p.slice(1),-1):1,F.DEBUG&&p.replace(/^0\.0*|\./,"").length>15)throw Error(a+e)}else m.s=45===p.charCodeAt(0)?(p=p.slice(1),-1):1;for(r=H.slice(0,t),c=f=0,h=p.length;f<h;f++)if(r.indexOf(i=p.charAt(f))<0){if("."==i){if(f>c){c=h;continue}}else if(!o&&(p==p.toUpperCase()&&(p=p.toLowerCase())||p==p.toLowerCase()&&(p=p.toUpperCase()))){o=!0,f=-1,c=0;continue}return E(m,String(e),d,t)}d=!1,(c=(p=_(p,t,10,m.s)).indexOf("."))>-1?p=p.replace(".",""):c=p.length}for(f=0;48===p.charCodeAt(f);f++);for(h=p.length;48===p.charCodeAt(--h););if(p=p.slice(f,++h)){if(h-=f,d&&F.DEBUG&&h>15&&(e>l||e!==s(e)))throw Error(a+m.s*e);if((c=c-f-1)>D)m.c=m.e=null;else if(c<L)m.c=[m.e=0];else{if(m.e=c,m.c=[],f=(c+1)%u,c<0&&(f+=u),f<h){for(f&&m.c.push(+p.slice(0,f)),h-=u;f<h;)m.c.push(+p.slice(f,f+=u));f=u-(p=p.slice(f)).length}else f-=h;for(;f--;p+="0");m.c.push(+p)}}else m.c=[m.e=0]}function G(e,t,r,n){var i,s,o,a,c;if(null==r?r=N:y(r,0,8),!e.c)return e.toString();if(i=e.c[0],o=e.e,null==t)c=m(e.c),c=1==n||2==n&&(o<=M||o>=j)?v(c,o):w(c,o,"0");else if(s=(e=Y(new F(e),t,r)).e,a=(c=m(e.c)).length,1==n||2==n&&(t<=s||s<=M)){for(;a<t;c+="0",a++);c=v(c,s)}else if(t-=o,c=w(c,s,"0"),s+1>a){if(--t>0)for(c+=".";t--;c+="0");}else if((t+=s-a)>0)for(s+1==a&&(c+=".");t--;c+="0");return e.s<0&&i?"-"+c:c}function q(e,t){for(var r,n=1,i=new F(e[0]);n<e.length;n++){if(!(r=new F(e[n])).s){i=r;break}t.call(i,r)&&(i=r)}return i}function z(e,t,r){for(var n=1,i=t.length;!t[--i];t.pop());for(i=t[0];i>=10;i/=10,n++);return(r=n+r*u-1)>D?e.c=e.e=null:r<L?e.c=[e.e=0]:(e.e=r,e.c=t),e}function Y(e,t,r,n){var o,a,l,d,h,p,m,g=e.c,y=f;if(g){e:{for(o=1,d=g[0];d>=10;d/=10,o++);if((a=t-o)<0)a+=u,l=t,m=(h=g[p=0])/y[o-l-1]%10|0;else if((p=i((a+1)/u))>=g.length){if(!n)break e;for(;g.length<=p;g.push(0));h=m=0,o=1,l=(a%=u)-u+1}else{for(h=d=g[p],o=1;d>=10;d/=10,o++);m=(l=(a%=u)-u+o)<0?0:h/y[o-l-1]%10|0}if(n=n||t<0||null!=g[p+1]||(l<0?h:h%y[o-l-1]),n=r<4?(m||n)&&(0==r||r==(e.s<0?3:2)):m>5||5==m&&(4==r||n||6==r&&(a>0?l>0?h/y[o-l]:0:g[p-1])%10&1||r==(e.s<0?8:7)),t<1||!g[0])return g.length=0,n?(t-=e.e+1,g[0]=y[(u-t%u)%u],e.e=-t||0):g[0]=e.e=0,e;if(0==a?(g.length=p,d=1,p--):(g.length=p+1,d=y[u-a],g[p]=l>0?s(h/y[o-l]%y[l])*d:0),n)for(;;){if(0==p){for(a=1,l=g[0];l>=10;l/=10,a++);for(l=g[0]+=d,d=1;l>=10;l/=10,d++);a!=d&&(e.e++,g[0]==c&&(g[0]=1));break}if(g[p]+=d,g[p]!=c)break;g[p--]=0,d=1}for(a=g.length;0===g[--a];g.pop());}e.e>D?e.c=e.e=null:e.e<L&&(e.c=[e.e=0])}return e}function W(e){var t,r=e.e;return null===r?e.toString():(t=m(e.c),t=r<=M||r>=j?v(t,r):w(t,r,"0"),e.s<0?"-"+t:t)}return F.clone=e,F.ROUND_UP=0,F.ROUND_DOWN=1,F.ROUND_CEIL=2,F.ROUND_FLOOR=3,F.ROUND_HALF_UP=4,F.ROUND_HALF_DOWN=5,F.ROUND_HALF_EVEN=6,F.ROUND_HALF_CEIL=7,F.ROUND_HALF_FLOOR=8,F.EUCLID=9,F.config=F.set=function(e){var t,r;if(null!=e){if("object"!=typeof e)throw Error(o+"Object expected: "+e);if(e.hasOwnProperty(t="DECIMAL_PLACES")&&(y(r=e[t],0,h,t),R=r),e.hasOwnProperty(t="ROUNDING_MODE")&&(y(r=e[t],0,8,t),N=r),e.hasOwnProperty(t="EXPONENTIAL_AT")&&((r=e[t])&&r.pop?(y(r[0],-h,0,t),y(r[1],0,h,t),M=r[0],j=r[1]):(y(r,-h,h,t),M=-(j=r<0?-r:r))),e.hasOwnProperty(t="RANGE"))if((r=e[t])&&r.pop)y(r[0],-h,-1,t),y(r[1],1,h,t),L=r[0],D=r[1];else{if(y(r,-h,h,t),!r)throw Error(o+t+" cannot be zero: "+r);L=-(D=r<0?-r:r)}if(e.hasOwnProperty(t="CRYPTO")){if((r=e[t])!==!!r)throw Error(o+t+" not true or false: "+r);if(r){if("undefined"==typeof crypto||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw B=!r,Error(o+"crypto unavailable");B=r}else B=r}if(e.hasOwnProperty(t="MODULO_MODE")&&(y(r=e[t],0,9,t),U=r),e.hasOwnProperty(t="POW_PRECISION")&&(y(r=e[t],0,h,t),K=r),e.hasOwnProperty(t="FORMAT")){if("object"!=typeof(r=e[t]))throw Error(o+t+" not an object: "+r);V=r}if(e.hasOwnProperty(t="ALPHABET")){if("string"!=typeof(r=e[t])||/^.?$|[+\-.\s]|(.).*\1/.test(r))throw Error(o+t+" invalid: "+r);H=r}}return{DECIMAL_PLACES:R,ROUNDING_MODE:N,EXPONENTIAL_AT:[M,j],RANGE:[L,D],CRYPTO:B,MODULO_MODE:U,POW_PRECISION:K,FORMAT:V,ALPHABET:H}},F.isBigNumber=function(e){if(!e||!0!==e._isBigNumber)return!1;if(!F.DEBUG)return!0;var t,r,n=e.c,i=e.e,a=e.s;e:if("[object Array]"=={}.toString.call(n)){if((1===a||-1===a)&&i>=-h&&i<=h&&i===s(i)){if(0===n[0]){if(0===i&&1===n.length)return!0;break e}if((t=(i+1)%u)<1&&(t+=u),String(n[0]).length==t){for(t=0;t<n.length;t++)if((r=n[t])<0||r>=c||r!==s(r))break e;if(0!==r)return!0}}}else if(null===n&&null===i&&(null===a||1===a||-1===a))return!0;throw Error(o+"Invalid BigNumber: "+e)},F.maximum=F.max=function(){return q(arguments,P.lt)},F.minimum=F.min=function(){return q(arguments,P.gt)},F.random=(k=9007199254740992,S=Math.random()*k&2097151?function(){return s(Math.random()*k)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(e){var t,r,n,a,c,l=0,d=[],p=new F(O);if(null==e?e=R:y(e,0,h),a=i(e/u),B)if(crypto.getRandomValues){for(t=crypto.getRandomValues(new Uint32Array(a*=2));l<a;)(c=131072*t[l]+(t[l+1]>>>11))>=9e15?(r=crypto.getRandomValues(new Uint32Array(2)),t[l]=r[0],t[l+1]=r[1]):(d.push(c%1e14),l+=2);l=a/2}else{if(!crypto.randomBytes)throw B=!1,Error(o+"crypto unavailable");for(t=crypto.randomBytes(a*=7);l<a;)(c=281474976710656*(31&t[l])+1099511627776*t[l+1]+4294967296*t[l+2]+16777216*t[l+3]+(t[l+4]<<16)+(t[l+5]<<8)+t[l+6])>=9e15?crypto.randomBytes(7).copy(t,l):(d.push(c%1e14),l+=7);l=a/7}if(!B)for(;l<a;)(c=S())<9e15&&(d[l++]=c%1e14);for(a=d[--l],e%=u,a&&e&&(c=f[u-e],d[l]=s(a/c)*c);0===d[l];d.pop(),l--);if(l<0)d=[n=0];else{for(n=-1;0===d[0];d.splice(0,1),n-=u);for(l=1,c=d[0];c>=10;c/=10,l++);l<u&&(n-=u-l)}return p.e=n,p.c=d,p}),F.sum=function(){for(var e=1,t=arguments,r=new F(t[0]);e<t.length;)r=r.plus(t[e++]);return r},_=function(){var e="0123456789";function t(e,t,r,n){for(var i,s,o=[0],a=0,c=e.length;a<c;){for(s=o.length;s--;o[s]*=t);for(o[0]+=n.indexOf(e.charAt(a++)),i=0;i<o.length;i++)o[i]>r-1&&(null==o[i+1]&&(o[i+1]=0),o[i+1]+=o[i]/r|0,o[i]%=r)}return o.reverse()}return function(n,i,s,o,a){var c,u,l,f,d,h,p,g,y=n.indexOf("."),b=R,v=N;for(y>=0&&(f=K,K=0,n=n.replace(".",""),h=(g=new F(i)).pow(n.length-y),K=f,g.c=t(w(m(h.c),h.e,"0"),10,s,e),g.e=g.c.length),l=f=(p=t(n,i,s,a?(c=H,e):(c=e,H))).length;0==p[--f];p.pop());if(!p[0])return c.charAt(0);if(y<0?--l:(h.c=p,h.e=l,h.s=o,p=(h=r(h,g,b,v,s)).c,d=h.r,l=h.e),y=p[u=l+b+1],f=s/2,d=d||u<0||null!=p[u+1],d=v<4?(null!=y||d)&&(0==v||v==(h.s<0?3:2)):y>f||y==f&&(4==v||d||6==v&&1&p[u-1]||v==(h.s<0?8:7)),u<1||!p[0])n=d?w(c.charAt(1),-b,c.charAt(0)):c.charAt(0);else{if(p.length=u,d)for(--s;++p[--u]>s;)p[u]=0,u||(++l,p=[1].concat(p));for(f=p.length;!p[--f];);for(y=0,n="";y<=f;n+=c.charAt(p[y++]));n=w(n,l,c.charAt(0))}return n}}(),r=function(){function e(e,t,r){var n,i,s,o,a=0,c=e.length,u=t%d,l=t/d|0;for(e=e.slice();c--;)a=((i=u*(s=e[c]%d)+(n=l*s+(o=e[c]/d|0)*u)%d*d+a)/r|0)+(n/d|0)+l*o,e[c]=i%r;return a&&(e=[a].concat(e)),e}function t(e,t,r,n){var i,s;if(r!=n)s=r>n?1:-1;else for(i=s=0;i<r;i++)if(e[i]!=t[i]){s=e[i]>t[i]?1:-1;break}return s}function r(e,t,r,n){for(var i=0;r--;)e[r]-=i,i=e[r]<t[r]?1:0,e[r]=i*n+e[r]-t[r];for(;!e[0]&&e.length>1;e.splice(0,1));}return function(n,i,o,a,l){var f,d,h,m,g,y,b,v,w,_,E,k,S,A,T,I,C,x=n.s==i.s?1:-1,P=n.c,O=i.c;if(!(P&&P[0]&&O&&O[0]))return new F(n.s&&i.s&&(P?!O||P[0]!=O[0]:O)?P&&0==P[0]||!O?0*x:x/0:NaN);for(w=(v=new F(x)).c=[],x=o+(d=n.e-i.e)+1,l||(l=c,d=p(n.e/u)-p(i.e/u),x=x/u|0),h=0;O[h]==(P[h]||0);h++);if(O[h]>(P[h]||0)&&d--,x<0)w.push(1),m=!0;else{for(A=P.length,I=O.length,h=0,x+=2,(g=s(l/(O[0]+1)))>1&&(O=e(O,g,l),P=e(P,g,l),I=O.length,A=P.length),S=I,E=(_=P.slice(0,I)).length;E<I;_[E++]=0);C=O.slice(),C=[0].concat(C),T=O[0],O[1]>=l/2&&T++;do{if(g=0,(f=t(O,_,I,E))<0){if(k=_[0],I!=E&&(k=k*l+(_[1]||0)),(g=s(k/T))>1)for(g>=l&&(g=l-1),b=(y=e(O,g,l)).length,E=_.length;1==t(y,_,b,E);)g--,r(y,I<b?C:O,b,l),b=y.length,f=1;else 0==g&&(f=g=1),b=(y=O.slice()).length;if(b<E&&(y=[0].concat(y)),r(_,y,E,l),E=_.length,-1==f)for(;t(O,_,I,E)<1;)g++,r(_,I<E?C:O,E,l),E=_.length}else 0===f&&(g++,_=[0]);w[h++]=g,_[0]?_[E++]=P[S]||0:(_=[P[S]],E=1)}while((S++<A||null!=_[0])&&x--);m=null!=_[0],w[0]||w.splice(0,1)}if(l==c){for(h=1,x=w[0];x>=10;x/=10,h++);Y(v,o+(v.e=h+d*u-1)+1,a,m)}else v.e=d,v.r=+m;return v}}(),A=/^(-?)0([xbo])(?=\w[\w.]*$)/i,T=/^([^.]+)\.$/,I=/^\.([^.]+)$/,C=/^-?(Infinity|NaN)$/,x=/^\s*\+(?=[\w.])|^\s+|\s+$/g,E=function(e,t,r,n){var i,s=r?t:t.replace(x,"");if(C.test(s))e.s=isNaN(s)?null:s<0?-1:1;else{if(!r&&(s=s.replace(A,(function(e,t,r){return i="x"==(r=r.toLowerCase())?16:"b"==r?2:8,n&&n!=i?e:t})),n&&(i=n,s=s.replace(T,"$1").replace(I,"0.$1")),t!=s))return new F(s,i);if(F.DEBUG)throw Error(o+"Not a"+(n?" base "+n:"")+" number: "+t);e.s=null}e.c=e.e=null},P.absoluteValue=P.abs=function(){var e=new F(this);return e.s<0&&(e.s=1),e},P.comparedTo=function(e,t){return g(this,new F(e,t))},P.decimalPlaces=P.dp=function(e,t){var r,n,i,s=this;if(null!=e)return y(e,0,h),null==t?t=N:y(t,0,8),Y(new F(s),e+s.e+1,t);if(!(r=s.c))return null;if(n=((i=r.length-1)-p(this.e/u))*u,i=r[i])for(;i%10==0;i/=10,n--);return n<0&&(n=0),n},P.dividedBy=P.div=function(e,t){return r(this,new F(e,t),R,N)},P.dividedToIntegerBy=P.idiv=function(e,t){return r(this,new F(e,t),0,1)},P.exponentiatedBy=P.pow=function(e,t){var r,n,a,c,l,f,d,h,p=this;if((e=new F(e)).c&&!e.isInteger())throw Error(o+"Exponent not an integer: "+W(e));if(null!=t&&(t=new F(t)),l=e.e>14,!p.c||!p.c[0]||1==p.c[0]&&!p.e&&1==p.c.length||!e.c||!e.c[0])return h=new F(Math.pow(+W(p),l?2-b(e):+W(e))),t?h.mod(t):h;if(f=e.s<0,t){if(t.c?!t.c[0]:!t.s)return new F(NaN);(n=!f&&p.isInteger()&&t.isInteger())&&(p=p.mod(t))}else{if(e.e>9&&(p.e>0||p.e<-1||(0==p.e?p.c[0]>1||l&&p.c[1]>=24e7:p.c[0]<8e13||l&&p.c[0]<=9999975e7)))return c=p.s<0&&b(e)?-0:0,p.e>-1&&(c=1/c),new F(f?1/c:c);K&&(c=i(K/u+2))}for(l?(r=new F(.5),f&&(e.s=1),d=b(e)):d=(a=Math.abs(+W(e)))%2,h=new F(O);;){if(d){if(!(h=h.times(p)).c)break;c?h.c.length>c&&(h.c.length=c):n&&(h=h.mod(t))}if(a){if(0===(a=s(a/2)))break;d=a%2}else if(Y(e=e.times(r),e.e+1,1),e.e>14)d=b(e);else{if(0===(a=+W(e)))break;d=a%2}p=p.times(p),c?p.c&&p.c.length>c&&(p.c.length=c):n&&(p=p.mod(t))}return n?h:(f&&(h=O.div(h)),t?h.mod(t):c?Y(h,K,N,undefined):h)},P.integerValue=function(e){var t=new F(this);return null==e?e=N:y(e,0,8),Y(t,t.e+1,e)},P.isEqualTo=P.eq=function(e,t){return 0===g(this,new F(e,t))},P.isFinite=function(){return!!this.c},P.isGreaterThan=P.gt=function(e,t){return g(this,new F(e,t))>0},P.isGreaterThanOrEqualTo=P.gte=function(e,t){return 1===(t=g(this,new F(e,t)))||0===t},P.isInteger=function(){return!!this.c&&p(this.e/u)>this.c.length-2},P.isLessThan=P.lt=function(e,t){return g(this,new F(e,t))<0},P.isLessThanOrEqualTo=P.lte=function(e,t){return-1===(t=g(this,new F(e,t)))||0===t},P.isNaN=function(){return!this.s},P.isNegative=function(){return this.s<0},P.isPositive=function(){return this.s>0},P.isZero=function(){return!!this.c&&0==this.c[0]},P.minus=function(e,t){var r,n,i,s,o=this,a=o.s;if(t=(e=new F(e,t)).s,!a||!t)return new F(NaN);if(a!=t)return e.s=-t,o.plus(e);var l=o.e/u,f=e.e/u,d=o.c,h=e.c;if(!l||!f){if(!d||!h)return d?(e.s=-t,e):new F(h?o:NaN);if(!d[0]||!h[0])return h[0]?(e.s=-t,e):new F(d[0]?o:3==N?-0:0)}if(l=p(l),f=p(f),d=d.slice(),a=l-f){for((s=a<0)?(a=-a,i=d):(f=l,i=h),i.reverse(),t=a;t--;i.push(0));i.reverse()}else for(n=(s=(a=d.length)<(t=h.length))?a:t,a=t=0;t<n;t++)if(d[t]!=h[t]){s=d[t]<h[t];break}if(s&&(i=d,d=h,h=i,e.s=-e.s),(t=(n=h.length)-(r=d.length))>0)for(;t--;d[r++]=0);for(t=c-1;n>a;){if(d[--n]<h[n]){for(r=n;r&&!d[--r];d[r]=t);--d[r],d[n]+=c}d[n]-=h[n]}for(;0==d[0];d.splice(0,1),--f);return d[0]?z(e,d,f):(e.s=3==N?-1:1,e.c=[e.e=0],e)},P.modulo=P.mod=function(e,t){var n,i,s=this;return e=new F(e,t),!s.c||!e.s||e.c&&!e.c[0]?new F(NaN):!e.c||s.c&&!s.c[0]?new F(s):(9==U?(i=e.s,e.s=1,n=r(s,e,0,3),e.s=i,n.s*=i):n=r(s,e,0,U),(e=s.minus(n.times(e))).c[0]||1!=U||(e.s=s.s),e)},P.multipliedBy=P.times=function(e,t){var r,n,i,s,o,a,l,f,h,m,g,y,b,v,w,_=this,E=_.c,k=(e=new F(e,t)).c;if(!(E&&k&&E[0]&&k[0]))return!_.s||!e.s||E&&!E[0]&&!k||k&&!k[0]&&!E?e.c=e.e=e.s=null:(e.s*=_.s,E&&k?(e.c=[0],e.e=0):e.c=e.e=null),e;for(n=p(_.e/u)+p(e.e/u),e.s*=_.s,(l=E.length)<(m=k.length)&&(b=E,E=k,k=b,i=l,l=m,m=i),i=l+m,b=[];i--;b.push(0));for(v=c,w=d,i=m;--i>=0;){for(r=0,g=k[i]%w,y=k[i]/w|0,s=i+(o=l);s>i;)r=((f=g*(f=E[--o]%w)+(a=y*f+(h=E[o]/w|0)*g)%w*w+b[s]+r)/v|0)+(a/w|0)+y*h,b[s--]=f%v;b[s]=r}return r?++n:b.splice(0,1),z(e,b,n)},P.negated=function(){var e=new F(this);return e.s=-e.s||null,e},P.plus=function(e,t){var r,n=this,i=n.s;if(t=(e=new F(e,t)).s,!i||!t)return new F(NaN);if(i!=t)return e.s=-t,n.minus(e);var s=n.e/u,o=e.e/u,a=n.c,l=e.c;if(!s||!o){if(!a||!l)return new F(i/0);if(!a[0]||!l[0])return l[0]?e:new F(a[0]?n:0*i)}if(s=p(s),o=p(o),a=a.slice(),i=s-o){for(i>0?(o=s,r=l):(i=-i,r=a),r.reverse();i--;r.push(0));r.reverse()}for((i=a.length)-(t=l.length)<0&&(r=l,l=a,a=r,t=i),i=0;t;)i=(a[--t]=a[t]+l[t]+i)/c|0,a[t]=c===a[t]?0:a[t]%c;return i&&(a=[i].concat(a),++o),z(e,a,o)},P.precision=P.sd=function(e,t){var r,n,i,s=this;if(null!=e&&e!==!!e)return y(e,1,h),null==t?t=N:y(t,0,8),Y(new F(s),e,t);if(!(r=s.c))return null;if(n=(i=r.length-1)*u+1,i=r[i]){for(;i%10==0;i/=10,n--);for(i=r[0];i>=10;i/=10,n++);}return e&&s.e+1>n&&(n=s.e+1),n},P.shiftedBy=function(e){return y(e,-9007199254740991,l),this.times("1e"+e)},P.squareRoot=P.sqrt=function(){var e,t,n,i,s,o=this,a=o.c,c=o.s,u=o.e,l=R+4,f=new F("0.5");if(1!==c||!a||!a[0])return new F(!c||c<0&&(!a||a[0])?NaN:a?o:1/0);if(0==(c=Math.sqrt(+W(o)))||c==1/0?(((t=m(a)).length+u)%2==0&&(t+="0"),c=Math.sqrt(+t),u=p((u+1)/2)-(u<0||u%2),n=new F(t=c==1/0?"5e"+u:(t=c.toExponential()).slice(0,t.indexOf("e")+1)+u)):n=new F(c+""),n.c[0])for((c=(u=n.e)+l)<3&&(c=0);;)if(s=n,n=f.times(s.plus(r(o,s,l,1))),m(s.c).slice(0,c)===(t=m(n.c)).slice(0,c)){if(n.e<u&&--c,"9999"!=(t=t.slice(c-3,c+1))&&(i||"4999"!=t)){+t&&(+t.slice(1)||"5"!=t.charAt(0))||(Y(n,n.e+R+2,1),e=!n.times(n).eq(o));break}if(!i&&(Y(s,s.e+R+2,0),s.times(s).eq(o))){n=s;break}l+=4,c+=4,i=1}return Y(n,n.e+R+1,N,e)},P.toExponential=function(e,t){return null!=e&&(y(e,0,h),e++),G(this,e,t,1)},P.toFixed=function(e,t){return null!=e&&(y(e,0,h),e=e+this.e+1),G(this,e,t)},P.toFormat=function(e,t,r){var n,i=this;if(null==r)null!=e&&t&&"object"==typeof t?(r=t,t=null):e&&"object"==typeof e?(r=e,e=t=null):r=V;else if("object"!=typeof r)throw Error(o+"Argument not an object: "+r);if(n=i.toFixed(e,t),i.c){var s,a=n.split("."),c=+r.groupSize,u=+r.secondaryGroupSize,l=r.groupSeparator||"",f=a[0],d=a[1],h=i.s<0,p=h?f.slice(1):f,m=p.length;if(u&&(s=c,c=u,u=s,m-=s),c>0&&m>0){for(s=m%c||c,f=p.substr(0,s);s<m;s+=c)f+=l+p.substr(s,c);u>0&&(f+=l+p.slice(s)),h&&(f="-"+f)}n=d?f+(r.decimalSeparator||"")+((u=+r.fractionGroupSize)?d.replace(new RegExp("\\d{"+u+"}\\B","g"),"$&"+(r.fractionGroupSeparator||"")):d):f}return(r.prefix||"")+n+(r.suffix||"")},P.toFraction=function(e){var t,n,i,s,a,c,l,d,h,p,g,y,b=this,v=b.c;if(null!=e&&(!(l=new F(e)).isInteger()&&(l.c||1!==l.s)||l.lt(O)))throw Error(o+"Argument "+(l.isInteger()?"out of range: ":"not an integer: ")+W(l));if(!v)return new F(b);for(t=new F(O),h=n=new F(O),i=d=new F(O),y=m(v),a=t.e=y.length-b.e-1,t.c[0]=f[(c=a%u)<0?u+c:c],e=!e||l.comparedTo(t)>0?a>0?t:h:l,c=D,D=1/0,l=new F(y),d.c[0]=0;p=r(l,t,0,1),1!=(s=n.plus(p.times(i))).comparedTo(e);)n=i,i=s,h=d.plus(p.times(s=h)),d=s,t=l.minus(p.times(s=t)),l=s;return s=r(e.minus(n),i,0,1),d=d.plus(s.times(h)),n=n.plus(s.times(i)),d.s=h.s=b.s,g=r(h,i,a*=2,N).minus(b).abs().comparedTo(r(d,n,a,N).minus(b).abs())<1?[h,i]:[d,n],D=c,g},P.toNumber=function(){return+W(this)},P.toPrecision=function(e,t){return null!=e&&y(e,1,h),G(this,e,t,2)},P.toString=function(e){var t,r=this,n=r.s,i=r.e;return null===i?n?(t="Infinity",n<0&&(t="-"+t)):t="NaN":(null==e?t=i<=M||i>=j?v(m(r.c),i):w(m(r.c),i,"0"):10===e?t=w(m((r=Y(new F(r),R+i+1,N)).c),r.e,"0"):(y(e,2,H.length,"Base"),t=_(w(m(r.c),i,"0"),10,e,n,!0)),n<0&&r.c[0]&&(t="-"+t)),t},P.valueOf=P.toJSON=function(){return W(this)},P._isBigNumber=!0,null!=t&&F.set(t),F}(),r.default=r.BigNumber=r,"function"==typeof define&&define.amd?define((function(){return r})):void 0!==t&&t.exports?t.exports=r:(e||(e="undefined"!=typeof self&&self?self:window),e.BigNumber=r)}(this)}}},{package:"bignumber.js",file:"/home/circleci/project/node_modules/@metamask/smart-transactions-controller/node_modules/bignumber.js/bignumber.js"}],[1321,{"./constants":1318,"./types":1320,"fast-json-patch":1399,lodash:5250},function(){with(this)return function(){"use strict";return function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.handleFetch=r.getStxProcessingTime=r.snapshotFromTxMeta=r.replayHistory=r.generateHistoryEntry=r.calculateStatus=r.getAPIRequestURL=r.isSmartTransactionStatusResolved=r.isSmartTransactionPending=void 0;const i=n(e("fast-json-patch")),s=e("lodash"),o=e("./types"),a=e("./constants");r.isSmartTransactionPending=function(e){return e.status===o.SmartTransactionStatuses.PENDING};r.isSmartTransactionStatusResolved=e=>"uuid_not_found"===e,r.getAPIRequestURL=function(e,t){const r=parseInt(t,16);switch(e){case o.APIType.GET_FEES:return`${a.API_BASE_URL}/networks/${r}/getFees`;case o.APIType.ESTIMATE_GAS:return`${a.API_BASE_URL}/networks/${r}/estimateGas`;case o.APIType.SUBMIT_TRANSACTIONS:return`${a.API_BASE_URL}/networks/${r}/submitTransactions`;case o.APIType.CANCEL:return`${a.API_BASE_URL}/networks/${r}/cancel`;case o.APIType.BATCH_STATUS:return`${a.API_BASE_URL}/networks/${r}/batchStatus`;case o.APIType.LIVENESS:return`${a.API_BASE_URL}/networks/${r}/health`;default:throw new Error("Invalid APIType")}};r.calculateStatus=e=>{if(r.isSmartTransactionStatusResolved(e))return o.SmartTransactionStatuses.RESOLVED;const t=[o.SmartTransactionCancellationReason.WOULD_REVERT,o.SmartTransactionCancellationReason.TOO_CHEAP,o.SmartTransactionCancellationReason.DEADLINE_MISSED,o.SmartTransactionCancellationReason.INVALID_NONCE,o.SmartTransactionCancellationReason.USER_CANCELLED];if((null==e?void 0:e.minedTx)===o.SmartTransactionMinedTx.NOT_MINED){if(e.cancellationReason===o.SmartTransactionCancellationReason.NOT_CANCELLED)return o.SmartTransactionStatuses.PENDING;const r=t.findIndex((t=>t===e.cancellationReason))>-1;if(e.cancellationReason&&r)return o.cancellationReasonToStatusMap[e.cancellationReason]}else{if((null==e?void 0:e.minedTx)===o.SmartTransactionMinedTx.SUCCESS)return o.SmartTransactionStatuses.SUCCESS;if((null==e?void 0:e.minedTx)===o.SmartTransactionMinedTx.REVERTED)return o.SmartTransactionStatuses.REVERTED;if((null==e?void 0:e.minedTx)===o.SmartTransactionMinedTx.UNKNOWN)return o.SmartTransactionStatuses.UNKNOWN}return o.SmartTransactionStatuses.UNKNOWN},r.generateHistoryEntry=function(e,t,r){const n=i.default.compare(e,t);return n[0]&&(r&&(n[0].note=r),n[0].timestamp=Date.now()),n},r.replayHistory=function(e){return s.cloneDeep(e).reduce(((e,t)=>i.default.applyPatch(e,t).newDocument))},r.snapshotFromTxMeta=function(e){const t=Object.assign({},e);return delete t.history,s.cloneDeep(t)};r.getStxProcessingTime=e=>e?Math.round((Date.now()-e)/1e3):undefined,r.handleFetch=async function(e,t){const r=await fetch(e,t),n=await r.json();if(!r.ok){const{error:e,error_details:t}=n;throw console.log("response",r),new Error(`Fetch error:${JSON.stringify({status:r.status,type:e,message:t})}`)}return n}}}},{package:"@metamask/smart-transactions-controller",file:"/home/circleci/project/node_modules/@metamask/smart-transactions-controller/dist/utils.js"}],[5226,{"./_baseClone":5107},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("./_baseClone");t.exports=function(e){return n(e,5)}}}},{package:"lodash",file:"/home/circleci/project/node_modules/lodash/cloneDeep.js"}],[5251,{"./_baseAssignValue":5106,"./_baseForOwn":5113,"./_baseIteratee":5129},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("./_baseAssignValue"),i=e("./_baseForOwn"),s=e("./_baseIteratee");t.exports=function(e,t){var r={};return t=s(t,3),i(e,(function(e,i,s){n(r,i,t(e,i,s))})),r}}}},{package:"lodash",file:"/home/circleci/project/node_modules/lodash/mapValues.js"}],[1358,{"./BaseController":1322,"./BaseControllerV2":1323,"./ComposableController":1324,"./ControllerMessenger":1325,"./approval/ApprovalController":1328,"./assets/AccountTrackerController":1329,"./assets/AssetsContractController":1330,"./assets/CollectibleDetectionController":1331,"./assets/CollectiblesController":1332,"./assets/CurrencyRateController":1333,"./assets/TokenBalancesController":1337,"./assets/TokenDetectionController":1338,"./assets/TokenListController":1339,"./assets/TokenRatesController":1340,"./assets/TokensController":1341,"./gas/GasFeeController":1344,"./keyring/KeyringController":1359,"./message-manager/MessageManager":1361,"./message-manager/PersonalMessageManager":1362,"./message-manager/TypedMessageManager":1363,"./network/NetworkController":1364,"./notification/NotificationController":1365,"./third-party/PhishingController":1366,"./transaction/TransactionController":1367,"./user/AddressBookController":1368,"./user/PreferencesController":1369,"./util":1370,"isomorphic-fetch":4792},function(){with(this)return function(){"use strict";return function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){n===undefined&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){n===undefined&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t},o=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),r.util=r.getAnonymizedState=r.getPersistentState=r.BaseControllerV2=void 0,e("isomorphic-fetch");const a=s(e("./util"));r.util=a,o(e("./assets/AccountTrackerController"),r),o(e("./user/AddressBookController"),r),o(e("./approval/ApprovalController"),r),o(e("./assets/AssetsContractController"),r),o(e("./BaseController"),r);var c=e("./BaseControllerV2");Object.defineProperty(r,"BaseControllerV2",{enumerable:!0,get:function(){return c.BaseController}}),Object.defineProperty(r,"getPersistentState",{enumerable:!0,get:function(){return c.getPersistentState}}),Object.defineProperty(r,"getAnonymizedState",{enumerable:!0,get:function(){return c.getAnonymizedState}}),o(e("./ComposableController"),r),o(e("./ControllerMessenger"),r),o(e("./assets/CurrencyRateController"),r),o(e("./keyring/KeyringController"),r),o(e("./message-manager/MessageManager"),r),o(e("./network/NetworkController"),r),o(e("./third-party/PhishingController"),r),o(e("./user/PreferencesController"),r),o(e("./assets/TokenBalancesController"),r),o(e("./assets/TokenRatesController"),r),o(e("./transaction/TransactionController"),r),o(e("./message-manager/PersonalMessageManager"),r),o(e("./message-manager/TypedMessageManager"),r),o(e("./notification/NotificationController"),r),o(e("./assets/TokenListController"),r),o(e("./gas/GasFeeController"),r),o(e("./assets/TokensController"),r),o(e("./assets/CollectiblesController"),r),o(e("./assets/TokenDetectionController"),r),o(e("./assets/CollectibleDetectionController"),r)}}},{package:"@metamask/controllers",file:"/home/circleci/project/node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/controllers/dist/index.js"}],[582,{"./ComposedStore":578,"./MergedStore":579,"./ObservableStore":580,"./asStream":581,"./transform":583},function(){with(this)return function(){"use strict";return function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){n===undefined&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){n===undefined&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),i(e("./asStream"),r),i(e("./ComposedStore"),r),i(e("./MergedStore"),r),i(e("./ObservableStore"),r),i(e("./transform"),r)}}},{package:"@metamask/obs-store",file:"/home/circleci/project/node_modules/@keystonehq/metamask-airgapped-keyring/node_modules/@metamask/obs-store/dist/index.js"}],[577,{"./bc-ur-registry-eth.cjs.development.js":575,"./bc-ur-registry-eth.cjs.production.min.js":576},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=e("./bc-ur-registry-eth.cjs.production.min.js")}}},{package:"@keystonehq/bc-ur-registry-eth",file:"/home/circleci/project/node_modules/@keystonehq/metamask-airgapped-keyring/node_modules/@keystonehq/bc-ur-registry-eth/dist/index.js"}],[542,{"./base-eth-keyring.cjs.development.js":540,"./base-eth-keyring.cjs.production.min.js":541},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=e("./base-eth-keyring.cjs.production.min.js")}}},{package:"@keystonehq/base-eth-keyring",file:"/home/circleci/project/node_modules/@keystonehq/base-eth-keyring/dist/index.js"}],[18,{"../util":20,"json-rpc-engine":4805},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.createPendingNonceMiddleware=function({getPendingNonce:e}){return(0,n.createAsyncMiddleware)((async(t,r,n)=>{const{method:i,params:s}=t;if("eth_getTransactionCount"!==i)return void n();const[o,a]=s;"pending"===a?r.result=await e(o):n()}))},r.createPendingTxMiddleware=function({getPendingTransactionByHash:e}){return(0,n.createAsyncMiddleware)((async(t,r,n)=>{const{method:s,params:o}=t;if("eth_getTransactionByHash"!==s)return void n();const[a]=o,c=e(a);c?r.result=(0,i.formatTxMetaForRpcResult)(c):n()}))};var n=e("json-rpc-engine"),i=e("../util")}}},{package:"<root>",file:"/home/circleci/project/app/scripts/controllers/network/middleware/pending.js"}],[168,{"./keyValueStore":167,"./utils/index":173,"@babel/runtime/helpers/asyncToGenerator":185,"@babel/runtime/helpers/classCallCheck":186,"@babel/runtime/helpers/createClass":188,"@babel/runtime/helpers/defineProperty":189,"@babel/runtime/helpers/get":191,"@babel/runtime/helpers/getPrototypeOf":192,"@babel/runtime/helpers/inherits":193,"@babel/runtime/helpers/interopRequireDefault":195,"@babel/runtime/helpers/possibleConstructorReturn":206,"@babel/runtime/regenerator":215},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault"),i=n(e("@babel/runtime/regenerator")),s=n(e("@babel/runtime/helpers/defineProperty")),o=n(e("@babel/runtime/helpers/asyncToGenerator")),a=n(e("@babel/runtime/helpers/classCallCheck")),c=n(e("@babel/runtime/helpers/createClass")),u=n(e("@babel/runtime/helpers/possibleConstructorReturn")),l=n(e("@babel/runtime/helpers/getPrototypeOf")),f=n(e("@babel/runtime/helpers/get")),d=n(e("@babel/runtime/helpers/inherits"));function h(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function p(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?h(r,!0).forEach((function(t){(0,s.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):h(r).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var m=e("./keyValueStore"),g=e("./utils/index"),y=function(e){function t(e,r,n,i){var s;return(0,a.default)(this,t),(s=(0,u.default)(this,(0,l.default)(t).call(this,e,r,n,i))).keyring=i.getKeyringBySpaceName(r),s._salt=s.keyring.getDBSalt(),s}var r,n,s,h,m;return(0,d.default)(t,e),(0,c.default)(t,[{key:"get",value:(m=(0,o.default)(i.default.mark((function e(r){var n,s,o=arguments;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=o.length>1&&o[1]!==undefined?o[1]:{},e.next=3,(0,f.default)((0,l.default)(t.prototype),"get",this).call(this,this._genDbKey(r),n);case 3:if(s=e.sent){e.next=6;break}return e.abrupt("return",null);case 6:if(!n.metadata){e.next=8;break}return e.abrupt("return",p({},s,{value:this._decryptEntry(s.value)}));case 8:return e.abrupt("return",this._decryptEntry(s));case 9:case"end":return e.stop()}}),e,this)}))),function(e){return m.apply(this,arguments)})},{key:"getMetadata",value:(h=(0,o.default)(i.default.mark((function e(r){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,f.default)((0,l.default)(t.prototype),"getMetadata",this).call(this,this._genDbKey(r)));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return h.apply(this,arguments)})},{key:"set",value:(s=(0,o.default)(i.default.mark((function e(r,n){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this._encryptEntry(n),r=this._genDbKey(r),e.abrupt("return",(0,f.default)((0,l.default)(t.prototype),"set",this).call(this,r,n));case 3:case"end":return e.stop()}}),e,this)}))),function(e,t){return s.apply(this,arguments)})},{key:"setMultiple",value:(n=(0,o.default)(i.default.mark((function e(r,n){var s,o;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return g.throwIfNotEqualLenArrays(r,n),s=r.map(this._genDbKey,this),o=n.map(this._encryptEntry,this),e.abrupt("return",(0,f.default)((0,l.default)(t.prototype),"setMultiple",this).call(this,s,o));case 4:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"remove",value:(r=(0,o.default)(i.default.mark((function e(r){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this._genDbKey(r),e.abrupt("return",(0,f.default)((0,l.default)(t.prototype),"remove",this).call(this,r));case 2:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"_genDbKey",value:function(e){return g.throwIfUndefined(e,"key"),g.sha256Multihash(this._salt+e)}},{key:"_encryptEntry",value:function(e){if(void 0===e)throw new Error("Entry to encrypt cannot be undefined");return this.keyring.symEncrypt(this._pad(JSON.stringify(e)))}},{key:"_decryptEntry",value:function(e){var t=e.ciphertext,r=e.nonce;return JSON.parse(this._unpad(this.keyring.symDecrypt(t,r)))}},{key:"_pad",value:function(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:24,r=(t-e.length%t)%t;return"".concat(e).concat("\0".repeat(r))}},{key:"_unpad",value:function(e){return e.replace(/\0+$/,"")}},{key:"log",get:function(){var e=this;return(0,f.default)((0,l.default)(t.prototype),"log",this).map((function(t){return Object.assign(t,{value:t.value?e._decryptEntry(t.value):null})}))}}]),t}(m);t.exports=y}}},{package:"3box",file:"/home/circleci/project/node_modules/3box/lib/privateStore.js"}],[5942,{"../plugins/json2":5943,"../src/store-engine":5945,"../storages/all":5947},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("../src/store-engine"),i=e("../storages/all"),s=[e("../plugins/json2")];t.exports=n.createStore(i,s)}}},{package:"store",file:"/home/circleci/project/node_modules/store/dist/store.legacy.js"}],[170,{"./keyValueStore":167,"./thread":171,"./utils":173,"@babel/runtime/helpers/asyncToGenerator":185,"@babel/runtime/helpers/classCallCheck":186,"@babel/runtime/helpers/createClass":188,"@babel/runtime/helpers/defineProperty":189,"@babel/runtime/helpers/interopRequireDefault":195,"@babel/runtime/regenerator":215,"orbit-db/src/orbit-db-address":5438},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault"),i=n(e("@babel/runtime/helpers/defineProperty")),s=n(e("@babel/runtime/regenerator")),o=n(e("@babel/runtime/helpers/asyncToGenerator")),a=n(e("@babel/runtime/helpers/classCallCheck")),c=n(e("@babel/runtime/helpers/createClass"));function u(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?u(r,!0).forEach((function(t){(0,i.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):u(r).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var f=e("./keyValueStore"),d=e("./thread"),h=e("./utils"),p=h.sha256Multihash,m=h.throwIfUndefined,g=h.throwIfNotEqualLenArrays,y=e("orbit-db/src/orbit-db-address"),b=function(e){return"3box.space.".concat(e,".keyvalue")},v=function(e,t){return"3box.thread.".concat(e,".").concat(t)},w=function(){function e(t,r,n,i,s){(0,a.default)(this,e),this._name=t,this._3id=r,this._ensureConnected=s,this._store=new f(n,b(this._name),this._ensureConnected,this._3id),this._orbitdb=n,this._activeThreads={},this._rootStore=i,this.public=null,this.private=null}var t,r,n,i,u,l;return(0,c.default)(e,[{key:"open",value:(l=(0,o.default)(s.default.mark((function e(){var t,r,n,i,a,c,u,l,f=this,d=arguments;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=d.length>0&&d[0]!==undefined?d[0]:{},this._store._db){e.next=29;break}return e.next=4,this._3id.initKeyringByName(this._name);case 4:return r=e.sent,t.consentCallback&&t.consentCallback(r,this._name),e.next=8,this._store._load();case 8:return n=e.sent,e.next=11,this._rootStore.iterator({limit:-1}).collect();case 11:if(i=e.sent,a=i.find((function(e){return e.payload.value.odbAddress&&-1!==e.payload.value.odbAddress.indexOf(b(f._name))}))){e.next=18;break}return e.next=16,this._rootStore.add({type:"space",DID:this.DID,odbAddress:n});case 16:e.next=23;break;case 18:if(a.payload.value.type){e.next=23;break}return e.next=21,this._rootStore.del(a.hash);case 21:return e.next=23,this._rootStore.add({type:"space",DID:this.DID,odbAddress:n});case 23:c=t.numEntriesMessages&&t.numEntriesMessages[n],u=c?t.numEntriesMessages[n].numEntries:undefined,l=function(){var e=(0,o.default)(s.default.mark((function e(){return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f._store._sync(u);case 2:t.onSyncDone&&t.onSyncDone();case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),this._syncSpacePromise=l(),this.public=_(this._store),this.private=E(this._store,this._3id.getKeyringBySpaceName(b(this._name)));case 29:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:"joinThread",value:(u=(0,o.default)(s.default.mark((function e(t){var r,n,i,o,a=arguments;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.length>1&&a[1]!==undefined?a[1]:{},n=r.noAutoSub?function(){}:this.subscribeThread.bind(this),r.firstModerator||(r.firstModerator=this._3id.getSubDID(this._name)),i=new d(this._orbitdb,v(this._name,t),this._3id,r.members,r.firstModerator,n,this._ensureConnected),e.next=6,i._getThreadAddress();case 6:if(o=e.sent,!this._activeThreads[o]){e.next=9;break}return e.abrupt("return",this._activeThreads[o]);case 9:return e.next=11,i._load();case 11:return this._activeThreads[o]=i,e.abrupt("return",i);case 13:case"end":return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})},{key:"joinThreadByAddress",value:(i=(0,o.default)(s.default.mark((function e(t){var r,n,i,o,a,c=arguments;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=c.length>1&&c[1]!==undefined?c[1]:{},y.isValid(t)){e.next=3;break}throw new Error("joinThreadByAddress: valid orbitdb address required");case 3:if(n=t.split(".")[2],i=t.split(".")[3],n===this._name){e.next=7;break}throw new Error("joinThreadByAddress: attempting to open thread from different space, must open within same space");case 7:if(!this._activeThreads[t]){e.next=9;break}return e.abrupt("return",this._activeThreads[t]);case 9:return o=r.noAutoSub?function(){}:this.subscribeThread.bind(this),a=new d(this._orbitdb,v(this._name,i),this._3id,r.members,r.firstModerator,o,this._ensureConnected),e.next=13,a._load(t);case 13:return this._activeThreads[t]=a,e.abrupt("return",a);case 15:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"subscribeThread",value:(n=(0,o.default)(s.default.mark((function e(t){var r,n,i=arguments;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=i.length>1&&i[1]!==undefined?i[1]:{},y.isValid(t)){e.next=3;break}throw new Error("subscribeThread: must subscribe to valid thread/orbitdb address");case 3:return n="thread-".concat(t),e.next=6,this._syncSpacePromise;case 6:return e.next=8,this.public.get(n);case 8:if(e.sent){e.next=11;break}return e.next=11,this.public.set(n,Object.assign({},r,{address:t}));case 11:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"unsubscribeThread",value:(r=(0,o.default)(s.default.mark((function e(t){var r;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="thread-".concat(t),e.next=3,this.public.get(r);case 3:if(!e.sent){e.next=6;break}return e.next=6,this.public.remove(r);case 6:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"subscribedThreads",value:(t=(0,o.default)(s.default.mark((function e(){var t;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.public.all();case 2:return t=e.sent,e.abrupt("return",Object.keys(t).reduce((function(e,r){if(r.startsWith("thread")){var n=r.split("thread-")[1];y.isValid(n)&&e.push(t[r])}return e}),[]));case 4:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"DID",get:function(){return this._3id.getSubDID(this._name)}}]),e}();t.exports=w;var _=function(e){var t,r,n,i,a,c,u="pub_";return{get:(c=(0,o.default)(s.default.mark((function t(r){var n,i=arguments;return s.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=i.length>1&&i[1]!==undefined?i[1]:{},t.abrupt("return",e.get(u+r,n));case 2:case"end":return t.stop()}}),t)}))),function(e){return c.apply(this,arguments)}),getMetadata:(a=(0,o.default)(s.default.mark((function t(r){return s.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.getMetadata(u+r));case 1:case"end":return t.stop()}}),t)}))),function(e){return a.apply(this,arguments)}),set:(i=(0,o.default)(s.default.mark((function t(r,n){return s.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return m(r,"key"),t.abrupt("return",e.set(u+r,n));case 2:case"end":return t.stop()}}),t)}))),function(e,t){return i.apply(this,arguments)}),setMultiple:(n=(0,o.default)(s.default.mark((function t(r,n){var i;return s.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return g(r,n),i=r.map((function(e){return u+e})),t.abrupt("return",e.setMultiple(i,n));case 3:case"end":return t.stop()}}),t)}))),function(e,t){return n.apply(this,arguments)}),remove:(r=(0,o.default)(s.default.mark((function t(r){return s.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return m(r,"key"),t.abrupt("return",e.remove(u+r));case 2:case"end":return t.stop()}}),t)}))),function(e){return r.apply(this,arguments)}),get log(){return e.log.reduce((function(e,t){return t.key.startsWith(u)&&(t.key=t.key.slice(4),e.push(t)),e}),[])},all:(t=(0,o.default)(s.default.mark((function t(r){var n;return s.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.all(r);case 2:return n=t.sent,t.abrupt("return",Object.keys(n).reduce((function(e,t){return t.startsWith(u)&&(e[t.slice(4)]=n[t]),e}),{}));case 4:case"end":return t.stop()}}),t)}))),function(e){return t.apply(this,arguments)})}},E=function(e,t){var r,n,i,a,c,u,f="priv_",d=t.getDBSalt(),h=function(e){return m(e,"key"),f+p(d+e)},y=function(e){return t.symEncrypt(function(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:24,r=(t-e.length%t)%t;return"".concat(e).concat("\0".repeat(r))}(JSON.stringify(e)))},b=function(e){var r=e.ciphertext,n=e.nonce;return JSON.parse(t.symDecrypt(r,n).replace(/\0+$/,""))};return{get:(u=(0,o.default)(s.default.mark((function t(r){var n,i,o=arguments;return s.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=o.length>1&&o[1]!==undefined?o[1]:{},t.next=3,e.get(h(r),n);case 3:if(i=t.sent){t.next=6;break}return t.abrupt("return",null);case 6:if(!n.metadata){t.next=8;break}return t.abrupt("return",l({},i,{value:b(i.value).value}));case 8:return t.abrupt("return",b(i).value);case 9:case"end":return t.stop()}}),t)}))),function(e){return u.apply(this,arguments)}),getMetadata:(c=(0,o.default)(s.default.mark((function t(r){return s.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.getMetadata(h(r)));case 1:case"end":return t.stop()}}),t)}))),function(e){return c.apply(this,arguments)}),set:(a=(0,o.default)(s.default.mark((function t(r,n){return s.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.set(h(r),y({key:r,value:n})));case 1:case"end":return t.stop()}}),t)}))),function(e,t){return a.apply(this,arguments)}),setMultiple:(i=(0,o.default)(s.default.mark((function t(r,n){var i,o;return s.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return g(r,n),i=r.map(h),o=n.map((function(e,t){return y({key:r[t],value:e})})),t.abrupt("return",e.setMultiple(i,o));case 4:case"end":return t.stop()}}),t)}))),function(e,t){return i.apply(this,arguments)}),remove:(n=(0,o.default)(s.default.mark((function t(r){return s.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.remove(h(r)));case 1:case"end":return t.stop()}}),t)}))),function(e){return n.apply(this,arguments)}),get log(){return e.log.reduce((function(e,t){if(t.key.startsWith(f)){var r=b(t.value);t.key=r.key,t.value=r.value,e.push(t)}return e}),[])},all:(r=(0,o.default)(s.default.mark((function t(){var r,n,i=arguments;return s.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=i.length>0&&i[0]!==undefined?i[0]:{},t.next=3,e.all(r);case 3:return n=t.sent,t.abrupt("return",Object.keys(n).reduce((function(e,t){if(t.startsWith(f)){var i=n[t];if(r.metadata){var s=b(i.value);e[s.key]=l({},i,{value:s.value})}else{var o=b(i);e[o.key]=o.value}}return e}),{}));case 5:case"end":return t.stop()}}),t)}))),function(){return r.apply(this,arguments)})}}}}},{package:"3box",file:"/home/circleci/project/node_modules/3box/lib/space.js"}],[165,{"./config.js":166,"./utils/id":172,"./utils/index":173,"./utils/verifier":174,"@babel/runtime/helpers/asyncToGenerator":185,"@babel/runtime/helpers/interopRequireDefault":195,"@babel/runtime/regenerator":215,"graphql-request":4396},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault"),i=n(e("@babel/runtime/regenerator")),s=n(e("@babel/runtime/helpers/asyncToGenerator")),o=e("graphql-request").request,a=e("./utils/index"),c=e("./utils/verifier"),u=e("./utils/id").isMuportDID,l=e("./config.js"),f=l.graphql_server_url,d=l.profile_server_url,h=l.address_server_url;function p(){return p=(0,s.default)(i.default.mark((function e(t){var r,n,s=arguments;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=s.length>1&&s[1]!==undefined?s[1]:h,e.next=3,a.fetchJson(r+"/odbAddress/"+t);case 3:return n=e.sent,e.abrupt("return",n.data.rootStoreAddress);case 5:case"end":return e.stop()}}),e)}))),p.apply(this,arguments)}function m(){return m=(0,s.default)(i.default.mark((function e(t){var r,n=arguments;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.length>1&&n[1]!==undefined?n[1]:d,e.prev=1,!u(t)){e.next=8;break}return e.next=5,a.fetchJson(r+"/list-spaces?did="+encodeURIComponent(t));case 5:case 10:return e.abrupt("return",e.sent);case 8:return e.next=10,a.fetchJson(r+"/list-spaces?address="+encodeURIComponent(t));case 11:e.next=16;break;case 13:return e.prev=13,e.t0=e.catch(1),e.abrupt("return",[]);case 16:case"end":return e.stop()}}),e,null,[[1,13]])}))),m.apply(this,arguments)}function g(){return g=(0,s.default)(i.default.mark((function e(t,r){var n,s,o,c,l,f=arguments;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=f.length>2&&f[2]!==undefined?f[2]:d,s=f.length>3&&f[3]!==undefined?f[3]:{},o=s.metadata,!(c=s.blocklist)||!c(t)){e.next=4;break}throw new Error("user with ".concat(t," is blocked"));case 4:return l="".concat(n,"/space"),e.prev=5,l=u(t)?"".concat(l,"?did=").concat(encodeURIComponent(t)):"".concat(l,"?address=").concat(encodeURIComponent(t.toLowerCase())),l="".concat(l,"&name=").concat(encodeURIComponent(r)),o&&(l="".concat(l,"&metadata=").concat(encodeURIComponent(o))),e.next=11,a.fetchJson(l);case 11:return e.abrupt("return",e.sent);case 14:return e.prev=14,e.t0=e.catch(5),e.abrupt("return",{});case 17:case"end":return e.stop()}}),e,null,[[5,14]])}))),g.apply(this,arguments)}function y(e,t){return b.apply(this,arguments)}function b(){return b=(0,s.default)(i.default.mark((function e(t,r){var n,s,o=arguments;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=o.length>2&&o[2]!==undefined?o[2]:{},e.next=3,_(t,n);case 3:if((s=e.sent).spaces[r]&&s.spaces[r].DID){e.next=6;break}throw new Error("Could not find appropriate DID for address ".concat(t));case 6:return e.abrupt("return",s.spaces[r].DID);case 7:case"end":return e.stop()}}),e)}))),b.apply(this,arguments)}function v(){return v=(0,s.default)(i.default.mark((function e(t,r,n,s){var o,c,u,l=arguments;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=l.length>4&&l[4]!==undefined?l[4]:{},c=o.profileServer||d,!n.startsWith("0x")){e.next=6;break}return e.next=5,y(n,t,o);case 5:n=e.sent;case 6:return e.prev=6,u="".concat(c,"/thread?space=").concat(encodeURIComponent(t),"&name=").concat(encodeURIComponent(r)),u+="&mod=".concat(encodeURIComponent(n),"&members=").concat(encodeURIComponent(s)),e.next=11,a.fetchJson(u);case 11:return e.abrupt("return",e.sent);case 14:throw e.prev=14,e.t0=e.catch(6),new Error(e.t0);case 17:case"end":return e.stop()}}),e,null,[[6,14]])}))),v.apply(this,arguments)}function w(){return w=(0,s.default)(i.default.mark((function e(t){var r,n,s=arguments;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=s.length>1&&s[1]!==undefined?s[1]:{},n=r.profileServer||d,e.prev=2,e.next=5,a.fetchJson("".concat(n,"/thread?address=").concat(encodeURIComponent(t)));case 5:return e.abrupt("return",e.sent);case 8:throw e.prev=8,e.t0=e.catch(2),new Error(e.t0);case 11:case"end":return e.stop()}}),e,null,[[2,8]])}))),w.apply(this,arguments)}function _(e){return E.apply(this,arguments)}function E(){return E=(0,s.default)(i.default.mark((function e(t){var r,n,s=arguments;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=s.length>1&&s[1]!==undefined?s[1]:{},n=r.profileServer||d,e.prev=2,e.next=5,a.fetchJson("".concat(n,"/config?address=").concat(encodeURIComponent(t)));case 5:return e.abrupt("return",e.sent);case 8:throw e.prev=8,e.t0=e.catch(2),new Error(e.t0);case 11:case"end":return e.stop()}}),e,null,[[2,8]])}))),E.apply(this,arguments)}function k(){return k=(0,s.default)(i.default.mark((function e(t){var r,n,s,o,c,l=arguments;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=l.length>1&&l[1]!==undefined?l[1]:d,n=l.length>2&&l[2]!==undefined?l[2]:{},s=n.metadata,!(o=n.blocklist)||!o(t)){e.next=4;break}throw new Error("user with ".concat(t," is blocked"));case 4:return c="".concat(r,"/profile"),e.prev=5,c=u(t)?"".concat(c,"?did=").concat(encodeURIComponent(t)):"".concat(c,"?address=").concat(encodeURIComponent(t.toLowerCase())),s&&(c="".concat(c,"&metadata=").concat(encodeURIComponent(s))),e.next=10,a.fetchJson(c);case 10:return e.abrupt("return",e.sent);case 13:return e.prev=13,e.t0=e.catch(5),e.abrupt("return",{});case 16:case"end":return e.stop()}}),e,null,[[5,13]])}))),k.apply(this,arguments)}function S(){return S=(0,s.default)(i.default.mark((function e(t){var r,n,s,o=arguments;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=o.length>1&&o[1]!==undefined?o[1]:{},r=Object.assign({profileServer:d},r),n={addressList:[],didList:[]},t.forEach((function(e){u(e)?n.didList.push(e):n.addressList.push(e)})),s="".concat(r.profileServer,"/profileList"),e.abrupt("return",a.fetchJson(s,n));case 6:case"end":return e.stop()}}),e)}))),S.apply(this,arguments)}function A(){return A=(0,s.default)(i.default.mark((function e(t){var r,n=arguments;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.length>1&&n[1]!==undefined?n[1]:{},r=Object.assign({graphqlServer:f},r),e.abrupt("return",o(r.graphqlServer,t));case 3:case"end":return e.stop()}}),e)}))),A.apply(this,arguments)}function T(){return(T=(0,s.default)(i.default.mark((function e(t){var r,n;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={},e.prev=1,e.next=4,c.verifyDID(t.proof_did);case 4:if(n=e.sent,r.did=n,!t.proof_github){e.next=15;break}return e.prev=7,e.next=10,c.verifyGithub(n,t.proof_github);case 10:r.github=e.sent,e.next=15;break;case 13:e.prev=13,e.t0=e.catch(7);case 15:if(!t.proof_twitter){e.next=24;break}return e.prev=16,e.next=19,c.verifyTwitter(n,t.proof_twitter);case 19:r.twitter=e.sent,e.next=24;break;case 22:e.prev=22,e.t1=e.catch(16);case 24:if(!t.ethereum_proof){e.next=33;break}return e.prev=25,e.next=28,c.verifyEthereum(t.ethereum_proof,n);case 28:r.ethereum=e.sent,e.next=33;break;case 31:e.prev=31,e.t2=e.catch(25);case 33:e.next=37;break;case 35:e.prev=35,e.t3=e.catch(1);case 37:return e.abrupt("return",r);case 38:case"end":return e.stop()}}),e,null,[[1,35],[7,13],[16,22],[25,31]])})))).apply(this,arguments)}t.exports={profileGraphQL:function(e){return A.apply(this,arguments)},getProfile:function(e){return k.apply(this,arguments)},getSpace:function(e,t){return g.apply(this,arguments)},listSpaces:function(e){return m.apply(this,arguments)},getThread:function(e,t,r,n){return v.apply(this,arguments)},getThreadByAddress:function(e){return w.apply(this,arguments)},getConfig:_,getRootStoreAddress:function(e){return p.apply(this,arguments)},getProfiles:function(e){return S.apply(this,arguments)},getVerifiedAccounts:function(e){return T.apply(this,arguments)},getSpaceDID:y}}}},{package:"3box",file:"/home/circleci/project/node_modules/3box/lib/api.js"}],[173,{"@babel/runtime/helpers/asyncToGenerator":185,"@babel/runtime/helpers/interopRequireDefault":195,"@babel/runtime/regenerator":215,buffer:2157,ethers:178,"js-sha256":4796,multihashes:5312,"node-fetch":5340},function(){with(this)return function(){"use strict";return function(e,t,r){(function(r){(function(){var n,i,s,o,a=e("@babel/runtime/helpers/interopRequireDefault"),c=a(e("@babel/runtime/regenerator")),u=a(e("@babel/runtime/helpers/asyncToGenerator")),l="undefined"!=typeof window?window.fetch:e("node-fetch"),f=e("multihashes"),d=e("js-sha256").sha256,h=e("ethers"),p=function(e,t){var r=new Error(t);return r.statusCode=e,r},m=function(e,t){var r="Create a new 3Box profile"+"\n\n"+"- \n"+"Your unique profile ID is "+e;return t&&(r+=" \n"+"Timestamp: "+t),r},g=function(e,t,r){var n=(Boolean(e.sendAsync)?e.sendAsync:e.send).bind(e);return new Promise((function(e,r){n(t,(function(t,n){t&&r(t),n.error&&r(n.error),e(n.result)}))}))};t.exports={getMessageConsent:m,recoverPersonalSign:(o=(0,u.default)(c.default.mark((function e(t,r){return c.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&r){e.next=2;break}throw new Error("recoverPersonalSign: missing arguments, msg and/or personalSig");case 2:return e.abrupt("return",h.utils.verifyMessage(t,r));case 4:case"end":return e.stop()}}),e)}))),function(e,t){return o.apply(this,arguments)}),openBoxConsent:function(e,t){var n="0x"+r.from("This app wants to view and update your 3Box profile.","utf8").toString("hex");return g(t,{jsonrpc:"2.0",id:0,method:"personal_sign",params:[n,e],fromAddress:e})},openSpaceConsent:function(e,t,n){var i="Allow this app to open your ".concat(n," space."),s="0x"+r.from(i,"utf8").toString("hex");return g(t,{jsonrpc:"2.0",id:0,method:"personal_sign",params:[s,e],fromAddress:e})},getLinkConsent:(s=(0,u.default)(c.default.mark((function e(t,n,i){var s,o,a,u,l;return c.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=Math.floor((new Date).getTime()/1e3),o=m(n,s),a="0x"+r.from(o,"utf8").toString("hex"),u=[a,t],e.next=7,g(i,{jsonrpc:"2.0",id:0,method:"personal_sign",params:u,fromAddress:t});case 7:return l=e.sent,e.abrupt("return",{msg:o,sig:l,timestamp:s});case 9:case"end":return e.stop()}}),e)}))),function(e,t,r){return s.apply(this,arguments)}),fetchJson:(i=(0,u.default)(c.default.mark((function e(t,r){var n,i;return c.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r&&(n={body:JSON.stringify(r),method:"POST",headers:{"Content-Type":"application/json"}}),e.next=3,l(t,n);case 3:if(!(i=e.sent).ok){e.next=8;break}return e.abrupt("return",i.json());case 8:throw p(i.status,"Invalid response (".concat(i.status,") for query at ").concat(t));case 9:case"end":return e.stop()}}),e)}))),function(e,t){return i.apply(this,arguments)}),fetchText:(n=(0,u.default)(c.default.mark((function e(t,r){var n;return c.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l(t,r);case 2:if(!(n=e.sent).ok){e.next=7;break}return e.abrupt("return",n.text());case 7:throw p(n.status,"Invalid response (".concat(n.status,") for query at ").concat(t));case 8:case"end":return e.stop()}}),e)}))),function(e,t){return n.apply(this,arguments)}),throwIfUndefined:function(e,t){if(e===undefined||null===e)throw new Error("".concat(t," is a required argument"))},throwIfNotEqualLenArrays:function(e,t){if(!Array.isArray(e)||!Array.isArray(t))throw new Error("One or more arguments are not an array");if(e.length!==t.length)throw new Error("Arrays must be of the same length")},sha256Multihash:function(e){var t=r.from(d.digest(e));return f.encode(t,"sha2-256").toString("hex")},sha256:d}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"3box",file:"/home/circleci/project/node_modules/3box/lib/utils/index.js"}],[5428,{"./src/ipfs-pubsub":5429},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=e("./src/ipfs-pubsub")}}},{package:"orbit-db-pubsub",file:"/home/circleci/project/node_modules/orbit-db-pubsub/index.js"}],[166,{_process:5498,"ipfs-log":4531},function(){with(this)return function(){"use strict";return function(e,t,r){(function(r){(function(){var n=e("ipfs-log"),i="0.0.3";t.exports={address_server_url:r.env.ADDRESS_SERVER_URL||"https://beta.3box.io/address-server",pinning_node:r.env.PINNING_NODE||"/dnsaddr/ipfs.3box.io/tcp/443/wss/ipfs/QmZvxEpiVNjmNbEKyQGvFzAY1BwmGuuvdUTmcTstQPhyVC",pinning_room:r.env.PINNING_ROOM||"3box-pinning",iframe_store_version:r.env.IFRAME_STORE_VERSION||i,iframe_store_url:r.env.IFRAME_STORE_URL||"https://iframe.3box.io/".concat(i,"/iframe.html"),ipfs_options:{EXPERIMENTAL:{pubsub:!0},preload:{enabled:!1},config:{Bootstrap:[]}},orbitdb_options:{syncLocal:!0,sortFn:n.Sorting.SortByEntryHash},graphql_server_url:r.env.GRAPHQL_SERVER_URL||"https://api.3box.io/graph/",profile_server_url:r.env.PROFILE_SERVER_URL||"https://ipfs.3box.io",muport_ipfs_host:r.env.MUPORT_IPFS_HOST||"ipfs.infura.io",muport_ipfs_port:r.env.MUPORT_IPFS_PORT||5001,muport_ipfs_protocol:r.env.MUPORT_IPFS_PROTOCOL||"https"}}).call(this)}).call(this,e("_process"))}}},{package:"3box",file:"/home/circleci/project/node_modules/3box/lib/config.js"}],[163,{"../config.js":166,"../utils/index":173,"./keyring":164,"3box-orbitdb-plugins":157,"3id-resolver":179,"@babel/runtime/helpers/asyncToGenerator":185,"@babel/runtime/helpers/classCallCheck":186,"@babel/runtime/helpers/createClass":188,"@babel/runtime/helpers/interopRequireDefault":195,"@babel/runtime/regenerator":215,buffer:2157,"did-jwt":176,ethers:178,"ipfs-did-document":4520,"ipfs-mini":4563,"orbit-db-identity-provider":5408,store:5942},function(){with(this)return function(){"use strict";return function(e,t,r){(function(r){(function(){var n=e("@babel/runtime/helpers/interopRequireDefault"),i=n(e("@babel/runtime/regenerator")),s=n(e("@babel/runtime/helpers/asyncToGenerator")),o=n(e("@babel/runtime/helpers/classCallCheck")),a=n(e("@babel/runtime/helpers/createClass")),c=e("ethers").utils.HDNode,u=e("did-jwt"),l=e("ipfs-did-document"),f=e("ipfs-mini"),d=e("store"),h=e("orbit-db-identity-provider"),p=e("3box-orbitdb-plugins").OdbIdentityProvider;h.addIdentityProvider(p);var m=e("3id-resolver"),g=e("../utils/index"),y=e("./keyring"),b=e("../config.js"),v="serialized3id_",w={host:b.muport_ipfs_host,port:b.muport_ipfs_port,protocol:b.muport_ipfs_protocol},_=function(){function e(t,r,n,i){(0,o.default)(this,e),this._ethereum=r,this._ipfs=n,this._keyrings={},this._initKeys(t,i),m(n),d.set(v+this.managementAddress,this.serializeState())}var t,n,p,b,_,k,S;return(0,a.default)(e,[{key:"signJWT",value:(S=(0,s.default)(i.default.mark((function e(t){var r,n,s,o,a,c,l,f=arguments;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=f.length>1&&f[1]!==undefined?f[1]:{},n=r.use3ID,s=r.space,o=r.expiresIn,a=s?this._keyrings[s]:this._mainKeyring,c=this.muportDID,n?c=this.DID:s&&(c=this._subDIDs[s]),l={signer:a.getJWTSigner(),issuer:c,expiresIn:o},e.abrupt("return",u.createJWT(t,l));case 6:case"end":return e.stop()}}),e,this)}))),function(e){return S.apply(this,arguments)})},{key:"getSubDID",value:function(e){return this._subDIDs[e]}},{key:"getOdbId",value:(k=(0,s.default)(i.default.mark((function e(t){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",h.createIdentity({type:"3ID",threeId:this,space:t}));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return k.apply(this,arguments)})},{key:"serializeState",value:function(){var e=this,t={managementAddress:this.managementAddress,seed:this._mainKeyring.serialize(),spaceSeeds:{}};return Object.keys(this._keyrings).map((function(r){t.spaceSeeds[r]=e._keyrings[r].serialize()})),JSON.stringify(t)}},{key:"_initKeys",value:function(e){var t=this,r=JSON.parse(e);this.managementAddress=r.managementAddress.toLowerCase(),this._mainKeyring=new y(r.seed),Object.keys(r.spaceSeeds).map((function(e){t._keyrings[e]=new y(r.spaceSeeds[e])}))}},{key:"_initDID",value:(_=(0,s.default)(i.default.mark((function e(t){var r,n,s,o=this;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this._initMuport(t),e.next=3,this._init3ID();case 3:return this._rootDID=e.sent,n=Object.keys(this._keyrings),e.next=7,Promise.all(n.map((function(e){return o._init3ID(e)})));case 7:return s=e.sent,this._subDIDs={},n.map((function(e,t){o._subDIDs[e]=s[t]})),e.next=12,r;case 12:case"end":return e.stop()}}),e,this)}))),function(e){return _.apply(this,arguments)})},{key:"_init3ID",value:(b=(0,s.default)(i.default.mark((function e(t){var r,n,s,o,a;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=new l(this._ipfs,"3"),t){e.next=9;break}n=this._mainKeyring.getPublicKeys(!0),r.addPublicKey("signingKey","Secp256k1VerificationKey2018","publicKeyHex",n.signingKey),r.addPublicKey("encryptionKey","Curve25519EncryptionPublicKey","publicKeyBase64",n.asymEncryptionKey),r.addPublicKey("managementKey","Secp256k1VerificationKey2018","ethereumAddress",this.managementAddress),r.addAuthentication("Secp256k1SignatureAuthentication2018","signingKey"),e.next=20;break;case 9:return s=this._keyrings[t].getPublicKeys(!0),r.addPublicKey("subSigningKey","Secp256k1VerificationKey2018","publicKeyHex",s.signingKey),r.addPublicKey("subEncryptionKey","Curve25519EncryptionPublicKey","publicKeyBase64",s.asymEncryptionKey),r.addAuthentication("Secp256k1SignatureAuthentication2018","subSigningKey"),r.addCustomProperty("space",t),r.addCustomProperty("root",this.DID),o={subSigningKey:s.signingKey,subEncryptionKey:s.asymEncryptionKey,space:t,iat:null},e.next=18,this.signJWT(o,{use3ID:!0});case 18:a=e.sent.split(".")[2],r.addCustomProperty("proof",{alg:"ES256K",signature:a});case 20:return e.next=22,r.commit({noTimestamp:!0});case 22:return e.abrupt("return",r.DID);case 23:case"end":return e.stop()}}),e,this)}))),function(e){return b.apply(this,arguments)})},{key:"_initMuport",value:(p=(0,s.default)(i.default.mark((function e(t){var n,o,a,c;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this._mainKeyring.getPublicKeys(),o=E(n.signingKey,this.managementAddress,n.asymEncryptionKey),e.next=4,this._ipfs.add(r.from(JSON.stringify(o)));case 4:a=e.sent[0].hash,this._muportDID="did:muport:"+a,this.muportFingerprint=g.sha256Multihash(this.muportDID),c=function(){var e=(0,s.default)(i.default.mark((function e(){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:new f(t).addJSON(o,(function(e,t){e&&console.error(e)}));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),c();case 9:case"end":return e.stop()}}),e,this)}))),function(e){return p.apply(this,arguments)})},{key:"getKeyringBySpaceName",value:function(e){var t=e.split(".");return t[0]===this.muportFingerprint?this._mainKeyring:this._keyrings[t[2]]}},{key:"initKeyringByName",value:(n=(0,s.default)(i.default.mark((function e(t){var r,n,s;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._keyrings[t]){e.next=14;break}return e.next=3,g.openSpaceConsent(this.managementAddress,this._ethereum,t);case 3:return r=e.sent,n="0x"+g.sha256(r.slice(2)),s=c.mnemonicToSeed(c.entropyToMnemonic(n)),this._keyrings[t]=new y(s),e.next=9,this._init3ID(t);case 9:return this._subDIDs[t]=e.sent,d.set(v+this.managementAddress,this.serializeState()),e.abrupt("return",!0);case 14:return e.abrupt("return",!1);case 15:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"logout",value:function(){d.remove(v+this.managementAddress)}},{key:"DID",get:function(){return this._rootDID}},{key:"muportDID",get:function(){return this._muportDID}}],[{key:"isLoggedIn",value:function(e){return Boolean(d.get(v+e.toLowerCase()))}},{key:"getIdFromEthAddress",value:(t=(0,s.default)(i.default.mark((function t(r,n,s){var o,a,u,l,f,h,p,m,y=arguments;return i.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o=y.length>3&&y[3]!==undefined?y[3]:{},a=r.toLowerCase(),!(u=d.get(v+a))){t.next=7;break}o.consentCallback&&o.consentCallback(!1),t.next=19;break;case 7:if(!o.contentSignature){t.next=11;break}l=o.contentSignature,t.next=14;break;case 11:return t.next=13,g.openBoxConsent(a,n);case 13:l=t.sent;case 14:o.consentCallback&&o.consentCallback(!0),f="0x"+g.sha256(l.slice(2)),h=c.entropyToMnemonic(f),p=c.mnemonicToSeed(h),u=JSON.stringify({managementAddress:a,seed:p,spaceSeeds:{}});case 19:return m=new e(u,n,s,o),t.next=22,m._initDID(o.muportIpfs||w);case 22:return t.abrupt("return",m);case 23:case"end":return t.stop()}}),t)}))),function(e,r,n){return t.apply(this,arguments)})}]),e}(),E=function(e,t,r){return{version:1,signingKey:e,managementKey:t,asymEncryptionKey:r}};t.exports=_}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"3box",file:"/home/circleci/project/node_modules/3box/lib/3id/index.js"}],[175,{"./utils/verifier":174,"@babel/runtime/helpers/asyncToGenerator":185,"@babel/runtime/helpers/classCallCheck":186,"@babel/runtime/helpers/createClass":188,"@babel/runtime/helpers/interopRequireDefault":195,"@babel/runtime/regenerator":215},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault"),i=n(e("@babel/runtime/regenerator")),s=n(e("@babel/runtime/helpers/asyncToGenerator")),o=n(e("@babel/runtime/helpers/classCallCheck")),a=n(e("@babel/runtime/helpers/createClass")),c=e("./utils/verifier"),u=function(){function e(t){(0,o.default)(this,e),this._box=t,this._did=t._3id.muportDID}var t,r,n,u,l,f,d,h,p,m,g;return(0,a.default)(e,[{key:"_addVerifiedPublicAccount",value:(g=(0,s.default)(i.default.mark((function e(t,r,n){var s;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n(this._did,r);case 2:return s=e.sent,e.next=5,this._box.public.set("proof_"+t,r);case 5:return e.abrupt("return",s);case 6:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return g.apply(this,arguments)})},{key:"_getVerifiedPublicAccount",value:(m=(0,s.default)(i.default.mark((function e(t,r){var n;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._box.public.get("proof_"+t);case 2:return n=e.sent,e.abrupt("return",r(this._did,n));case 4:case"end":return e.stop()}}),e,this)}))),function(e,t){return m.apply(this,arguments)})},{key:"_addVerifiedPrivateAccount",value:(p=(0,s.default)(i.default.mark((function e(t,r,n){var s;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n(this._did,r);case 2:return s=e.sent,e.next=5,this._box.private.set("proof_"+t,r);case 5:return e.abrupt("return",s);case 6:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return p.apply(this,arguments)})},{key:"_getVerifiedPrivateAccount",value:(h=(0,s.default)(i.default.mark((function e(t,r){var n;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._box.private.get("proof_"+t);case 2:return n=e.sent,e.abrupt("return",r(this._did,n));case 4:case"end":return e.stop()}}),e,this)}))),function(e,t){return h.apply(this,arguments)})},{key:"DID",value:(d=(0,s.default)(i.default.mark((function e(){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._did);case 1:case"end":return e.stop()}}),e,this)}))),function(){return d.apply(this,arguments)})},{key:"github",value:(f=(0,s.default)(i.default.mark((function e(){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._getVerifiedPublicAccount("github",c.verifyGithub));case 1:case"end":return e.stop()}}),e,this)}))),function(){return f.apply(this,arguments)})},{key:"addGithub",value:(l=(0,s.default)(i.default.mark((function e(t){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._addVerifiedPublicAccount("github",t,c.verifyGithub));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return l.apply(this,arguments)})},{key:"twitter",value:(u=(0,s.default)(i.default.mark((function e(){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._getVerifiedPublicAccount("twitter",c.verifyTwitter));case 1:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"addTwitter",value:(n=(0,s.default)(i.default.mark((function e(t){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._addVerifiedPublicAccount("twitter",t,c.verifyTwitter));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"email",value:(r=(0,s.default)(i.default.mark((function e(){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._getVerifiedPrivateAccount("email",c.verifyEmail));case 1:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"addEmail",value:(t=(0,s.default)(i.default.mark((function e(t){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._addVerifiedPrivateAccount("email",t,c.verifyEmail));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),e}();t.exports=u}}},{package:"3box",file:"/home/circleci/project/node_modules/3box/lib/verified.js"}],[172,{"@babel/runtime/helpers/asyncToGenerator":185,"@babel/runtime/helpers/interopRequireDefault":195,"@babel/runtime/regenerator":215,"did-jwt":176},function(){with(this)return function(){"use strict";return function(e,t,r){var n,i=e("@babel/runtime/helpers/interopRequireDefault"),s=i(e("@babel/runtime/regenerator")),o=i(e("@babel/runtime/helpers/asyncToGenerator")),a=e("did-jwt");t.exports={isMuportDID:function(e){return e.startsWith("did:muport:")},isClaim:(n=(0,o.default)(s.default.mark((function e(t){var r,n=arguments;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.length>1&&n[1]!==undefined?n[1]:{},e.prev=1,e.next=4,a.decodeJWT(t,r);case 4:return e.abrupt("return",!0);case 7:return e.prev=7,e.t0=e.catch(1),e.abrupt("return",!1);case 10:case"end":return e.stop()}}),e,null,[[1,7]])}))),function(e){return n.apply(this,arguments)}),verifyClaim:a.verifyJWT}}}},{package:"3box",file:"/home/circleci/project/node_modules/3box/lib/utils/id.js"}],[5386,{"./src/access-controllers":5389},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("./src/access-controllers");t.exports=n}}},{package:"orbit-db-access-controllers",file:"/home/circleci/project/node_modules/orbit-db-access-controllers/index.js"}],[169,{"./keyValueStore":167,"./utils/index":173,"@babel/runtime/helpers/asyncToGenerator":185,"@babel/runtime/helpers/classCallCheck":186,"@babel/runtime/helpers/createClass":188,"@babel/runtime/helpers/get":191,"@babel/runtime/helpers/getPrototypeOf":192,"@babel/runtime/helpers/inherits":193,"@babel/runtime/helpers/interopRequireDefault":195,"@babel/runtime/helpers/possibleConstructorReturn":206,"@babel/runtime/regenerator":215},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault"),i=n(e("@babel/runtime/regenerator")),s=n(e("@babel/runtime/helpers/asyncToGenerator")),o=n(e("@babel/runtime/helpers/classCallCheck")),a=n(e("@babel/runtime/helpers/createClass")),c=n(e("@babel/runtime/helpers/possibleConstructorReturn")),u=n(e("@babel/runtime/helpers/getPrototypeOf")),l=n(e("@babel/runtime/helpers/get")),f=n(e("@babel/runtime/helpers/inherits")),d=e("./keyValueStore"),h=e("./utils/index"),p=h.throwIfUndefined,m=h.throwIfNotEqualLenArrays,g=function(e){function t(e,r,n,i,s){var a;return(0,o.default)(this,t),(a=(0,c.default)(this,(0,u.default)(t).call(this,e,r,i,s)))._linkProfile=n,a}var r,n;return(0,f.default)(t,e),(0,a.default)(t,[{key:"set",value:(n=(0,s.default)(i.default.mark((function e(r,n){var s,o=arguments;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=o.length>2&&o[2]!==undefined?o[2]:{},p(r,"key"),s.noLink){e.next=5;break}return e.next=5,this._linkProfile();case 5:return e.abrupt("return",(0,l.default)((0,u.default)(t.prototype),"set",this).call(this,r,n));case 6:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"setMultiple",value:(r=(0,s.default)(i.default.mark((function e(r,n){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return m(r,n),e.next=3,this._linkProfile();case 3:return e.abrupt("return",(0,l.default)((0,u.default)(t.prototype),"setMultiple",this).call(this,r,n));case 4:case"end":return e.stop()}}),e,this)}))),function(e,t){return r.apply(this,arguments)})}]),t}(d);t.exports=g}}},{package:"3box",file:"/home/circleci/project/node_modules/3box/lib/publicStore.js"}],[157,{"./legacyIpfs3boxAccessController":158,"./moderatorAccessController":159,"./odbIdentityProvider":160,"./threadAccessController":161},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("./odbIdentityProvider"),i=e("./moderatorAccessController"),s=e("./threadAccessController"),o=e("./legacyIpfs3boxAccessController");t.exports={OdbIdentityProvider:n,ModeratorAccessController:i,ThreadAccessController:s,LegacyIPFS3BoxAccessController:o}}}},{package:"3box-orbitdb-plugins",file:"/home/circleci/project/node_modules/3box-orbitdb-plugins/src/index.js"}],[5435,{"./db-manifest":5436,"./exchange-heads":5437,"./orbit-db-address":5438,"./utils":5439,logplease:5261,"orbit-db-access-controllers":5386,"orbit-db-cache":5398,"orbit-db-counterstore":5400,"orbit-db-docstore":5403,"orbit-db-eventstore":5405,"orbit-db-feedstore":5407,"orbit-db-identity-provider":5408,"orbit-db-keystore":5415,"orbit-db-kvstore":5427,"orbit-db-pubsub":5428,path:5474},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("path"),i=e("orbit-db-eventstore"),s=e("orbit-db-feedstore"),o=e("orbit-db-kvstore"),a=e("orbit-db-counterstore"),c=e("orbit-db-docstore"),u=e("orbit-db-pubsub"),l=e("orbit-db-cache"),f=e("orbit-db-keystore"),d=e("orbit-db-identity-provider");let h=e("orbit-db-access-controllers");const p=e("./orbit-db-address"),m=e("./db-manifest"),g=e("./exchange-heads"),{isDefined:y,io:b}=e("./utils"),v=e("logplease"),w=v.create("orbit-db");v.setLogLevel("ERROR");let _={counter:a,eventlog:i,feed:s,docstore:c,keyvalue:o};class E{constructor(e,t,r={}){if(!y(e))throw new Error("IPFS is a required argument. See https://github.com/orbitdb/orbit-db/blob/master/API.md#createinstance");if(!y(t))throw new Error("identity is a required argument. See https://github.com/orbitdb/orbit-db/blob/master/API.md#createinstance");this._ipfs=e,this.identity=t,this.id=r.peerId,this._pubsub=r&&r.broker?new r.broker(this._ipfs):new u(this._ipfs,this.id),this.directory=r.directory||"./orbitdb",this.keystore=r.keystore,this.cache=r.cache||l,this.stores={},this._directConnections={},h=r.AccessControllers||h}static async createInstance(e,t={}){if(!y(e))throw new Error("IPFS is a required argument. See https://github.com/orbitdb/orbit-db/blob/master/API.md#createinstance");const{id:r}=await e.id(),i=t.directory||"./orbitdb",s=t.keystore||f.create(n.join(i,r,"/keystore")),o=t.identity||await d.createIdentity({id:t.id||r,keystore:s});t=Object.assign({},t,{peerId:r,directory:i,keystore:s});return new E(e,o,t)}async feed(e,t={}){return t=Object.assign({create:!0,type:"feed"},t),this.open(e,t)}async log(e,t={}){return t=Object.assign({create:!0,type:"eventlog"},t),this.open(e,t)}async eventlog(e,t={}){return this.log(e,t)}async keyvalue(e,t={}){return t=Object.assign({create:!0,type:"keyvalue"},t),this.open(e,t)}async kvstore(e,t={}){return this.keyvalue(e,t)}async counter(e,t={}){return t=Object.assign({create:!0,type:"counter"},t),this.open(e,t)}async docs(e,t={}){return t=Object.assign({create:!0,type:"docstore"},t),this.open(e,t)}async docstore(e,t={}){return this.docs(e,t)}async disconnect(){this.keystore.close&&await this.keystore.close();const e=Object.values(this.stores);for(let t of e)await t.close(),delete this.stores[t.address.toString()];Object.keys(this._directConnections).forEach((e=>{this._directConnections[e].close(),delete this._directConnections[e]})),this._pubsub&&await this._pubsub.disconnect(),this.stores={}}async stop(){await this.disconnect()}async _createStore(e,t,r){const n=_[e];if(!n)throw new Error(`Invalid database type '${e}'`);let i;r.accessControllerAddress&&(i=await h.resolve(this,r.accessControllerAddress,r.accessController));const s=await this._loadCache(this.directory,t),o=Object.assign({replicate:!0},r,{accessController:i,keystore:this.keystore,cache:s,onClose:this._onClose.bind(this)}),a=r.identity||this.identity,c=new n(this._ipfs,a,t,o);c.events.on("write",this._onWrite.bind(this));const u=t.toString();return this.stores[u]=c,o.replicate&&this._pubsub&&this._pubsub.subscribe(u,this._onMessage.bind(this),this._onPeerConnected.bind(this)),c}_onWrite(e,t,r){if(!r)throw new Error("'heads' not defined");this._pubsub&&this._pubsub.publish(e,r)}async _onMessage(e,t){const r=this.stores[e];try{w.debug(`Received ${t.length} heads for '${e}':\n`,JSON.stringify(t.map((e=>e.hash)),null,2)),r&&t&&t.length>0&&await r.sync(t)}catch(e){w.error(e)}}async _onPeerConnected(e,t){w.debug(`New peer '${t}' connected to '${e}'`);const r=e=>this.stores[e];await g(this._ipfs,e,t,r,(e=>this._directConnections[e]),((e,t)=>this._onMessage(e,t)),(e=>this._directConnections[e._receiverID]=e));r(e)&&r(e).events.emit("peer",t)}async _onClose(e){w.debug(`Close ${e}`),this._pubsub&&await this._pubsub.unsubscribe(e),delete this.stores[e]}async _determineAddress(e,t,r={}){if(!E.isValidType(t))throw new Error(`Invalid database type '${t}'`);if(p.isValid(e))throw new Error("Given database name is an address. Please give only the name of the database!");r.accessController=Object.assign({},{name:e,type:"ipfs"},r.accessController);const i=await h.create(this,r.accessController.type,r.accessController||{}),s=await m(this._ipfs,e,t,i,r);return p.parse(n.join("/orbitdb",s,e))}async create(e,t,r={}){w.debug("create()");const n=r.directory||this.directory;w.debug(`Creating database '${e}' as ${t} in '${n}'`);const i=await this._determineAddress(e,t,r),s=await this._loadCache(n,i);if(await this._haveLocalData(s,i)&&!r.overwrite)throw new Error(`Database '${i}' already exists!`);return await this._addManifestToCache(n,i),w.debug(`Created database '${i}'`),this.open(i,r)}async determineAddress(e,t,r={}){const n=Object.assign({},{onlyHash:!0},r);return this._determineAddress(e,t,n)}async open(e,t={}){w.debug("open()"),t=Object.assign({localOnly:!1,create:!1},t),w.debug(`Open database '${e}'`);const r=t.directory||this.directory;if(w.debug(`Look from '${r}'`),!p.isValid(e)){if(t.create){if(t.create&&!t.type)throw new Error(`Database type not provided! Provide a type with 'options.type' (${E.databaseTypes.join("|")})`);return w.warn(`Not a valid OrbitDB address '${e}', creating the database`),t.overwrite=!t.overwrite||t.overwrite,this.create(e,t.type,t)}throw new Error("'options.create' set to 'false'. If you want to create a database, set 'options.create' to 'true'.")}const n=p.parse(e),i=await this._loadCache(r,n),s=await this._haveLocalData(i,n);if(w.debug((s?"Found":"Didn't find")+` database '${n}'`),t.localOnly&&!s)throw w.warn(`Database '${n}' doesn't exist!`),new Error(`Database '${n}' doesn't exist!`);w.debug(`Loading Manifest for '${n}'`);const o=await b.read(this._ipfs,n.root);if(w.debug(`Manifest for '${n}':\n${JSON.stringify(o,null,2)}`),t.type&&o.type!==t.type)throw new Error(`Database '${n}' is type '${o.type}' but was opened as '${t.type}'`);return await this._addManifestToCache(r,n),t=Object.assign({},t,{accessControllerAddress:o.accessController}),this._createStore(o.type,n,t)}async _addManifestToCache(e,t){const r=await this._loadCache(e,t);await r.set(n.join(t.toString(),"_manifest"),t.root),w.debug(`Saved manifest to IPFS as '${t.root}'`)}async _loadCache(e,t){let r;try{r=await this.cache.load(e,t)}catch(e){console.log(e),w.error("Couldn't load Cache:",e)}return r}async _haveLocalData(e,t){if(!e)return!1;const r=await e.get(n.join(t.toString(),"_manifest"));return r!==undefined&&null!==r}static get databaseTypes(){return Object.keys(_)}static isValidType(e){return Object.keys(_).includes(e)}static addDatabaseType(e,t){if(_[e])throw new Error(`Type already exists: ${e}`);_[e]=t}static getDatabaseTypes(){return _}static isValidAddress(e){return p.isValid(e)}static parseAddress(e){return p.parse(e)}}t.exports=E}}},{package:"orbit-db",file:"/home/circleci/project/node_modules/orbit-db/src/OrbitDB.js"}],[4716,{"./boot":4658,"./components":4691,"./config":4715,"./mfs-preload":4726,"./preload":4727,"./runtime/ipld-nodejs":4732,"./runtime/repo-nodejs":4735,"./state":4736,buffer:2157,cids:2195,debug:2329,events:2158,"ipfs-block-service":4518,ipld:4757,"is-ipfs":4775,"libp2p-crypto":4928,"merge-options":5271,multiaddr:5286,multibase:5294,multicodec:5297,multihashes:5312,"multihashing-async":4640,"peer-book":5487,"peer-id":5488,"peer-info":5489},function(){with(this)return function(){"use strict";return function(e,t,r){(function(r){(function(){const n=e("ipfs-block-service"),i=e("ipld"),s=e("peer-id"),o=e("peer-info"),a=e("libp2p-crypto"),c=e("is-ipfs"),u=e("multiaddr"),l=e("multihashes"),f=e("peer-book"),d=e("multibase"),h=e("multicodec"),p=e("multihashing-async"),m=e("cids"),g=e("debug"),y=e("merge-options"),b=e("events"),v=e("./config"),w=e("./boot"),_=e("./components"),E=e("./runtime/repo-nodejs"),k=e("./preload"),S=e("./mfs-preload"),A=e("./runtime/ipld-nodejs");class T extends b{constructor(t){super();t=v.validate(t||{}),this._options=y({init:!0,start:!0,EXPERIMENTAL:{},preload:{enabled:!0,addresses:["/dnsaddr/node0.preload.ipfs.io/https","/dnsaddr/node1.preload.ipfs.io/https"]}},t),!1===t.init&&(this._options.init=!1),!1!==t.start&&(this._options.start=!0),"string"==typeof t.repo||t.repo===undefined?this._repo=E(t.repo):this._repo=t.repo,this.log=g("ipfs"),this.log.err=g("ipfs:err"),this._peerInfoBook=new f,this._peerInfo=undefined,this._bitswap=undefined,this._blockService=new n(this._repo),this._ipld=new i(A(this._blockService,this._options.ipld,this.log)),this._preload=k(this),this._mfsPreload=S(this),this._ipns=undefined,this._print=this._options.silent?this.log:console.log,this.init=_.init(this),this.preStart=_.preStart(this),this.start=_.start(this),this.stop=_.stop(this),this.shutdown=this.stop,this.isOnline=_.isOnline(this),Object.assign(this,_.filesRegular(this)),this.version=_.version(this),this.id=_.id(this),this.repo=_.repo(this),this.bootstrap=_.bootstrap(this),this.config=_.config(this),this.block=_.block(this),this.object=_.object(this),this.dag=_.dag(this),this.files=_.filesMFS(this),this.libp2p=null,this.swarm=_.swarm(this),this.name=_.name(this),this.bitswap=_.bitswap(this),this.pin=_.pin(this),this.ping=_.ping(this),this.pingPullStream=_.pingPullStream(this),this.pingReadableStream=_.pingReadableStream(this),this.pubsub=_.pubsub(this),this.dht=_.dht(this),this.dns=_.dns(this),this.key=_.key(this),this.stats=_.stats(this),this.resolve=_.resolve(this),this._options.EXPERIMENTAL.pubsub&&this.log("EXPERIMENTAL pubsub is enabled"),this._options.EXPERIMENTAL.ipnsPubsub&&(this._options.EXPERIMENTAL.pubsub||(this.log("EXPERIMENTAL pubsub is enabled to use IPNS pubsub"),this._options.EXPERIMENTAL.pubsub=!0),this.log("EXPERIMENTAL IPNS pubsub is enabled")),this._options.EXPERIMENTAL.sharding&&this.log("EXPERIMENTAL sharding is enabled"),this.state=e("./state")(this),w(this)}}t.exports=T;const I=r;Object.assign(t.exports,{crypto:a,isIPFS:c,Buffer:I,CID:m,multiaddr:u,multibase:d,multihash:l,multihashing:p,multicodec:h,PeerId:s,PeerInfo:o}),t.exports.createNode=e=>new T(e)}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"ipfs",file:"/home/circleci/project/node_modules/ipfs/src/core/index.js"}],[69,{"./add-ethereum-chain":66,"./eth-accounts":67,"./get-provider-state":68,"./log-web3-shim-usage":70,"./request-accounts":71,"./send-metadata":72,"./switch-ethereum-chain":73,"./watch-asset":74,"@babel/runtime/helpers/interopRequireDefault":195},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=n(e("./add-ethereum-chain")),s=n(e("./eth-accounts")),o=n(e("./get-provider-state")),a=n(e("./log-web3-shim-usage")),c=n(e("./request-accounts")),u=n(e("./send-metadata")),l=n(e("./switch-ethereum-chain")),f=n(e("./watch-asset"));var d=[i.default,s.default,o.default,a.default,c.default,u.default,l.default,f.default];r.default=d}}},{package:"<root>",file:"/home/circleci/project/app/scripts/lib/rpc-method-middleware/handlers/index.js"}],[1213,{"./permitted":1218,"./restricted":1223,"./utils":1227},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.selectHooks=r.restrictedMethodPermissionBuilders=r.permittedMethods=void 0;var n=e("./permitted");Object.defineProperty(r,"permittedMethods",{enumerable:!0,get:function(){return n.handlers}});var i=e("./restricted");Object.defineProperty(r,"restrictedMethodPermissionBuilders",{enumerable:!0,get:function(){return i.builders}});var s=e("./utils");Object.defineProperty(r,"selectHooks",{enumerable:!0,get:function(){return s.selectHooks}})}}},{package:"@metamask/rpc-methods",file:"/home/circleci/project/node_modules/@metamask/rpc-methods/dist/index.js"}],[4374,{},function(){with(this)return function(){"use strict";return function(e,t,r){
/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017 Joachim Wester
 * MIT license
 */
var n,i=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},n(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0});var s=Object.prototype.hasOwnProperty;function o(e,t){return s.call(e,t)}function a(e){if(Array.isArray(e)){for(var t=new Array(e.length),r=0;r<t.length;r++)t[r]=""+r;return t}if(Object.keys)return Object.keys(e);t=[];for(var n in e)o(e,n)&&t.push(n);return t}function c(e){return-1===e.indexOf("/")&&-1===e.indexOf("~")?e:e.replace(/~/g,"~0").replace(/\//g,"~1")}function u(e,t){var r;for(var n in e)if(o(e,n)){if(e[n]===t)return c(n)+"/";if("object"==typeof e[n]&&""!=(r=u(e[n],t)))return c(n)+"/"+r}return""}function l(e,t){var r=[e];for(var n in t){var i="object"==typeof t[n]?JSON.stringify(t[n],null,2):t[n];void 0!==i&&r.push(n+": "+i)}return r.join("\n")}Object.defineProperty(r,"hasOwnProperty",{value:o}),r._objectKeys=a,r._deepClone=function(e){switch(typeof e){case"object":return JSON.parse(JSON.stringify(e));case"undefined":return null;default:return e}},r.isInteger=function(e){for(var t,r=0,n=e.length;r<n;){if(!((t=e.charCodeAt(r))>=48&&t<=57))return!1;r++}return!0},r.escapePathComponent=c,r.unescapePathComponent=function(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")},r._getPathRecursive=u,r.getPath=function(e,t){if(e===t)return"/";var r=u(e,t);if(""===r)throw new Error("Object not found in root");return"/"+r},r.hasUndefined=function e(t){if(t===undefined)return!0;if(t)if(Array.isArray(t)){for(var r=0,n=t.length;r<n;r++)if(e(t[r]))return!0}else if("object"==typeof t){var i=a(t),s=i.length;for(r=0;r<s;r++)if(e(t[i[r]]))return!0}return!1};var f=function(e){function t(t,r,n,i,s){var o=this.constructor,a=e.call(this,l(t,{name:r,index:n,operation:i,tree:s}))||this;return a.name=r,a.index=n,a.operation=i,a.tree=s,Object.setPrototypeOf(a,o.prototype),a.message=l(t,{name:r,index:n,operation:i,tree:s}),a}return i(t,e),t}(Error);r.PatchError=f}}},{package:"fast-json-patch",file:"/home/circleci/project/node_modules/fast-json-patch/lib/helpers.js"}],[4372,{"./helpers":4374,"fast-deep-equal":4375},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=e("fast-deep-equal"),i=e("./helpers");r.JsonPatchError=i.PatchError,r.deepClone=i._deepClone;var s={add:function(e,t,r){return e[t]=this.value,{newDocument:r}},remove:function(e,t,r){var n=e[t];return delete e[t],{newDocument:r,removed:n}},replace:function(e,t,r){var n=e[t];return e[t]=this.value,{newDocument:r,removed:n}},move:function(e,t,r){var n=a(r,this.path);n&&(n=i._deepClone(n));var s=c(r,{op:"remove",path:this.from}).removed;return c(r,{op:"add",path:this.path,value:s}),{newDocument:r,removed:n}},copy:function(e,t,r){var n=a(r,this.from);return c(r,{op:"add",path:this.path,value:i._deepClone(n)}),{newDocument:r}},test:function(e,t,r){return{newDocument:r,test:n(e[t],this.value)}},_get:function(e,t,r){return this.value=e[t],{newDocument:r}}},o={add:function(e,t,r){return i.isInteger(t)?e.splice(t,0,this.value):e[t]=this.value,{newDocument:r,index:t}},remove:function(e,t,r){return{newDocument:r,removed:e.splice(t,1)[0]}},replace:function(e,t,r){var n=e[t];return e[t]=this.value,{newDocument:r,removed:n}},move:s.move,copy:s.copy,test:s.test,_get:s._get};function a(e,t){if(""==t)return e;var r={op:"_get",path:t};return c(e,r),r.value}function c(e,t,c,u,l,d){if(void 0===c&&(c=!1),void 0===u&&(u=!0),void 0===l&&(l=!0),void 0===d&&(d=0),c&&("function"==typeof c?c(t,0,e,t.path):f(t,0)),""===t.path){var h={newDocument:e};if("add"===t.op)return h.newDocument=t.value,h;if("replace"===t.op)return h.newDocument=t.value,h.removed=e,h;if("move"===t.op||"copy"===t.op)return h.newDocument=a(e,t.from),"move"===t.op&&(h.removed=e),h;if("test"===t.op){if(h.test=n(e,t.value),!1===h.test)throw new r.JsonPatchError("Test operation failed","TEST_OPERATION_FAILED",d,t,e);return h.newDocument=e,h}if("remove"===t.op)return h.removed=e,h.newDocument=null,h;if("_get"===t.op)return t.value=e,h;if(c)throw new r.JsonPatchError("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",d,t,e);return h}u||(e=i._deepClone(e));var p=(t.path||"").split("/"),m=e,g=1,y=p.length,b=undefined,v=void 0,w=void 0;for(w="function"==typeof c?c:f;;){if(v=p[g],l&&"__proto__"==v)throw new TypeError("JSON-Patch: modifying `__proto__` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(c&&b===undefined&&(m[v]===undefined?b=p.slice(0,g).join("/"):g==y-1&&(b=t.path),b!==undefined&&w(t,0,e,b)),g++,Array.isArray(m)){if("-"===v)v=m.length;else{if(c&&!i.isInteger(v))throw new r.JsonPatchError("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",d,t,e);i.isInteger(v)&&(v=~~v)}if(g>=y){if(c&&"add"===t.op&&v>m.length)throw new r.JsonPatchError("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",d,t,e);if(!1===(h=o[t.op].call(t,m,v,e)).test)throw new r.JsonPatchError("Test operation failed","TEST_OPERATION_FAILED",d,t,e);return h}}else if(v&&-1!=v.indexOf("~")&&(v=i.unescapePathComponent(v)),g>=y){if(!1===(h=s[t.op].call(t,m,v,e)).test)throw new r.JsonPatchError("Test operation failed","TEST_OPERATION_FAILED",d,t,e);return h}m=m[v]}}function u(e,t,n,s,o){if(void 0===s&&(s=!0),void 0===o&&(o=!0),n&&!Array.isArray(t))throw new r.JsonPatchError("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");s||(e=i._deepClone(e));for(var a=new Array(t.length),u=0,l=t.length;u<l;u++)a[u]=c(e,t[u],n,!0,o,u),e=a[u].newDocument;return a.newDocument=e,a}function l(e,t,n){var i=c(e,t);if(!1===i.test)throw new r.JsonPatchError("Test operation failed","TEST_OPERATION_FAILED",n,t,e);return i.newDocument}function f(e,t,n,o){if("object"!=typeof e||null===e||Array.isArray(e))throw new r.JsonPatchError("Operation is not an object","OPERATION_NOT_AN_OBJECT",t,e,n);if(!s[e.op])throw new r.JsonPatchError("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",t,e,n);if("string"!=typeof e.path)throw new r.JsonPatchError("Operation `path` property is not a string","OPERATION_PATH_INVALID",t,e,n);if(0!==e.path.indexOf("/")&&e.path.length>0)throw new r.JsonPatchError('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",t,e,n);if(("move"===e.op||"copy"===e.op)&&"string"!=typeof e.from)throw new r.JsonPatchError("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",t,e,n);if(("add"===e.op||"replace"===e.op||"test"===e.op)&&e.value===undefined)throw new r.JsonPatchError("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",t,e,n);if(("add"===e.op||"replace"===e.op||"test"===e.op)&&i.hasUndefined(e.value))throw new r.JsonPatchError("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",t,e,n);if(n)if("add"==e.op){var a=e.path.split("/").length,c=o.split("/").length;if(a!==c+1&&a!==c)throw new r.JsonPatchError("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",t,e,n)}else if("replace"===e.op||"remove"===e.op||"_get"===e.op){if(e.path!==o)throw new r.JsonPatchError("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",t,e,n)}else if("move"===e.op||"copy"===e.op){var u=d([{op:"_get",path:e.from,value:undefined}],n);if(u&&"OPERATION_PATH_UNRESOLVABLE"===u.name)throw new r.JsonPatchError("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",t,e,n)}}function d(e,t,n){try{if(!Array.isArray(e))throw new r.JsonPatchError("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(t)u(i._deepClone(t),i._deepClone(e),n||!0);else{n=n||f;for(var s=0;s<e.length;s++)n(e[s],s,t,undefined)}}catch(e){if(e instanceof r.JsonPatchError)return e;throw e}}r.getValueByPointer=a,r.applyOperation=c,r.applyPatch=u,r.applyReducer=l,r.validator=f,r.validate=d,r.default={JsonPatchError:r.JsonPatchError,deepClone:r.deepClone,getValueByPointer:a,applyOperation:c,applyPatch:u,applyReducer:l,validator:f,validate:d}}}},{package:"fast-json-patch",file:"/home/circleci/project/node_modules/fast-json-patch/lib/core.js"}],[237,{"./cid-util":236,multibase:219,multicodec:227,multihashes:231,"uint8arrays/concat":232,"uint8arrays/equals":233,"uint8arrays/to-string":235},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("multihashes"),i=e("multibase"),s=e("multicodec"),o=e("./cid-util"),a=e("uint8arrays/concat"),c=e("uint8arrays/to-string"),u=e("uint8arrays/equals"),l=s.nameToCode,f=Object.keys(l).reduce(((e,t)=>(e[l[t]]=t,e)),{}),d=Symbol.for("@ipld/js-cid/CID");class h{constructor(e,t,r,o){if(this.version,this.codec,this.multihash,Object.defineProperty(this,d,{value:!0}),h.isCID(e)){const t=e;return this.version=t.version,this.codec=t.codec,this.multihash=t.multihash,void(this.multibaseName=t.multibaseName||(0===t.version?"base58btc":"base32"))}if("string"==typeof e){const t=i.isEncoded(e);if(t){const r=i.decode(e);this.version=parseInt(r[0].toString(),16),this.codec=s.getCodec(r.slice(1)),this.multihash=s.rmPrefix(r.slice(1)),this.multibaseName=t}else this.version=0,this.codec="dag-pb",this.multihash=n.fromB58String(e),this.multibaseName="base58btc";return h.validateCID(this),void Object.defineProperty(this,"string",{value:e})}if(e instanceof Uint8Array){const t=parseInt(e[0].toString(),16);if(1===t){const r=e;this.version=t,this.codec=s.getCodec(r.slice(1)),this.multihash=s.rmPrefix(r.slice(1)),this.multibaseName="base32"}else this.version=0,this.codec="dag-pb",this.multihash=e,this.multibaseName="base58btc";h.validateCID(this)}else this.version=e,"number"==typeof t&&(t=f[t]),this.codec=t,this.multihash=r,this.multibaseName=o||(0===e?"base58btc":"base32"),h.validateCID(this)}get bytes(){let e=this._bytes;if(!e){if(0===this.version)e=this.multihash;else{if(1!==this.version)throw new Error("unsupported version");{const t=s.getCodeVarint(this.codec);e=a([[1],t,this.multihash],1+t.byteLength+this.multihash.byteLength)}}Object.defineProperty(this,"_bytes",{value:e})}return e}get prefix(){const e=s.getCodeVarint(this.codec),t=n.prefix(this.multihash);return a([[this.version],e,t],1+e.byteLength+t.byteLength)}get code(){return l[this.codec]}toV0(){if("dag-pb"!==this.codec)throw new Error("Cannot convert a non dag-pb CID to CIDv0");const{name:e,length:t}=n.decode(this.multihash);if("sha2-256"!==e)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");if(32!==t)throw new Error("Cannot convert non 32 byte multihash CID to CIDv0");return new h(0,this.codec,this.multihash)}toV1(){return new h(1,this.codec,this.multihash,this.multibaseName)}toBaseEncodedString(e=this.multibaseName){if(this.string&&0!==this.string.length&&e===this.multibaseName)return this.string;let t;if(0===this.version){if("base58btc"!==e)throw new Error("not supported with CIDv0, to support different bases, please migrate the instance do CIDv1, you can do that through cid.toV1()");t=n.toB58String(this.multihash)}else{if(1!==this.version)throw new Error("unsupported version");t=c(i.encode(e,this.bytes))}return e===this.multibaseName&&Object.defineProperty(this,"string",{value:t}),t}[Symbol.for("nodejs.util.inspect.custom")](){return"CID("+this.toString()+")"}toString(e){return this.toBaseEncodedString(e)}toJSON(){return{codec:this.codec,version:this.version,hash:this.multihash}}equals(e){return this.codec===e.codec&&this.version===e.version&&u(this.multihash,e.multihash)}static validateCID(e){const t=o.checkCIDComponents(e);if(t)throw new Error(t)}static isCID(e){return e instanceof h||Boolean(e&&e[d])}}h.codecs=l,t.exports=h}}},{package:"cids",file:"/home/circleci/project/node_modules/@ensdomains/content-hash/node_modules/cids/src/index.js"}],[4795,{buffer:2157},function(){with(this)return function(){"use strict";return function(e,t,r){(function(e){(function(){!function(e,n){"object"==typeof r&&void 0!==t?t.exports=n():"function"==typeof define&&define.amd?define(n):function(){const t=e.Base64,r=n();r.noConflict=()=>(e.Base64=t,r),e.Meteor&&(Base64=r),e.Base64=r}()}("undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:this,(function(){const t="3.6.1",r="function"==typeof atob,n="function"==typeof btoa,i="function"==typeof e,s="function"==typeof TextDecoder?new TextDecoder:undefined,o="function"==typeof TextEncoder?new TextEncoder:undefined,a=[..."ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="],c=(e=>{let t={};return e.forEach(((e,r)=>t[e]=r)),t})(a),u=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,l=String.fromCharCode.bind(String),f="function"==typeof Uint8Array.from?Uint8Array.from.bind(Uint8Array):(e,t=(e=>e))=>new Uint8Array(Array.prototype.slice.call(e,0).map(t)),d=e=>e.replace(/[+\/]/g,(e=>"+"==e?"-":"_")).replace(/=+$/m,""),h=e=>e.replace(/[^A-Za-z0-9\+\/]/g,""),p=e=>{let t,r,n,i,s="";const o=e.length%3;for(let o=0;o<e.length;){if((r=e.charCodeAt(o++))>255||(n=e.charCodeAt(o++))>255||(i=e.charCodeAt(o++))>255)throw new TypeError("invalid character found");t=r<<16|n<<8|i,s+=a[t>>18&63]+a[t>>12&63]+a[t>>6&63]+a[63&t]}return o?s.slice(0,o-3)+"===".substring(o):s},m=n?e=>btoa(e):i?t=>e.from(t,"binary").toString("base64"):p,g=i?t=>e.from(t).toString("base64"):e=>{let t=[];for(let r=0,n=e.length;r<n;r+=4096)t.push(l.apply(null,e.subarray(r,r+4096)));return m(t.join(""))},y=(e,t=!1)=>t?d(g(e)):g(e),b=e=>{if(e.length<2)return(t=e.charCodeAt(0))<128?e:t<2048?l(192|t>>>6)+l(128|63&t):l(224|t>>>12&15)+l(128|t>>>6&63)+l(128|63&t);var t=65536+1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320);return l(240|t>>>18&7)+l(128|t>>>12&63)+l(128|t>>>6&63)+l(128|63&t)},v=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,w=e=>e.replace(v,b),_=i?t=>e.from(t,"utf8").toString("base64"):o?e=>g(o.encode(e)):e=>m(w(e)),E=(e,t=!1)=>t?d(_(e)):_(e),k=e=>E(e,!0),S=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,A=e=>{switch(e.length){case 4:var t=((7&e.charCodeAt(0))<<18|(63&e.charCodeAt(1))<<12|(63&e.charCodeAt(2))<<6|63&e.charCodeAt(3))-65536;return l(55296+(t>>>10))+l(56320+(1023&t));case 3:return l((15&e.charCodeAt(0))<<12|(63&e.charCodeAt(1))<<6|63&e.charCodeAt(2));default:return l((31&e.charCodeAt(0))<<6|63&e.charCodeAt(1))}},T=e=>e.replace(S,A),I=e=>{if(e=e.replace(/\s+/g,""),!u.test(e))throw new TypeError("malformed base64.");e+="==".slice(2-(3&e.length));let t,r,n,i="";for(let s=0;s<e.length;)t=c[e.charAt(s++)]<<18|c[e.charAt(s++)]<<12|(r=c[e.charAt(s++)])<<6|(n=c[e.charAt(s++)]),i+=64===r?l(t>>16&255):64===n?l(t>>16&255,t>>8&255):l(t>>16&255,t>>8&255,255&t);return i},C=r?e=>atob(h(e)):i?t=>e.from(t,"base64").toString("binary"):I,x=i?t=>f(e.from(t,"base64")):e=>f(C(e),(e=>e.charCodeAt(0))),P=e=>x(R(e)),O=i?t=>e.from(t,"base64").toString("utf8"):s?e=>s.decode(x(e)):e=>T(C(e)),R=e=>h(e.replace(/[-_]/g,(e=>"-"==e?"+":"/"))),N=e=>O(R(e)),M=e=>({value:e,enumerable:!1,writable:!0,configurable:!0}),j=function(){const e=(e,t)=>Object.defineProperty(String.prototype,e,M(t));e("fromBase64",(function(){return N(this)})),e("toBase64",(function(e){return E(this,e)})),e("toBase64URI",(function(){return E(this,!0)})),e("toBase64URL",(function(){return E(this,!0)})),e("toUint8Array",(function(){return P(this)}))},L=function(){const e=(e,t)=>Object.defineProperty(Uint8Array.prototype,e,M(t));e("toBase64",(function(e){return y(this,e)})),e("toBase64URI",(function(){return y(this,!0)})),e("toBase64URL",(function(){return y(this,!0)}))},D={version:t,VERSION:"3.6.1",atob:C,atobPolyfill:I,btoa:m,btoaPolyfill:p,fromBase64:N,toBase64:E,encode:E,encodeURI:k,encodeURL:k,utob:w,btou:T,decode:N,isValid:e=>{if("string"!=typeof e)return!1;const t=e.replace(/\s+/g,"").replace(/=+$/,"");return!/[^\s0-9a-zA-Z\+/]/.test(t)||!/[^\s0-9a-zA-Z\-_]/.test(t)},fromUint8Array:y,toUint8Array:P,extendString:j,extendUint8Array:L,extendBuiltins:()=>{j(),L()},Base64:{}};return Object.keys(D).forEach((e=>D.Base64[e]=D[e])),D}))}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"js-base64",file:"/home/circleci/project/node_modules/js-base64/base64.js"}],[254,{},function(){with(this)return function(){"use strict";return function(e,t,r){const n=Object.freeze({identity:0,sha1:17,"sha2-256":18,"sha2-512":19,"sha3-512":20,"sha3-384":21,"sha3-256":22,"sha3-224":23,"shake-128":24,"shake-256":25,"keccak-224":26,"keccak-256":27,"keccak-384":28,"keccak-512":29,blake3:30,"murmur3-128":34,"murmur3-32":35,"dbl-sha2-256":86,md4:212,md5:213,bmt:214,"sha2-256-trunc254-padded":4114,"ripemd-128":4178,"ripemd-160":4179,"ripemd-256":4180,"ripemd-320":4181,x11:4352,"sm3-256":21325,"blake2b-8":45569,"blake2b-16":45570,"blake2b-24":45571,"blake2b-32":45572,"blake2b-40":45573,"blake2b-48":45574,"blake2b-56":45575,"blake2b-64":45576,"blake2b-72":45577,"blake2b-80":45578,"blake2b-88":45579,"blake2b-96":45580,"blake2b-104":45581,"blake2b-112":45582,"blake2b-120":45583,"blake2b-128":45584,"blake2b-136":45585,"blake2b-144":45586,"blake2b-152":45587,"blake2b-160":45588,"blake2b-168":45589,"blake2b-176":45590,"blake2b-184":45591,"blake2b-192":45592,"blake2b-200":45593,"blake2b-208":45594,"blake2b-216":45595,"blake2b-224":45596,"blake2b-232":45597,"blake2b-240":45598,"blake2b-248":45599,"blake2b-256":45600,"blake2b-264":45601,"blake2b-272":45602,"blake2b-280":45603,"blake2b-288":45604,"blake2b-296":45605,"blake2b-304":45606,"blake2b-312":45607,"blake2b-320":45608,"blake2b-328":45609,"blake2b-336":45610,"blake2b-344":45611,"blake2b-352":45612,"blake2b-360":45613,"blake2b-368":45614,"blake2b-376":45615,"blake2b-384":45616,"blake2b-392":45617,"blake2b-400":45618,"blake2b-408":45619,"blake2b-416":45620,"blake2b-424":45621,"blake2b-432":45622,"blake2b-440":45623,"blake2b-448":45624,"blake2b-456":45625,"blake2b-464":45626,"blake2b-472":45627,"blake2b-480":45628,"blake2b-488":45629,"blake2b-496":45630,"blake2b-504":45631,"blake2b-512":45632,"blake2s-8":45633,"blake2s-16":45634,"blake2s-24":45635,"blake2s-32":45636,"blake2s-40":45637,"blake2s-48":45638,"blake2s-56":45639,"blake2s-64":45640,"blake2s-72":45641,"blake2s-80":45642,"blake2s-88":45643,"blake2s-96":45644,"blake2s-104":45645,"blake2s-112":45646,"blake2s-120":45647,"blake2s-128":45648,"blake2s-136":45649,"blake2s-144":45650,"blake2s-152":45651,"blake2s-160":45652,"blake2s-168":45653,"blake2s-176":45654,"blake2s-184":45655,"blake2s-192":45656,"blake2s-200":45657,"blake2s-208":45658,"blake2s-216":45659,"blake2s-224":45660,"blake2s-232":45661,"blake2s-240":45662,"blake2s-248":45663,"blake2s-256":45664,"skein256-8":45825,"skein256-16":45826,"skein256-24":45827,"skein256-32":45828,"skein256-40":45829,"skein256-48":45830,"skein256-56":45831,"skein256-64":45832,"skein256-72":45833,"skein256-80":45834,"skein256-88":45835,"skein256-96":45836,"skein256-104":45837,"skein256-112":45838,"skein256-120":45839,"skein256-128":45840,"skein256-136":45841,"skein256-144":45842,"skein256-152":45843,"skein256-160":45844,"skein256-168":45845,"skein256-176":45846,"skein256-184":45847,"skein256-192":45848,"skein256-200":45849,"skein256-208":45850,"skein256-216":45851,"skein256-224":45852,"skein256-232":45853,"skein256-240":45854,"skein256-248":45855,"skein256-256":45856,"skein512-8":45857,"skein512-16":45858,"skein512-24":45859,"skein512-32":45860,"skein512-40":45861,"skein512-48":45862,"skein512-56":45863,"skein512-64":45864,"skein512-72":45865,"skein512-80":45866,"skein512-88":45867,"skein512-96":45868,"skein512-104":45869,"skein512-112":45870,"skein512-120":45871,"skein512-128":45872,"skein512-136":45873,"skein512-144":45874,"skein512-152":45875,"skein512-160":45876,"skein512-168":45877,"skein512-176":45878,"skein512-184":45879,"skein512-192":45880,"skein512-200":45881,"skein512-208":45882,"skein512-216":45883,"skein512-224":45884,"skein512-232":45885,"skein512-240":45886,"skein512-248":45887,"skein512-256":45888,"skein512-264":45889,"skein512-272":45890,"skein512-280":45891,"skein512-288":45892,"skein512-296":45893,"skein512-304":45894,"skein512-312":45895,"skein512-320":45896,"skein512-328":45897,"skein512-336":45898,"skein512-344":45899,"skein512-352":45900,"skein512-360":45901,"skein512-368":45902,"skein512-376":45903,"skein512-384":45904,"skein512-392":45905,"skein512-400":45906,"skein512-408":45907,"skein512-416":45908,"skein512-424":45909,"skein512-432":45910,"skein512-440":45911,"skein512-448":45912,"skein512-456":45913,"skein512-464":45914,"skein512-472":45915,"skein512-480":45916,"skein512-488":45917,"skein512-496":45918,"skein512-504":45919,"skein512-512":45920,"skein1024-8":45921,"skein1024-16":45922,"skein1024-24":45923,"skein1024-32":45924,"skein1024-40":45925,"skein1024-48":45926,"skein1024-56":45927,"skein1024-64":45928,"skein1024-72":45929,"skein1024-80":45930,"skein1024-88":45931,"skein1024-96":45932,"skein1024-104":45933,"skein1024-112":45934,"skein1024-120":45935,"skein1024-128":45936,"skein1024-136":45937,"skein1024-144":45938,"skein1024-152":45939,"skein1024-160":45940,"skein1024-168":45941,"skein1024-176":45942,"skein1024-184":45943,"skein1024-192":45944,"skein1024-200":45945,"skein1024-208":45946,"skein1024-216":45947,"skein1024-224":45948,"skein1024-232":45949,"skein1024-240":45950,"skein1024-248":45951,"skein1024-256":45952,"skein1024-264":45953,"skein1024-272":45954,"skein1024-280":45955,"skein1024-288":45956,"skein1024-296":45957,"skein1024-304":45958,"skein1024-312":45959,"skein1024-320":45960,"skein1024-328":45961,"skein1024-336":45962,"skein1024-344":45963,"skein1024-352":45964,"skein1024-360":45965,"skein1024-368":45966,"skein1024-376":45967,"skein1024-384":45968,"skein1024-392":45969,"skein1024-400":45970,"skein1024-408":45971,"skein1024-416":45972,"skein1024-424":45973,"skein1024-432":45974,"skein1024-440":45975,"skein1024-448":45976,"skein1024-456":45977,"skein1024-464":45978,"skein1024-472":45979,"skein1024-480":45980,"skein1024-488":45981,"skein1024-496":45982,"skein1024-504":45983,"skein1024-512":45984,"skein1024-520":45985,"skein1024-528":45986,"skein1024-536":45987,"skein1024-544":45988,"skein1024-552":45989,"skein1024-560":45990,"skein1024-568":45991,"skein1024-576":45992,"skein1024-584":45993,"skein1024-592":45994,"skein1024-600":45995,"skein1024-608":45996,"skein1024-616":45997,"skein1024-624":45998,"skein1024-632":45999,"skein1024-640":46e3,"skein1024-648":46001,"skein1024-656":46002,"skein1024-664":46003,"skein1024-672":46004,"skein1024-680":46005,"skein1024-688":46006,"skein1024-696":46007,"skein1024-704":46008,"skein1024-712":46009,"skein1024-720":46010,"skein1024-728":46011,"skein1024-736":46012,"skein1024-744":46013,"skein1024-752":46014,"skein1024-760":46015,"skein1024-768":46016,"skein1024-776":46017,"skein1024-784":46018,"skein1024-792":46019,"skein1024-800":46020,"skein1024-808":46021,"skein1024-816":46022,"skein1024-824":46023,"skein1024-832":46024,"skein1024-840":46025,"skein1024-848":46026,"skein1024-856":46027,"skein1024-864":46028,"skein1024-872":46029,"skein1024-880":46030,"skein1024-888":46031,"skein1024-896":46032,"skein1024-904":46033,"skein1024-912":46034,"skein1024-920":46035,"skein1024-928":46036,"skein1024-936":46037,"skein1024-944":46038,"skein1024-952":46039,"skein1024-960":46040,"skein1024-968":46041,"skein1024-976":46042,"skein1024-984":46043,"skein1024-992":46044,"skein1024-1000":46045,"skein1024-1008":46046,"skein1024-1016":46047,"skein1024-1024":46048,"poseidon-bls12_381-a2-fc1":46081,"poseidon-bls12_381-a2-fc1-sc":46082});t.exports={names:n}}}},{package:"multihashes",file:"/home/circleci/project/node_modules/@ensdomains/content-hash/node_modules/multihashes/src/constants.js"}],[6109,{"./decode.js":6107,"./encode.js":6108,"./length.js":6110},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports={encode:e("./encode.js"),decode:e("./decode.js"),encodingLength:e("./length.js")}}}},{package:"varint",file:"/home/circleci/project/node_modules/varint/index.js"}],[6113,{util:2163},function(){with(this)return function(){"use strict";return function(e,t,r){r.TextEncoder="undefined"!=typeof TextEncoder?TextEncoder:e("util").TextEncoder,r.TextDecoder="undefined"!=typeof TextDecoder?TextDecoder:e("util").TextDecoder}}},{package:"web-encoding",file:"/home/circleci/project/node_modules/web-encoding/src/lib.js"}],[240,{"./constants":239,"./util":242,buffer:2157},function(){with(this)return function(){"use strict";return function(e,t,r){const{Buffer:n}=e("buffer"),i=e("./constants"),{decodeText:s,asBuffer:o}=e("./util");function a(e){if(i.names[e])return i.names[e];if(i.codes[e])return i.codes[e];throw new Error(`Unsupported encoding: ${e}`)}(r=t.exports=function(e,t){if(!t)throw new Error("requires an encoded buffer");const{name:r,codeBuf:i}=a(e);!function(e,t){a(e).decode(s(t))}(r,t);const o=n.alloc(i.length+t.length);return o.set(i,0),o.set(t,i.length),o}).encode=function(e,t){const r=a(e);return n.concat([r.codeBuf,n.from(r.encode(t))])},r.decode=function(e){ArrayBuffer.isView(e)&&(e=s(e));const t=e[0];["f","F","v","V","t","T","b","B","c","C","h","k","K"].includes(t)&&(e=e.toLowerCase());const r=a(e[0]);return o(r.decode(e.substring(1)))},r.isEncoded=function(e){if(e instanceof Uint8Array&&(e=s(e)),"[object String]"!==Object.prototype.toString.call(e))return!1;try{return a(e[0]).name}catch(e){return!1}},r.encoding=a,r.encodingFromData=function(e){return e instanceof Uint8Array&&(e=s(e)),a(e[0])},r.names=Object.freeze(i.names),r.codes=Object.freeze(i.codes)}}},{package:"multibase",file:"/home/circleci/project/node_modules/@ensdomains/content-hash/node_modules/multibase/src/index.js"}],[251,{"./base-table":247},function(){with(this)return function(){"use strict";return function(e,t,r){const{baseTable:n}=e("./base-table"),i={};for(const[e,t]of Object.entries(n))i[t]===undefined&&(i[t]=e);t.exports=Object.freeze(i)}}},{package:"multicodec",file:"/home/circleci/project/node_modules/@ensdomains/content-hash/node_modules/multicodec/src/print.js"}],[248,{"./base-table":247},function(){with(this)return function(){"use strict";return function(e,t,r){const{baseTable:n}=e("./base-table"),i={};for(const[e,t]of Object.entries(n)){i[e.toUpperCase().replace(/-/g,"_")]=t}t.exports=Object.freeze(i)}}},{package:"multicodec",file:"/home/circleci/project/node_modules/@ensdomains/content-hash/node_modules/multicodec/src/constants.js"}],[253,{"./base-table":247,"./util":252},function(){with(this)return function(){"use strict";return function(e,t,r){const{baseTable:n}=e("./base-table"),i=e("./util").varintEncode,s={};for(const e in n){const t=n[e];s[e]=i(t)}t.exports=Object.freeze(s)}}},{package:"multicodec",file:"/home/circleci/project/node_modules/@ensdomains/content-hash/node_modules/multicodec/src/varint-table.js"}],[250,{"./base-table":247},function(){with(this)return function(){"use strict";return function(e,t,r){const{baseTable:n}=e("./base-table"),i=new Map;for(const e in n){const t=n[e];i.set(t,e)}t.exports=Object.freeze(i)}}},{package:"multicodec",file:"/home/circleci/project/node_modules/@ensdomains/content-hash/node_modules/multicodec/src/int-table.js"}],[256,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=function(e,t){t||(t=e.reduce(((e,t)=>e+t.length),0));const r=new Uint8Array(t);let n=0;for(const t of e)r.set(t,n),n+=t.length;return r}}}},{package:"uint8arrays",file:"/home/circleci/project/node_modules/@ensdomains/content-hash/node_modules/uint8arrays/concat.js"}],[245,{"./decode.js":243,"./encode.js":244,"./length.js":246},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports={encode:e("./encode.js"),decode:e("./decode.js"),encodingLength:e("./length.js")}}}},{package:"varint",file:"/home/circleci/project/node_modules/@ensdomains/content-hash/node_modules/multicodec/node_modules/varint/index.js"}],[252,{"uint8arrays/from-string":257,"uint8arrays/to-string":262,varint:245},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("varint"),i=e("uint8arrays/to-string"),s=e("uint8arrays/from-string");function o(e){return parseInt(i(e,"base16"),16)}t.exports={numberToUint8Array:function(e){let t=e.toString(16);t.length%2==1&&(t="0"+t);return s(t,"base16")},uint8ArrayToNumber:o,varintUint8ArrayEncode:function(e){return Uint8Array.from(n.encode(o(e)))},varintEncode:function(e){return Uint8Array.from(n.encode(e))}}}}},{package:"multicodec",file:"/home/circleci/project/node_modules/@ensdomains/content-hash/node_modules/multicodec/src/util.js"}],[1755,{},function(){with(this)return function(){"use strict";return function(e,t,r){var n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(n){var i=new Uint8Array(16);t.exports=function(){return n(i),i}}else{var s=new Array(16);t.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),s[t]=e>>>((3&t)<<3)&255;return s}}}}},{package:"uuid",file:"/home/circleci/project/node_modules/analytics-node/node_modules/uuid/lib/rng-browser.js"}],[1754,{},function(){with(this)return function(){"use strict";return function(e,t,r){for(var n=[],i=0;i<256;++i)n[i]=(i+256).toString(16).substr(1);t.exports=function(e,t){var r=t||0,i=n;return[i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]]].join("")}}}},{package:"uuid",file:"/home/circleci/project/node_modules/analytics-node/node_modules/uuid/lib/bytesToUuid.js"}],[2266,{},function(){with(this)return function(){"use strict";return function(e,t,r){var n,i;n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i={rotl:function(e,t){return e<<t|e>>>32-t},rotr:function(e,t){return e<<32-t|e>>>t},endian:function(e){if(e.constructor==Number)return 16711935&i.rotl(e,8)|4278255360&i.rotl(e,24);for(var t=0;t<e.length;t++)e[t]=i.endian(e[t]);return e},randomBytes:function(e){for(var t=[];e>0;e--)t.push(Math.floor(256*Math.random()));return t},bytesToWords:function(e){for(var t=[],r=0,n=0;r<e.length;r++,n+=8)t[n>>>5]|=e[r]<<24-n%32;return t},wordsToBytes:function(e){for(var t=[],r=0;r<32*e.length;r+=8)t.push(e[r>>>5]>>>24-r%32&255);return t},bytesToHex:function(e){for(var t=[],r=0;r<e.length;r++)t.push((e[r]>>>4).toString(16)),t.push((15&e[r]).toString(16));return t.join("")},hexToBytes:function(e){for(var t=[],r=0;r<e.length;r+=2)t.push(parseInt(e.substr(r,2),16));return t},bytesToBase64:function(e){for(var t=[],r=0;r<e.length;r+=3)for(var i=e[r]<<16|e[r+1]<<8|e[r+2],s=0;s<4;s++)8*r+6*s<=8*e.length?t.push(n.charAt(i>>>6*(3-s)&63)):t.push("=");return t.join("")},base64ToBytes:function(e){e=e.replace(/[^A-Z0-9+\/]/gi,"");for(var t=[],r=0,i=0;r<e.length;i=++r%4)0!=i&&t.push((n.indexOf(e.charAt(r-1))&Math.pow(2,-2*i+8)-1)<<2*i|n.indexOf(e.charAt(r))>>>6-2*i);return t}},t.exports=i}}},{package:"crypt",file:"/home/circleci/project/node_modules/crypt/crypt.js"}],[2193,{},function(){with(this)return function(){"use strict";return function(e,t,r){var n={utf8:{stringToBytes:function(e){return n.bin.stringToBytes(unescape(encodeURIComponent(e)))},bytesToString:function(e){return decodeURIComponent(escape(n.bin.bytesToString(e)))}},bin:{stringToBytes:function(e){for(var t=[],r=0;r<e.length;r++)t.push(255&e.charCodeAt(r));return t},bytesToString:function(e){for(var t=[],r=0;r<e.length;r++)t.push(String.fromCharCode(e[r]));return t.join("")}}};t.exports=n}}},{package:"charenc",file:"/home/circleci/project/node_modules/charenc/charenc.js"}],[2226,{},function(){with(this)return function(){"use strict";return function(e,t,r){var n=Object.prototype.toString;t.exports=function(e){switch(n.call(e)){case"[object Date]":return"date";case"[object RegExp]":return"regexp";case"[object Arguments]":return"arguments";case"[object Array]":return"array";case"[object Error]":return"error"}return null===e?"null":e===undefined?"undefined":e!=e?"nan":e&&1===e.nodeType?"element":null!=(t=e)&&(t._isBuffer||t.constructor&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t))?"buffer":typeof(e=e.valueOf?e.valueOf():Object.prototype.valueOf.apply(e));var t}}}},{package:"component-type",file:"/home/circleci/project/node_modules/component-type/index.js"}],[4794,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=function(e,t,r){return t=t||"and",r=r||", ",e.length<2?e[0]||"":(t.slice(0,2)===r?2==e.length&&(t=t.slice(1)):t=" "+t,e.slice(0,-1).join(r)+t+" "+e[e.length-1])}}}},{package:"join-component",file:"/home/circleci/project/node_modules/join-component/index.js"}],[1859,{"is-retry-allowed":4782},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.isNetworkError=a,r.isRetryableError=l,r.isSafeRequestError=f,r.isIdempotentRequestError=d,r.isNetworkOrIdempotentRequestError=h,r.exponentialDelay=m,r.default=y;var n,i=e("is-retry-allowed"),s=(n=i)&&n.__esModule?n:{default:n};var o="axios-retry";function a(e){return!e.response&&Boolean(e.code)&&"ECONNABORTED"!==e.code&&(0,s.default)(e)}var c=["get","head","options"],u=c.concat(["put","delete"]);function l(e){return"ECONNABORTED"!==e.code&&(!e.response||e.response.status>=500&&e.response.status<=599)}function f(e){return!!e.config&&(l(e)&&-1!==c.indexOf(e.config.method))}function d(e){return!!e.config&&(l(e)&&-1!==u.indexOf(e.config.method))}function h(e){return a(e)||d(e)}function p(){return 0}function m(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0,t=100*Math.pow(2,e),r=.2*t*Math.random();return t+r}function g(e){var t=e[o]||{};return t.retryCount=t.retryCount||0,e[o]=t,t}function y(e,t){e.interceptors.request.use((function(e){return g(e).lastRequestTime=Date.now(),e})),e.interceptors.response.use(null,(function(r){var n=r.config;if(!n)return Promise.reject(r);var i=function(e,t){return Object.assign({},t,e[o])}(n,t),s=i.retries,a=s===undefined?3:s,c=i.retryCondition,u=c===undefined?h:c,l=i.retryDelay,f=l===undefined?p:l,d=i.shouldResetTimeout,m=d!==undefined&&d,y=g(n);if(u(r)&&y.retryCount<a){y.retryCount+=1;var b=f(y.retryCount,r);if(function(e,t){e.defaults.agent===t.agent&&delete t.agent,e.defaults.httpAgent===t.httpAgent&&delete t.httpAgent,e.defaults.httpsAgent===t.httpsAgent&&delete t.httpsAgent}(e,n),!m&&n.timeout&&y.lastRequestTime){var v=Date.now()-y.lastRequestTime;n.timeout=Math.max(n.timeout-v-b,1)}return n.transformRequest=[function(e){return e}],new Promise((function(t){return setTimeout((function(){return t(e(n))}),b)}))}return Promise.reject(r)}))}y.isNetworkError=a,y.isSafeRequestError=f,y.isIdempotentRequestError=d,y.isNetworkOrIdempotentRequestError=h,y.exponentialDelay=m,y.isRetryableError=l}}},{package:"axios-retry",file:"/home/circleci/project/node_modules/axios-retry/lib/index.js"}],[1862,{"./cancel/Cancel":1863,"./cancel/CancelToken":1864,"./cancel/isCancel":1865,"./core/Axios":1866,"./core/mergeConfig":1872,"./defaults":1875,"./helpers/bind":1876,"./helpers/isAxiosError":1881,"./helpers/spread":1885,"./utils":1887},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("./utils"),i=e("./helpers/bind"),s=e("./core/Axios"),o=e("./core/mergeConfig");function a(e){var t=new s(e),r=i(s.prototype.request,t);return n.extend(r,s.prototype,t),n.extend(r,t),r}var c=a(e("./defaults"));c.Axios=s,c.create=function(e){return a(o(c.defaults,e))},c.Cancel=e("./cancel/Cancel"),c.CancelToken=e("./cancel/CancelToken"),c.isCancel=e("./cancel/isCancel"),c.all=function(e){return Promise.all(e)},c.spread=e("./helpers/spread"),c.isAxiosError=e("./helpers/isAxiosError"),t.exports=c,t.exports.default=c}}},{package:"axios",file:"/home/circleci/project/node_modules/axios/lib/axios.js"}],[2606,{"bn.js":2113,buffer:2157},function(){with(this)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.KECCAK256_RLP=r.KECCAK256_RLP_S=r.KECCAK256_RLP_ARRAY=r.KECCAK256_RLP_ARRAY_S=r.KECCAK256_NULL=r.KECCAK256_NULL_S=r.TWO_POW256=r.MAX_INTEGER=void 0;var n=e("bn.js");r.MAX_INTEGER=new n("ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff",16),r.TWO_POW256=new n("10000000000000000000000000000000000000000000000000000000000000000",16),r.KECCAK256_NULL_S="c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470",r.KECCAK256_NULL=t.from(r.KECCAK256_NULL_S,"hex"),r.KECCAK256_RLP_ARRAY_S="1dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347",r.KECCAK256_RLP_ARRAY=t.from(r.KECCAK256_RLP_ARRAY_S,"hex"),r.KECCAK256_RLP_S="56e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421",r.KECCAK256_RLP=t.from(r.KECCAK256_RLP_S,"hex")}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"ethereumjs-util",file:"/home/circleci/project/node_modules/ethereumjs-wallet/node_modules/ethereumjs-util/dist/constants.js"}],[2613,{"./bytes":2605,"./hash":2607,"./secp256k1v3-adapter":2610,"bn.js":2113,buffer:2157},function(){with(this)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.hashPersonalMessage=r.isValidSignature=r.fromRpcSig=r.toRpcSig=r.ecrecover=r.ecsign=void 0;var n=e("./secp256k1v3-adapter"),i=e("bn.js"),s=e("./bytes"),o=e("./hash");function a(e,t){return t?e-(2*t+35):e-27}function c(e){return 0===e||1===e}r.ecsign=function(e,t,r){var i=n.sign(e,t),s=i.recovery;return{r:i.signature.slice(0,32),s:i.signature.slice(32,64),v:r?s+(2*r+35):s+27}},r.ecrecover=function(e,r,i,o,u){var l=t.concat([s.setLength(i,32),s.setLength(o,32)],64),f=a(r,u);if(!c(f))throw new Error("Invalid signature v value");var d=n.recover(e,l,f);return n.publicKeyConvert(d,!1).slice(1)},r.toRpcSig=function(e,r,n,i){if(!c(a(e,i)))throw new Error("Invalid signature v value");return s.bufferToHex(t.concat([s.setLengthLeft(r,32),s.setLengthLeft(n,32),s.toBuffer(e)]))},r.fromRpcSig=function(e){var t=s.toBuffer(e);if(65!==t.length)throw new Error("Invalid signature length");var r=t[64];return r<27&&(r+=27),{v:r,r:t.slice(0,32),s:t.slice(32,64)}},r.isValidSignature=function(e,t,r,n,s){void 0===n&&(n=!0);var o=new i("7fffffffffffffffffffffffffffffff5d576e7357a4501ddfe92f46681b20a0",16),u=new i("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141",16);if(32!==t.length||32!==r.length)return!1;if(!c(a(e,s)))return!1;var l=new i(t),f=new i(r);return!(l.isZero()||l.gt(u)||f.isZero()||f.gt(u))&&(!n||1!==f.cmp(o))},r.hashPersonalMessage=function(e){var r=t.from("Ethereum Signed Message:\n"+e.length.toString(),"utf-8");return o.keccak(t.concat([r,e]))}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"ethereumjs-util",file:"/home/circleci/project/node_modules/ethereumjs-wallet/node_modules/ethereumjs-util/dist/signature.js"}],[2604,{"./bytes":2605,"./hash":2607,"./secp256k1v3-adapter":2610,assert:1776,"bn.js":2113,buffer:2157,"ethjs-util":2614},function(){with(this)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.importPublic=r.privateToPublic=r.privateToAddress=r.publicToAddress=r.pubToAddress=r.isValidPublic=r.isValidPrivate=r.isPrecompiled=r.generateAddress2=r.generateAddress=r.isValidChecksumAddress=r.toChecksumAddress=r.isZeroAddress=r.isValidAddress=r.zeroAddress=void 0;var n=e("assert"),i=e("ethjs-util"),s=e("./secp256k1v3-adapter"),o=e("bn.js"),a=e("./bytes"),c=e("./hash");r.zeroAddress=function(){var e=a.zeros(20);return a.bufferToHex(e)},r.isValidAddress=function(e){return/^0x[0-9a-fA-F]{40}$/.test(e)},r.isZeroAddress=function(e){return r.zeroAddress()===a.addHexPrefix(e)},r.toChecksumAddress=function(e,t){e=i.stripHexPrefix(e).toLowerCase();for(var r=t!==undefined?t.toString()+"0x":"",n=c.keccak(r+e).toString("hex"),s="0x",o=0;o<e.length;o++)parseInt(n[o],16)>=8?s+=e[o].toUpperCase():s+=e[o];return s},r.isValidChecksumAddress=function(e,t){return r.isValidAddress(e)&&r.toChecksumAddress(e,t)===e},r.generateAddress=function(e,r){e=a.toBuffer(e);var n=new o(r);return n.isZero()?c.rlphash([e,null]).slice(-20):c.rlphash([e,t.from(n.toArray())]).slice(-20)},r.generateAddress2=function(e,r,i){var s=a.toBuffer(e),o=a.toBuffer(r),u=a.toBuffer(i);return n(20===s.length),n(32===o.length),c.keccak256(t.concat([t.from("ff","hex"),s,o,c.keccak256(u)])).slice(-20)},r.isPrecompiled=function(e){var t=a.unpad(e);return 1===t.length&&t[0]>=1&&t[0]<=8},r.isValidPrivate=function(e){return s.privateKeyVerify(e)},r.isValidPublic=function(e,r){return void 0===r&&(r=!1),64===e.length?s.publicKeyVerify(t.concat([t.from([4]),e])):!!r&&s.publicKeyVerify(e)},r.pubToAddress=function(e,t){return void 0===t&&(t=!1),e=a.toBuffer(e),t&&64!==e.length&&(e=s.publicKeyConvert(e,!1).slice(1)),n(64===e.length),c.keccak(e).slice(-20)},r.publicToAddress=r.pubToAddress,r.privateToAddress=function(e){return r.publicToAddress(r.privateToPublic(e))},r.privateToPublic=function(e){return e=a.toBuffer(e),s.publicKeyCreate(e,!1).slice(1)},r.importPublic=function(e){return 64!==(e=a.toBuffer(e)).length&&(e=s.publicKeyConvert(e,!1).slice(1)),e}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"ethereumjs-util",file:"/home/circleci/project/node_modules/ethereumjs-wallet/node_modules/ethereumjs-util/dist/account.js"}],[2605,{"bn.js":2113,buffer:2157,"ethjs-util":2614},function(){with(this)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.baToJSON=r.addHexPrefix=r.toUnsigned=r.fromSigned=r.bufferToHex=r.bufferToInt=r.toBuffer=r.stripZeros=r.unpad=r.setLengthRight=r.setLength=r.setLengthLeft=r.zeros=void 0;var n=e("ethjs-util"),i=e("bn.js");r.zeros=function(e){return t.allocUnsafe(e).fill(0)},r.setLengthLeft=function(e,t,n){void 0===n&&(n=!1);var i=r.zeros(t);return e=r.toBuffer(e),n?e.length<t?(e.copy(i),i):e.slice(0,t):e.length<t?(e.copy(i,t-e.length),i):e.slice(-t)},r.setLength=r.setLengthLeft,r.setLengthRight=function(e,t){return r.setLength(e,t,!0)},r.unpad=function(e){for(var t=(e=n.stripHexPrefix(e))[0];e.length>0&&"0"===t.toString();)t=(e=e.slice(1))[0];return e},r.stripZeros=r.unpad,r.toBuffer=function(e){if(!t.isBuffer(e))if(Array.isArray(e))e=t.from(e);else if("string"==typeof e){if(!n.isHexString(e))throw new Error("Cannot convert string to buffer. toBuffer only supports 0x-prefixed hex strings and this string was given: "+e);e=t.from(n.padToEven(n.stripHexPrefix(e)),"hex")}else if("number"==typeof e)e=n.intToBuffer(e);else if(null===e||e===undefined)e=t.allocUnsafe(0);else if(i.isBN(e))e=e.toArrayLike(t);else{if(!e.toArray)throw new Error("invalid type");e=t.from(e.toArray())}return e},r.bufferToInt=function(e){return new i(r.toBuffer(e)).toNumber()},r.bufferToHex=function(e){return"0x"+(e=r.toBuffer(e)).toString("hex")},r.fromSigned=function(e){return new i(e).fromTwos(256)},r.toUnsigned=function(e){return t.from(e.toTwos(256).toArray())},r.addHexPrefix=function(e){return"string"!=typeof e||n.isHexPrefixed(e)?e:"0x"+e},r.baToJSON=function(e){if(t.isBuffer(e))return"0x"+e.toString("hex");if(e instanceof Array){for(var n=[],i=0;i<e.length;i++)n.push(r.baToJSON(e[i]));return n}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"ethereumjs-util",file:"/home/circleci/project/node_modules/ethereumjs-wallet/node_modules/ethereumjs-util/dist/bytes.js"}],[2609,{"./bytes":2605,assert:1776,buffer:2157,"ethjs-util":2614,rlp:5815},function(){with(this)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.defineProperties=void 0;var n=e("assert"),i=e("ethjs-util"),s=e("rlp"),o=e("./bytes");r.defineProperties=function(e,r,a){if(e.raw=[],e._fields=[],e.toJSON=function(t){if(void 0===t&&(t=!1),t){var r={};return e._fields.forEach((function(t){r[t]="0x"+e[t].toString("hex")})),r}return o.baToJSON(e.raw)},e.serialize=function(){return s.encode(e.raw)},r.forEach((function(r,i){function s(){return e.raw[i]}function a(s){"00"!==(s=o.toBuffer(s)).toString("hex")||r.allowZero||(s=t.allocUnsafe(0)),r.allowLess&&r.length?(s=o.stripZeros(s),n(r.length>=s.length,"The field "+r.name+" must not have more "+r.length+" bytes")):r.allowZero&&0===s.length||!r.length||n(r.length===s.length,"The field "+r.name+" must have byte length of "+r.length),e.raw[i]=s}e._fields.push(r.name),Object.defineProperty(e,r.name,{enumerable:!0,configurable:!0,get:s,set:a}),r.default&&(e[r.name]=r.default),r.alias&&Object.defineProperty(e,r.alias,{enumerable:!1,configurable:!0,set:a,get:s})})),a)if("string"==typeof a&&(a=t.from(i.stripHexPrefix(a),"hex")),t.isBuffer(a)&&(a=s.decode(a)),Array.isArray(a)){if(a.length>e._fields.length)throw new Error("wrong number of fields in data");a.forEach((function(t,r){e[e._fields[r]]=o.toBuffer(t)}))}else{if("object"!=typeof a)throw new Error("invalid data");var c=Object.keys(a);r.forEach((function(t){-1!==c.indexOf(t.name)&&(e[t.name]=a[t.name]),-1!==c.indexOf(t.alias)&&(e[t.alias]=a[t.alias])}))}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"ethereumjs-util",file:"/home/circleci/project/node_modules/ethereumjs-wallet/node_modules/ethereumjs-util/dist/object.js"}],[2607,{"./bytes":2605,buffer:2157,"create-hash":2261,"ethereum-cryptography/keccak":2566,"ethjs-util":2614,rlp:5815},function(){with(this)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.rlphash=r.ripemd160=r.sha256=r.keccak256=r.keccak=void 0;var n=e("ethereum-cryptography/keccak"),i=n.keccak224,s=n.keccak384,o=n.keccak256,a=n.keccak512,c=e("create-hash"),u=e("ethjs-util"),l=e("rlp"),f=e("./bytes");r.keccak=function(e,r){switch(void 0===r&&(r=256),e="string"!=typeof e||u.isHexString(e)?f.toBuffer(e):t.from(e,"utf8"),r||(r=256),r){case 224:return i(e);case 256:return o(e);case 384:return s(e);case 512:return a(e);default:throw new Error("Invald algorithm: keccak"+r)}},r.keccak256=function(e){return r.keccak(e)},r.sha256=function(e){return e=f.toBuffer(e),c("sha256").update(e).digest()},r.ripemd160=function(e,t){e=f.toBuffer(e);var r=c("rmd160").update(e).digest();return!0===t?f.setLength(r,32):r},r.rlphash=function(e){return r.keccak(l.encode(e))}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"ethereumjs-util",file:"/home/circleci/project/node_modules/ethereumjs-wallet/node_modules/ethereumjs-util/dist/hash.js"}],[2614,{buffer:2157,"is-hex-prefixed":4772,"strip-hex-prefix":5977},function(){with(this)return function(){"use strict";return function(e,t,r){(function(r){(function(){var n=e("is-hex-prefixed"),i=e("strip-hex-prefix");function s(e){var t=e;if("string"!=typeof t)throw new Error("[ethjs-util] while padding to even, value must be string, is currently "+typeof t+", while padToEven.");return t.length%2&&(t="0"+t),t}function o(e){return"0x"+e.toString(16)}t.exports={arrayContainsArray:function(e,t,r){if(!0!==Array.isArray(e))throw new Error("[ethjs-util] method arrayContainsArray requires input 'superset' to be an array got type '"+typeof e+"'");if(!0!==Array.isArray(t))throw new Error("[ethjs-util] method arrayContainsArray requires input 'subset' to be an array got type '"+typeof t+"'");return t[Boolean(r)?"some":"every"]((function(t){return e.indexOf(t)>=0}))},intToBuffer:function(e){var t=o(e);return new r(s(t.slice(2)),"hex")},getBinarySize:function(e){if("string"!=typeof e)throw new Error("[ethjs-util] while getting binary size, method getBinarySize requires input 'str' to be type String, got '"+typeof e+"'.");return r.byteLength(e,"utf8")},isHexPrefixed:n,stripHexPrefix:i,padToEven:s,intToHex:o,fromAscii:function(e){for(var t="",r=0;r<e.length;r++){var n=e.charCodeAt(r).toString(16);t+=n.length<2?"0"+n:n}return"0x"+t},fromUtf8:function(e){return"0x"+s(new r(e,"utf8").toString("hex")).replace(/^0+|0+$/g,"")},toAscii:function(e){var t="",r=0,n=e.length;for("0x"===e.substring(0,2)&&(r=2);r<n;r+=2){var i=parseInt(e.substr(r,2),16);t+=String.fromCharCode(i)}return t},toUtf8:function(e){return new r(s(i(e).replace(/^0+|0+$/g,"")),"hex").toString("utf8")},getKeys:function(e,t,r){if(!Array.isArray(e))throw new Error("[ethjs-util] method getKeys expecting type Array as 'params' input, got '"+typeof e+"'");if("string"!=typeof t)throw new Error("[ethjs-util] method getKeys expecting type String for input 'key' got '"+typeof t+"'.");for(var n=[],i=0;i<e.length;i++){var s=e[i][t];if(r&&!s)s="";else if("string"!=typeof s)throw new Error("invalid abi");n.push(s)}return n},isHexString:function(e,t){return!("string"!=typeof e||!e.match(/^0x[0-9A-Fa-f]*$/))&&(!t||e.length===2+2*t)}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"ethjs-util",file:"/home/circleci/project/node_modules/ethereumjs-wallet/node_modules/ethjs-util/lib/index.js"}],[2610,{"./secp256k1v3-lib/der":2611,"./secp256k1v3-lib/index":2612,buffer:2157,"ethereum-cryptography/secp256k1":2574},function(){with(this)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.ecdhUnsafe=r.ecdh=r.recover=r.verify=r.sign=r.signatureImportLax=r.signatureImport=r.signatureExport=r.signatureNormalize=r.publicKeyCombine=r.publicKeyTweakMul=r.publicKeyTweakAdd=r.publicKeyVerify=r.publicKeyConvert=r.publicKeyCreate=r.privateKeyTweakMul=r.privateKeyTweakAdd=r.privateKeyModInverse=r.privateKeyNegate=r.privateKeyImport=r.privateKeyExport=r.privateKeyVerify=void 0;var n=e("ethereum-cryptography/secp256k1"),i=e("./secp256k1v3-lib/index"),s=e("./secp256k1v3-lib/der");r.privateKeyVerify=function(e){return 32===e.length&&n.privateKeyVerify(Uint8Array.from(e))},r.privateKeyExport=function(e,t){if(32!==e.length)throw new RangeError("private key length is invalid");var r=i.privateKeyExport(e,t);return s.privateKeyExport(e,r,t)},r.privateKeyImport=function(e){if(null!==(e=s.privateKeyImport(e))&&32===e.length&&r.privateKeyVerify(e))return e;throw new Error("couldn't import from DER format")},r.privateKeyNegate=function(e){return t.from(n.privateKeyNegate(Uint8Array.from(e)))},r.privateKeyModInverse=function(e){if(32!==e.length)throw new Error("private key length is invalid");return t.from(i.privateKeyModInverse(Uint8Array.from(e)))},r.privateKeyTweakAdd=function(e,r){return t.from(n.privateKeyTweakAdd(Uint8Array.from(e),r))},r.privateKeyTweakMul=function(e,r){return t.from(n.privateKeyTweakMul(Uint8Array.from(e),Uint8Array.from(r)))},r.publicKeyCreate=function(e,r){return t.from(n.publicKeyCreate(Uint8Array.from(e),r))},r.publicKeyConvert=function(e,r){return t.from(n.publicKeyConvert(Uint8Array.from(e),r))},r.publicKeyVerify=function(e){return(33===e.length||65===e.length)&&n.publicKeyVerify(Uint8Array.from(e))},r.publicKeyTweakAdd=function(e,r,i){return t.from(n.publicKeyTweakAdd(Uint8Array.from(e),Uint8Array.from(r),i))},r.publicKeyTweakMul=function(e,r,i){return t.from(n.publicKeyTweakMul(Uint8Array.from(e),Uint8Array.from(r),i))},r.publicKeyCombine=function(e,r){var i=[];return e.forEach((function(e){i.push(Uint8Array.from(e))})),t.from(n.publicKeyCombine(i,r))},r.signatureNormalize=function(e){return t.from(n.signatureNormalize(Uint8Array.from(e)))},r.signatureExport=function(e){return t.from(n.signatureExport(Uint8Array.from(e)))},r.signatureImport=function(e){return t.from(n.signatureImport(Uint8Array.from(e)))},r.signatureImportLax=function(e){if(0===e.length)throw new RangeError("signature length is invalid");var t=s.signatureImportLax(e);if(null===t)throw new Error("couldn't parse DER signature");return i.signatureImport(t)},r.sign=function(e,r,i){if(null===i)throw new TypeError("options should be an Object");var s=undefined;if(i){if(s={},null===i.data)throw new TypeError("options.data should be a Buffer");if(i.data){if(32!=i.data.length)throw new RangeError("options.data length is invalid");s.data=new Uint8Array(i.data)}if(null===i.noncefn)throw new TypeError("options.noncefn should be a Function");i.noncefn&&(s.noncefn=function(e,r,n,s,o){var a=null!=n?t.from(n):null,c=null!=s?t.from(s):null,u=t.from("");return i.noncefn&&(u=i.noncefn(t.from(e),t.from(r),a,c,o)),new Uint8Array(u)})}var o=n.ecdsaSign(Uint8Array.from(e),Uint8Array.from(r),s);return{signature:t.from(o.signature),recovery:o.recid}},r.verify=function(e,t,r){return n.ecdsaVerify(Uint8Array.from(t),Uint8Array.from(e),r)},r.recover=function(e,r,i,s){return t.from(n.ecdsaRecover(Uint8Array.from(r),i,Uint8Array.from(e),s))},r.ecdh=function(e,r){return t.from(n.ecdh(Uint8Array.from(e),Uint8Array.from(r),{}))},r.ecdhUnsafe=function(e,r,n){if(33!==e.length&&65!==e.length)throw new RangeError("public key length is invalid");if(32!==r.length)throw new RangeError("private key length is invalid");return t.from(i.ecdhUnsafe(Uint8Array.from(e),Uint8Array.from(r),n))}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"ethereumjs-util",file:"/home/circleci/project/node_modules/ethereumjs-wallet/node_modules/ethereumjs-util/dist/secp256k1v3-adapter.js"}],[2616,{},function(){with(this)return function(){"use strict";return function(e,t,r){var n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(n){var i=new Uint8Array(16);t.exports=function(){return n(i),i}}else{var s=new Array(16);t.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),s[t]=e>>>((3&t)<<3)&255;return s}}}}},{package:"uuid",file:"/home/circleci/project/node_modules/ethereumjs-wallet/node_modules/uuid/lib/rng-browser.js"}],[2615,{},function(){with(this)return function(){"use strict";return function(e,t,r){for(var n=[],i=0;i<256;++i)n[i]=(i+256).toString(16).substr(1);t.exports=function(e,t){var r=t||0,i=n;return[i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]]].join("")}}}},{package:"uuid",file:"/home/circleci/project/node_modules/ethereumjs-wallet/node_modules/uuid/lib/bytesToUuid.js"}],[5986,{},function(){with(this)return function(){"use strict";return function(e,t,r){const n=()=>!0,i=["newListener","removeListener"],s=e=>!i.includes(e);t.exports=function(e,t){let r=(t=t||{}).eventFilter||n;if("skipInternal"===r&&(r=s),"function"!=typeof r)throw new Error("createEventEmitterProxy - Invalid eventFilter");let i=e;return new Proxy({},{get:(e,t)=>"setTarget"===t?o:i[t],set:(e,t,r)=>"setTarget"===t?(o=r,!0):(i[t]=r,!0)});function o(e){const t=i;i=e,t.eventNames().filter(r).forEach((r=>{(function(e,t){if(e.rawListeners)return e.rawListeners(t);let r=e._events[t]||[];Array.isArray(r)||(r=[r]);return r.slice()})(t,r).forEach((t=>e.on(r,t)))})),t.removeAllListeners()}}}}},{package:"swappable-obj-proxy",file:"/home/circleci/project/node_modules/swappable-obj-proxy/src/createEventEmitterProxy.js"}],[5987,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=function(e){let t=e;return new Proxy({},{get:(e,n)=>"setTarget"===n?r:t[n],set:(e,n,i)=>"setTarget"===n?(r=i,!0):(t[n]=i,!0)});function r(e){t=e}}}}},{package:"swappable-obj-proxy",file:"/home/circleci/project/node_modules/swappable-obj-proxy/src/createSwappableProxy.js"}],[2437,{"./BaseBlockTracker":2434,"./PollingBlockTracker":2435,"./SubscribeBlockTracker":2436},function(){with(this)return function(){"use strict";return function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){n===undefined&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){n===undefined&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),i(e("./BaseBlockTracker"),r),i(e("./PollingBlockTracker"),r),i(e("./SubscribeBlockTracker"),r)}}},{package:"eth-block-tracker",file:"/home/circleci/project/node_modules/eth-block-tracker/dist/index.js"}],[2202,{},function(){with(this)return function(){"use strict";return function(e,t,r){for(var n="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz",i={},s=0;s<n.length;s++)i[n.charAt(s)]=s;t.exports={encode:function(e){if(0===e.length)return"";var t,r=[0];for(o=0;o<e.length;o++){for(t=0;t<r.length;t++)r[t]<<=8;r[0]+=e[o];var i=0;for(t=0;t<r.length;++t)r[t]+=i,i=r[t]/58|0,r[t]%=58;for(;i;)r.push(i%58),i=i/58|0}for(o=0;0===e[o]&&o<e.length-1;o++)r.push(0);for(var s="",o=r.length-1;o>=0;o--)s+=n[r[o]];return s},decode:function(e){if(0===e.length)return[];var t,r,n=[0];for(t=0;t<e.length;t++){var s=e[t];if(!(s in i))throw new Error("Non-base58 character");for(r=0;r<n.length;r++)n[r]*=58;n[0]+=i[s];var o=0;for(r=0;r<n.length;++r)n[r]+=o,o=n[r]>>8,n[r]&=255;for(;o;)n.push(255&o),o>>=8}for(t=0;"1"===e[t]&&t<e.length-1;t++)n.push(0);return n.reverse()}}}}},{package:"bs58",file:"/home/circleci/project/node_modules/coinstring/node_modules/bs58/lib/bs58.js"}],[1107,{"../messages.json":1109,"bn.js":2113,"create-hash":2261,elliptic:2391,"safe-buffer":5817},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("safe-buffer").Buffer,i=e("create-hash"),s=e("bn.js"),o=e("elliptic").ec,a=e("../messages.json"),c=new o("secp256k1"),u=c.curve;function l(e){var t=e[0];switch(t){case 2:case 3:return 33!==e.length?null:function(e,t){var r=new s(t);if(r.cmp(u.p)>=0)return null;var n=(r=r.toRed(u.red)).redSqr().redIMul(r).redIAdd(u.b).redSqrt();return 3===e!==n.isOdd()&&(n=n.redNeg()),c.keyPair({pub:{x:r,y:n}})}(t,e.slice(1,33));case 4:case 6:case 7:return 65!==e.length?null:function(e,t,r){var n=new s(t),i=new s(r);if(n.cmp(u.p)>=0||i.cmp(u.p)>=0)return null;if(n=n.toRed(u.red),i=i.toRed(u.red),(6===e||7===e)&&i.isOdd()!==(7===e))return null;var o=n.redSqr().redIMul(n);return i.redSqr().redISub(o.redIAdd(u.b)).isZero()?c.keyPair({pub:{x:n,y:i}}):null}(t,e.slice(1,33),e.slice(33,65));default:return null}}r.privateKeyVerify=function(e){var t=new s(e);return t.cmp(u.n)<0&&!t.isZero()},r.privateKeyExport=function(e,t){var r=new s(e);if(r.cmp(u.n)>=0||r.isZero())throw new Error(a.EC_PRIVATE_KEY_EXPORT_DER_FAIL);return n.from(c.keyFromPrivate(e).getPublic(t,!0))},r.privateKeyNegate=function(e){var t=new s(e);return t.isZero()?n.alloc(32):u.n.sub(t).umod(u.n).toArrayLike(n,"be",32)},r.privateKeyModInverse=function(e){var t=new s(e);if(t.cmp(u.n)>=0||t.isZero())throw new Error(a.EC_PRIVATE_KEY_RANGE_INVALID);return t.invm(u.n).toArrayLike(n,"be",32)},r.privateKeyTweakAdd=function(e,t){var r=new s(t);if(r.cmp(u.n)>=0)throw new Error(a.EC_PRIVATE_KEY_TWEAK_ADD_FAIL);if(r.iadd(new s(e)),r.cmp(u.n)>=0&&r.isub(u.n),r.isZero())throw new Error(a.EC_PRIVATE_KEY_TWEAK_ADD_FAIL);return r.toArrayLike(n,"be",32)},r.privateKeyTweakMul=function(e,t){var r=new s(t);if(r.cmp(u.n)>=0||r.isZero())throw new Error(a.EC_PRIVATE_KEY_TWEAK_MUL_FAIL);return r.imul(new s(e)),r.cmp(u.n)&&(r=r.umod(u.n)),r.toArrayLike(n,"be",32)},r.publicKeyCreate=function(e,t){var r=new s(e);if(r.cmp(u.n)>=0||r.isZero())throw new Error(a.EC_PUBLIC_KEY_CREATE_FAIL);return n.from(c.keyFromPrivate(e).getPublic(t,!0))},r.publicKeyConvert=function(e,t){var r=l(e);if(null===r)throw new Error(a.EC_PUBLIC_KEY_PARSE_FAIL);return n.from(r.getPublic(t,!0))},r.publicKeyVerify=function(e){return null!==l(e)},r.publicKeyTweakAdd=function(e,t,r){var i=l(e);if(null===i)throw new Error(a.EC_PUBLIC_KEY_PARSE_FAIL);if((t=new s(t)).cmp(u.n)>=0)throw new Error(a.EC_PUBLIC_KEY_TWEAK_ADD_FAIL);var o=u.g.mul(t).add(i.pub);if(o.isInfinity())throw new Error(a.EC_PUBLIC_KEY_TWEAK_ADD_FAIL);return n.from(o.encode(!0,r))},r.publicKeyTweakMul=function(e,t,r){var i=l(e);if(null===i)throw new Error(a.EC_PUBLIC_KEY_PARSE_FAIL);if((t=new s(t)).cmp(u.n)>=0||t.isZero())throw new Error(a.EC_PUBLIC_KEY_TWEAK_MUL_FAIL);return n.from(i.pub.mul(t).encode(!0,r))},r.publicKeyCombine=function(e,t){for(var r=new Array(e.length),i=0;i<e.length;++i)if(r[i]=l(e[i]),null===r[i])throw new Error(a.EC_PUBLIC_KEY_PARSE_FAIL);for(var s=r[0].pub,o=1;o<r.length;++o)s=s.add(r[o].pub);if(s.isInfinity())throw new Error(a.EC_PUBLIC_KEY_COMBINE_FAIL);return n.from(s.encode(!0,t))},r.signatureNormalize=function(e){var t=new s(e.slice(0,32)),r=new s(e.slice(32,64));if(t.cmp(u.n)>=0||r.cmp(u.n)>=0)throw new Error(a.ECDSA_SIGNATURE_PARSE_FAIL);var i=n.from(e);return 1===r.cmp(c.nh)&&u.n.sub(r).toArrayLike(n,"be",32).copy(i,32),i},r.signatureExport=function(e){var t=e.slice(0,32),r=e.slice(32,64);if(new s(t).cmp(u.n)>=0||new s(r).cmp(u.n)>=0)throw new Error(a.ECDSA_SIGNATURE_PARSE_FAIL);return{r:t,s:r}},r.signatureImport=function(e){var t=new s(e.r);t.cmp(u.n)>=0&&(t=new s(0));var r=new s(e.s);return r.cmp(u.n)>=0&&(r=new s(0)),n.concat([t.toArrayLike(n,"be",32),r.toArrayLike(n,"be",32)])},r.sign=function(e,t,r,i){if("function"==typeof r){var o=r;r=function(r){var c=o(e,t,null,i,r);if(!n.isBuffer(c)||32!==c.length)throw new Error(a.ECDSA_SIGN_FAIL);return new s(c)}}var l=new s(t);if(l.cmp(u.n)>=0||l.isZero())throw new Error(a.ECDSA_SIGN_FAIL);var f=c.sign(e,t,{canonical:!0,k:r,pers:i});return{signature:n.concat([f.r.toArrayLike(n,"be",32),f.s.toArrayLike(n,"be",32)]),recovery:f.recoveryParam}},r.verify=function(e,t,r){var n={r:t.slice(0,32),s:t.slice(32,64)},i=new s(n.r),o=new s(n.s);if(i.cmp(u.n)>=0||o.cmp(u.n)>=0)throw new Error(a.ECDSA_SIGNATURE_PARSE_FAIL);if(1===o.cmp(c.nh)||i.isZero()||o.isZero())return!1;var f=l(r);if(null===f)throw new Error(a.EC_PUBLIC_KEY_PARSE_FAIL);return c.verify(e,n,{x:f.pub.x,y:f.pub.y})},r.recover=function(e,t,r,i){var o={r:t.slice(0,32),s:t.slice(32,64)},l=new s(o.r),f=new s(o.s);if(l.cmp(u.n)>=0||f.cmp(u.n)>=0)throw new Error(a.ECDSA_SIGNATURE_PARSE_FAIL);try{if(l.isZero()||f.isZero())throw new Error;var d=c.recoverPubKey(e,o,r);return n.from(d.encode(!0,i))}catch(e){throw new Error(a.ECDSA_RECOVER_FAIL)}},r.ecdh=function(e,t){var n=r.ecdhUnsafe(e,t,!0);return i("sha256").update(n).digest()},r.ecdhUnsafe=function(e,t,r){var i=l(e);if(null===i)throw new Error(a.EC_PUBLIC_KEY_PARSE_FAIL);var o=new s(t);if(o.cmp(u.n)>=0||o.isZero())throw new Error(a.ECDH_FAIL);return n.from(i.pub.mul(o).encode(!0,r))}}}},{package:"secp256k1",file:"/home/circleci/project/node_modules/@metamask/eth-ledger-bridge-keyring/node_modules/secp256k1/lib/elliptic/index.js"}],[1108,{"./assert":1105,"./der":1106,"./messages.json":1109},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("./assert"),i=e("./der"),s=e("./messages.json");function o(e,t){return e===undefined?t:(n.isBoolean(e,s.COMPRESSED_TYPE_INVALID),e)}t.exports=function(e){return{privateKeyVerify:function(t){return n.isBuffer(t,s.EC_PRIVATE_KEY_TYPE_INVALID),32===t.length&&e.privateKeyVerify(t)},privateKeyExport:function(t,r){n.isBuffer(t,s.EC_PRIVATE_KEY_TYPE_INVALID),n.isBufferLength(t,32,s.EC_PRIVATE_KEY_LENGTH_INVALID),r=o(r,!0);var a=e.privateKeyExport(t,r);return i.privateKeyExport(t,a,r)},privateKeyImport:function(t){if(n.isBuffer(t,s.EC_PRIVATE_KEY_TYPE_INVALID),(t=i.privateKeyImport(t))&&32===t.length&&e.privateKeyVerify(t))return t;throw new Error(s.EC_PRIVATE_KEY_IMPORT_DER_FAIL)},privateKeyNegate:function(t){return n.isBuffer(t,s.EC_PRIVATE_KEY_TYPE_INVALID),n.isBufferLength(t,32,s.EC_PRIVATE_KEY_LENGTH_INVALID),e.privateKeyNegate(t)},privateKeyModInverse:function(t){return n.isBuffer(t,s.EC_PRIVATE_KEY_TYPE_INVALID),n.isBufferLength(t,32,s.EC_PRIVATE_KEY_LENGTH_INVALID),e.privateKeyModInverse(t)},privateKeyTweakAdd:function(t,r){return n.isBuffer(t,s.EC_PRIVATE_KEY_TYPE_INVALID),n.isBufferLength(t,32,s.EC_PRIVATE_KEY_LENGTH_INVALID),n.isBuffer(r,s.TWEAK_TYPE_INVALID),n.isBufferLength(r,32,s.TWEAK_LENGTH_INVALID),e.privateKeyTweakAdd(t,r)},privateKeyTweakMul:function(t,r){return n.isBuffer(t,s.EC_PRIVATE_KEY_TYPE_INVALID),n.isBufferLength(t,32,s.EC_PRIVATE_KEY_LENGTH_INVALID),n.isBuffer(r,s.TWEAK_TYPE_INVALID),n.isBufferLength(r,32,s.TWEAK_LENGTH_INVALID),e.privateKeyTweakMul(t,r)},publicKeyCreate:function(t,r){return n.isBuffer(t,s.EC_PRIVATE_KEY_TYPE_INVALID),n.isBufferLength(t,32,s.EC_PRIVATE_KEY_LENGTH_INVALID),r=o(r,!0),e.publicKeyCreate(t,r)},publicKeyConvert:function(t,r){return n.isBuffer(t,s.EC_PUBLIC_KEY_TYPE_INVALID),n.isBufferLength2(t,33,65,s.EC_PUBLIC_KEY_LENGTH_INVALID),r=o(r,!0),e.publicKeyConvert(t,r)},publicKeyVerify:function(t){return n.isBuffer(t,s.EC_PUBLIC_KEY_TYPE_INVALID),e.publicKeyVerify(t)},publicKeyTweakAdd:function(t,r,i){return n.isBuffer(t,s.EC_PUBLIC_KEY_TYPE_INVALID),n.isBufferLength2(t,33,65,s.EC_PUBLIC_KEY_LENGTH_INVALID),n.isBuffer(r,s.TWEAK_TYPE_INVALID),n.isBufferLength(r,32,s.TWEAK_LENGTH_INVALID),i=o(i,!0),e.publicKeyTweakAdd(t,r,i)},publicKeyTweakMul:function(t,r,i){return n.isBuffer(t,s.EC_PUBLIC_KEY_TYPE_INVALID),n.isBufferLength2(t,33,65,s.EC_PUBLIC_KEY_LENGTH_INVALID),n.isBuffer(r,s.TWEAK_TYPE_INVALID),n.isBufferLength(r,32,s.TWEAK_LENGTH_INVALID),i=o(i,!0),e.publicKeyTweakMul(t,r,i)},publicKeyCombine:function(t,r){n.isArray(t,s.EC_PUBLIC_KEYS_TYPE_INVALID),n.isLengthGTZero(t,s.EC_PUBLIC_KEYS_LENGTH_INVALID);for(var i=0;i<t.length;++i)n.isBuffer(t[i],s.EC_PUBLIC_KEY_TYPE_INVALID),n.isBufferLength2(t[i],33,65,s.EC_PUBLIC_KEY_LENGTH_INVALID);return r=o(r,!0),e.publicKeyCombine(t,r)},signatureNormalize:function(t){return n.isBuffer(t,s.ECDSA_SIGNATURE_TYPE_INVALID),n.isBufferLength(t,64,s.ECDSA_SIGNATURE_LENGTH_INVALID),e.signatureNormalize(t)},signatureExport:function(t){n.isBuffer(t,s.ECDSA_SIGNATURE_TYPE_INVALID),n.isBufferLength(t,64,s.ECDSA_SIGNATURE_LENGTH_INVALID);var r=e.signatureExport(t);return i.signatureExport(r)},signatureImport:function(t){n.isBuffer(t,s.ECDSA_SIGNATURE_TYPE_INVALID),n.isLengthGTZero(t,s.ECDSA_SIGNATURE_LENGTH_INVALID);var r=i.signatureImport(t);if(r)return e.signatureImport(r);throw new Error(s.ECDSA_SIGNATURE_PARSE_DER_FAIL)},signatureImportLax:function(t){n.isBuffer(t,s.ECDSA_SIGNATURE_TYPE_INVALID),n.isLengthGTZero(t,s.ECDSA_SIGNATURE_LENGTH_INVALID);var r=i.signatureImportLax(t);if(r)return e.signatureImport(r);throw new Error(s.ECDSA_SIGNATURE_PARSE_DER_FAIL)},sign:function(t,r,i){n.isBuffer(t,s.MSG32_TYPE_INVALID),n.isBufferLength(t,32,s.MSG32_LENGTH_INVALID),n.isBuffer(r,s.EC_PRIVATE_KEY_TYPE_INVALID),n.isBufferLength(r,32,s.EC_PRIVATE_KEY_LENGTH_INVALID);var o=null,a=null;return i!==undefined&&(n.isObject(i,s.OPTIONS_TYPE_INVALID),i.data!==undefined&&(n.isBuffer(i.data,s.OPTIONS_DATA_TYPE_INVALID),n.isBufferLength(i.data,32,s.OPTIONS_DATA_LENGTH_INVALID),o=i.data),i.noncefn!==undefined&&(n.isFunction(i.noncefn,s.OPTIONS_NONCEFN_TYPE_INVALID),a=i.noncefn)),e.sign(t,r,a,o)},verify:function(t,r,i){return n.isBuffer(t,s.MSG32_TYPE_INVALID),n.isBufferLength(t,32,s.MSG32_LENGTH_INVALID),n.isBuffer(r,s.ECDSA_SIGNATURE_TYPE_INVALID),n.isBufferLength(r,64,s.ECDSA_SIGNATURE_LENGTH_INVALID),n.isBuffer(i,s.EC_PUBLIC_KEY_TYPE_INVALID),n.isBufferLength2(i,33,65,s.EC_PUBLIC_KEY_LENGTH_INVALID),e.verify(t,r,i)},recover:function(t,r,i,a){return n.isBuffer(t,s.MSG32_TYPE_INVALID),n.isBufferLength(t,32,s.MSG32_LENGTH_INVALID),n.isBuffer(r,s.ECDSA_SIGNATURE_TYPE_INVALID),n.isBufferLength(r,64,s.ECDSA_SIGNATURE_LENGTH_INVALID),n.isNumber(i,s.RECOVERY_ID_TYPE_INVALID),n.isNumberInInterval(i,-1,4,s.RECOVERY_ID_VALUE_INVALID),a=o(a,!0),e.recover(t,r,i,a)},ecdh:function(t,r){return n.isBuffer(t,s.EC_PUBLIC_KEY_TYPE_INVALID),n.isBufferLength2(t,33,65,s.EC_PUBLIC_KEY_LENGTH_INVALID),n.isBuffer(r,s.EC_PRIVATE_KEY_TYPE_INVALID),n.isBufferLength(r,32,s.EC_PRIVATE_KEY_LENGTH_INVALID),e.ecdh(t,r)},ecdhUnsafe:function(t,r,i){return n.isBuffer(t,s.EC_PUBLIC_KEY_TYPE_INVALID),n.isBufferLength2(t,33,65,s.EC_PUBLIC_KEY_LENGTH_INVALID),n.isBuffer(r,s.EC_PRIVATE_KEY_TYPE_INVALID),n.isBufferLength(r,32,s.EC_PRIVATE_KEY_LENGTH_INVALID),i=o(i,!0),e.ecdhUnsafe(t,r,i)}}}}}},{package:"secp256k1",file:"/home/circleci/project/node_modules/@metamask/eth-ledger-bridge-keyring/node_modules/secp256k1/lib/index.js"}],[1096,{buffer:2157,"is-hex-prefixed":4772,"strip-hex-prefix":5977},function(){with(this)return function(){"use strict";return function(e,t,r){(function(r){(function(){var n=e("is-hex-prefixed"),i=e("strip-hex-prefix");function s(e){var t=e;if("string"!=typeof t)throw new Error("[ethjs-util] while padding to even, value must be string, is currently "+typeof t+", while padToEven.");return t.length%2&&(t="0"+t),t}function o(e){return"0x"+e.toString(16)}t.exports={arrayContainsArray:function(e,t,r){if(!0!==Array.isArray(e))throw new Error("[ethjs-util] method arrayContainsArray requires input 'superset' to be an array got type '"+typeof e+"'");if(!0!==Array.isArray(t))throw new Error("[ethjs-util] method arrayContainsArray requires input 'subset' to be an array got type '"+typeof t+"'");return t[Boolean(r)?"some":"every"]((function(t){return e.indexOf(t)>=0}))},intToBuffer:function(e){var t=o(e);return new r(s(t.slice(2)),"hex")},getBinarySize:function(e){if("string"!=typeof e)throw new Error("[ethjs-util] while getting binary size, method getBinarySize requires input 'str' to be type String, got '"+typeof e+"'.");return r.byteLength(e,"utf8")},isHexPrefixed:n,stripHexPrefix:i,padToEven:s,intToHex:o,fromAscii:function(e){for(var t="",r=0;r<e.length;r++){var n=e.charCodeAt(r).toString(16);t+=n.length<2?"0"+n:n}return"0x"+t},fromUtf8:function(e){return"0x"+s(new r(e,"utf8").toString("hex")).replace(/^0+|0+$/g,"")},toAscii:function(e){var t="",r=0,n=e.length;for("0x"===e.substring(0,2)&&(r=2);r<n;r+=2){var i=parseInt(e.substr(r,2),16);t+=String.fromCharCode(i)}return t},toUtf8:function(e){return new r(s(i(e).replace(/^0+|0+$/g,"")),"hex").toString("utf8")},getKeys:function(e,t,r){if(!Array.isArray(e))throw new Error("[ethjs-util] method getKeys expecting type Array as 'params' input, got '"+typeof e+"'");if("string"!=typeof t)throw new Error("[ethjs-util] method getKeys expecting type String for input 'key' got '"+typeof t+"'.");for(var n=[],i=0;i<e.length;i++){var s=e[i][t];if(r&&!s)s="";else if("string"!=typeof s)throw new Error("invalid abi");n.push(s)}return n},isHexString:function(e,t){return!("string"!=typeof e||!e.match(/^0x[0-9A-Fa-f]*$/))&&(!t||e.length===2+2*t)}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"ethjs-util",file:"/home/circleci/project/node_modules/@metamask/eth-ledger-bridge-keyring/node_modules/ethjs-util/lib/index.js"}],[1098,{"./lib/api":1099,"./lib/keccak":1103},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=e("./lib/api")(e("./lib/keccak"))}}},{package:"keccak",file:"/home/circleci/project/node_modules/@metamask/eth-ledger-bridge-keyring/node_modules/keccak/js.js"}],[2503,{assert:1776,"bn.js":2113,"create-hash":2261,"ethjs-util":2504,keccak:2505,rlp:5815,"safe-buffer":5817,secp256k1:2512},function(){with(this)return function(){"use strict";return function(e,t,r){var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=e("keccak"),s=e("secp256k1"),o=e("assert"),a=e("rlp"),c=e("bn.js"),u=e("create-hash"),l=e("safe-buffer").Buffer;Object.assign(r,e("ethjs-util")),r.MAX_INTEGER=new c("ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff",16),r.TWO_POW256=new c("10000000000000000000000000000000000000000000000000000000000000000",16),r.KECCAK256_NULL_S="c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470",r.SHA3_NULL_S=r.KECCAK256_NULL_S,r.KECCAK256_NULL=l.from(r.KECCAK256_NULL_S,"hex"),r.SHA3_NULL=r.KECCAK256_NULL,r.KECCAK256_RLP_ARRAY_S="1dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347",r.SHA3_RLP_ARRAY_S=r.KECCAK256_RLP_ARRAY_S,r.KECCAK256_RLP_ARRAY=l.from(r.KECCAK256_RLP_ARRAY_S,"hex"),r.SHA3_RLP_ARRAY=r.KECCAK256_RLP_ARRAY,r.KECCAK256_RLP_S="56e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421",r.SHA3_RLP_S=r.KECCAK256_RLP_S,r.KECCAK256_RLP=l.from(r.KECCAK256_RLP_S,"hex"),r.SHA3_RLP=r.KECCAK256_RLP,r.BN=c,r.rlp=a,r.secp256k1=s,r.zeros=function(e){return l.allocUnsafe(e).fill(0)},r.zeroAddress=function(){var e=r.zeros(20);return r.bufferToHex(e)},r.setLengthLeft=r.setLength=function(e,t,n){var i=r.zeros(t);return e=r.toBuffer(e),n?e.length<t?(e.copy(i),i):e.slice(0,t):e.length<t?(e.copy(i,t-e.length),i):e.slice(-t)},r.setLengthRight=function(e,t){return r.setLength(e,t,!0)},r.unpad=r.stripZeros=function(e){for(var t=(e=r.stripHexPrefix(e))[0];e.length>0&&"0"===t.toString();)t=(e=e.slice(1))[0];return e},r.toBuffer=function(e){if(!l.isBuffer(e))if(Array.isArray(e))e=l.from(e);else if("string"==typeof e)e=r.isHexString(e)?l.from(r.padToEven(r.stripHexPrefix(e)),"hex"):l.from(e);else if("number"==typeof e)e=r.intToBuffer(e);else if(null===e||e===undefined)e=l.allocUnsafe(0);else if(c.isBN(e))e=e.toArrayLike(l);else{if(!e.toArray)throw new Error("invalid type");e=l.from(e.toArray())}return e},r.bufferToInt=function(e){return new c(r.toBuffer(e)).toNumber()},r.bufferToHex=function(e){return"0x"+(e=r.toBuffer(e)).toString("hex")},r.fromSigned=function(e){return new c(e).fromTwos(256)},r.toUnsigned=function(e){return l.from(e.toTwos(256).toArray())},r.keccak=function(e,t){return e=r.toBuffer(e),t||(t=256),i("keccak"+t).update(e).digest()},r.keccak256=function(e){return r.keccak(e)},r.sha3=r.keccak,r.sha256=function(e){return e=r.toBuffer(e),u("sha256").update(e).digest()},r.ripemd160=function(e,t){e=r.toBuffer(e);var n=u("rmd160").update(e).digest();return!0===t?r.setLength(n,32):n},r.rlphash=function(e){return r.keccak(a.encode(e))},r.isValidPrivate=function(e){return s.privateKeyVerify(e)},r.isValidPublic=function(e,t){return 64===e.length?s.publicKeyVerify(l.concat([l.from([4]),e])):!!t&&s.publicKeyVerify(e)},r.pubToAddress=r.publicToAddress=function(e,t){return e=r.toBuffer(e),t&&64!==e.length&&(e=s.publicKeyConvert(e,!1).slice(1)),o(64===e.length),r.keccak(e).slice(-20)};var f=r.privateToPublic=function(e){return e=r.toBuffer(e),s.publicKeyCreate(e,!1).slice(1)};r.importPublic=function(e){return 64!==(e=r.toBuffer(e)).length&&(e=s.publicKeyConvert(e,!1).slice(1)),e},r.ecsign=function(e,t){var r=s.sign(e,t),n={};return n.r=r.signature.slice(0,32),n.s=r.signature.slice(32,64),n.v=r.recovery+27,n},r.hashPersonalMessage=function(e){var t=r.toBuffer("Ethereum Signed Message:\n"+e.length.toString());return r.keccak(l.concat([t,e]))},r.ecrecover=function(e,t,n,i){var o=l.concat([r.setLength(n,32),r.setLength(i,32)],64),a=t-27;if(0!==a&&1!==a)throw new Error("Invalid signature v value");var c=s.recover(e,o,a);return s.publicKeyConvert(c,!1).slice(1)},r.toRpcSig=function(e,t,n){if(27!==e&&28!==e)throw new Error("Invalid recovery id");return r.bufferToHex(l.concat([r.setLengthLeft(t,32),r.setLengthLeft(n,32),r.toBuffer(e-27)]))},r.fromRpcSig=function(e){if(65!==(e=r.toBuffer(e)).length)throw new Error("Invalid signature length");var t=e[64];return t<27&&(t+=27),{v:t,r:e.slice(0,32),s:e.slice(32,64)}},r.privateToAddress=function(e){return r.publicToAddress(f(e))},r.isValidAddress=function(e){return/^0x[0-9a-fA-F]{40}$/.test(e)},r.isZeroAddress=function(e){return r.zeroAddress()===r.addHexPrefix(e)},r.toChecksumAddress=function(e){e=r.stripHexPrefix(e).toLowerCase();for(var t=r.keccak(e).toString("hex"),n="0x",i=0;i<e.length;i++)parseInt(t[i],16)>=8?n+=e[i].toUpperCase():n+=e[i];return n},r.isValidChecksumAddress=function(e){return r.isValidAddress(e)&&r.toChecksumAddress(e)===e},r.generateAddress=function(e,t){return e=r.toBuffer(e),t=(t=new c(t)).isZero()?null:l.from(t.toArray()),r.rlphash([e,t]).slice(-20)},r.isPrecompiled=function(e){var t=r.unpad(e);return 1===t.length&&t[0]>=1&&t[0]<=8},r.addHexPrefix=function(e){return"string"!=typeof e||r.isHexPrefixed(e)?e:"0x"+e},r.isValidSignature=function(e,t,r,n){var i=new c("7fffffffffffffffffffffffffffffff5d576e7357a4501ddfe92f46681b20a0",16),s=new c("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141",16);return 32===t.length&&32===r.length&&((27===e||28===e)&&(t=new c(t),r=new c(r),!(t.isZero()||t.gt(s)||r.isZero()||r.gt(s))&&(!1!==n||1!==new c(r).cmp(i))))},r.baToJSON=function(e){if(l.isBuffer(e))return"0x"+e.toString("hex");if(e instanceof Array){for(var t=[],n=0;n<e.length;n++)t.push(r.baToJSON(e[n]));return t}},r.defineProperties=function(e,t,i){if(e.raw=[],e._fields=[],e.toJSON=function(t){if(t){var n={};return e._fields.forEach((function(t){n[t]="0x"+e[t].toString("hex")})),n}return r.baToJSON(this.raw)},e.serialize=function(){return a.encode(e.raw)},t.forEach((function(t,n){function i(){return e.raw[n]}function s(i){"00"!==(i=r.toBuffer(i)).toString("hex")||t.allowZero||(i=l.allocUnsafe(0)),t.allowLess&&t.length?(i=r.stripZeros(i),o(t.length>=i.length,"The field "+t.name+" must not have more "+t.length+" bytes")):t.allowZero&&0===i.length||!t.length||o(t.length===i.length,"The field "+t.name+" must have byte length of "+t.length),e.raw[n]=i}e._fields.push(t.name),Object.defineProperty(e,t.name,{enumerable:!0,configurable:!0,get:i,set:s}),t.default&&(e[t.name]=t.default),t.alias&&Object.defineProperty(e,t.alias,{enumerable:!1,configurable:!0,set:s,get:i})})),i)if("string"==typeof i&&(i=l.from(r.stripHexPrefix(i),"hex")),l.isBuffer(i)&&(i=a.decode(i)),Array.isArray(i)){if(i.length>e._fields.length)throw new Error("wrong number of fields in data");i.forEach((function(t,n){e[e._fields[n]]=r.toBuffer(t)}))}else{if("object"!==(void 0===i?"undefined":n(i)))throw new Error("invalid data");var s=Object.keys(i);t.forEach((function(t){-1!==s.indexOf(t.name)&&(e[t.name]=i[t.name]),-1!==s.indexOf(t.alias)&&(e[t.alias]=i[t.alias])}))}}}}},{package:"ethereumjs-util",file:"/home/circleci/project/node_modules/eth-json-rpc-middleware/node_modules/ethereumjs-util/dist/index.js"}],[2491,{"./lib/index.js":2492},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=e("./lib/index.js")}}},{package:"ethereumjs-abi",file:"/home/circleci/project/node_modules/eth-json-rpc-middleware/node_modules/ethereumjs-abi/index.js"}],[4403,{"./constants":4401,"buffer/":2172,"js-sha3":4797},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.abiParsers=r.unpackAbiDef=r.getFuncSig=r.buildAddAbiPayload=r.ABI_DEF_SZ=r.MAX_ABI_DEFS=void 0;var n=e("buffer/"),i=e("js-sha3"),s=e("./constants"),o=100,a=32,c=18;r.MAX_ABI_DEFS=2,r.ABI_DEF_SZ=605;r.buildAddAbiPayload=function(e){if(!e||!Array.isArray(e))throw new Error("Missing definitions.");if(e.length>r.MAX_ABI_DEFS)throw new Error("You may only add ".concat(r.MAX_ABI_DEFS," ABI definitions per request."));var t=n.Buffer.alloc(1+r.MAX_ABI_DEFS*r.ABI_DEF_SZ),i=0;return t.writeUInt8(e.length,i),i++,e.forEach((function(e){if(!e.sig||!e.name||!e.params)throw new Error("name, sig, and params must be present for every ABI definition.");var r=n.Buffer.from(e.sig,"hex");if(4!==r.length)throw new Error("Function signatures must always be four bytes.");if(r.copy(t,i),i+=r.length,n.Buffer.from(e.name).length>99)throw new Error("Only function names shorter than ".concat(99," characters are supported."));n.Buffer.from(e.name).slice(0,o).copy(t,i),i+=o;var s=Array.isArray(e.params)?e.params.length:0;if(t.writeUInt8(s,i),i++,e.category&&"string"==typeof e.category){var u=n.Buffer.from(e.category);if(u.length>31)throw new Error("Category name must be shorter than ".concat(31,". Got ").concat(u.length));u.copy(t,i)}if(i+=a,s>c)throw new Error("Currently only ABI defintions with <=10 parameters are supported.");s>0?(e.params.forEach((function(e){if(e.name===undefined||e.latticeTypeIdx===undefined||e.isArray===undefined||e.arraySz===undefined)throw new Error("name, latticeTypeIdx, isArray, and arraySz must be defined for all ABI params.");n.Buffer.from(e.name).slice(0,20).copy(t,i),i+=20})),i+=20*(c-s),e.params.forEach((function(e){t.writeUInt8(e.latticeTypeIdx,i),i++,t.writeUInt8(e.isArray?1:0,i),i++,t.writeUInt32LE(e.arraySz,i),i+=4})),i+=6*(c-s)):i+=468})),t};r.getFuncSig=function(e){var t="".concat(e.name,"(");return e.inputs.forEach((function(e){if(e.type.indexOf("tuple")>-1){var r=e.type.slice(e.type.indexOf("tuple")+5);t+="(",e.components.forEach((function(r,n){t+="".concat(r.type).concat(n===e.components.length-1?"":",")})),t+=")".concat(r,",")}else t+="".concat(e.type,",")})),e.inputs.length>0&&(t=t.slice(0,t.length-1)),t+=")",(0,i.keccak256)(t).slice(0,8)};function u(e,t,r){void 0===t&&(t=[]),void 0===r&&(r=!1);var n=[];if(e.forEach((function(e){var i=e.type,o={isArray:!1,arraySz:0,name:e.name},a=i.indexOf("["),c=i.indexOf("]");if(i.split("[").length>2)throw new Error("Skipping function with unsupported multidimensional array type");if(a>-1&&c>-1)if(a>=c);else if(a+1===c)o.isArray=!0;else{var l=parseInt(i.slice(a+1,c));if(isNaN(l))return o;o.isArray=!0,o.arraySz=l}var f,d=a>-1?i.slice(0,a):i;if("tuple"===d){if(!0===r)throw new Error("Nested tuples are not supported");d="tuple".concat(e.components.length),n=u(e.components,n,!0)}if(o.latticeTypeIdx=(f=d,s.ETH_ABI_LATTICE_FW_TYPE_MAP[f]),!o.latticeTypeIdx)throw new Error("Unsupported type: ".concat(i));t.push(o)})),t.concat(n).length>18)throw new Error("Function has too many parameters for Lattice firmware (18 max)");return t.concat(n)}r.unpackAbiDef=function(e){var t=0,r={header:{sig:"",name:"",numParam:0},category:"",params:[]};r.header.sig="0x"+e.slice(t,t+4).toString("hex"),t+=4,r.header.name=e.slice(t,t+o).toString().split("\0")[0],t+=o,r.header.numParam=e.readUInt8(t),t+=1,r.category=e.slice(t,t+a).toString().split("\0")[0],t+=a;for(var n=0;n<c;n++){if(n<r.header.numParam){var i={name:"",type:0,typeName:"",isArray:!1,arraySz:0};i.name=e.slice(t,t+20).toString().split("\0")[0],r.params.push(i)}t+=20}function u(e){var t=null;return Object.keys(s.ETH_ABI_LATTICE_FW_TYPE_MAP).forEach((function(r){s.ETH_ABI_LATTICE_FW_TYPE_MAP[r]===e&&(t=r)})),t}for(n=0;n<c;n++)n<r.header.numParam&&(r.params[n].type=e.readUInt8(t),t+=1,r.params[n].typeName=u(r.params[n].type),r.params[n].isArray=e.readUInt8(t),t+=1,r.params[n].arraySz=e.readUInt32LE(t),t+=4);return r},r.abiParsers={etherscan:function(e,t){void 0===t&&(t=!1);var n=[];return e.forEach((function(e){if(e.name&&e.inputs&&"function"===e.type&&"view"!==e.stateMutability&&!0!==e.constant)try{var i=(0,r.getFuncSig)(e),s=u(e.inputs);n.push({name:e.name,sig:i,params:s})}catch(r){if(!0!==t)throw new Error(r);console.error("Failed to load def:",e.name,r.toString())}})),n}},r.default={MAX_ABI_DEFS:r.MAX_ABI_DEFS,buildAddAbiPayload:r.buildAddAbiPayload,getFuncSig:r.getFuncSig,abiParsers:r.abiParsers}}}},{package:"gridplus-sdk",file:"/home/circleci/project/node_modules/gridplus-sdk/dist/ethereumAbi.js"}],[4406,{"./constants":4401,"aes-js":1751,"bignumber.js":4408,"buffer/":2172,"crc-32":2232,elliptic:2391},function(){with(this)return function(){"use strict";return function(e,t,r){var n=this&&this.__spreadArray||function(e,t,r){if(r||2===arguments.length)for(var n,i=0,s=t.length;i<s;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.randomBytes=r.promisifyCb=r.existsIn=r.isAsciiStr=r.buildSignerPathBuf=r.getP256KeyPairFromPub=r.getP256KeyPair=r.parseDER=r.aes256_decrypt=r.aes256_encrypt=r.fixLen=r.ensureHexBuffer=r.splitFrames=r.isValidAssetPath=r.toPaddedDER=r.checksum=r.parseLattice1Response=void 0;var s=i(e("aes-js")),o=i(e("bignumber.js")),a=e("buffer/"),c=i(e("crc-32")),u=i(e("elliptic")),l=e("./constants"),f=l.BIP_CONSTANTS.COINS,d=l.BIP_CONSTANTS.PURPOSES,h=new(0,u.default.ec)("p256");r.parseLattice1Response=function(e){var t={err:null,data:null},n=a.Buffer.from(e,"hex"),i=0,s=n.readUInt8(i);if(i++,s!==l.VERSION_BYTE)return t.err="Incorrect protocol version. Please update your SDK",t;var o=n.readUInt8(i);if(i++,0!==o)return t.err="Incorrect response from Lattice1",t;n.readUInt32BE(i),i+=4;var c=n.readUInt16BE(i);i+=2;var u=n.slice(i,i+c);i+=c;var f=u.readUInt8(0);return f!==l.responseCodes.RESP_SUCCESS?(t.err="".concat(l.responseMsgs[f]?l.responseMsgs[f]:"Unknown Error"," (Lattice)"),t.responseCode=f,t):(t.data=u.slice(1,u.length),n.readUInt32BE(i)!==(0,r.checksum)(n.slice(0,n.length-4))?(t.err="Invalid checksum from device response",t.data=null,t):t)};r.checksum=function(e){return c.default.buf(e)>>>0};r.toPaddedDER=function(e){var t=a.Buffer.alloc(74);return a.Buffer.from(e.toDER()).copy(t),t};r.isValidAssetPath=function(e,t){var r=[d.ETH,d.BTC_LEGACY,d.BTC_WRAPPED_SEGWIT,d.BTC_SEGWIT],n=[f.ETH,f.BTC,f.BTC_TESTNET];return!((e[1]===f.BTC||e[1]===f.BTC_TESTNET)&&e[0]!==d.BTC_WRAPPED_SEGWIT&&!t.allowBtcLegacyAndSegwitAddrs)&&(r.indexOf(e[0])>=0&&(n.indexOf(e[1])>=0||[60,61,966,700,9006,9e3,1007,553,178,137,37310,108,40,889,1987,820,6060,1620,1313114,76,246529,246785,1001,227,916,464,2221,344,73799,246].indexOf(e[1]-l.HARDENED_OFFSET)>0))};r.splitFrames=function(e,t){for(var r=[],n=Math.ceil(e.length/t),i=0,s=0;s<n;s++)r.push(e.slice(i,i+t)),i+=t;return r};r.ensureHexBuffer=function(e,t){void 0===t&&(t=!0);try{if(null===e||0===e&&!0===t)return a.Buffer.alloc(0);var r="number"==typeof e||function(e){var t=new o.default(e).toString().split(".").join(""),r=new String(e);return t.slice(0,8)===r.slice(0,8)}(e);return(e=r?"".concat(new o.default(e).toString(16)):"string"==typeof e&&"0x"===e.slice(0,2)?e.slice(2):e.toString("hex")).length%2>0&&(e="0".concat(e)),"00"!==e||r?a.Buffer.from(e,"hex"):a.Buffer.alloc(0)}catch(t){throw new Error("Cannot convert ".concat(e.toString()," to hex buffer (").concat(t.toString(),")"))}};r.fixLen=function(e,t){var r=a.Buffer.alloc(t);return e.length<t?(e.copy(r,t-e.length),r):e.slice(-t)};r.aes256_encrypt=function(e,t){var r=a.Buffer.from(l.AES_IV),n=new s.default.ModeOfOperation.cbc(t,r),i=e.length%16==0?e:s.default.padding.pkcs7.pad(e);return a.Buffer.from(n.encrypt(i))};r.aes256_decrypt=function(e,t){var r=a.Buffer.from(l.AES_IV),n=new s.default.ModeOfOperation.cbc(t,r);return a.Buffer.from(n.decrypt(e))};r.parseDER=function(e){if(48!==e[0]||2!==e[2])return null;var t=3,r={r:null,s:null},n=e[t];if(t++,r.r=e.slice(t,t+n),2!==e[t+=n])return null;var i=e[++t];return t++,r.s=e.slice(t,t+i),r};r.getP256KeyPair=function(e){return h.keyFromPrivate(e,"hex")};r.getP256KeyPairFromPub=function(e){return h.keyFromPublic(e,"hex")};r.buildSignerPathBuf=function(e,t){var r=a.Buffer.alloc(24),n=0;if(t&&e.length>5)throw new Error("Signer path must be <=5 indices.");if(!t&&5!==e.length)throw new Error("Your Lattice firmware only supports 5-index derivation paths. Please upgrade.");r.writeUInt32LE(e.length,n),n+=4;for(var i=0;i<5;i++)i<e.length?r.writeUInt32LE(e[i],n):r.writeUInt32LE(0,n),n+=4;return r};r.isAsciiStr=function(e,t){if(void 0===t&&(t=!1),"string"!=typeof e)return!1;for(var r=t?[32,10]:[],n=0;n<e.length;n++){var i=e.charCodeAt(n);if(r.indexOf(i)<0&&(i<32||i>127))return!1}return!0};r.existsIn=function(e,t){return Object.keys(t).some((function(r){return t[r]===e}))};r.promisifyCb=function(e,t,r){return function(i){for(var s=[],o=1;o<arguments.length;o++)s[o-1]=arguments[o];return r&&"function"==typeof r?r.apply(void 0,n([i],s,!1)):i&&"string"==typeof i?t(i):e.apply(void 0,s)}};r.randomBytes=function(e){for(var t=a.Buffer.alloc(e),r=0;r<e;r++)t[r]=Math.round(255*Math.random());return t}}}},{package:"gridplus-sdk",file:"/home/circleci/project/node_modules/gridplus-sdk/dist/util.js"}],[2172,{"base64-js":2030,ieee754:4471},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("base64-js"),i=e("ieee754"),s="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;r.Buffer=c,r.SlowBuffer=function(e){+e!=e&&(e=0);return c.alloc(+e)},r.INSPECT_MAX_BYTES=50;var o=2147483647;function a(e){if(e>o)throw new RangeError('The value "'+e+'" is invalid for option "size"');var t=new Uint8Array(e);return Object.setPrototypeOf(t,c.prototype),t}function c(e,t,r){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return f(e)}return u(e,t,r)}function u(e,t,r){if("string"==typeof e)return function(e,t){"string"==typeof t&&""!==t||(t="utf8");if(!c.isEncoding(t))throw new TypeError("Unknown encoding: "+t);var r=0|m(e,t),n=a(r),i=n.write(e,t);i!==r&&(n=n.slice(0,i));return n}(e,t);if(ArrayBuffer.isView(e))return function(e){if(V(e,Uint8Array)){var t=new Uint8Array(e);return h(t.buffer,t.byteOffset,t.byteLength)}return d(e)}(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, "+"or Array-like Object. Received type "+typeof e);if(V(e,ArrayBuffer)||e&&V(e.buffer,ArrayBuffer))return h(e,t,r);if("undefined"!=typeof SharedArrayBuffer&&(V(e,SharedArrayBuffer)||e&&V(e.buffer,SharedArrayBuffer)))return h(e,t,r);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');var n=e.valueOf&&e.valueOf();if(null!=n&&n!==e)return c.from(n,t,r);var i=function(e){if(c.isBuffer(e)){var t=0|p(e.length),r=a(t);return 0===r.length||e.copy(r,0,0,t),r}if(e.length!==undefined)return"number"!=typeof e.length||H(e.length)?a(0):d(e);if("Buffer"===e.type&&Array.isArray(e.data))return d(e.data)}(e);if(i)return i;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return c.from(e[Symbol.toPrimitive]("string"),t,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, "+"or Array-like Object. Received type "+typeof e)}function l(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function f(e){return l(e),a(e<0?0:0|p(e))}function d(e){for(var t=e.length<0?0:0|p(e.length),r=a(t),n=0;n<t;n+=1)r[n]=255&e[n];return r}function h(e,t,r){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(r||0))throw new RangeError('"length" is outside of buffer bounds');var n;return n=t===undefined&&r===undefined?new Uint8Array(e):r===undefined?new Uint8Array(e,t):new Uint8Array(e,t,r),Object.setPrototypeOf(n,c.prototype),n}function p(e){if(e>=o)throw new RangeError("Attempt to allocate Buffer larger than maximum "+"size: 0x"+o.toString(16)+" bytes");return 0|e}function m(e,t){if(c.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||V(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. '+"Received type "+typeof e);var r=e.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===r)return 0;for(var i=!1;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return B(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return U(e).length;default:if(i)return n?-1:B(e).length;t=(""+t).toLowerCase(),i=!0}}function g(e,t,r){var n=!1;if((t===undefined||t<0)&&(t=0),t>this.length)return"";if((r===undefined||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return P(this,t,r);case"utf8":case"utf-8":return T(this,t,r);case"ascii":return C(this,t,r);case"latin1":case"binary":return x(this,t,r);case"base64":return A(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return O(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function y(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function b(e,t,r,n,i){if(0===e.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),H(r=+r)&&(r=i?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(i)return-1;r=e.length-1}else if(r<0){if(!i)return-1;r=0}if("string"==typeof t&&(t=c.from(t,n)),c.isBuffer(t))return 0===t.length?-1:v(e,t,r,n,i);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):v(e,[t],r,n,i);throw new TypeError("val must be string, number or Buffer")}function v(e,t,r,n,i){var s,o=1,a=e.length,c=t.length;if(n!==undefined&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;o=2,a/=2,c/=2,r/=2}function u(e,t){return 1===o?e[t]:e.readUInt16BE(t*o)}if(i){var l=-1;for(s=r;s<a;s++)if(u(e,s)===u(t,-1===l?0:s-l)){if(-1===l&&(l=s),s-l+1===c)return l*o}else-1!==l&&(s-=s-l),l=-1}else for(r+c>a&&(r=a-c),s=r;s>=0;s--){for(var f=!0,d=0;d<c;d++)if(u(e,s+d)!==u(t,d)){f=!1;break}if(f)return s}return-1}function w(e,t,r,n){r=Number(r)||0;var i=e.length-r;n?(n=Number(n))>i&&(n=i):n=i;var s=t.length;n>s/2&&(n=s/2);for(var o=0;o<n;++o){var a=parseInt(t.substr(2*o,2),16);if(H(a))return o;e[r+o]=a}return o}function _(e,t,r,n){return K(B(t,e.length-r),e,r,n)}function E(e,t,r,n){return K(function(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,n)}function k(e,t,r,n){return K(U(t),e,r,n)}function S(e,t,r,n){return K(function(e,t){for(var r,n,i,s=[],o=0;o<e.length&&!((t-=2)<0);++o)n=(r=e.charCodeAt(o))>>8,i=r%256,s.push(i),s.push(n);return s}(t,e.length-r),e,r,n)}function A(e,t,r){return 0===t&&r===e.length?n.fromByteArray(e):n.fromByteArray(e.slice(t,r))}function T(e,t,r){r=Math.min(e.length,r);for(var n=[],i=t;i<r;){var s,o,a,c,u=e[i],l=null,f=u>239?4:u>223?3:u>191?2:1;if(i+f<=r)switch(f){case 1:u<128&&(l=u);break;case 2:128==(192&(s=e[i+1]))&&(c=(31&u)<<6|63&s)>127&&(l=c);break;case 3:s=e[i+1],o=e[i+2],128==(192&s)&&128==(192&o)&&(c=(15&u)<<12|(63&s)<<6|63&o)>2047&&(c<55296||c>57343)&&(l=c);break;case 4:s=e[i+1],o=e[i+2],a=e[i+3],128==(192&s)&&128==(192&o)&&128==(192&a)&&(c=(15&u)<<18|(63&s)<<12|(63&o)<<6|63&a)>65535&&c<1114112&&(l=c)}null===l?(l=65533,f=1):l>65535&&(l-=65536,n.push(l>>>10&1023|55296),l=56320|1023&l),n.push(l),i+=f}return function(e){var t=e.length;if(t<=I)return String.fromCharCode.apply(String,e);var r="",n=0;for(;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=I));return r}(n)}r.kMaxLength=o,c.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),c.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by "+"`buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(c.prototype,"parent",{enumerable:!0,get:function(){return c.isBuffer(this)?this.buffer:undefined}}),Object.defineProperty(c.prototype,"offset",{enumerable:!0,get:function(){return c.isBuffer(this)?this.byteOffset:undefined}}),c.poolSize=8192,c.from=function(e,t,r){return u(e,t,r)},Object.setPrototypeOf(c.prototype,Uint8Array.prototype),Object.setPrototypeOf(c,Uint8Array),c.alloc=function(e,t,r){return function(e,t,r){return l(e),e<=0?a(e):t!==undefined?"string"==typeof r?a(e).fill(t,r):a(e).fill(t):a(e)}(e,t,r)},c.allocUnsafe=function(e){return f(e)},c.allocUnsafeSlow=function(e){return f(e)},c.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==c.prototype},c.compare=function(e,t){if(V(e,Uint8Array)&&(e=c.from(e,e.offset,e.byteLength)),V(t,Uint8Array)&&(t=c.from(t,t.offset,t.byteLength)),!c.isBuffer(e)||!c.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;for(var r=e.length,n=t.length,i=0,s=Math.min(r,n);i<s;++i)if(e[i]!==t[i]){r=e[i],n=t[i];break}return r<n?-1:n<r?1:0},c.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return c.alloc(0);var r;if(t===undefined)for(t=0,r=0;r<e.length;++r)t+=e[r].length;var n=c.allocUnsafe(t),i=0;for(r=0;r<e.length;++r){var s=e[r];if(V(s,Uint8Array))i+s.length>n.length?c.from(s).copy(n,i):Uint8Array.prototype.set.call(n,s,i);else{if(!c.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(n,i)}i+=s.length}return n},c.byteLength=m,c.prototype._isBuffer=!0,c.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)y(this,t,t+1);return this},c.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)y(this,t,t+3),y(this,t+1,t+2);return this},c.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)y(this,t,t+7),y(this,t+1,t+6),y(this,t+2,t+5),y(this,t+3,t+4);return this},c.prototype.toString=function(){var e=this.length;return 0===e?"":0===arguments.length?T(this,0,e):g.apply(this,arguments)},c.prototype.toLocaleString=c.prototype.toString,c.prototype.equals=function(e){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===c.compare(this,e)},c.prototype.inspect=function(){var e="",t=r.INSPECT_MAX_BYTES;return e=this.toString("hex",0,t).replace(/(.{2})/g,"$1 ").trim(),this.length>t&&(e+=" ... "),"<Buffer "+e+">"},s&&(c.prototype[s]=c.prototype.inspect),c.prototype.compare=function(e,t,r,n,i){if(V(e,Uint8Array)&&(e=c.from(e,e.offset,e.byteLength)),!c.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. '+"Received type "+typeof e);if(t===undefined&&(t=0),r===undefined&&(r=e?e.length:0),n===undefined&&(n=0),i===undefined&&(i=this.length),t<0||r>e.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&t>=r)return 0;if(n>=i)return-1;if(t>=r)return 1;if(this===e)return 0;for(var s=(i>>>=0)-(n>>>=0),o=(r>>>=0)-(t>>>=0),a=Math.min(s,o),u=this.slice(n,i),l=e.slice(t,r),f=0;f<a;++f)if(u[f]!==l[f]){s=u[f],o=l[f];break}return s<o?-1:o<s?1:0},c.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},c.prototype.indexOf=function(e,t,r){return b(this,e,t,r,!0)},c.prototype.lastIndexOf=function(e,t,r){return b(this,e,t,r,!1)},c.prototype.write=function(e,t,r,n){if(t===undefined)n="utf8",r=this.length,t=0;else if(r===undefined&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(r)?(r>>>=0,n===undefined&&(n="utf8")):(n=r,r=undefined)}var i=this.length-t;if((r===undefined||r>i)&&(r=i),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var s=!1;;)switch(n){case"hex":return w(this,e,t,r);case"utf8":case"utf-8":return _(this,e,t,r);case"ascii":case"latin1":case"binary":return E(this,e,t,r);case"base64":return k(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return S(this,e,t,r);default:if(s)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),s=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var I=4096;function C(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(127&e[i]);return n}function x(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(e[i]);return n}function P(e,t,r){var n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);for(var i="",s=t;s<r;++s)i+=F[e[s]];return i}function O(e,t,r){for(var n=e.slice(t,r),i="",s=0;s<n.length-1;s+=2)i+=String.fromCharCode(n[s]+256*n[s+1]);return i}function R(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function N(e,t,r,n,i,s){if(!c.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<s)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}function M(e,t,r,n,i,s){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function j(e,t,r,n,s){return t=+t,r>>>=0,s||M(e,0,r,4),i.write(e,t,r,n,23,4),r+4}function L(e,t,r,n,s){return t=+t,r>>>=0,s||M(e,0,r,8),i.write(e,t,r,n,52,8),r+8}c.prototype.slice=function(e,t){var r=this.length;(e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=t===undefined?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e);var n=this.subarray(e,t);return Object.setPrototypeOf(n,c.prototype),n},c.prototype.readUintLE=c.prototype.readUIntLE=function(e,t,r){e>>>=0,t>>>=0,r||R(e,t,this.length);for(var n=this[e],i=1,s=0;++s<t&&(i*=256);)n+=this[e+s]*i;return n},c.prototype.readUintBE=c.prototype.readUIntBE=function(e,t,r){e>>>=0,t>>>=0,r||R(e,t,this.length);for(var n=this[e+--t],i=1;t>0&&(i*=256);)n+=this[e+--t]*i;return n},c.prototype.readUint8=c.prototype.readUInt8=function(e,t){return e>>>=0,t||R(e,1,this.length),this[e]},c.prototype.readUint16LE=c.prototype.readUInt16LE=function(e,t){return e>>>=0,t||R(e,2,this.length),this[e]|this[e+1]<<8},c.prototype.readUint16BE=c.prototype.readUInt16BE=function(e,t){return e>>>=0,t||R(e,2,this.length),this[e]<<8|this[e+1]},c.prototype.readUint32LE=c.prototype.readUInt32LE=function(e,t){return e>>>=0,t||R(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},c.prototype.readUint32BE=c.prototype.readUInt32BE=function(e,t){return e>>>=0,t||R(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},c.prototype.readIntLE=function(e,t,r){e>>>=0,t>>>=0,r||R(e,t,this.length);for(var n=this[e],i=1,s=0;++s<t&&(i*=256);)n+=this[e+s]*i;return n>=(i*=128)&&(n-=Math.pow(2,8*t)),n},c.prototype.readIntBE=function(e,t,r){e>>>=0,t>>>=0,r||R(e,t,this.length);for(var n=t,i=1,s=this[e+--n];n>0&&(i*=256);)s+=this[e+--n]*i;return s>=(i*=128)&&(s-=Math.pow(2,8*t)),s},c.prototype.readInt8=function(e,t){return e>>>=0,t||R(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},c.prototype.readInt16LE=function(e,t){e>>>=0,t||R(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},c.prototype.readInt16BE=function(e,t){e>>>=0,t||R(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},c.prototype.readInt32LE=function(e,t){return e>>>=0,t||R(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},c.prototype.readInt32BE=function(e,t){return e>>>=0,t||R(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},c.prototype.readFloatLE=function(e,t){return e>>>=0,t||R(e,4,this.length),i.read(this,e,!0,23,4)},c.prototype.readFloatBE=function(e,t){return e>>>=0,t||R(e,4,this.length),i.read(this,e,!1,23,4)},c.prototype.readDoubleLE=function(e,t){return e>>>=0,t||R(e,8,this.length),i.read(this,e,!0,52,8)},c.prototype.readDoubleBE=function(e,t){return e>>>=0,t||R(e,8,this.length),i.read(this,e,!1,52,8)},c.prototype.writeUintLE=c.prototype.writeUIntLE=function(e,t,r,n){(e=+e,t>>>=0,r>>>=0,n)||N(this,e,t,r,Math.pow(2,8*r)-1,0);var i=1,s=0;for(this[t]=255&e;++s<r&&(i*=256);)this[t+s]=e/i&255;return t+r},c.prototype.writeUintBE=c.prototype.writeUIntBE=function(e,t,r,n){(e=+e,t>>>=0,r>>>=0,n)||N(this,e,t,r,Math.pow(2,8*r)-1,0);var i=r-1,s=1;for(this[t+i]=255&e;--i>=0&&(s*=256);)this[t+i]=e/s&255;return t+r},c.prototype.writeUint8=c.prototype.writeUInt8=function(e,t,r){return e=+e,t>>>=0,r||N(this,e,t,1,255,0),this[t]=255&e,t+1},c.prototype.writeUint16LE=c.prototype.writeUInt16LE=function(e,t,r){return e=+e,t>>>=0,r||N(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},c.prototype.writeUint16BE=c.prototype.writeUInt16BE=function(e,t,r){return e=+e,t>>>=0,r||N(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},c.prototype.writeUint32LE=c.prototype.writeUInt32LE=function(e,t,r){return e=+e,t>>>=0,r||N(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},c.prototype.writeUint32BE=c.prototype.writeUInt32BE=function(e,t,r){return e=+e,t>>>=0,r||N(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},c.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t>>>=0,!n){var i=Math.pow(2,8*r-1);N(this,e,t,r,i-1,-i)}var s=0,o=1,a=0;for(this[t]=255&e;++s<r&&(o*=256);)e<0&&0===a&&0!==this[t+s-1]&&(a=1),this[t+s]=(e/o>>0)-a&255;return t+r},c.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t>>>=0,!n){var i=Math.pow(2,8*r-1);N(this,e,t,r,i-1,-i)}var s=r-1,o=1,a=0;for(this[t+s]=255&e;--s>=0&&(o*=256);)e<0&&0===a&&0!==this[t+s+1]&&(a=1),this[t+s]=(e/o>>0)-a&255;return t+r},c.prototype.writeInt8=function(e,t,r){return e=+e,t>>>=0,r||N(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},c.prototype.writeInt16LE=function(e,t,r){return e=+e,t>>>=0,r||N(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},c.prototype.writeInt16BE=function(e,t,r){return e=+e,t>>>=0,r||N(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},c.prototype.writeInt32LE=function(e,t,r){return e=+e,t>>>=0,r||N(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},c.prototype.writeInt32BE=function(e,t,r){return e=+e,t>>>=0,r||N(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},c.prototype.writeFloatLE=function(e,t,r){return j(this,e,t,!0,r)},c.prototype.writeFloatBE=function(e,t,r){return j(this,e,t,!1,r)},c.prototype.writeDoubleLE=function(e,t,r){return L(this,e,t,!0,r)},c.prototype.writeDoubleBE=function(e,t,r){return L(this,e,t,!1,r)},c.prototype.copy=function(e,t,r,n){if(!c.isBuffer(e))throw new TypeError("argument should be a Buffer");if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);var i=n-r;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,r,n):Uint8Array.prototype.set.call(e,this.subarray(r,n),t),i},c.prototype.fill=function(e,t,r,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),n!==undefined&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!c.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(1===e.length){var i=e.charCodeAt(0);("utf8"===n&&i<128||"latin1"===n)&&(e=i)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;var s;if(t>>>=0,r=r===undefined?this.length:r>>>0,e||(e=0),"number"==typeof e)for(s=t;s<r;++s)this[s]=e;else{var o=c.isBuffer(e)?e:c.from(e,n),a=o.length;if(0===a)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(s=0;s<r-t;++s)this[s+t]=o[s%a]}return this};var D=/[^+/0-9A-Za-z-_]/g;function B(e,t){var r;t=t||Infinity;for(var n=e.length,i=null,s=[],o=0;o<n;++o){if((r=e.charCodeAt(o))>55295&&r<57344){if(!i){if(r>56319){(t-=3)>-1&&s.push(239,191,189);continue}if(o+1===n){(t-=3)>-1&&s.push(239,191,189);continue}i=r;continue}if(r<56320){(t-=3)>-1&&s.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(t-=3)>-1&&s.push(239,191,189);if(i=null,r<128){if((t-=1)<0)break;s.push(r)}else if(r<2048){if((t-=2)<0)break;s.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;s.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;s.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return s}function U(e){return n.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(D,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function K(e,t,r,n){for(var i=0;i<n&&!(i+r>=t.length||i>=e.length);++i)t[i+r]=e[i];return i}function V(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function H(e){return e!=e}var F=function(){for(var e="0123456789abcdef",t=new Array(256),r=0;r<16;++r)for(var n=16*r,i=0;i<16;++i)t[n+i]=e[r]+e[i];return t}()}}},{package:"buffer",file:"/home/circleci/project/node_modules/buffer/index.js"}],[5979,{"./agent-base":5978,"./is-object":5980,"./request-base":5981,"./response-base":5982,"component-emitter":2224},function(){with(this)return function(){"use strict";return function(e,t,r){var n;"undefined"!=typeof window?n=window:"undefined"!=typeof self?n=self:(console.warn("Using browser-only version of superagent in non-browser environment"),n=this);var i=e("component-emitter"),s=e("./request-base"),o=e("./is-object"),a=e("./response-base"),c=e("./agent-base");function u(){}var l=r=t.exports=function(e,t){return"function"==typeof t?new r.Request("GET",e).end(t):1==arguments.length?new r.Request("GET",e):new r.Request(e,t)};r.Request=y,l.getXHR=function(){if(!(!n.XMLHttpRequest||n.location&&"file:"==n.location.protocol&&n.ActiveXObject))return new XMLHttpRequest;try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(e){}throw Error("Browser-only version of superagent could not find XHR")};var f="".trim?function(e){return e.trim()}:function(e){return e.replace(/(^\s*|\s*$)/g,"")};function d(e){if(!o(e))return e;var t=[];for(var r in e)h(t,r,e[r]);return t.join("&")}function h(e,t,r){if(null!=r)if(Array.isArray(r))r.forEach((function(r){h(e,t,r)}));else if(o(r))for(var n in r)h(e,t+"["+n+"]",r[n]);else e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));else null===r&&e.push(encodeURIComponent(t))}function p(e){for(var t,r,n={},i=e.split("&"),s=0,o=i.length;s<o;++s)-1==(r=(t=i[s]).indexOf("="))?n[decodeURIComponent(t)]="":n[decodeURIComponent(t.slice(0,r))]=decodeURIComponent(t.slice(r+1));return n}function m(e){return/[\/+]json($|[^-\w])/.test(e)}function g(e){this.req=e,this.xhr=this.req.xhr,this.text="HEAD"!=this.req.method&&(""===this.xhr.responseType||"text"===this.xhr.responseType)||void 0===this.xhr.responseType?this.xhr.responseText:null,this.statusText=this.req.xhr.statusText;var t=this.xhr.status;1223===t&&(t=204),this._setStatusProperties(t),this.header=this.headers=function(e){for(var t,r,n,i,s=e.split(/\r?\n/),o={},a=0,c=s.length;a<c;++a)-1!==(t=(r=s[a]).indexOf(":"))&&(n=r.slice(0,t).toLowerCase(),i=f(r.slice(t+1)),o[n]=i);return o}(this.xhr.getAllResponseHeaders()),this.header["content-type"]=this.xhr.getResponseHeader("content-type"),this._setHeaderProperties(this.header),null===this.text&&e._responseType?this.body=this.xhr.response:this.body="HEAD"!=this.req.method?this._parseBody(this.text?this.text:this.xhr.response):null}function y(e,t){var r=this;this._query=this._query||[],this.method=e,this.url=t,this.header={},this._header={},this.on("end",(function(){var e,t=null,n=null;try{n=new g(r)}catch(e){return(t=new Error("Parser is unable to parse the response")).parse=!0,t.original=e,r.xhr?(t.rawResponse=void 0===r.xhr.responseType?r.xhr.responseText:r.xhr.response,t.status=r.xhr.status?r.xhr.status:null,t.statusCode=t.status):(t.rawResponse=null,t.status=null),r.callback(t)}r.emit("response",n);try{r._isResponseOK(n)||(e=new Error(n.statusText||"Unsuccessful HTTP response"))}catch(t){e=t}e?(e.original=t,e.response=n,e.status=n.status,r.callback(e,n)):r.callback(null,n)}))}function b(e,t,r){var n=l("DELETE",e);return"function"==typeof t&&(r=t,t=null),t&&n.send(t),r&&n.end(r),n}l.serializeObject=d,l.parseString=p,l.types={html:"text/html",json:"application/json",xml:"text/xml",urlencoded:"application/x-www-form-urlencoded",form:"application/x-www-form-urlencoded","form-data":"application/x-www-form-urlencoded"},l.serialize={"application/x-www-form-urlencoded":d,"application/json":JSON.stringify},l.parse={"application/x-www-form-urlencoded":p,"application/json":JSON.parse},a(g.prototype),g.prototype._parseBody=function(e){var t=l.parse[this.type];return this.req._parser?this.req._parser(this,e):(!t&&m(this.type)&&(t=l.parse["application/json"]),t&&e&&(e.length||e instanceof Object)?t(e):null)},g.prototype.toError=function(){var e=this.req,t=e.method,r=e.url,n="cannot "+t+" "+r+" ("+this.status+")",i=new Error(n);return i.status=this.status,i.method=t,i.url=r,i},l.Response=g,i(y.prototype),s(y.prototype),y.prototype.type=function(e){return this.set("Content-Type",l.types[e]||e),this},y.prototype.accept=function(e){return this.set("Accept",l.types[e]||e),this},y.prototype.auth=function(e,t,r){1===arguments.length&&(t=""),"object"==typeof t&&null!==t&&(r=t,t=""),r||(r={type:"function"==typeof btoa?"basic":"auto"});var n=function(e){if("function"==typeof btoa)return btoa(e);throw new Error("Cannot use basic auth, btoa is not a function")};return this._auth(e,t,r,n)},y.prototype.query=function(e){return"string"!=typeof e&&(e=d(e)),e&&this._query.push(e),this},y.prototype.attach=function(e,t,r){if(t){if(this._data)throw Error("superagent can't mix .send() and .attach()");this._getFormData().append(e,t,r||t.name)}return this},y.prototype._getFormData=function(){return this._formData||(this._formData=new n.FormData),this._formData},y.prototype.callback=function(e,t){if(this._shouldRetry(e,t))return this._retry();var r=this._callback;this.clearTimeout(),e&&(this._maxRetries&&(e.retries=this._retries-1),this.emit("error",e)),r(e,t)},y.prototype.crossDomainError=function(){var e=new Error("Request has been terminated\nPossible causes: the network is offline, Origin is not allowed by Access-Control-Allow-Origin, the page is being unloaded, etc.");e.crossDomain=!0,e.status=this.status,e.method=this.method,e.url=this.url,this.callback(e)},y.prototype.buffer=y.prototype.ca=y.prototype.agent=function(){return console.warn("This is not supported in browser version of superagent"),this},y.prototype.pipe=y.prototype.write=function(){throw Error("Streaming is not supported in browser version of superagent")},y.prototype._isHost=function(e){return e&&"object"==typeof e&&!Array.isArray(e)&&"[object Object]"!==Object.prototype.toString.call(e)},y.prototype.end=function(e){return this._endCalled&&console.warn("Warning: .end() was called twice. This is not supported in superagent"),this._endCalled=!0,this._callback=e||u,this._finalizeQueryString(),this._end()},y.prototype._end=function(){var e=this,t=this.xhr=l.getXHR(),r=this._formData||this._data;this._setTimeouts(),t.onreadystatechange=function(){var r=t.readyState;if(r>=2&&e._responseTimeoutTimer&&clearTimeout(e._responseTimeoutTimer),4==r){var n;try{n=t.status}catch(e){n=0}if(!n){if(e.timedout||e._aborted)return;return e.crossDomainError()}e.emit("end")}};var n=function(t,r){r.total>0&&(r.percent=r.loaded/r.total*100),r.direction=t,e.emit("progress",r)};if(this.hasListeners("progress"))try{t.onprogress=n.bind(null,"download"),t.upload&&(t.upload.onprogress=n.bind(null,"upload"))}catch(e){}try{this.username&&this.password?t.open(this.method,this.url,!0,this.username,this.password):t.open(this.method,this.url,!0)}catch(e){return this.callback(e)}if(this._withCredentials&&(t.withCredentials=!0),!this._formData&&"GET"!=this.method&&"HEAD"!=this.method&&"string"!=typeof r&&!this._isHost(r)){var i=this._header["content-type"],s=this._serializer||l.serialize[i?i.split(";")[0]:""];!s&&m(i)&&(s=l.serialize["application/json"]),s&&(r=s(r))}for(var o in this.header)null!=this.header[o]&&this.header.hasOwnProperty(o)&&t.setRequestHeader(o,this.header[o]);return this._responseType&&(t.responseType=this._responseType),this.emit("request",this),t.send(void 0!==r?r:null),this},l.agent=function(){return new c},["GET","POST","OPTIONS","PATCH","PUT","DELETE"].forEach((function(e){c.prototype[e.toLowerCase()]=function(t,r){var n=new l.Request(e,t);return this._setDefaults(n),r&&n.end(r),n}})),c.prototype.del=c.prototype.delete,l.get=function(e,t,r){var n=l("GET",e);return"function"==typeof t&&(r=t,t=null),t&&n.query(t),r&&n.end(r),n},l.head=function(e,t,r){var n=l("HEAD",e);return"function"==typeof t&&(r=t,t=null),t&&n.query(t),r&&n.end(r),n},l.options=function(e,t,r){var n=l("OPTIONS",e);return"function"==typeof t&&(r=t,t=null),t&&n.send(t),r&&n.end(r),n},l.del=b,l.delete=b,l.patch=function(e,t,r){var n=l("PATCH",e);return"function"==typeof t&&(r=t,t=null),t&&n.send(t),r&&n.end(r),n},l.post=function(e,t,r){var n=l("POST",e);return"function"==typeof t&&(r=t,t=null),t&&n.send(t),r&&n.end(r),n},l.put=function(e,t,r){var n=l("PUT",e);return"function"==typeof t&&(r=t,t=null),t&&n.send(t),r&&n.end(r),n}}}},{package:"superagent",file:"/home/circleci/project/node_modules/superagent/lib/client.js"}],[4404,{"./constants":4401,"./index":4405,"./util":4406,"buffer/":2172,"hash.js/lib/hash/sha":4444,"js-sha3":4797},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.getEncodedPayload=r.parseGenericSigningResponse=r.buildGenericSigningMsgRequest=void 0;var n=e("buffer/"),i=e("js-sha3"),s=e("hash.js/lib/hash/sha"),o=e("./constants"),a=e("./index"),c=e("./util");r.buildGenericSigningMsgRequest=function(e){var t=e.signerPath,a=e.curveType,u=e.hashType,l=e.encodingType,f=void 0===l?null:l,d=e.omitPubkey,h=void 0!==d&&d,p=e.fwConstants,m=p.extraDataFrameSz,g=p.extraDataMaxFrames,y=p.prehashAllowed,b=p.genericSigning,v=p.varAddrPathSzAllowed,w=b.curveTypes,_=b.encodingTypes,E=b.hashTypes,k=b.baseDataSz,S=b.baseReqSz,A=(0,r.getEncodedPayload)(e.payload,f,_),T=A.encoding,I=A.payloadBuf;if(0===I.length)throw new Error("Payload could not be handled.");if(!(b&&m&&g&&y))throw new Error("Unsupported. Please update your Lattice firmware.");if(!(0,c.existsIn)(a,w))throw new Error("Unsupported curve type.");if(!(0,c.existsIn)(u,E))throw new Error("Unsupported hash type.");if(a===w.ED25519){if(u!==E.NONE)throw new Error("Signing on ed25519 requires unhashed message");t.forEach((function(e){if(e<o.HARDENED_OFFSET)throw new Error("Signing on ed25519 requires all signer path indices be hardened.")}))}var C=n.Buffer.alloc(S),x=0;C.writeUInt32LE(T,x),x+=4,C.writeUInt8(u,x),x+=1,C.writeUInt8(a,x),x+=1;var P=(0,c.buildSignerPathBuf)(t,v);P.copy(C,x),x+=P.length,C.writeUInt8(h?1:0,x),x+=1,C.writeUInt16LE(I.length,x),x+=2;var O=k+g*m,R=[],N=null;if(I.length>k)if(y&&I.length>O){if(u===E.NONE)throw new Error("Message too large to send and could not be prehashed (hashType=NONE).");if(u===E.KECCAK256)N=n.Buffer.from((0,i.keccak256)(I),"hex");else{if(u!==E.SHA256)throw new Error("Unsupported hash type.");N=n.Buffer.from((0,s.sha256)().update(I).digest("hex"),"hex")}}else{(0,c.splitFrames)(I.slice(k),m).forEach((function(e){var t=n.Buffer.alloc(4);t.writeUInt32LE(e.length,0),R.push(n.Buffer.concat([t,e]))}))}return(N||I).copy(C,x),{payload:C,extraDataPayloads:R,schema:o.signingSchema.GENERAL_SIGNING,curveType:a,omitPubkey:h}};r.parseGenericSigningResponse=function(e,t,r,i){var s={pubkey:null,sig:null};if(r===a.Constants.SIGNING.CURVES.SECP256K1){if(i)t+=65;else{var o=e.readUint8(t);if(t+=1,2===o||3===o)s.pubkey=n.Buffer.alloc(33),s.pubkey.writeUInt8(o,0),e.slice(t,t+32).copy(s.pubkey,1);else{if(4!==o)throw new Error("Bad compression byte in signing response.");s.pubkey=n.Buffer.alloc(65),s.pubkey.writeUInt8(o,0),e.slice(t).copy(s.pubkey,1)}t+=64}s.sig=(0,c.parseDER)(e.slice(t,t+2+e[t+1])),s.sig.r=(0,c.fixLen)(s.sig.r,32),s.sig.s=(0,c.fixLen)(s.sig.s,32)}else{if(r!==a.Constants.SIGNING.CURVES.ED25519)throw new Error("Unsupported curve.");i||(s.pubkey=n.Buffer.alloc(32),e.slice(t,t+32).copy(s.pubkey)),t+=32,s.sig={r:e.slice(t,t+32),s:e.slice(t+32,t+64)}}return s};r.getEncodedPayload=function(e,t,r){if(t||(t=a.Constants.SIGNING.ENCODINGS.NONE),!(0,c.existsIn)(t,r))throw new Error("Encoding not supported by Lattice firmware. You may want to update.");return{payloadBuf:"string"==typeof e&&"0x"===e.slice(0,2)?n.Buffer.from(e.slice(2),"hex"):n.Buffer.from(e),encoding:t}}}}},{package:"gridplus-sdk",file:"/home/circleci/project/node_modules/gridplus-sdk/dist/genericSigning.js"}],[2081,{"./bits":2050,"./buffer":2067,"./byte":2078,"./integer":2083,"./nibble":2086,"./string":2089},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.string=r.nibble=r.integer=r.byte=r.buffer=r.bits=void 0;var n=e("./bits");r.bits=n.default;var i=e("./buffer");r.buffer=i.default;var s=e("./byte");r.byte=s.default;var o=e("./integer");r.integer=o.default;var a=e("./nibble");r.nibble=a.default;var c=e("./string");r.string=c.default;var u={bits:n.default,buffer:i.default,byte:s.default,integer:o.default,nibble:a.default,string:c.default};r.default=u}}},{package:"bitwise",file:"/home/circleci/project/node_modules/bitwise/index.js"}],[4402,{"./constants":4401,"./util":4406,"@ethereumjs/common":401,"@ethereumjs/tx":405,"bignumber.js":4408,borc:2120,"buffer/":2172,"eth-eip712-util-browser":2440,"js-sha3":4797,rlp:4409,"rlp-browser":5814,secp256k1:5828},function(){with(this)return function(){"use strict";return function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){n===undefined&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){n===undefined&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0});var a=o(e("bignumber.js")),c=o(e("borc")),u=e("buffer/"),l=e("eth-eip712-util-browser"),f=e("js-sha3"),d=o(e("rlp-browser")),h=e("rlp"),p=o(e("secp256k1")),m=e("./constants"),g=e("./util"),y=s(e("@ethereumjs/common")),b=e("@ethereumjs/tx");function v(e){for(var t=e[0];e.length>0&&"0"===t.toString();)t=(e=e.slice(1))[0];return e}function w(e,t,r,n){void 0===n&&(n={});try{var i=new Uint8Array(e),s=0,o=(0,g.fixLen)(t.r,32);t.r=o;var a=(0,g.fixLen)(t.s,32);t.s=a;var c=new Uint8Array(u.Buffer.concat([o,a])),l=p.default.ecdsaRecover(c,s,i,!1).slice(1);if(_(l)===r.toString("hex"))return t.v=E(s,n),t;if(s=1,_(l=p.default.ecdsaRecover(c,s,i,!1).slice(1))===r.toString("hex"))return t.v=E(s,n),t;throw new Error("Invalid Ethereum signature returned.")}catch(e){throw new Error(e)}}function _(e){return(0,f.keccak256)(e).slice(-40)}function E(e,t){void 0===t&&(t={});var r=t.chainId,n=t.useEIP155,i=t.type;if(1===i||2===i)return(0,g.ensureHexBuffer)(e,!0);if(!1===n||null===r)return u.Buffer.from(new a.default(e).plus(27).toString(16),"hex");var s=S(r),o=new a.default(s.toString("hex"),16);return(0,g.ensureHexBuffer)("0x".concat(o.times(2).plus(35).plus(e).toString(16)))}var k={mainnet:1,roptsten:3,rinkeby:4,kovan:42,goerli:5};function S(e){var t,r;if((t=!0===A(e)?(0,g.ensureHexBuffer)(e):(0,g.ensureHexBuffer)("0x".concat(new a.default(e).toString(16)))).length>8)throw new Error("ChainID provided is too large.");return t.length<=2||4===t.length||8===t.length?t:(3===t.length?(r=u.Buffer.alloc(4)).writeUInt32BE(e):t.length<=8&&(r=u.Buffer.alloc(8),t.copy(r,8-t.length)),r)}function A(e){if("string"!=typeof e)return!1;if("0x"!==e.slice(0,2))return!1;try{return!1===new a.default(e,16).isNaN()}catch(e){return!1}}function T(e,t){var r=t.fwConstants,n=r.ethMaxMsgSz,i=r.extraDataFrameSz,s=r.extraDataMaxFrames,o=n,a=i>0&&s>0,c=[];if(e.length>o){var l=o+s*i;if(!a)throw new Error("Your message is ".concat(e.length," bytes, but can only be a maximum of ").concat(o));if(a&&e.length>l)throw new Error("Your message is ".concat(e.length," bytes, but can only be a maximum of ").concat(l));(0,g.splitFrames)(e.slice(o),i).forEach((function(e){var t=u.Buffer.alloc(4);t.writeUInt32LE(e.length,0),c.push(u.Buffer.concat([t,e]))}))}return c}function I(e,t,r,n){void 0===n&&(n=!1);try{r[t].forEach((function(t){var i=t.type.indexOf("[")>-1,s=i?t.type.slice(0,t.type.indexOf("[")):t.type,o=Object.keys(r).indexOf(s)>-1;if(o&&Array.isArray(e))for(var a=0;a<e.length;a++)e[a][t.name]=I(e[a][t.name],s,r,n);else if(o)e[t.name]=I(e[t.name],s,r,n);else if(Array.isArray(e))for(a=0;a<e.length;a++)if(i)for(var c=0;c<e[a][t.name].length;c++)e[a][t.name][c]=C(e[a][t.name][c],s,n);else e[a][t.name]=C(e[a][t.name],s,n);else if(i)for(a=0;a<e[t.name].length;a++)e[t.name][a]=C(e[t.name][a],s,n);else e[t.name]=C(e[t.name],s,n)}))}catch(e){throw new Error(e.message)}return e}function C(e,t,r){if(void 0===r&&(r=!1),"bytes"===t)e=(0,g.ensureHexBuffer)(e),r&&(e="0x".concat(e.toString("hex")));else if("bytes"===t.slice(0,5)){var n=parseInt(t.slice(5));if((e=(0,g.ensureHexBuffer)(e)).length!==n)throw new Error("Expected ".concat(t," type, but got ").concat(e.length," bytes"));r&&(e="0x".concat(e.toString("hex")))}else if("address"===t){if(0===(e=(0,g.ensureHexBuffer)(e)).length&&(e=u.Buffer.alloc(20)),20!==e.length)throw new Error("Address type must be 20 bytes, but got ".concat(e.length," bytes"));r&&(e="0x".concat(e.toString("hex")))}else if(m.ethMsgProtocol.TYPED_DATA.typeCodes[t]&&(t.indexOf("uint")>-1||t.indexOf("int")>-1)){var i=(0,g.ensureHexBuffer)(e);0===i.length&&(i=u.Buffer.from("00","hex")),e=r?"0x".concat(i.toString("hex")):(new c.default.Encoder).semanticTypes[1][0](i.toString("hex"),16)}else"bool"===t&&(e=!0===e?1:0);return e}function x(e){return u.Buffer.from("Ethereum Signed Message:\n".concat(e.toString()),"utf-8")}function P(e,t){return t?u.Buffer.concat([u.Buffer.from([t]),d.default.encode(e)]):d.default.encode(e)}r.default={buildEthereumMsgRequest:function(e){if(!e.payload||!e.protocol||!e.signerPath)throw new Error("You must provide `payload`, `signerPath`, and `protocol` arguments in the messsage request");if(e.signerPath.length>5||e.signerPath.length<2)throw new Error("Please provide a signer path with 2-5 indices");var t={schema:m.signingSchema.ETH_MSG,payload:null,input:e,msg:null};try{switch(e.protocol){case"signPersonal":return function(e,t){var r=t.fwConstants.ethMaxMsgSz,n=t.fwConstants.varAddrPathSzAllowed,i=24+r+4,s=0;e.payload=u.Buffer.alloc(i),e.payload.writeUInt8(m.ethMsgProtocol.SIGN_PERSONAL,0),s+=1;var o=(0,g.buildSignerPathBuf)(t.signerPath,n);o.copy(e.payload,s),s+=o.length;var a=t.payload,c=!1;if("string"==typeof t.payload)if("0x"===t.payload.slice(0,2))a=(0,g.ensureHexBuffer)(t.payload),c=!1===m.ASCII_REGEX.test(u.Buffer.from(t.payload.slice(2),"hex").toString());else{if(!1===(0,g.isAsciiStr)(t.payload))throw new Error("Currently, the Lattice can only display ASCII strings.");a=u.Buffer.from(t.payload)}else if("boolean"==typeof t.displayHex)c=t.displayHex;else{if(!t.payload.toString)throw new Error("Unsupported input data type");c=!1===m.ASCII_REGEX.test(t.payload.toString())}var l=t.fwConstants,d=r+l.extraDataMaxFrames*l.extraDataFrameSz;l.personalSignHeaderSz&&(d-=l.personalSignHeaderSz);if(l.ethMsgPreHashAllowed&&a.length>d){e.payload.writeUInt8(c,s),s+=1,e.payload.writeUInt16LE(a.length,s),s+=2;var h=u.Buffer.from((0,f.keccak256)(u.Buffer.concat([x(a.length),a])),"hex");h.copy(e.payload,s),e.prehash=h}else{var p=T(a,t);e.extraDataPayloads=p,e.msg=a,e.payload.writeUInt8(c,s),s+=1,e.payload.writeUInt16LE(a.length,s),s+=2,a.copy(e.payload,s)}return e}(t,e);case"eip712":if(!e.fwConstants.eip712Supported)throw new Error("EIP712 is not supported by your Lattice firmware version. Please upgrade.");return function(e,t){try{var r=t.fwConstants,n=r.ethMaxMsgSz,i=r.varAddrPathSzAllowed,s=r.eip712MaxTypeParams,o=m.ethMsgProtocol.TYPED_DATA,a=24+n+4,f=0;e.payload=u.Buffer.alloc(a),e.payload.writeUInt8(o.enumIdx,0),f+=1;var d=(0,g.buildSignerPathBuf)(t.signerPath,i);d.copy(e.payload,f),f+=d.length;var h=JSON.parse(JSON.stringify(t.payload));if(!h.primaryType||!h.types[h.primaryType])throw new Error("primaryType must be specified and the type must be included.");if(!h.message||!h.domain)throw new Error("message and domain must be specified.");if(0>Object.keys(h.types).indexOf("EIP712Domain"))throw new Error("EIP712Domain type must be defined.");t.payload.message=I(JSON.parse(JSON.stringify(h.message)),JSON.parse(JSON.stringify(h.primaryType)),JSON.parse(JSON.stringify(h.types)),!0),t.payload.domain=I(JSON.parse(JSON.stringify(h.domain)),"EIP712Domain",JSON.parse(JSON.stringify(h.types)),!0),h.domain=I(h.domain,"EIP712Domain",h.types,!1),h.message=I(h.message,h.primaryType,h.types,!1);var p=u.Buffer.from(c.default.encode(h)),y=t.fwConstants,b=n+y.extraDataMaxFrames*y.extraDataFrameSz,v=p.length>b;if(Object.keys(h.types).forEach((function(e){h.types[e].length>s&&(v=!0)})),y.ethMsgPreHashAllowed&&v){e.payload.writeUInt16LE(p.length,f),f+=2;var w=l.TypedDataUtils.hash(e.input.payload);w.copy(e.payload,f),e.prehash=w}else{var _=T(p,t);e.extraDataPayloads=_,e.payload.writeUInt16LE(p.length,f),f+=2,p.copy(e.payload,f),f+=p.length,e.payload=e.payload.slice(0,f)}return e}catch(e){return{err:"Failed to build EIP712 request: ".concat(e.message)}}}(t,e);default:throw new Error("Unsupported protocol")}}catch(e){return{err:e.toString()}}},validateEthereumMsgResponse:function(e,t){var r=e.signer,n=e.sig,i=t.input,s=t.msg,o=t.prehash,a=void 0===o?null:o;if("signPersonal"===i.protocol)return w(a||u.Buffer.from((0,f.keccak256)(u.Buffer.concat([x(s.length),s])),"hex"),n,r,{chainId:1,useEIP155:!1});if("eip712"===i.protocol){var c=l.TypedDataUtils.hash(t.input.payload);return w(a||c,n,r,{useEIP155:!1})}throw new Error("Unsupported protocol")},buildEthereumTxRequest:function(e){try{var t=e.chainId,r=void 0===t?1:t,n=e.signerPath,i=e.eip155,s=void 0===i?null:i,o=e.fwConstants,a=e.type,c=void 0===a?null:a,l=o.contractDeployKey,d=o.extraDataFrameSz,h=o.extraDataMaxFrames,p=o.prehashAllowed,y=d>0&&h>0,b=o.ethMaxDataSz,v=o.varAddrPathSzAllowed;if("number"!=typeof r&&!1===A(r)&&(r=k[r]),!r)throw new Error("Unsupported chain ID or name");if(!n)throw new Error("`signerPath` not provided");if(null===e.to&&!l)throw new Error("Contract deployment not supported. Please update your Lattice firmware.");var w=null===e.to&&l,_=o.allowedEthTxTypes&&o.allowedEthTxTypes.indexOf(2)>-1,E=o.allowedEthTxTypes&&o.allowedEthTxTypes.indexOf(1)>-1,T=_&&(2===c||"eip1559"===c),I=E&&(1===c||"eip2930"===c);if(null!==c&&!T&&!I)throw new Error("Unsupported Ethereum transaction type");var C=function(e){switch(e){case 3:case 4:return!1;default:return!0}}(r);null!==s&&"boolean"==typeof s?C=s:(T||I)&&(C=!1),e.value||(e.value=0);var x=[],O=(0,g.ensureHexBuffer)(r),R=(0,g.ensureHexBuffer)(e.nonce),N=void 0,M=(0,g.ensureHexBuffer)(e.gasLimit),j=void 0,L=void 0;w?(j=u.Buffer.alloc(0),L=(0,g.ensureHexBuffer)(l)):(j=(0,g.ensureHexBuffer)(e.to),L=(0,g.ensureHexBuffer)(e.to));var D=(0,g.ensureHexBuffer)(e.value),B=(0,g.ensureHexBuffer)(e.data);(T||I)&&x.push(O),x.push(R);var U=void 0,K=void 0;if(T){if(!e.maxPriorityFeePerGas)throw new Error("EIP1559 transactions must include `maxPriorityFeePerGas`");U=(0,g.ensureHexBuffer)(e.maxPriorityFeePerGas),x.push(U),K=(0,g.ensureHexBuffer)(e.maxFeePerGas),x.push(K),N=K}else N=(0,g.ensureHexBuffer)(e.gasPrice),x.push(N);x.push(M),x.push(j),x.push(D),x.push(B);var V=!1;if(T||I){var H=[];Array.isArray(e.accessList)&&e.accessList.forEach((function(e){var t=[];e.storageKeys.forEach((function(e){t.push((0,g.ensureHexBuffer)(e))})),H.push([(0,g.ensureHexBuffer)(e.address),t]),V=!0})),x.push(H)}else!0===C&&(x.push(O),x.push((0,g.ensureHexBuffer)(null)),x.push((0,g.ensureHexBuffer)(null)));var F=u.Buffer.alloc(b+122),G=0;F.writeUInt8(Number(C),G),G++;var q=void 0,z=0;if(!0==(1!==(re=S(r)).length||255===re.readUInt8(0))){if((z=(q=S(r)).length)>m.MAX_CHAIN_ID_BYTES)throw new Error("ChainID provided is too large.");F.writeUInt8(m.HANDLE_LARGER_CHAIN_ID,G),G++}else{if(1!==(q=(0,g.ensureHexBuffer)(r)).length)throw new Error("Error parsing chainID");q.copy(F,G),G+=q.length}var Y=(0,g.buildSignerPathBuf)(n,v);if(Y.copy(F,G),G+=Y.length,R.length>4)throw new Error("Nonce too large");if(R.copy(F,G+(4-R.length)),G+=4,N.length>8)throw new Error("Gas price too large");if(N.copy(F,G+(8-N.length)),G+=8,M.length>4)throw new Error("Gas limit too large");if(M.copy(F,G+(4-M.length)),G+=4,20!==L.length)throw new Error("Invalid `to` address");if(L.copy(F,G),G+=20,D.length>32)throw new Error("Value too large");D.copy(F,G+(32-D.length)),G+=32;var W=!1;if(o.allowedEthTxTypes)if(V&&(W=!0),F.writeUInt8(W?1:0,G),G+=1,T){if(F.writeUInt8(2,G),G+=1,U.length>8)throw new Error("maxPriorityFeePerGasBytes too large");U.copy(F,G+(8-U.length)),G+=8}else I?(F.writeUInt8(1,G),G+=1,G+=8):G+=9;var $=[],J=null,Z=B.length||0,X=z>0?z+1:0,Q=u.Buffer.alloc(Z+X);if(X>0&&(Q.writeUInt8(z,0),q.copy(Q,1)),B.copy(Q,X),Z>b){var ee=Z+X,te=b+h*d;if(p&&ee>te)J=u.Buffer.from((0,f.keccak256)(P(x,c)),"hex");else{if(!y||y&&ee>te)throw new Error("Data field too large (got ".concat(B.length,"; must be <=").concat(te-X," bytes)"));(0,g.splitFrames)(Q.slice(b),d).forEach((function(e){var t=u.Buffer.alloc(4);t.writeUInt32LE(e.length,0),$.push(u.Buffer.concat([t,e]))}))}}else W&&(J=u.Buffer.from((0,f.keccak256)(P(x,c)),"hex"));return F.writeUInt16BE(B.length,G),G+=2,z>0&&(F.writeUInt8(z,G),G++,q.copy(F,G),G+=z),J?(J.copy(F,G),G+=b):(B.slice(0,b).copy(F,G),G+=b),{rawTx:x,type:c,payload:F.slice(0,G),extraDataPayloads:$,schema:m.signingSchema.ETH_TRANSFER,chainId:r,useEIP155:C,signerPath:n}}catch(e){return{err:e.message}}var re},buildEthRawTx:function(e,t,r){var n=w(u.Buffer.from((0,f.keccak256)(P(e.rawTx,e.type)),"hex"),t,r,e),i=e.useEIP155?e.rawTx.slice(0,-3):e.rawTx;i.push(n.v),i.push(v(n.r)),i.push(v(n.s));var s=d.default.encode(i);return e.type&&(s=u.Buffer.concat([u.Buffer.from([e.type]),s])),{rawTx:s.toString("hex"),sigWithV:n}},hashTransaction:function(e){return(0,f.keccak256)(u.Buffer.from(e,"hex"))},chainIds:k,ensureHexBuffer:g.ensureHexBuffer,ethConvertLegacyToGenericReq:function(e){var t;t=e.chainId&&"01"!==(0,g.ensureHexBuffer)(e.chainId).toString("hex")?y.default.custom({chainId:e.chainId},{hardfork:y.Hardfork.London,eips:[1559,2930]}):new y.default({chain:y.Chain.Mainnet,hardfork:y.Hardfork.London});var r=b.TransactionFactory.fromTxData(e,{common:t});return e.type?r.getMessageToSign(!1):u.Buffer.from((0,h.encode)(r.getMessageToSign(!1)))}}}}},{package:"gridplus-sdk",file:"/home/circleci/project/node_modules/gridplus-sdk/dist/ethereum.js"}],[4399,{"./constants":4401,bech32:4407,bs58check:2166,"buffer/":2172,"hash.js/lib/hash/ripemd":4443,"hash.js/lib/hash/sha":4444},function(){with(this)return function(){"use strict";return function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0});var i=e("bech32"),s=n(e("bs58check")),o=e("buffer/"),a=e("hash.js/lib/hash/ripemd"),c=e("hash.js/lib/hash/sha"),u=e("./constants"),l=o.Buffer.from("01","hex"),f=u.BIP_CONSTANTS.PURPOSES,d=u.BIP_CONSTANTS.COINS,h=0,p=169,m=118,g=135,y=136,b=172,v=208,w=240;function _(e,t){return o.Buffer.concat([e,t])}function E(e){var t=o.Buffer.alloc(4);return t.writeUInt32LE(e,0),t}function k(e){var t;return e<253?(t=o.Buffer.alloc(1)).writeUInt8(e,0):e<=65535?((t=o.Buffer.alloc(3)).writeUInt8(253,0),t.writeUInt16LE(e,1)):e<4294967295?((t=o.Buffer.alloc(5)).writeUInt8(254,0),t.writeUInt32LE(e,1)):((t=o.Buffer.alloc(9)).writeUInt8(255,0),t.writeUInt32LE(e>>>0,1),t.writeUInt32LE(e/4294967296|0,5)),t}function S(e,t,r){"number"==typeof e&&(e=e.toString(16));var n=o.Buffer.alloc(8),i=e.length%2==0?e.toString(16):"0".concat(e.toString(16));return o.Buffer.from(i,"hex").reverse().copy(n,0),n.copy(t,r),n}function A(e){var t,r;try{t=s.default.decode(e)[0],r=s.default.decode(e).slice(1)}catch(s){try{var n=i.bech32.decode(e);if("bc"===n.prefix)t=v;else{if("tb"!==n.prefix)throw new Error("Unsupported prefix: must be bc or tb.");t=w}if(0!==n.words[0])throw new Error("Unsupported segwit version: must be 0, got ".concat(n.words[0]));r=o.Buffer.from(i.bech32.fromWords(n.words.slice(1)))}catch(t){throw new Error("Unable to decode address: ".concat(e,": ").concat(t.message))}}return{versionByte:t,pkh:r}}function T(e){if(e.length<2)throw new Error("Path must be >1 index");var t=e[0],r=e[1];if(t===f.BTC_SEGWIT&&r===d.BTC)return v;if(t===f.BTC_SEGWIT&&r===d.BTC_TESTNET)return w;if(t===f.BTC_WRAPPED_SEGWIT&&r===d.BTC)return 5;if(t===f.BTC_WRAPPED_SEGWIT&&r===d.BTC_TESTNET)return 196;if(t===f.BTC_LEGACY&&r===d.BTC)return 0;if(t===f.BTC_LEGACY&&r===d.BTC_TESTNET)return 111;throw new Error("Invalid Bitcoin path provided. Cannot determine address format.")}function I(e){switch(e.signerPath[0]){case f.BTC_LEGACY:return 1;case f.BTC_WRAPPED_SEGWIT:return 3;case f.BTC_SEGWIT:return 4;default:throw new Error("Unsupported path purpose (".concat(e.signerPath[0],"): cannot determine BTC script type."))}}r.default={buildBitcoinTxRequest:function(e){try{var t=e.prevOuts,r=e.recipient,n=e.value,i=e.changePath,s=e.fee;if(!i)throw new Error("No changePath provided.");if(5!==i.length)throw new Error("Please provide a full change path.");var a=o.Buffer.alloc(59+69*t.length),c=0,l=T(i);a.writeUInt8(l,0),c++,a.writeUInt32LE(i.length,c),c+=4;for(var f=0;f<i.length;f++)a.writeUInt32LE(i[f],c),c+=4;a.writeUInt32LE(s,c),c+=4;var d=A(r);a.writeUInt8(d.versionByte,c),c++,d.pkh.copy(a,c),c+=d.pkh.length,S(n,a,c),c+=8,a.writeUInt8(t.length,c),c++;var h=0;return t.forEach((function(e){if(!e.signerPath||5!==e.signerPath.length)throw new Error("Full recipient path not specified ");a.writeUInt32LE(e.signerPath.length,c),c+=4;for(var t=0;t<e.signerPath.length;t++)a.writeUInt32LE(e.signerPath[t],c),c+=4;a.writeUInt32LE(e.index,c),c+=4,S(e.value,a,c),c+=8,h+=e.value;var r=I(e);a.writeUInt8(r,c),c++,o.Buffer.isBuffer(e.txHash)||(e.txHash=o.Buffer.from(e.txHash,"hex")),e.txHash.copy(a,c),c+=e.txHash.length})),{payload:a,schema:u.signingSchema.BTC_TRANSFER,origData:e,changeData:{value:h-(n+s)}}}catch(e){return{err:e}}},serializeTx:function(e){var t=e.inputs,r=e.outputs,n=e.lockTime,i=void 0===n?0:n,s=o.Buffer.alloc(4),u=0,d=function(e){var t=!1;return e.forEach((function(e){e.signerPath[0]!==f.BTC_SEGWIT&&e.signerPath[0]!==f.BTC_WRAPPED_SEGWIT||(t=!0)})),t}(t);s.writeUInt32LE(2,u),u+=4,d&&(s=_(s,o.Buffer.from("00","hex")),s=_(s,o.Buffer.from("01","hex")));var T=k(t.length);s=_(s,T),u+=T.length,t.forEach((function(e){s=_(s,e.hash.reverse()),u+=e.hash.length;var t=E(e.index);s=_(s,t),u+=t.length;var r=I(e);if(3===r){var n=function(e){var t=o.Buffer.alloc(22),r=o.Buffer.from((0,c.sha256)().update(e).digest("hex"),"hex"),n=o.Buffer.from((0,a.ripemd160)().update(r).digest("hex"),"hex");return t.writeUInt8(h,0),t.writeUInt8(n.length,1),n.copy(t,2),t}(e.pubkey),i=k(n.length),f=k((d=o.Buffer.concat([i,n])).length);s=_(s,f),u+=f.length,s=_(s,d),u+=d.length}else if(1===r){var d=function(e,t){var r=k((e=o.Buffer.concat([e,l])).length),n=k(t.length),i=o.Buffer.concat([r,e,n,t]),s=k(i.length);return o.Buffer.concat([s,i])}(e.sig,e.pubkey);s=_(s,d),u+=d.length}else if(4===r){var p=o.Buffer.from("00","hex");s=_(s,p),u+=1}var m=E(4294967295);s=_(s,m),u+=m.length}));var C=k(r.length);if(s=_(s,C),u+=C.length,r.forEach((function(e){var t,r,n=(t=e.value,r=o.Buffer.alloc(8),S(t,r,0),r);s=_(s,n),u+=n.length;var i=function(e){var t=A(e);switch(t.versionByte){case v:case w:return r=t.pkh,(n=o.Buffer.alloc(2+r.length)).writeUInt8(h,0),n.writeUInt8(r.length,1),r.copy(n,2),n;case 5:case 196:return function(e){var t=o.Buffer.alloc(3+e.length),r=0;return t.writeUInt8(p,r),r++,t.writeUInt8(e.length,r),r++,e.copy(t,r),r+=e.length,t.writeUInt8(g,r),r++,t}(t.pkh);case 0:case 111:return function(e){var t=o.Buffer.alloc(5+e.length),r=0;return t.writeUInt8(m,r),r++,t.writeUInt8(p,r),r++,t.writeUInt8(e.length,r),r++,e.copy(t,r),r+=e.length,t.writeUInt8(y,r),r++,t.writeUInt8(b,r),r++,t}(t.pkh);default:throw new Error("Unknown version byte: ".concat(t.versionByte,". Cannot build BTC transaction."))}var r,n}(e.recipient),a=k(i.length);s=_(s,a),u+=a.length,s=_(s,i),u+=i.length})),d){for(var x=[],P=[],O=0;O<t.length;O++)x.push(t[O].sig),P.push(t[O].pubkey);var R=function(e,t){var r=o.Buffer.alloc(0),n=o.Buffer.alloc(1);n.writeUInt8(2,0);for(var i=0;i<e.length;i++){var s=o.Buffer.concat([e[i],l]),a=k(s.length),c=t[i],u=k(c.length);r=o.Buffer.concat([r,n,a,s,u,c])}return r}(x,P);s=_(s,R),u+=R.length}return o.Buffer.concat([s,E(i)]).toString("hex")},getBitcoinAddress:function(e,t){var r=null,n=null;if(t===v?(r="bc",n=0):t===w&&(r="tb",n=0),null!==r&&null!==n){var a=i.bech32.toWords(e);return a.unshift(n),i.bech32.encode(r,a)}return s.default.encode(o.Buffer.concat([o.Buffer.from([t]),e]))},getAddressFormat:T}}}},{package:"gridplus-sdk",file:"/home/circleci/project/node_modules/gridplus-sdk/dist/bitcoin.js"}],[2560,{"../messages.json":2562,"bn.js":2113,"create-hash":2261,elliptic:2391,"safe-buffer":5817},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("safe-buffer").Buffer,i=e("create-hash"),s=e("bn.js"),o=e("elliptic").ec,a=e("../messages.json"),c=new o("secp256k1"),u=c.curve;function l(e){var t=e[0];switch(t){case 2:case 3:return 33!==e.length?null:function(e,t){var r=new s(t);if(r.cmp(u.p)>=0)return null;var n=(r=r.toRed(u.red)).redSqr().redIMul(r).redIAdd(u.b).redSqrt();return 3===e!==n.isOdd()&&(n=n.redNeg()),c.keyPair({pub:{x:r,y:n}})}(t,e.slice(1,33));case 4:case 6:case 7:return 65!==e.length?null:function(e,t,r){var n=new s(t),i=new s(r);if(n.cmp(u.p)>=0||i.cmp(u.p)>=0)return null;if(n=n.toRed(u.red),i=i.toRed(u.red),(6===e||7===e)&&i.isOdd()!==(7===e))return null;var o=n.redSqr().redIMul(n);return i.redSqr().redISub(o.redIAdd(u.b)).isZero()?c.keyPair({pub:{x:n,y:i}}):null}(t,e.slice(1,33),e.slice(33,65));default:return null}}r.privateKeyVerify=function(e){var t=new s(e);return t.cmp(u.n)<0&&!t.isZero()},r.privateKeyExport=function(e,t){var r=new s(e);if(r.cmp(u.n)>=0||r.isZero())throw new Error(a.EC_PRIVATE_KEY_EXPORT_DER_FAIL);return n.from(c.keyFromPrivate(e).getPublic(t,!0))},r.privateKeyNegate=function(e){var t=new s(e);return t.isZero()?n.alloc(32):u.n.sub(t).umod(u.n).toArrayLike(n,"be",32)},r.privateKeyModInverse=function(e){var t=new s(e);if(t.cmp(u.n)>=0||t.isZero())throw new Error(a.EC_PRIVATE_KEY_RANGE_INVALID);return t.invm(u.n).toArrayLike(n,"be",32)},r.privateKeyTweakAdd=function(e,t){var r=new s(t);if(r.cmp(u.n)>=0)throw new Error(a.EC_PRIVATE_KEY_TWEAK_ADD_FAIL);if(r.iadd(new s(e)),r.cmp(u.n)>=0&&r.isub(u.n),r.isZero())throw new Error(a.EC_PRIVATE_KEY_TWEAK_ADD_FAIL);return r.toArrayLike(n,"be",32)},r.privateKeyTweakMul=function(e,t){var r=new s(t);if(r.cmp(u.n)>=0||r.isZero())throw new Error(a.EC_PRIVATE_KEY_TWEAK_MUL_FAIL);return r.imul(new s(e)),r.cmp(u.n)&&(r=r.umod(u.n)),r.toArrayLike(n,"be",32)},r.publicKeyCreate=function(e,t){var r=new s(e);if(r.cmp(u.n)>=0||r.isZero())throw new Error(a.EC_PUBLIC_KEY_CREATE_FAIL);return n.from(c.keyFromPrivate(e).getPublic(t,!0))},r.publicKeyConvert=function(e,t){var r=l(e);if(null===r)throw new Error(a.EC_PUBLIC_KEY_PARSE_FAIL);return n.from(r.getPublic(t,!0))},r.publicKeyVerify=function(e){return null!==l(e)},r.publicKeyTweakAdd=function(e,t,r){var i=l(e);if(null===i)throw new Error(a.EC_PUBLIC_KEY_PARSE_FAIL);if((t=new s(t)).cmp(u.n)>=0)throw new Error(a.EC_PUBLIC_KEY_TWEAK_ADD_FAIL);var o=u.g.mul(t).add(i.pub);if(o.isInfinity())throw new Error(a.EC_PUBLIC_KEY_TWEAK_ADD_FAIL);return n.from(o.encode(!0,r))},r.publicKeyTweakMul=function(e,t,r){var i=l(e);if(null===i)throw new Error(a.EC_PUBLIC_KEY_PARSE_FAIL);if((t=new s(t)).cmp(u.n)>=0||t.isZero())throw new Error(a.EC_PUBLIC_KEY_TWEAK_MUL_FAIL);return n.from(i.pub.mul(t).encode(!0,r))},r.publicKeyCombine=function(e,t){for(var r=new Array(e.length),i=0;i<e.length;++i)if(r[i]=l(e[i]),null===r[i])throw new Error(a.EC_PUBLIC_KEY_PARSE_FAIL);for(var s=r[0].pub,o=1;o<r.length;++o)s=s.add(r[o].pub);if(s.isInfinity())throw new Error(a.EC_PUBLIC_KEY_COMBINE_FAIL);return n.from(s.encode(!0,t))},r.signatureNormalize=function(e){var t=new s(e.slice(0,32)),r=new s(e.slice(32,64));if(t.cmp(u.n)>=0||r.cmp(u.n)>=0)throw new Error(a.ECDSA_SIGNATURE_PARSE_FAIL);var i=n.from(e);return 1===r.cmp(c.nh)&&u.n.sub(r).toArrayLike(n,"be",32).copy(i,32),i},r.signatureExport=function(e){var t=e.slice(0,32),r=e.slice(32,64);if(new s(t).cmp(u.n)>=0||new s(r).cmp(u.n)>=0)throw new Error(a.ECDSA_SIGNATURE_PARSE_FAIL);return{r:t,s:r}},r.signatureImport=function(e){var t=new s(e.r);t.cmp(u.n)>=0&&(t=new s(0));var r=new s(e.s);return r.cmp(u.n)>=0&&(r=new s(0)),n.concat([t.toArrayLike(n,"be",32),r.toArrayLike(n,"be",32)])},r.sign=function(e,t,r,i){if("function"==typeof r){var o=r;r=function(r){var c=o(e,t,null,i,r);if(!n.isBuffer(c)||32!==c.length)throw new Error(a.ECDSA_SIGN_FAIL);return new s(c)}}var l=new s(t);if(l.cmp(u.n)>=0||l.isZero())throw new Error(a.ECDSA_SIGN_FAIL);var f=c.sign(e,t,{canonical:!0,k:r,pers:i});return{signature:n.concat([f.r.toArrayLike(n,"be",32),f.s.toArrayLike(n,"be",32)]),recovery:f.recoveryParam}},r.verify=function(e,t,r){var n={r:t.slice(0,32),s:t.slice(32,64)},i=new s(n.r),o=new s(n.s);if(i.cmp(u.n)>=0||o.cmp(u.n)>=0)throw new Error(a.ECDSA_SIGNATURE_PARSE_FAIL);if(1===o.cmp(c.nh)||i.isZero()||o.isZero())return!1;var f=l(r);if(null===f)throw new Error(a.EC_PUBLIC_KEY_PARSE_FAIL);return c.verify(e,n,{x:f.pub.x,y:f.pub.y})},r.recover=function(e,t,r,i){var o={r:t.slice(0,32),s:t.slice(32,64)},l=new s(o.r),f=new s(o.s);if(l.cmp(u.n)>=0||f.cmp(u.n)>=0)throw new Error(a.ECDSA_SIGNATURE_PARSE_FAIL);try{if(l.isZero()||f.isZero())throw new Error;var d=c.recoverPubKey(e,o,r);return n.from(d.encode(!0,i))}catch(e){throw new Error(a.ECDSA_RECOVER_FAIL)}},r.ecdh=function(e,t){var n=r.ecdhUnsafe(e,t,!0);return i("sha256").update(n).digest()},r.ecdhUnsafe=function(e,t,r){var i=l(e);if(null===i)throw new Error(a.EC_PUBLIC_KEY_PARSE_FAIL);var o=new s(t);if(o.cmp(u.n)>=0||o.isZero())throw new Error(a.ECDH_FAIL);return n.from(i.pub.mul(o).encode(!0,r))}}}},{package:"secp256k1",file:"/home/circleci/project/node_modules/eth-trezor-keyring/node_modules/secp256k1/lib/elliptic/index.js"}],[2561,{"./assert":2558,"./der":2559,"./messages.json":2562},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("./assert"),i=e("./der"),s=e("./messages.json");function o(e,t){return e===undefined?t:(n.isBoolean(e,s.COMPRESSED_TYPE_INVALID),e)}t.exports=function(e){return{privateKeyVerify:function(t){return n.isBuffer(t,s.EC_PRIVATE_KEY_TYPE_INVALID),32===t.length&&e.privateKeyVerify(t)},privateKeyExport:function(t,r){n.isBuffer(t,s.EC_PRIVATE_KEY_TYPE_INVALID),n.isBufferLength(t,32,s.EC_PRIVATE_KEY_LENGTH_INVALID),r=o(r,!0);var a=e.privateKeyExport(t,r);return i.privateKeyExport(t,a,r)},privateKeyImport:function(t){if(n.isBuffer(t,s.EC_PRIVATE_KEY_TYPE_INVALID),(t=i.privateKeyImport(t))&&32===t.length&&e.privateKeyVerify(t))return t;throw new Error(s.EC_PRIVATE_KEY_IMPORT_DER_FAIL)},privateKeyNegate:function(t){return n.isBuffer(t,s.EC_PRIVATE_KEY_TYPE_INVALID),n.isBufferLength(t,32,s.EC_PRIVATE_KEY_LENGTH_INVALID),e.privateKeyNegate(t)},privateKeyModInverse:function(t){return n.isBuffer(t,s.EC_PRIVATE_KEY_TYPE_INVALID),n.isBufferLength(t,32,s.EC_PRIVATE_KEY_LENGTH_INVALID),e.privateKeyModInverse(t)},privateKeyTweakAdd:function(t,r){return n.isBuffer(t,s.EC_PRIVATE_KEY_TYPE_INVALID),n.isBufferLength(t,32,s.EC_PRIVATE_KEY_LENGTH_INVALID),n.isBuffer(r,s.TWEAK_TYPE_INVALID),n.isBufferLength(r,32,s.TWEAK_LENGTH_INVALID),e.privateKeyTweakAdd(t,r)},privateKeyTweakMul:function(t,r){return n.isBuffer(t,s.EC_PRIVATE_KEY_TYPE_INVALID),n.isBufferLength(t,32,s.EC_PRIVATE_KEY_LENGTH_INVALID),n.isBuffer(r,s.TWEAK_TYPE_INVALID),n.isBufferLength(r,32,s.TWEAK_LENGTH_INVALID),e.privateKeyTweakMul(t,r)},publicKeyCreate:function(t,r){return n.isBuffer(t,s.EC_PRIVATE_KEY_TYPE_INVALID),n.isBufferLength(t,32,s.EC_PRIVATE_KEY_LENGTH_INVALID),r=o(r,!0),e.publicKeyCreate(t,r)},publicKeyConvert:function(t,r){return n.isBuffer(t,s.EC_PUBLIC_KEY_TYPE_INVALID),n.isBufferLength2(t,33,65,s.EC_PUBLIC_KEY_LENGTH_INVALID),r=o(r,!0),e.publicKeyConvert(t,r)},publicKeyVerify:function(t){return n.isBuffer(t,s.EC_PUBLIC_KEY_TYPE_INVALID),e.publicKeyVerify(t)},publicKeyTweakAdd:function(t,r,i){return n.isBuffer(t,s.EC_PUBLIC_KEY_TYPE_INVALID),n.isBufferLength2(t,33,65,s.EC_PUBLIC_KEY_LENGTH_INVALID),n.isBuffer(r,s.TWEAK_TYPE_INVALID),n.isBufferLength(r,32,s.TWEAK_LENGTH_INVALID),i=o(i,!0),e.publicKeyTweakAdd(t,r,i)},publicKeyTweakMul:function(t,r,i){return n.isBuffer(t,s.EC_PUBLIC_KEY_TYPE_INVALID),n.isBufferLength2(t,33,65,s.EC_PUBLIC_KEY_LENGTH_INVALID),n.isBuffer(r,s.TWEAK_TYPE_INVALID),n.isBufferLength(r,32,s.TWEAK_LENGTH_INVALID),i=o(i,!0),e.publicKeyTweakMul(t,r,i)},publicKeyCombine:function(t,r){n.isArray(t,s.EC_PUBLIC_KEYS_TYPE_INVALID),n.isLengthGTZero(t,s.EC_PUBLIC_KEYS_LENGTH_INVALID);for(var i=0;i<t.length;++i)n.isBuffer(t[i],s.EC_PUBLIC_KEY_TYPE_INVALID),n.isBufferLength2(t[i],33,65,s.EC_PUBLIC_KEY_LENGTH_INVALID);return r=o(r,!0),e.publicKeyCombine(t,r)},signatureNormalize:function(t){return n.isBuffer(t,s.ECDSA_SIGNATURE_TYPE_INVALID),n.isBufferLength(t,64,s.ECDSA_SIGNATURE_LENGTH_INVALID),e.signatureNormalize(t)},signatureExport:function(t){n.isBuffer(t,s.ECDSA_SIGNATURE_TYPE_INVALID),n.isBufferLength(t,64,s.ECDSA_SIGNATURE_LENGTH_INVALID);var r=e.signatureExport(t);return i.signatureExport(r)},signatureImport:function(t){n.isBuffer(t,s.ECDSA_SIGNATURE_TYPE_INVALID),n.isLengthGTZero(t,s.ECDSA_SIGNATURE_LENGTH_INVALID);var r=i.signatureImport(t);if(r)return e.signatureImport(r);throw new Error(s.ECDSA_SIGNATURE_PARSE_DER_FAIL)},signatureImportLax:function(t){n.isBuffer(t,s.ECDSA_SIGNATURE_TYPE_INVALID),n.isLengthGTZero(t,s.ECDSA_SIGNATURE_LENGTH_INVALID);var r=i.signatureImportLax(t);if(r)return e.signatureImport(r);throw new Error(s.ECDSA_SIGNATURE_PARSE_DER_FAIL)},sign:function(t,r,i){n.isBuffer(t,s.MSG32_TYPE_INVALID),n.isBufferLength(t,32,s.MSG32_LENGTH_INVALID),n.isBuffer(r,s.EC_PRIVATE_KEY_TYPE_INVALID),n.isBufferLength(r,32,s.EC_PRIVATE_KEY_LENGTH_INVALID);var o=null,a=null;return i!==undefined&&(n.isObject(i,s.OPTIONS_TYPE_INVALID),i.data!==undefined&&(n.isBuffer(i.data,s.OPTIONS_DATA_TYPE_INVALID),n.isBufferLength(i.data,32,s.OPTIONS_DATA_LENGTH_INVALID),o=i.data),i.noncefn!==undefined&&(n.isFunction(i.noncefn,s.OPTIONS_NONCEFN_TYPE_INVALID),a=i.noncefn)),e.sign(t,r,a,o)},verify:function(t,r,i){return n.isBuffer(t,s.MSG32_TYPE_INVALID),n.isBufferLength(t,32,s.MSG32_LENGTH_INVALID),n.isBuffer(r,s.ECDSA_SIGNATURE_TYPE_INVALID),n.isBufferLength(r,64,s.ECDSA_SIGNATURE_LENGTH_INVALID),n.isBuffer(i,s.EC_PUBLIC_KEY_TYPE_INVALID),n.isBufferLength2(i,33,65,s.EC_PUBLIC_KEY_LENGTH_INVALID),e.verify(t,r,i)},recover:function(t,r,i,a){return n.isBuffer(t,s.MSG32_TYPE_INVALID),n.isBufferLength(t,32,s.MSG32_LENGTH_INVALID),n.isBuffer(r,s.ECDSA_SIGNATURE_TYPE_INVALID),n.isBufferLength(r,64,s.ECDSA_SIGNATURE_LENGTH_INVALID),n.isNumber(i,s.RECOVERY_ID_TYPE_INVALID),n.isNumberInInterval(i,-1,4,s.RECOVERY_ID_VALUE_INVALID),a=o(a,!0),e.recover(t,r,i,a)},ecdh:function(t,r){return n.isBuffer(t,s.EC_PUBLIC_KEY_TYPE_INVALID),n.isBufferLength2(t,33,65,s.EC_PUBLIC_KEY_LENGTH_INVALID),n.isBuffer(r,s.EC_PRIVATE_KEY_TYPE_INVALID),n.isBufferLength(r,32,s.EC_PRIVATE_KEY_LENGTH_INVALID),e.ecdh(t,r)},ecdhUnsafe:function(t,r,i){return n.isBuffer(t,s.EC_PUBLIC_KEY_TYPE_INVALID),n.isBufferLength2(t,33,65,s.EC_PUBLIC_KEY_LENGTH_INVALID),n.isBuffer(r,s.EC_PRIVATE_KEY_TYPE_INVALID),n.isBufferLength(r,32,s.EC_PRIVATE_KEY_LENGTH_INVALID),i=o(i,!0),e.ecdhUnsafe(t,r,i)}}}}}},{package:"secp256k1",file:"/home/circleci/project/node_modules/eth-trezor-keyring/node_modules/secp256k1/lib/index.js"}],[6042,{},function(){with(this)return function(){"use strict";return function(e,t,r){}}},{package:"trezor-connect",file:"/home/circleci/project/node_modules/trezor-connect/lib/types/account.js"}],[6048,{},function(){with(this)return function(){"use strict";return function(e,t,r){}}},{package:"trezor-connect",file:"/home/circleci/project/node_modules/trezor-connect/lib/types/misc.js"}],[6059,{},function(){with(this)return function(){"use strict";return function(e,t,r){}}},{package:"trezor-connect",file:"/home/circleci/project/node_modules/trezor-connect/lib/types/params.js"}],[6061,{},function(){with(this)return function(){"use strict";return function(e,t,r){}}},{package:"trezor-connect",file:"/home/circleci/project/node_modules/trezor-connect/lib/types/trezor/management.js"}],[6050,{},function(){with(this)return function(){"use strict";return function(e,t,r){}}},{package:"trezor-connect",file:"/home/circleci/project/node_modules/trezor-connect/lib/types/networks/bitcoin.js"}],[6049,{},function(){with(this)return function(){"use strict";return function(e,t,r){}}},{package:"trezor-connect",file:"/home/circleci/project/node_modules/trezor-connect/lib/types/networks/binance.js"}],[6052,{},function(){with(this)return function(){"use strict";return function(e,t,r){}}},{package:"trezor-connect",file:"/home/circleci/project/node_modules/trezor-connect/lib/types/networks/coinInfo.js"}],[6053,{},function(){with(this)return function(){"use strict";return function(e,t,r){}}},{package:"trezor-connect",file:"/home/circleci/project/node_modules/trezor-connect/lib/types/networks/eos.js"}],[6054,{},function(){with(this)return function(){"use strict";return function(e,t,r){}}},{package:"trezor-connect",file:"/home/circleci/project/node_modules/trezor-connect/lib/types/networks/ethereum.js"}],[6055,{},function(){with(this)return function(){"use strict";return function(e,t,r){}}},{package:"trezor-connect",file:"/home/circleci/project/node_modules/trezor-connect/lib/types/networks/nem.js"}],[6056,{},function(){with(this)return function(){"use strict";return function(e,t,r){}}},{package:"trezor-connect",file:"/home/circleci/project/node_modules/trezor-connect/lib/types/networks/ripple.js"}],[6057,{},function(){with(this)return function(){"use strict";return function(e,t,r){}}},{package:"trezor-connect",file:"/home/circleci/project/node_modules/trezor-connect/lib/types/networks/stellar.js"}],[6058,{},function(){with(this)return function(){"use strict";return function(e,t,r){}}},{package:"trezor-connect",file:"/home/circleci/project/node_modules/trezor-connect/lib/types/networks/tezos.js"}],[6045,{},function(){with(this)return function(){"use strict";return function(e,t,r){}}},{package:"trezor-connect",file:"/home/circleci/project/node_modules/trezor-connect/lib/types/backend/transactions.js"}],[6051,{"../trezor/protobuf":6062},function(){with(this)return function(){"use strict";return function(e,t,r){r.__esModule=!0,r.CardanoTxWitnessType=r.CardanoTxSigningMode=r.CardanoPoolRelayType=r.CardanoNativeScriptHashDisplayFormat=r.CardanoNativeScriptType=r.CardanoCertificateType=r.CardanoAddressType=void 0;var n=e("../trezor/protobuf");r.CardanoAddressType=n.Enum_CardanoAddressType,r.CardanoCertificateType=n.Enum_CardanoCertificateType,r.CardanoNativeScriptType=n.Enum_CardanoNativeScriptType,r.CardanoNativeScriptHashDisplayFormat=n.Enum_CardanoNativeScriptHashDisplayFormat,r.CardanoPoolRelayType=n.Enum_CardanoPoolRelayType,r.CardanoTxSigningMode=n.Enum_CardanoTxSigningMode,r.CardanoTxWitnessType=n.Enum_CardanoTxWitnessType}}},{package:"trezor-connect",file:"/home/circleci/project/node_modules/trezor-connect/lib/types/networks/cardano.js"}],[6043,{"../constants":6026,"./account":6042,"./backend/blockchain":6044,"./events":6046,"./misc":6048,"./networks/binance":6049,"./networks/bitcoin":6050,"./networks/cardano":6051,"./networks/coinInfo":6052,"./networks/eos":6053,"./networks/ethereum":6054,"./networks/nem":6055,"./networks/ripple":6056,"./networks/stellar":6057,"./networks/tezos":6058,"./params":6059,"./trezor/device":6060,"./trezor/management":6061,"./trezor/protobuf":6062},function(){with(this)return function(){"use strict";return function(e,t,r){i(e("../constants")),i(e("./params")),i(e("./trezor/device")),i(e("./trezor/management")),i(e("./trezor/protobuf")),i(e("./account")),i(e("./networks/bitcoin")),i(e("./networks/binance")),i(e("./networks/cardano")),i(e("./networks/coinInfo")),i(e("./networks/eos")),i(e("./networks/ethereum")),i(e("./networks/nem")),i(e("./networks/ripple")),i(e("./networks/stellar")),i(e("./networks/tezos")),i(e("./misc")),i(e("./events")),i(e("./backend/blockchain"));function n(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(n=function(e){return e?r:t})(e)}function i(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=n(t);if(r&&r.has(e))return r.get(e);var i={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var a=s?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(i,o,a):i[o]=e[o]}return i.default=e,r&&r.set(e,i),i}}}},{package:"trezor-connect",file:"/home/circleci/project/node_modules/trezor-connect/lib/types/api.js"}],[6046,{"../constants":6026},function(){with(this)return function(){"use strict";return function(e,t,r){e("../constants")}}},{package:"trezor-connect",file:"/home/circleci/project/node_modules/trezor-connect/lib/types/events.js"}],[6060,{"../../constants":6026},function(){with(this)return function(){"use strict";return function(e,t,r){e("../../constants")}}},{package:"trezor-connect",file:"/home/circleci/project/node_modules/trezor-connect/lib/types/trezor/device.js"}],[6044,{"../../constants":6026},function(){with(this)return function(){"use strict";return function(e,t,r){e("../../constants")}}},{package:"trezor-connect",file:"/home/circleci/project/node_modules/trezor-connect/lib/types/backend/blockchain.js"}],[6027,{},function(){with(this)return function(){"use strict";return function(e,t,r){r.__esModule=!0,r.TYPES=void 0;var n=Object.freeze({bitcoin:"Bitcoin",ethereum:"Ethereum",eos:"Eos",nem:"NEM",stellar:"Stellar",cardano:"Cardano",ripple:"Ripple",tezos:"Tezors",binance:"Binance"});r.TYPES=n}}},{package:"trezor-connect",file:"/home/circleci/project/node_modules/trezor-connect/lib/constants/network.js"}],[6028,{},function(){with(this)return function(){"use strict";return function(e,t,r){r.__esModule=!0,r.CLOSE_WINDOW=r.CANCEL_POPUP_REQUEST=r.CLOSED=r.HANDSHAKE=r.EXTENSION_USB_PERMISSIONS=r.ERROR=r.INIT=r.LOADED=r.BOOTSTRAP=void 0;r.BOOTSTRAP="popup-bootstrap";r.LOADED="popup-loaded";r.INIT="popup-init";r.ERROR="popup-error";r.EXTENSION_USB_PERMISSIONS="open-usb-permissions";r.HANDSHAKE="popup-handshake";r.CLOSED="popup-closed";r.CANCEL_POPUP_REQUEST="ui-cancel-popup-request";r.CLOSE_WINDOW="window.close"}}},{package:"trezor-connect",file:"/home/circleci/project/node_modules/trezor-connect/lib/constants/popup.js"}],[6021,{},function(){with(this)return function(){"use strict";return function(e,t,r){r.__esModule=!0,r.FIAT_RATES_UPDATE=r.NOTIFICATION=r.BLOCK=r.CONNECT=r.ERROR=void 0;r.ERROR="blockchain-error";r.CONNECT="blockchain-connect";r.BLOCK="blockchain-block";r.NOTIFICATION="blockchain-notification";r.FIAT_RATES_UPDATE="fiat-rates-update"}}},{package:"trezor-connect",file:"/home/circleci/project/node_modules/trezor-connect/lib/constants/blockchain.js"}],[6030,{},function(){with(this)return function(){"use strict";return function(e,t,r){r.__esModule=!0,r.IFRAME_FAILURE=r.ADDRESS_VALIDATION=r.BUNDLE_PROGRESS=r.LOGIN_CHALLENGE_RESPONSE=r.LOGIN_CHALLENGE_REQUEST=r.CUSTOM_MESSAGE_RESPONSE=r.CUSTOM_MESSAGE_REQUEST=r.CHANGE_SETTINGS=r.RECEIVE_WORD=r.RECEIVE_FEE=r.RECEIVE_ACCOUNT=r.CHANGE_ACCOUNT=r.RECEIVE_DEVICE=r.RECEIVE_PASSPHRASE=r.RECEIVE_PIN=r.RECEIVE_CONFIRMATION=r.RECEIVE_PERMISSION=r.REQUEST_WORD=r.REQUEST_BUTTON=r.INSUFFICIENT_FUNDS=r.UPDATE_CUSTOM_FEE=r.SELECT_FEE=r.SELECT_ACCOUNT=r.SELECT_DEVICE=r.SET_OPERATION=r.LOADING=r.CONNECT=r.INVALID_PASSPHRASE_ACTION=r.INVALID_PASSPHRASE=r.REQUEST_PASSPHRASE_ON_DEVICE=r.REQUEST_PASSPHRASE=r.INVALID_PIN=r.REQUEST_PIN=r.REQUEST_CONFIRMATION=r.REQUEST_PERMISSION=r.CLOSE_UI_WINDOW=r.REQUEST_UI_WINDOW=r.DEVICE_NEEDS_BACKUP=r.FIRMWARE_PROGRESS=r.FIRMWARE_NOT_INSTALLED=r.FIRMWARE_NOT_COMPATIBLE=r.FIRMWARE_NOT_SUPPORTED=r.FIRMWARE_OUTDATED=r.FIRMWARE_OLD=r.SEEDLESS=r.INITIALIZE=r.REQUIRE_MODE=r.NOT_IN_BOOTLOADER=r.BOOTLOADER=r.TRANSPORT=void 0;r.TRANSPORT="ui-no_transport";r.BOOTLOADER="ui-device_bootloader_mode";r.NOT_IN_BOOTLOADER="ui-device_not_in_bootloader_mode";r.REQUIRE_MODE="ui-device_require_mode";r.INITIALIZE="ui-device_not_initialized";r.SEEDLESS="ui-device_seedless";r.FIRMWARE_OLD="ui-device_firmware_old";r.FIRMWARE_OUTDATED="ui-device_firmware_outdated";r.FIRMWARE_NOT_SUPPORTED="ui-device_firmware_unsupported";r.FIRMWARE_NOT_COMPATIBLE="ui-device_firmware_not_compatible";r.FIRMWARE_NOT_INSTALLED="ui-device_firmware_not_installed";r.FIRMWARE_PROGRESS="ui-firmware-progress";r.DEVICE_NEEDS_BACKUP="ui-device_needs_backup";r.REQUEST_UI_WINDOW="ui-request_window";r.CLOSE_UI_WINDOW="ui-close_window";r.REQUEST_PERMISSION="ui-request_permission";r.REQUEST_CONFIRMATION="ui-request_confirmation";r.REQUEST_PIN="ui-request_pin";r.INVALID_PIN="ui-invalid_pin";r.REQUEST_PASSPHRASE="ui-request_passphrase";r.REQUEST_PASSPHRASE_ON_DEVICE="ui-request_passphrase_on_device";r.INVALID_PASSPHRASE="ui-invalid_passphrase";r.INVALID_PASSPHRASE_ACTION="ui-invalid_passphrase_action";r.CONNECT="ui-connect";r.LOADING="ui-loading";r.SET_OPERATION="ui-set_operation";r.SELECT_DEVICE="ui-select_device";r.SELECT_ACCOUNT="ui-select_account";r.SELECT_FEE="ui-select_fee";r.UPDATE_CUSTOM_FEE="ui-update_custom_fee";r.INSUFFICIENT_FUNDS="ui-insufficient_funds";r.REQUEST_BUTTON="ui-button";r.REQUEST_WORD="ui-request_word";r.RECEIVE_PERMISSION="ui-receive_permission";r.RECEIVE_CONFIRMATION="ui-receive_confirmation";r.RECEIVE_PIN="ui-receive_pin";r.RECEIVE_PASSPHRASE="ui-receive_passphrase";r.RECEIVE_DEVICE="ui-receive_device";r.CHANGE_ACCOUNT="ui-change_account";r.RECEIVE_ACCOUNT="ui-receive_account";r.RECEIVE_FEE="ui-receive_fee";r.RECEIVE_WORD="ui-receive_word";r.CHANGE_SETTINGS="ui-change_settings";r.CUSTOM_MESSAGE_REQUEST="ui-custom_request";r.CUSTOM_MESSAGE_RESPONSE="ui-custom_response";r.LOGIN_CHALLENGE_REQUEST="ui-login_challenge_request";r.LOGIN_CHALLENGE_RESPONSE="ui-login_challenge_response";r.BUNDLE_PROGRESS="ui-bundle_progress";r.ADDRESS_VALIDATION="ui-address_validation";r.IFRAME_FAILURE="ui-iframe_failure"}}},{package:"trezor-connect",file:"/home/circleci/project/node_modules/trezor-connect/lib/constants/ui.js"}],[6029,{},function(){with(this)return function(){"use strict";return function(e,t,r){r.__esModule=!0,r.START_PENDING=r.DISABLE_WEBUSB=r.REQUEST=r.STREAM=r.UPDATE=r.ERROR=r.START=void 0;r.START="transport-start";r.ERROR="transport-error";r.UPDATE="transport-update";r.STREAM="transport-stream";r.REQUEST="transport-request_device";r.DISABLE_WEBUSB="transport-disable_webusb";r.START_PENDING="transport-start_pending"}}},{package:"trezor-connect",file:"/home/circleci/project/node_modules/trezor-connect/lib/constants/transport.js"}],[6023,{},function(){with(this)return function(){"use strict";return function(e,t,r){r.__esModule=!0,r.WAIT_FOR_SELECTION=r.WORD=r.PASSPHRASE_ON_DEVICE=r.PASSPHRASE=r.PIN=r.BUTTON=r.LOADING=r.USED_ELSEWHERE=r.RELEASED=r.ACQUIRED=r.RELEASE=r.ACQUIRE=r.CHANGED=r.DISCONNECT=r.CONNECT_UNACQUIRED=r.CONNECT=void 0;r.CONNECT="device-connect";r.CONNECT_UNACQUIRED="device-connect_unacquired";r.DISCONNECT="device-disconnect";r.CHANGED="device-changed";r.ACQUIRE="device-acquire";r.RELEASE="device-release";r.ACQUIRED="device-acquired";r.RELEASED="device-released";r.USED_ELSEWHERE="device-used_elsewhere";r.LOADING="device-loading";r.BUTTON="button";r.PIN="pin";r.PASSPHRASE="passphrase";r.PASSPHRASE_ON_DEVICE="passphrase_on_device";r.WORD="word";r.WAIT_FOR_SELECTION="device-wait_for_selection"}}},{package:"trezor-connect",file:"/home/circleci/project/node_modules/trezor-connect/lib/constants/device.js"}],[6022,{},function(){with(this)return function(){"use strict";return function(e,t,r){r.__esModule=!0,r.POOL_RELAY_TYPE=r.CERTIFICATE_TYPE=r.ADDRESS_TYPE=r.NETWORK_IDS=r.PROTOCOL_MAGICS=void 0;var n=Object.freeze({mainnet:764824073,testnet:42});r.PROTOCOL_MAGICS=n;var i=Object.freeze({mainnet:1,testnet:0});r.NETWORK_IDS=i;var s=Object.freeze({Base:0,Pointer:4,Enterprise:6,Byron:8,Reward:14});r.ADDRESS_TYPE=s;var o=Object.freeze({StakeRegistration:0,StakeDeregistration:1,StakeDelegation:2,StakePoolRegistration:3});r.CERTIFICATE_TYPE=o;var a=Object.freeze({SingleHostIp:0,SingleHostName:1,MultipleHostName:2});r.POOL_RELAY_TYPE=a}}},{package:"trezor-connect",file:"/home/circleci/project/node_modules/trezor-connect/lib/constants/cardano.js"}],[6025,{},function(){with(this)return function(){"use strict";return function(e,t,r){r.__esModule=!0,r.CALL=r.ERROR=r.INIT=r.LOADED=r.BOOTSTRAP=void 0;r.BOOTSTRAP="iframe-bootstrap";r.LOADED="iframe-loaded";r.INIT="iframe-init";r.ERROR="iframe-error";r.CALL="iframe-call"}}},{package:"trezor-connect",file:"/home/circleci/project/node_modules/trezor-connect/lib/constants/iframe.js"}],[6024,{"@babel/runtime/helpers/inheritsLoose":194,"@babel/runtime/helpers/interopRequireDefault":195,"@babel/runtime/helpers/wrapNativeSuper":214},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault");r.__esModule=!0,r.LIBUSB_ERROR_MESSAGE=r.WEBUSB_ERROR_MESSAGE=r.INVALID_PIN_ERROR_MESSAGE=r.WRONG_PREVIOUS_SESSION_ERROR_MESSAGE=r.TypedError=r.TrezorError=r.ERROR_CODES=void 0;var i=n(e("@babel/runtime/helpers/inheritsLoose")),s=n(e("@babel/runtime/helpers/wrapNativeSuper")),o={Init_NotInitialized:"TrezorConnect not yet initialized",Init_AlreadyInitialized:"TrezorConnect has been already initialized",Init_IframeBlocked:"Iframe blocked",Init_IframeTimeout:"Iframe timeout",Init_ManifestMissing:"Manifest not set. Read more at https://github.com/trezor/connect/blob/develop/docs/index.md",Popup_ConnectionMissing:"Unable to establish connection with iframe",Transport_Missing:"Transport is missing",Transport_InvalidProtobuf:"",Method_InvalidPackage:"This version of trezor-connect is not suitable to work without browser. Use trezor-connect@extended package instead",Method_InvalidParameter:"",Method_NotAllowed:"Method not allowed for this configuration",Method_PermissionsNotGranted:"Permissions not granted",Method_Cancel:"Cancelled",Method_Interrupted:"Popup closed",Method_UnknownCoin:"Coin not found",Method_AddressNotMatch:"Addresses do not match",Method_FirmwareUpdate_DownloadFailed:"Failed to download firmware binary",Method_CustomMessage_Callback:'Parameter "callback" is not a function',Method_Discovery_BundleException:"",Method_Override:"override",Method_NoResponse:"Call resolved without response",Backend_NotSupported:"BlockchainLink settings not found in coins.json",Backend_WorkerMissing:"",Backend_Disconnected:"Backend disconnected",Backend_Invalid:"Invalid backend",Backend_Error:"",Runtime:"",Device_NotFound:"Device not found",Device_InitializeFailed:"",Device_FwException:"",Device_ModeException:"",Device_Disconnected:"Device disconnected",Device_UsedElsewhere:"Device is used in another window",Device_InvalidState:"Passphrase is incorrect",Device_CallInProgress:"Device call in progress"};r.ERROR_CODES=o;var a=function(e){function t(t,r){var n;return(n=e.call(this,r)||this).code=t,n.message=r,n}return(0,i.default)(t,e),t}((0,s.default)(Error));r.TrezorError=a;r.TypedError=function(e,t){return new a(e,t||o[e])};r.WRONG_PREVIOUS_SESSION_ERROR_MESSAGE="wrong previous session";r.INVALID_PIN_ERROR_MESSAGE="PIN invalid";r.WEBUSB_ERROR_MESSAGE="NetworkError: Unable to claim interface.";r.LIBUSB_ERROR_MESSAGE="LIBUSB_ERROR"}}},{package:"trezor-connect",file:"/home/circleci/project/node_modules/trezor-connect/lib/constants/errors.js"}],[6063,{},function(){with(this)return function(){"use strict";return function(e,t,r){r.__esModule=!0,r.getLog=r.enableLogByPrefix=r.enableLog=r.initLog=void 0;var n={DescriptorStream:"color: #77ab59",DeviceList:"color: #36802d",Device:"color: #bada55",Core:"color: #c9df8a",IFrame:"color: #FFFFFF; background: #f4a742;",Popup:"color: #f48a00"},i=function(){function e(e,t){this.prefix=e,this.enabled=t,this.messages=[],this.css=n[e]||"color: #000000; background: #FFFFFF;"}var t=e.prototype;return t.addMessage=function(e,t){for(var r=arguments.length,n=new Array(r>2?r-2:0),i=2;i<r;i++)n[i-2]=arguments[i];this.messages.push({level:e,prefix:t,message:n,timestamp:(new Date).getTime()}),this.messages.length>100&&this.messages.shift()},t.log=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n;(this.addMessage.apply(this,["log",this.prefix].concat(t)),this.enabled)&&(n=console).log.apply(n,[this.prefix].concat(t))},t.error=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n;(this.addMessage.apply(this,["error",this.prefix].concat(t)),this.enabled)&&(n=console).error.apply(n,[this.prefix].concat(t))},t.warn=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n;(this.addMessage.apply(this,["warn",this.prefix].concat(t)),this.enabled)&&(n=console).warn.apply(n,[this.prefix].concat(t))},t.debug=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n;(this.addMessage.apply(this,["debug",this.prefix].concat(t)),this.enabled)&&(n=console).log.apply(n,["%c"+this.prefix,this.css].concat(t))},e}(),s={};r.initLog=function(e,t){var r=new i(e,!!t);return s[e]=r,r};r.enableLog=function(e){Object.keys(s).forEach((function(t){s[t].enabled=e}))};r.enableLogByPrefix=function(e,t){s[e]&&(s[e].enabled=t)};r.getLog=function(){var e=[];return Object.keys(s).forEach((function(t){e=e.concat(s[t].messages)})),e.sort((function(e,t){return e.timestamp-t.timestamp})),e}}}},{package:"trezor-connect",file:"/home/circleci/project/node_modules/trezor-connect/lib/utils/debug.js"}],[6065,{},function(){with(this)return function(){"use strict";return function(e,t,r){r.__esModule=!0,r.default=void 0;var n=function(e,t,r){var n=e||".trezor-webusb-button",i=document.querySelectorAll(n),s=t+"?"+Date.now();i.forEach((function(e){if(e.getElementsByTagName("iframe").length<1){var t=e.getBoundingClientRect(),n=document.createElement("iframe");n.frameBorder="0",n.width=Math.round(t.width)+"px",n.height=Math.round(t.height)+"px",n.style.position="absolute",n.style.top="0px",n.style.left="0px",n.style.zIndex="1",n.setAttribute("allow","usb"),n.setAttribute("scrolling","no"),n.onload=function(){n.contentWindow.postMessage({},r)},n.src=s,e.append(n)}}))};r.default=n}}},{package:"trezor-connect",file:"/home/circleci/project/node_modules/trezor-connect/lib/webusb/button.js"}],[6038,{},function(){with(this)return function(){"use strict";return function(e,t,r){r.__esModule=!0,r.errorMessage=r.parseMessage=void 0;r.parseMessage=function(e){var t={event:e.event,type:e.type,payload:e.payload};return"number"==typeof e.id&&(t.id=e.id),"boolean"==typeof e.success&&(t.success=e.success),t};r.errorMessage=function(e){return{success:!1,payload:{error:e.message,code:e.code}}}}}},{package:"trezor-connect",file:"/home/circleci/project/node_modules/trezor-connect/lib/message/index.js"}],[6034,{"../constants":6026,"../env/browser/networkUtils":6033,"../utils/deferred":6064,"./inline-styles":6035,"@babel/runtime/helpers/asyncToGenerator":185,"@babel/runtime/helpers/interopRequireDefault":195,"@babel/runtime/regenerator":215},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault");r.__esModule=!0,r.clearTimeout=r.dispose=r.postMessage=r.init=r.messagePromises=r.error=r.timeout=r.initPromise=r.origin=r.instance=void 0;var i,s,o=n(e("@babel/runtime/regenerator")),a=n(e("@babel/runtime/helpers/asyncToGenerator")),c=e("../utils/deferred"),u=e("../constants"),l=e("../env/browser/networkUtils"),f=n(e("./inline-styles"));r.instance=i,r.origin=s;var d=(0,c.create)();r.initPromise=d;var h,p=0;r.timeout=p,r.error=h;var m=0,g={};r.messagePromises=g;var y=function(){var e=(0,a.default)(o.default.mark((function e(t){var n,a,f,h,m;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.initPromise=d=(0,c.create)(),(n=document.getElementById("trezorconnect"))?r.instance=i=n:(r.instance=i=document.createElement("iframe"),i.frameBorder="0",i.width="0px",i.height="0px",i.style.position="absolute",i.style.display="none",i.style.border="0px",i.style.width="0px",i.style.height="0px",i.id="trezorconnect"),"web"===t.env?(f=t.manifest?JSON.stringify(t.manifest):"undefined",h="version="+t.version+"&manifest="+encodeURIComponent(btoa(JSON.stringify(f))),a=t.iframeSrc+"?"+h):a=t.iframeSrc,i.setAttribute("src",a),t.webusb&&i.setAttribute("allow","usb"),r.origin=s=(0,l.getOrigin)(i.src),r.timeout=p=window.setTimeout((function(){d.reject(u.ERRORS.TypedError("Init_IframeTimeout"))}),1e4),m=function(){if(i){try{var e=i.contentWindow.location.origin;if(!e||"null"===e)return void v()}catch(e){}var r;"undefined"!=typeof chrome&&chrome.runtime&&void 0!==chrome.runtime.onConnect&&(chrome.runtime.onConnect.addListener((function(){})),r=chrome.runtime.id),i.contentWindow.postMessage({type:u.IFRAME.INIT,payload:{settings:t,extension:r}},s),i.onload=undefined}else d.reject(u.ERRORS.TypedError("Init_IframeBlocked"))},i.attachEvent?i.attachEvent("onload",m):i.onload=m,document.body&&(document.body.appendChild(i),b()),e.prev=11,e.next=14,d.promise;case 14:e.next=20;break;case 16:throw e.prev=16,e.t0=e.catch(11),i&&(i.parentNode&&i.parentNode.removeChild(i),r.instance=i=null),e.t0;case 20:return e.prev=20,window.clearTimeout(p),r.timeout=p=0,e.finish(20);case 24:case"end":return e.stop()}}),e,null,[[11,16,20,24]])})));return function(t){return e.apply(this,arguments)}}();r.init=y;var b=function(){if(!i)throw u.ERRORS.TypedError("Init_IframeBlocked");var e=i.ownerDocument,t=e.head||e.getElementsByTagName("head")[0],r=document.createElement("style");r.setAttribute("type","text/css"),r.setAttribute("id","TrezorConnectStylesheet"),r.styleSheet?(r.styleSheet.cssText=f.default,t.appendChild(r)):(r.appendChild(document.createTextNode(f.default)),t.append(r))},v=function(){window.clearTimeout(p),r.error=h=u.ERRORS.TypedError("Init_IframeBlocked"),w(),d.reject(h)};r.postMessage=function(e,t){if(void 0===t&&(t=!0),!i)throw u.ERRORS.TypedError("Init_IframeBlocked");if(t){m++,e.id=m,g[m]=(0,c.create)();var r=g[m].promise;return i.contentWindow.postMessage(e,s),r}return i.contentWindow.postMessage(e,s),null};var w=function(){if(i&&i.parentNode)try{i.parentNode.removeChild(i)}catch(e){}r.instance=i=null,r.timeout=p=0};r.dispose=w;r.clearTimeout=function(){window.clearTimeout(p)}}}},{package:"trezor-connect",file:"/home/circleci/project/node_modules/trezor-connect/lib/iframe/builder.js"}],[6037,{"../constants":6026,"@babel/runtime/helpers/defineProperty":189,"@babel/runtime/helpers/interopRequireDefault":195},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault");r.__esModule=!0,r.BlockchainMessage=r.ResponseMessage=r.TransportMessage=r.DeviceMessage=r.UiMessage=void 0;var i=n(e("@babel/runtime/helpers/defineProperty")),s=e("../constants");function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function a(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){(0,i.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}r.UiMessage=function(e,t){return{event:s.UI_EVENT,type:e,payload:t}};r.DeviceMessage=function(e,t){return{event:s.DEVICE_EVENT,type:e,payload:t}};r.TransportMessage=function(e,t){return{event:s.TRANSPORT_EVENT,type:e,payload:t.error?a(a({},t),{},{error:t.error.message,code:t.error.code}):t}};r.ResponseMessage=function(e,t,r){return void 0===r&&(r=null),{event:s.RESPONSE_EVENT,type:s.RESPONSE_EVENT,id:e,success:t,payload:t?r:{error:r.error.message,code:r.error.code}}};r.BlockchainMessage=function(e,t){return{event:s.BLOCKCHAIN_EVENT,type:e,payload:t}}}}},{package:"trezor-connect",file:"/home/circleci/project/node_modules/trezor-connect/lib/message/builder.js"}],[6031,{"@babel/runtime/helpers/defineProperty":189,"@babel/runtime/helpers/interopRequireDefault":195},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault");r.__esModule=!0,r.parse=r.corsValidator=r.getEnv=r.DEFAULT_PRIORITY=void 0;var i=n(e("@babel/runtime/helpers/defineProperty"));function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}var o="8.2.6",a="https://connect.trezor.io/"+(o.split(".").map((function(e){return parseInt(e,10)}))[0]+"/");r.DEFAULT_PRIORITY=2;var c={configSrc:"./data/config.json",version:o,debug:!1,priority:2,trustedHost:!1,connectSrc:a,iframeSrc:a+"iframe.html",popup:!0,popupSrc:a+"popup.html",webusbSrc:a+"webusb.html",transportReconnect:!1,webusb:!0,pendingTransportEvent:!0,supportedBrowser:"undefined"==typeof navigator||!/Trident|MSIE|Edge/.test(navigator.userAgent),manifest:null,env:"web",lazyLoad:!1,timestamp:(new Date).getTime(),interactionTimeout:600},u=function(){if("undefined"!=typeof chrome&&chrome.runtime&&void 0!==chrome.runtime.onConnect)return"webextension";if("undefined"!=typeof navigator){if("string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase())return"react-native";if(navigator.userAgent.toLowerCase().indexOf(" electron/")>-1)return"electron"}return"web"};r.getEnv=u;var l=function(e){if("string"==typeof e)return e.match(/^https:\/\/([A-Za-z0-9\-_]+\.)*trezor\.io\//)||e.match(/^https?:\/\/localhost:[58][0-9]{3}\//)||e.match(/^https:\/\/([A-Za-z0-9\-_]+\.)*sldev\.cz\//)||e.match(/^https?:\/\/([A-Za-z0-9\-_]+\.)*trezoriovpjcahpzkrewelclulmszwbqpzmzgub37gbcjlvluxtruqad\.onion\//)?e:void 0};r.corsValidator=l;r.parse=function(e){void 0===e&&(e={});var t=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(Object(r),!0).forEach((function(t){(0,i.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},c);if(Object.prototype.hasOwnProperty.call(e,"debug")&&(Array.isArray(e),"boolean"==typeof e.debug?t.debug=e.debug:"string"==typeof e.debug&&(t.debug="true"===e.debug)),"string"==typeof e.connectSrc&&(t.connectSrc=e.connectSrc),"undefined"!=typeof global&&"string"==typeof global.__TREZOR_CONNECT_SRC&&(t.connectSrc=l(global.__TREZOR_CONNECT_SRC),t.debug=!0),"undefined"!=typeof window&&window.location&&"string"==typeof window.location.search){var r=window.location.search.split("&").find((function(e){return e.indexOf("trezor-connect-src")>=0}));if(r){var n=r.split("=")[1];t.connectSrc=l(decodeURIComponent(n)),t.debug=!0}}var o=t.connectSrc||a;return t.iframeSrc=o+"iframe.html",t.popupSrc=o+"popup.html",t.webusbSrc=o+"webusb.html","boolean"==typeof e.transportReconnect&&(t.transportReconnect=e.transportReconnect),"boolean"==typeof e.webusb&&(t.webusb=e.webusb),"boolean"==typeof e.popup&&(t.popup=e.popup),"boolean"==typeof e.lazyLoad&&(t.lazyLoad=e.lazyLoad),"boolean"==typeof e.pendingTransportEvent&&(t.pendingTransportEvent=e.pendingTransportEvent),"undefined"!=typeof window&&window.location&&"file:"===window.location.protocol&&(t.origin="file://"+window.location.pathname,t.webusb=!1),"string"==typeof e.extension&&(t.extension=e.extension),"string"==typeof e.env?t.env=e.env:t.env=u(),"number"==typeof e.timestamp&&(t.timestamp=e.timestamp),"number"==typeof e.interactionTimeout&&(t.interactionTimeout=e.interactionTimeout),"object"==typeof e.manifest&&(t.manifest=function(e){if(e&&"string"==typeof e.email&&"string"==typeof e.appUrl)return{email:e.email,appUrl:e.appUrl}}(e.manifest)),c=t}}}},{package:"trezor-connect",file:"/home/circleci/project/node_modules/trezor-connect/lib/data/ConnectSettings.js"}],[6040,{"../constants/iframe":6025,"../constants/popup":6028,"../constants/ui":6030,"../env/browser/networkUtils":6033,"../utils/deferred":6064,"./showPopupRequest":6041,"@babel/runtime/helpers/assertThisInitialized":184,"@babel/runtime/helpers/asyncToGenerator":185,"@babel/runtime/helpers/defineProperty":189,"@babel/runtime/helpers/inheritsLoose":194,"@babel/runtime/helpers/interopRequireDefault":195,"@babel/runtime/regenerator":215,events:2158},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault");r.__esModule=!0,r.default=void 0;var i=n(e("@babel/runtime/regenerator")),s=n(e("@babel/runtime/helpers/asyncToGenerator")),o=n(e("@babel/runtime/helpers/assertThisInitialized")),a=n(e("@babel/runtime/helpers/inheritsLoose")),c=n(e("@babel/runtime/helpers/defineProperty")),u=n(e("events")),l=y(e("../constants/popup")),f=y(e("../constants/iframe")),d=y(e("../constants/ui")),h=e("./showPopupRequest"),p=e("../env/browser/networkUtils"),m=e("../utils/deferred");function g(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(g=function(e){return e?r:t})(e)}function y(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=g(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if("default"!==s&&Object.prototype.hasOwnProperty.call(e,s)){var o=i?Object.getOwnPropertyDescriptor(e,s):null;o&&(o.get||o.set)?Object.defineProperty(n,s,o):n[s]=e[s]}return n.default=e,r&&r.set(e,n),n}var b=function(e){function t(t){var r;return r=e.call(this)||this,(0,c.default)((0,o.default)(r),"requestTimeout",0),(0,c.default)((0,o.default)(r),"closeInterval",0),(0,c.default)((0,o.default)(r),"extensionTabId",0),r.settings=t,r.origin=(0,p.getOrigin)(t.popupSrc),r.handleMessage=r.handleMessage.bind((0,o.default)(r)),r.iframeHandshake=(0,m.create)(f.LOADED),"webextension"===r.settings.env&&(r.handleExtensionConnect=r.handleExtensionConnect.bind((0,o.default)(r)),r.handleExtensionMessage=r.handleExtensionMessage.bind((0,o.default)(r)),chrome.runtime.onConnect.addListener(r.handleExtensionConnect)),window.addEventListener("message",r.handleMessage,!1),r}(0,a.default)(t,e);var r=t.prototype;return r.request=function(e){var t=this;if(void 0===e&&(e=!1),this.locked)this._window&&("webextension"===this.settings.env?chrome.tabs.update(this._window.id,{active:!0}):this._window.focus());else{var r=this.open.bind(this);if(this.locked=!0,this.settings.supportedBrowser){var n=e||"webextension"===this.settings.env?1:850;this.requestTimeout=window.setTimeout((function(){t.requestTimeout=0,r(e)}),n)}else r()}},r.cancel=function(){this.close()},r.unlock=function(){this.locked=!1},r.open=function(e){var t=this,r=this.settings.popupSrc;this.settings.supportedBrowser?(this.popupPromise=(0,m.create)(l.LOADED),this.openWrapper(e?r+"#loading":r),this.closeInterval=window.setInterval((function(){t._window&&("webextension"===t.settings.env?chrome.tabs.get(t._window.id,(function(e){e||(t.close(),t.emit(l.CLOSED))})):t._window.closed&&(t.close(),t.emit(l.CLOSED)))}),500),this.openTimeout=window.setTimeout((function(){t.close(),(0,h.showPopupRequest)(t.open.bind(t),(function(){t.emit(l.CLOSED)}))}),3e3)):this.openWrapper(r+"#unsupported")},r.openWrapper=function(e){var t=this;"webextension"===this.settings.env?chrome.windows.getCurrent(null,(function(r){"normal"!==r.type?chrome.windows.create({url:e},(function(e){chrome.tabs.query({windowId:e.id,active:!0},(function(e){t._window=e[0]}))})):chrome.tabs.query({currentWindow:!0,active:!0},(function(r){t.extensionTabId=r[0].id,chrome.tabs.create({url:e,index:r[0].index+1},(function(e){t._window=e}))}))})):"electron"===this.settings.env?this._window=window.open(e,"modal"):(this._window=window.open("","_blank"),this._window&&(this._window.location.href=e))},r.handleExtensionConnect=function(e){"trezor-connect"===e.name&&(!this._window||this._window&&this._window.id!==e.sender.tab.id?e.disconnect():(window.clearTimeout(this.openTimeout),this.extensionPort=e,this.extensionPort.onMessage.addListener(this.handleExtensionMessage)))},r.handleExtensionMessage=function(e){var t=this;if(this.extensionPort){var r=this.extensionPort,n=e.data;if(n&&"object"==typeof n)if(n.type===l.ERROR){var i=n.payload&&"string"==typeof n.payload.error?n.payload.error:null;this.emit(l.CLOSED,i?"Popup error: "+i:null),this.close()}else n.type===l.LOADED?(this.popupPromise&&this.popupPromise.resolve(),this.iframeHandshake.promise.then((function(e){r.postMessage({type:l.INIT,payload:{settings:t.settings,useBroadcastChannel:e}})}))):n.type===l.EXTENSION_USB_PERMISSIONS?chrome.tabs.query({currentWindow:!0,active:!0},(function(e){chrome.tabs.create({url:"trezor-usb-permissions.html",index:e[0].index+1},(function(e){}))})):n.type===l.CLOSE_WINDOW&&(this.emit(l.CLOSED),this.close())}},r.handleMessage=function(e){var t=this,r=e.data;if((0,p.getOrigin)(e.origin)===this.origin&&r&&"object"==typeof r)if(r.type===f.LOADED){var n=!(!r.payload||"boolean"!=typeof r.payload.useBroadcastChannel)&&r.payload.useBroadcastChannel;this.iframeHandshake.resolve(n)}else if(r.type===l.BOOTSTRAP)window.clearTimeout(this.openTimeout);else if(r.type===l.ERROR&&this._window){var i=r.payload&&"string"==typeof r.payload.error?r.payload.error:null;this.emit(l.CLOSED,i?"Popup error: "+i:null),this.close()}else r.type===l.LOADED?(this.popupPromise&&this.popupPromise.resolve(),this.iframeHandshake.promise.then((function(e){t._window.postMessage({type:l.INIT,payload:{settings:t.settings,useBroadcastChannel:e}},t.origin)}))):r.type!==l.CANCEL_POPUP_REQUEST&&r.type!==d.CLOSE_UI_WINDOW||this.close()},r.close=function(){if(this.locked=!1,this.popupPromise=undefined,this.requestTimeout&&(window.clearTimeout(this.requestTimeout),this.requestTimeout=0),this.openTimeout&&(window.clearTimeout(this.openTimeout),this.openTimeout=0),this.closeInterval&&(window.clearInterval(this.closeInterval),this.closeInterval=0),this.extensionPort&&(this.extensionPort.disconnect(),this.extensionPort=null),this.extensionTabId&&(chrome.tabs.update(this.extensionTabId,{active:!0}),this.extensionTabId=0),this._window){if("webextension"===this.settings.env){chrome.runtime.lastError;chrome.tabs.remove(this._window.id,(function(){chrome.runtime.lastError}))}else this._window.close();this._window=null}},r.postMessage=function(){var e=(0,s.default)(i.default.mark((function e(t){var r=this;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._window||t.type===d.REQUEST_UI_WINDOW||!this.openTimeout){e.next=4;break}return this.close(),(0,h.showPopupRequest)(this.open.bind(this),(function(){r.emit(l.CLOSED)})),e.abrupt("return");case 4:if(!this.popupPromise){e.next=7;break}return e.next=7,this.popupPromise.promise;case 7:this._window&&this._window.postMessage(t,this.origin);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t}(u.default);r.default=b}}},{package:"trezor-connect",file:"/home/circleci/project/node_modules/trezor-connect/lib/popup/PopupManager.js"}],[1110,{"./utils":1114,buffer:2157,tweetnacl:6070,"tweetnacl-util":6069},function(){with(this)return function(){"use strict";return function(e,t,r){(function(t){(function(){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){n===undefined&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){n===undefined&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(r,"__esModule",{value:!0}),r.getEncryptionPublicKey=r.decryptSafely=r.decrypt=r.encryptSafely=r.encrypt=void 0;const o=s(e("tweetnacl")),a=s(e("tweetnacl-util")),c=e("./utils");function u({publicKey:e,data:t,version:r}){if(c.isNullish(e))throw new Error("Missing publicKey parameter");if(c.isNullish(t))throw new Error("Missing data parameter");if(c.isNullish(r))throw new Error("Missing version parameter");if("x25519-xsalsa20-poly1305"===r){if("string"!=typeof t)throw new Error("Message data must be given as a string");const r=o.box.keyPair();let n;try{n=a.decodeBase64(e)}catch(e){throw new Error("Bad public key")}const i=a.decodeUTF8(t),s=o.randomBytes(o.box.nonceLength),c=o.box(i,s,n,r.secretKey);return{version:"x25519-xsalsa20-poly1305",nonce:a.encodeBase64(s),ephemPublicKey:a.encodeBase64(r.publicKey),ciphertext:a.encodeBase64(c)}}throw new Error("Encryption type/version not supported")}function l({encryptedData:e,privateKey:t}){if(c.isNullish(e))throw new Error("Missing encryptedData parameter");if(c.isNullish(t))throw new Error("Missing privateKey parameter");if("x25519-xsalsa20-poly1305"===e.version){const r=f(t),n=o.box.keyPair.fromSecretKey(r).secretKey,i=a.decodeBase64(e.nonce),s=a.decodeBase64(e.ciphertext),c=a.decodeBase64(e.ephemPublicKey),u=o.box.open(s,i,c,n);let l;try{l=a.encodeUTF8(u)}catch(e){throw new Error("Decryption failed.")}if(l)return l;throw new Error("Decryption failed.")}throw new Error("Encryption type/version not supported.")}function f(e){const r=t.from(e,"hex").toString("base64");return a.decodeBase64(r)}r.encrypt=u,r.encryptSafely=function({publicKey:e,data:r,version:n}){if(c.isNullish(e))throw new Error("Missing publicKey parameter");if(c.isNullish(r))throw new Error("Missing data parameter");if(c.isNullish(n))throw new Error("Missing version parameter");if("object"==typeof r&&"toJSON"in r)throw new Error("Cannot encrypt with toJSON property.  Please remove toJSON property");const i={data:r,padding:""},s=t.byteLength(JSON.stringify(i),"utf-8")%2048;let o=0;return s>0&&(o=2048-s-16),i.padding="0".repeat(o),u({publicKey:e,data:JSON.stringify(i),version:n})},r.decrypt=l,r.decryptSafely=function({encryptedData:e,privateKey:t}){if(c.isNullish(e))throw new Error("Missing encryptedData parameter");if(c.isNullish(t))throw new Error("Missing privateKey parameter");return JSON.parse(l({encryptedData:e,privateKey:t})).data},r.getEncryptionPublicKey=function(e){const t=f(e),r=o.box.keyPair.fromSecretKey(t).publicKey;return a.encodeBase64(r)}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/eth-sig-util",file:"/home/circleci/project/node_modules/@metamask/eth-sig-util/dist/encryption.js"}],[1113,{"./utils":1114,buffer:2157,"ethereumjs-abi":2577,"ethereumjs-util":1119},function(){with(this)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.recoverTypedSignature=r.signTypedData=r.typedSignatureHash=r.TypedDataUtils=r.TYPED_MESSAGE_SCHEMA=r.SignTypedDataVersion=void 0;const n=e("ethereumjs-util"),i=e("ethereumjs-abi"),s=e("./utils");var o;function a(e,t){if(!Object.keys(o).includes(e))throw new Error(`Invalid version: '${e}'`);if(t&&!t.includes(e))throw new Error(`SignTypedDataVersion not allowed: '${e}'. Allowed versions are: ${t.join(", ")}`)}function c(e,r,s,l,f){if(a(f,[o.V3,o.V4]),e[s]!==undefined)return["bytes32",f===o.V4&&null==l?"0x0000000000000000000000000000000000000000000000000000000000000000":n.keccak(u(s,l,e,f))];if(l===undefined)throw new Error(`missing value for field ${r} of type ${s}`);if("bytes"===s)return["bytes32",n.keccak(l)];if("string"===s)return"string"==typeof l&&(l=t.from(l,"utf8")),["bytes32",n.keccak(l)];if(s.lastIndexOf("]")===s.length-1){if(f===o.V3)throw new Error("Arrays are unimplemented in encodeData; use V4 extension");const t=s.slice(0,s.lastIndexOf("[")),a=l.map((n=>c(e,r,t,n,f)));return["bytes32",n.keccak(i.rawEncode(a.map((([e])=>e)),a.map((([,e])=>e))))]}return[s,l]}function u(e,t,r,n){a(n,[o.V3,o.V4]);const s=["bytes32"],u=[h(e,r)];for(const i of r[e]){if(n===o.V3&&t[i.name]===undefined)continue;const[e,a]=c(r,i.name,i.type,t[i.name],n);s.push(e),u.push(a)}return i.rawEncode(s,u)}function l(e,t){let r="";const n=f(e,t);n.delete(e);const i=[e,...Array.from(n).sort()];for(const e of i){if(!t[e])throw new Error(`No type definition specified: ${e}`);r+=`${e}(${t[e].map((({name:e,type:t})=>`${t} ${e}`)).join(",")})`}return r}function f(e,t,r=new Set){if([e]=e.match(/^\w*/u),r.has(e)||t[e]===undefined)return r;r.add(e);for(const n of t[e])f(n.type,t,r);return r}function d(e,t,r,i){return a(i,[o.V3,o.V4]),n.keccak(u(e,t,r,i))}function h(e,t){return n.keccak(l(e,t))}function p(e){const t={};for(const n in r.TYPED_MESSAGE_SCHEMA.properties)e[n]&&(t[n]=e[n]);return"types"in t&&(t.types=Object.assign({EIP712Domain:[]},t.types)),t}function m(e){const t=new Error("Expect argument to be non-empty array");if("object"!=typeof e||!("length"in e)||!e.length)throw t;const r=e.map((function(e){return"bytes"!==e.type?e.value:s.legacyToBuffer(e.value)})),n=e.map((function(e){return e.type})),o=e.map((function(e){if(!e.name)throw t;return`${e.type} ${e.name}`}));return i.soliditySHA3(["bytes32","bytes32"],[i.soliditySHA3(new Array(e.length).fill("string"),o),i.soliditySHA3(n,r)])}!function(e){e.V1="V1",e.V3="V3",e.V4="V4"}(o=r.SignTypedDataVersion||(r.SignTypedDataVersion={})),r.TYPED_MESSAGE_SCHEMA={type:"object",properties:{types:{type:"object",additionalProperties:{type:"array",items:{type:"object",properties:{name:{type:"string"},type:{type:"string",enum:function(){const e=Array.from(new Array(32)).map(((e,t)=>"int"+8*(t+1))),t=Array.from(new Array(32)).map(((e,t)=>"uint"+8*(t+1))),r=Array.from(new Array(32)).map(((e,t)=>`bytes${t+1}`));return["bool","address","string","bytes",...e,...t,...r]}()}},required:["name","type"]}}},primaryType:{type:"string"},domain:{type:"object"},message:{type:"object"}},required:["types","primaryType","domain","message"]},r.TypedDataUtils={encodeData:u,encodeType:l,findTypeDependencies:f,hashStruct:d,hashType:h,sanitizeData:p,eip712Hash:function(e,r){a(r,[o.V3,o.V4]);const i=p(e),s=[t.from("1901","hex")];return s.push(d("EIP712Domain",i.domain,i.types,r)),"EIP712Domain"!==i.primaryType&&s.push(d(i.primaryType,i.message,i.types,r)),n.keccak(t.concat(s))}},r.typedSignatureHash=function(e){const t=m(e);return n.bufferToHex(t)},r.signTypedData=function({privateKey:e,data:t,version:i}){if(a(i),s.isNullish(t))throw new Error("Missing data parameter");if(s.isNullish(e))throw new Error("Missing private key parameter");const c=i===o.V1?m(t):r.TypedDataUtils.eip712Hash(t,i),u=n.ecsign(c,e);return s.concatSig(n.toBuffer(u.v),u.r,u.s)},r.recoverTypedSignature=function({data:e,signature:t,version:i}){if(a(i),s.isNullish(e))throw new Error("Missing data parameter");if(s.isNullish(t))throw new Error("Missing signature parameter");const c=i===o.V1?m(e):r.TypedDataUtils.eip712Hash(e,i),u=s.recoverPublicKey(c,t),l=n.publicToAddress(u);return n.bufferToHex(l)}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/eth-sig-util",file:"/home/circleci/project/node_modules/@metamask/eth-sig-util/dist/sign-typed-data.js"}],[1114,{buffer:2157,"ethereumjs-util":1119,"ethjs-util":1125},function(){with(this)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.normalize=r.recoverPublicKey=r.concatSig=r.legacyToBuffer=r.isNullish=r.padWithZeroes=void 0;const n=e("ethereumjs-util"),i=e("ethjs-util");function s(e,t){if(""!==e&&!/^[a-f0-9]+$/iu.test(e))throw new Error(`Expected an unprefixed hex string. Received: ${e}`);if(t<0)throw new Error(`Expected a non-negative integer target length. Received: ${t}`);return String.prototype.padStart.call(e,t,"0")}r.padWithZeroes=s,r.isNullish=function(e){return null===e||e===undefined},r.legacyToBuffer=function(e){return"string"!=typeof e||i.isHexString(e)?n.toBuffer(e):t.from(e)},r.concatSig=function(e,t,r){const o=n.fromSigned(t),a=n.fromSigned(r),c=n.bufferToInt(e),u=s(n.toUnsigned(o).toString("hex"),64),l=s(n.toUnsigned(a).toString("hex"),64),f=i.stripHexPrefix(i.intToHex(c));return n.addHexPrefix(u.concat(l,f))},r.recoverPublicKey=function(e,t){const r=n.fromRpcSig(t);return n.ecrecover(e,r.v,r.r,r.s)},r.normalize=function(e){if(!e)return undefined;if("number"==typeof e){const t=n.toBuffer(e);e=n.bufferToHex(t)}if("string"!=typeof e){let t="eth-sig-util.normalize() requires hex string or integer input.";throw t+=` received ${typeof e}: ${e}`,new Error(t)}return n.addHexPrefix(e.toLowerCase())}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/eth-sig-util",file:"/home/circleci/project/node_modules/@metamask/eth-sig-util/dist/utils.js"}],[1112,{"./utils":1114,"ethereumjs-util":1119},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.extractPublicKey=r.recoverPersonalSignature=r.personalSign=void 0;const n=e("ethereumjs-util"),i=e("./utils");function s(e,t){const r=n.hashPersonalMessage(i.legacyToBuffer(e));return i.recoverPublicKey(r,t)}r.personalSign=function({privateKey:e,data:t}){if(i.isNullish(t))throw new Error("Missing data parameter");if(i.isNullish(e))throw new Error("Missing privateKey parameter");const r=i.legacyToBuffer(t),s=n.hashPersonalMessage(r),o=n.ecsign(s,e);return i.concatSig(n.toBuffer(o.v),o.r,o.s)},r.recoverPersonalSignature=function({data:e,signature:t}){if(i.isNullish(e))throw new Error("Missing data parameter");if(i.isNullish(t))throw new Error("Missing signature parameter");const r=s(e,t),o=n.publicToAddress(r);return n.bufferToHex(o)},r.extractPublicKey=function({data:e,signature:t}){if(i.isNullish(e))throw new Error("Missing data parameter");if(i.isNullish(t))throw new Error("Missing signature parameter");return`0x${s(e,t).toString("hex")}`}}}},{package:"@metamask/eth-sig-util",file:"/home/circleci/project/node_modules/@metamask/eth-sig-util/dist/personal-sign.js"}],[1399,{"./commonjs/core.js":1396,"./commonjs/duplex.js":1397,"./commonjs/helpers.js":1398},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("./commonjs/core.js");Object.assign(r,n);var i=e("./commonjs/duplex.js");Object.assign(r,i);var s=e("./commonjs/helpers.js");r.JsonPatchError=s.PatchError,r.deepClone=s._deepClone,r.escapePathComponent=s.escapePathComponent,r.unescapePathComponent=s.unescapePathComponent}}},{package:"fast-json-patch",file:"/home/circleci/project/node_modules/@metamask/smart-transactions-controller/node_modules/fast-json-patch/index.js"}],[5107,{"./_Stack":5089,"./_arrayEach":5094,"./_assignValue":5102,"./_baseAssign":5104,"./_baseAssignIn":5105,"./_cloneBuffer":5147,"./_copyArray":5152,"./_copySymbols":5154,"./_copySymbolsIn":5155,"./_getAllKeys":5164,"./_getAllKeysIn":5165,"./_getTag":5173,"./_initCloneArray":5181,"./_initCloneByTag":5182,"./_initCloneObject":5183,"./isArray":5234,"./isBuffer":5237,"./isMap":5241,"./isObject":5242,"./isSet":5245,"./keys":5248,"./keysIn":5249},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("./_Stack"),i=e("./_arrayEach"),s=e("./_assignValue"),o=e("./_baseAssign"),a=e("./_baseAssignIn"),c=e("./_cloneBuffer"),u=e("./_copyArray"),l=e("./_copySymbols"),f=e("./_copySymbolsIn"),d=e("./_getAllKeys"),h=e("./_getAllKeysIn"),p=e("./_getTag"),m=e("./_initCloneArray"),g=e("./_initCloneByTag"),y=e("./_initCloneObject"),b=e("./isArray"),v=e("./isBuffer"),w=e("./isMap"),_=e("./isObject"),E=e("./isSet"),k=e("./keys"),S=e("./keysIn"),A="[object Arguments]",T="[object Function]",I="[object Object]",C={};C[A]=C["[object Array]"]=C["[object ArrayBuffer]"]=C["[object DataView]"]=C["[object Boolean]"]=C["[object Date]"]=C["[object Float32Array]"]=C["[object Float64Array]"]=C["[object Int8Array]"]=C["[object Int16Array]"]=C["[object Int32Array]"]=C["[object Map]"]=C["[object Number]"]=C[I]=C["[object RegExp]"]=C["[object Set]"]=C["[object String]"]=C["[object Symbol]"]=C["[object Uint8Array]"]=C["[object Uint8ClampedArray]"]=C["[object Uint16Array]"]=C["[object Uint32Array]"]=!0,C["[object Error]"]=C[T]=C["[object WeakMap]"]=!1,t.exports=function e(t,r,x,P,O,R){var N,M=1&r,j=2&r,L=4&r;if(x&&(N=O?x(t,P,O,R):x(t)),N!==undefined)return N;if(!_(t))return t;var D=b(t);if(D){if(N=m(t),!M)return u(t,N)}else{var B=p(t),U=B==T||"[object GeneratorFunction]"==B;if(v(t))return c(t,M);if(B==I||B==A||U&&!O){if(N=j||U?{}:y(t),!M)return j?f(t,a(N,t)):l(t,o(N,t))}else{if(!C[B])return O?t:{};N=g(t,B,M)}}R||(R=new n);var K=R.get(t);if(K)return K;R.set(t,N),E(t)?t.forEach((function(n){N.add(e(n,r,x,n,t,R))})):w(t)&&t.forEach((function(n,i){N.set(i,e(n,r,x,i,t,R))}));var V=D?undefined:(L?j?h:d:j?S:k)(t);return i(V||t,(function(n,i){V&&(n=t[i=n]),s(N,i,e(n,r,x,i,t,R))})),N}}}},{package:"lodash",file:"/home/circleci/project/node_modules/lodash/_baseClone.js"}],[5113,{"./_baseFor":5112,"./keys":5248},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("./_baseFor"),i=e("./keys");t.exports=function(e,t){return e&&n(e,t,i)}}}},{package:"lodash",file:"/home/circleci/project/node_modules/lodash/_baseForOwn.js"}],[5106,{"./_defineProperty":5159},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("./_defineProperty");t.exports=function(e,t,r){"__proto__"==t&&n?n(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}}}},{package:"lodash",file:"/home/circleci/project/node_modules/lodash/_baseAssignValue.js"}],[5129,{"./_baseMatches":5132,"./_baseMatchesProperty":5133,"./identity":5231,"./isArray":5234,"./property":5254},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("./_baseMatches"),i=e("./_baseMatchesProperty"),s=e("./identity"),o=e("./isArray"),a=e("./property");t.exports=function(e){return"function"==typeof e?e:null==e?s:"object"==typeof e?o(e)?i(e[0],e[1]):n(e):a(e)}}}},{package:"lodash",file:"/home/circleci/project/node_modules/lodash/_baseIteratee.js"}],[1322,{},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.BaseController=void 0;class n{constructor(e={},t={}){this.defaultConfig={},this.defaultState={},this.disabled=!1,this.name="BaseController",this.internalConfig=this.defaultConfig,this.internalState=this.defaultState,this.internalListeners=[],this.initialState=t,this.initialConfig=e}initialize(){return this.internalState=this.defaultState,this.internalConfig=this.defaultConfig,this.configure(this.initialConfig),this.update(this.initialState),this}get config(){return this.internalConfig}get state(){return this.internalState}configure(e,t=!1,r=!0){if(r){this.internalConfig=t?e:Object.assign(this.internalConfig,e);for(const e in this.internalConfig)void 0!==this.internalConfig[e]&&(this[e]=this.internalConfig[e])}else for(const t in e)void 0!==this.internalConfig[t]&&(this.internalConfig[t]=e[t],this[t]=e[t])}notify(){this.disabled||this.internalListeners.forEach((e=>{e(this.internalState)}))}subscribe(e){this.internalListeners.push(e)}unsubscribe(e){const t=this.internalListeners.findIndex((t=>e===t));return t>-1&&this.internalListeners.splice(t,1),t>-1}update(e,t=!1){this.internalState=t?Object.assign({},e):Object.assign({},this.internalState,e),this.notify()}}r.BaseController=n,r.default=n}}},{package:"@metamask/controllers",file:"/home/circleci/project/node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/controllers/dist/BaseController.js"}],[1325,{},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.ControllerMessenger=r.RestrictedControllerMessenger=void 0;class n{constructor({controllerMessenger:e,name:t,allowedActions:r,allowedEvents:n}){this.controllerMessenger=e,this.controllerName=t,this.allowedActions=r||null,this.allowedEvents=n||null}registerActionHandler(e,t){if(!e.startsWith(`${this.controllerName}:`))throw new Error(`Only allowed registering action handlers prefixed by '${this.controllerName}:'`);this.controllerMessenger.registerActionHandler(e,t)}unregisterActionHandler(e){if(!e.startsWith(`${this.controllerName}:`))throw new Error(`Only allowed unregistering action handlers prefixed by '${this.controllerName}:'`);this.controllerMessenger.unregisterActionHandler(e)}call(e,...t){if(null===this.allowedActions)throw new Error("No actions allowed");if(!this.allowedActions.includes(e))throw new Error(`Action missing from allow list: ${e}`);return this.controllerMessenger.call(e,...t)}publish(e,...t){if(!e.startsWith(`${this.controllerName}:`))throw new Error(`Only allowed publishing events prefixed by '${this.controllerName}:'`);this.controllerMessenger.publish(e,...t)}subscribe(e,t,r){if(null===this.allowedEvents)throw new Error("No events allowed");if(!this.allowedEvents.includes(e))throw new Error(`Event missing from allow list: ${e}`);return r?this.controllerMessenger.subscribe(e,t,r):this.controllerMessenger.subscribe(e,t)}unsubscribe(e,t){if(null===this.allowedEvents)throw new Error("No events allowed");if(!this.allowedEvents.includes(e))throw new Error(`Event missing from allow list: ${e}`);this.controllerMessenger.unsubscribe(e,t)}clearEventSubscriptions(e){if(!e.startsWith(`${this.controllerName}:`))throw new Error(`Only allowed clearing events prefixed by '${this.controllerName}:'`);this.controllerMessenger.clearEventSubscriptions(e)}}r.RestrictedControllerMessenger=n;r.ControllerMessenger=class{constructor(){this.actions=new Map,this.events=new Map,this.eventPayloadCache=new Map}registerActionHandler(e,t){if(this.actions.has(e))throw new Error(`A handler for ${e} has already been registered`);this.actions.set(e,t)}unregisterActionHandler(e){this.actions.delete(e)}clearActions(){this.actions.clear()}call(e,...t){const r=this.actions.get(e);if(!r)throw new Error(`A handler for ${e} has not been registered`);return r(...t)}publish(e,...t){const r=this.events.get(e);if(r)for(const[e,n]of r.entries())if(n){const r=this.eventPayloadCache.get(e),i=n(...t);i!==r&&(this.eventPayloadCache.set(e,i),e(i,r))}else e(...t)}subscribe(e,t,r){let n=this.events.get(e);n||(n=new Map,this.events.set(e,n)),n.set(t,r)}unsubscribe(e,t){const r=this.events.get(e);if(!r||!r.has(t))throw new Error(`Subscription not found for event: ${e}`);r.get(t)&&this.eventPayloadCache.delete(t),r.delete(t)}clearEventSubscriptions(e){this.events.delete(e)}clearSubscriptions(){this.events.clear()}getRestricted({name:e,allowedActions:t,allowedEvents:r}){return new n({controllerMessenger:this,name:e,allowedActions:t,allowedEvents:r})}}}}},{package:"@metamask/controllers",file:"/home/circleci/project/node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/controllers/dist/ControllerMessenger.js"}],[1324,{"./BaseController":1322},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.ComposableController=void 0;const n=e("./BaseController");class i extends n.BaseController{constructor(e,t){super(undefined,e.reduce(((e,t)=>(e[t.name]=t.state,e)),{})),this.controllers=[],this.name="ComposableController",this.initialize(),this.controllers=e,this.messagingSystem=t,this.controllers.forEach((e=>{const{name:t}=e;if(e.subscribe!==undefined)e.subscribe((e=>{this.update({[t]:e})}));else{if(!this.messagingSystem)throw new Error("Messaging system required if any BaseControllerV2 controllers are used");this.messagingSystem.subscribe(`${t}:stateChange`,(e=>{this.update({[t]:e})}))}}))}get flatState(){let e={};for(const t of this.controllers)e=Object.assign(Object.assign({},e),t.state);return e}}r.ComposableController=i,r.default=i}}},{package:"@metamask/controllers",file:"/home/circleci/project/node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/controllers/dist/ComposableController.js"}],[1368,{"../BaseController":1322,"../util":1370},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.AddressBookController=void 0;const n=e("../util"),i=e("../BaseController");class s extends i.BaseController{constructor(e,t){super(e,t),this.name="AddressBookController",this.defaultState={addressBook:{}},this.initialize()}clear(){this.update({addressBook:{}})}delete(e,t){if(t=n.toChecksumHexAddress(t),!n.isValidHexAddress(t)||!this.state.addressBook[e]||!this.state.addressBook[e][t])return!1;const r=Object.assign({},this.state.addressBook);return delete r[e][t],0===Object.keys(r[e]).length&&delete r[e],this.update({addressBook:r}),!0}set(e,t,r="1",i=""){if(e=n.toChecksumHexAddress(e),!n.isValidHexAddress(e))return!1;const s={address:e,chainId:r,isEns:!1,memo:i,name:t},o=n.normalizeEnsName(t);return o&&(s.name=o,s.isEns=!0),this.update({addressBook:Object.assign(Object.assign({},this.state.addressBook),{[r]:Object.assign(Object.assign({},this.state.addressBook[r]),{[e]:s})})}),!0}}r.AddressBookController=s,r.default=s}}},{package:"@metamask/controllers",file:"/home/circleci/project/node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/controllers/dist/user/AddressBookController.js"}],[1369,{"../BaseController":1322,"../util":1370},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.PreferencesController=void 0;const n=e("../BaseController"),i=e("../util");class s extends n.BaseController{constructor(e,t){super(e,t),this.name="PreferencesController",this.defaultState={featureFlags:{},frequentRpcList:[],identities:{},ipfsGateway:"https://ipfs.io/ipfs/",lostIdentities:{},selectedAddress:"",useStaticTokenList:!1,useCollectibleDetection:!1,openSeaEnabled:!1},this.initialize()}addIdentities(e){const{identities:t}=this.state;e.forEach((e=>{if(e=i.toChecksumHexAddress(e),t[e])return;const r=Object.keys(t).length;t[e]={name:`Account ${r+1}`,address:e,importTime:Date.now()}})),this.update({identities:Object.assign({},t)})}removeIdentity(e){e=i.toChecksumHexAddress(e);const{identities:t}=this.state;t[e]&&(delete t[e],this.update({identities:Object.assign({},t)}),e===this.state.selectedAddress&&this.update({selectedAddress:Object.keys(t)[0]}))}setAccountLabel(e,t){e=i.toChecksumHexAddress(e);const{identities:r}=this.state;r[e]=r[e]||{},r[e].name=t,this.update({identities:Object.assign({},r)})}setFeatureFlag(e,t){const r=this.state.featureFlags,n=Object.assign(Object.assign({},r),{[e]:t});this.update({featureFlags:Object.assign({},n)})}syncIdentities(e){e=e.map((e=>i.toChecksumHexAddress(e)));const{identities:t,lostIdentities:r}=this.state,n={};for(const r in t)-1===e.indexOf(r)&&(n[r]=t[r],delete t[r]);if(Object.keys(n).length>0)for(const e in n)r[e]=n[e];return this.update({identities:Object.assign({},t),lostIdentities:Object.assign({},r)}),this.addIdentities(e),-1===e.indexOf(this.state.selectedAddress)&&this.update({selectedAddress:e[0]}),this.state.selectedAddress}updateIdentities(e){e=e.map((e=>i.toChecksumHexAddress(e)));const t=this.state.identities,r=e.reduce(((e,r,n)=>(e[r]=t[r]||{address:r,name:`Account ${n+1}`,importTime:Date.now()},e)),{});let{selectedAddress:n}=this.state;Object.keys(r).includes(n)||(n=Object.keys(r)[0]),this.update({identities:Object.assign({},r),selectedAddress:n})}addToFrequentRpcList(e,t,r,n,i){const{frequentRpcList:s}=this.state,o=s.findIndex((({rpcUrl:t})=>t===e));-1!==o&&s.splice(o,1);const a={rpcUrl:e,chainId:t,ticker:r,nickname:n,rpcPrefs:i};s.push(a),this.update({frequentRpcList:[...s]})}removeFromFrequentRpcList(e){const{frequentRpcList:t}=this.state,r=t.findIndex((({rpcUrl:t})=>t===e));-1!==r&&t.splice(r,1),this.update({frequentRpcList:[...t]})}setSelectedAddress(e){this.update({selectedAddress:i.toChecksumHexAddress(e)})}setIpfsGateway(e){this.update({ipfsGateway:e})}setUseStaticTokenList(e){this.update({useStaticTokenList:e})}setUseCollectibleDetection(e){if(e&&!this.state.openSeaEnabled)throw new Error("useCollectibleDetection cannot be enabled if openSeaEnabled is false");this.update({useCollectibleDetection:e})}setOpenSeaEnabled(e){this.update({openSeaEnabled:e}),e||this.update({useCollectibleDetection:!1})}}r.PreferencesController=s,r.default=s}}},{package:"@metamask/controllers",file:"/home/circleci/project/node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/controllers/dist/user/PreferencesController.js"}],[1365,{"../BaseController":1322},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.NotificationController=void 0;const n=e("../BaseController"),i={notifications:{}};class s extends n.BaseController{constructor(e,t){super(e,t||i),this.initialize(),this._addNotifications()}_addNotifications(){const e={},{allNotifications:t}=this.config;Object.values(t).forEach((t=>{e[t.id]=this.state.notifications[t.id]?this.state.notifications[t.id]:Object.assign(Object.assign({},t),{isShown:!1})})),this.update({notifications:e})}updateViewed(e){const t=this.state.notifications;for(const r of Object.keys(e).map(Number))t[r].isShown=e[r];this.update({notifications:t},!0)}}r.NotificationController=s}}},{package:"@metamask/controllers",file:"/home/circleci/project/node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/controllers/dist/notification/NotificationController.js"}],[1338,{"../BaseController":1322,"../constants":1343,"../util":1370},function(){with(this)return function(){"use strict";return function(e,t,r){var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(r,"__esModule",{value:!0}),r.TokenDetectionController=void 0;const i=e("../BaseController"),s=e("../util"),o=e("../constants");class a extends i.BaseController{constructor({onTokensStateChange:e,onPreferencesStateChange:t,onNetworkStateChange:r,getBalancesInSingleCall:n,addTokens:i,getTokenListState:s,getTokensState:a},c,u){super(c,u),this.name="TokenDetectionController",this.isMainnet=()=>this.config.networkType===o.MAINNET,this.defaultConfig={interval:18e4,networkType:o.MAINNET,selectedAddress:"",tokens:[]},this.initialize(),this.getTokensState=a,this.getTokenListState=s,this.addTokens=i,e((({tokens:e})=>{this.configure({tokens:e})})),t((({selectedAddress:e})=>{e!==this.config.selectedAddress&&(this.configure({selectedAddress:e}),this.detectTokens())})),r((({provider:e})=>{this.configure({networkType:e.type})})),this.getBalancesInSingleCall=n}start(){return n(this,void 0,void 0,(function*(){this.isMainnet()&&!this.disabled&&(yield this.startPolling())}))}stop(){this.stopPolling()}stopPolling(){this.intervalId&&clearInterval(this.intervalId)}startPolling(e){return n(this,void 0,void 0,(function*(){e&&this.configure({interval:e},!1,!1),this.stopPolling(),yield this.detectTokens(),this.intervalId=setInterval((()=>n(this,void 0,void 0,(function*(){yield this.detectTokens()}))),this.config.interval)}))}detectTokens(){return n(this,void 0,void 0,(function*(){if(!this.isMainnet()||this.disabled)return;const e=this.config.tokens.map((e=>e.address.toLowerCase())),{tokenList:t}=this.getTokenListState(),r=[];for(const n in t)e.includes(n)||r.push(n);const i=[];i[0]=r.slice(0,1e3),i[1]=r.slice(1e3,r.length-1);const{selectedAddress:o}=this.config;if(o)for(const e of i){if(0===e.length)break;yield s.safelyExecute((()=>n(this,void 0,void 0,(function*(){const r=yield this.getBalancesInSingleCall(o,e),n=[];for(const e in r){let r;const{ignoredTokens:i}=this.getTokensState();i.length&&(r=i.find((t=>t===s.toChecksumHexAddress(e))));const o=Object.keys(t).find((t=>t.toLowerCase()===e.toLowerCase()))||"";r===undefined&&n.push({address:e,decimals:t[o].decimals,symbol:t[o].symbol})}n.length&&(yield this.addTokens(n))}))))}}))}}r.TokenDetectionController=a,r.default=a}}},{package:"@metamask/controllers",file:"/home/circleci/project/node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/controllers/dist/assets/TokenDetectionController.js"}],[1331,{"../BaseController":1322,"../constants":1343,"../util":1370},function(){with(this)return function(){"use strict";return function(e,t,r){var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(r,"__esModule",{value:!0}),r.CollectibleDetectionController=void 0;const i=e("../BaseController"),s=e("../util"),o=e("../constants");class a extends i.BaseController{constructor({onPreferencesStateChange:e,onNetworkStateChange:t,getOpenSeaApiKey:r,addCollectible:n,getCollectiblesState:i},s,a){super(s,a),this.name="CollectibleDetectionController",this.isMainnet=()=>this.config.networkType===o.MAINNET,this.defaultConfig={interval:18e4,networkType:o.MAINNET,chainId:"1",selectedAddress:"",disabled:!0},this.initialize(),this.getCollectiblesState=i,e((({selectedAddress:e,useCollectibleDetection:t})=>{const{selectedAddress:r,disabled:n}=this.config;e===r&&!t===n||this.configure({selectedAddress:e,disabled:!t}),t!==undefined&&(t?this.start():this.stop())})),t((({provider:e})=>{this.configure({networkType:e.type,chainId:e.chainId})})),this.getOpenSeaApiKey=r,this.addCollectible=n}getOwnerCollectiblesApi(e,t){return`https://api.opensea.io/api/v1/assets?owner=${e}&offset=${t}&limit=50`}getOwnerCollectibles(e){var t;return n(this,void 0,void 0,(function*(){let r,n=[];const i=this.getOpenSeaApiKey();try{let o=0,a=!1;do{const c=this.getOwnerCollectiblesApi(e,o);r=yield s.timeoutFetch(c,i?{headers:{"X-API-KEY":i}}:{},15e3);const u=yield r.json();0!==(null===(t=u.assets)||void 0===t?void 0:t.length)?n=[...n,...u.assets]:a=!0,o+=50}while(!a)}catch(e){return[]}return n}))}start(){return n(this,void 0,void 0,(function*(){this.isMainnet()&&!this.disabled&&(yield this.startPolling())}))}stop(){this.stopPolling()}stopPolling(){this.intervalId&&clearInterval(this.intervalId)}startPolling(e){return n(this,void 0,void 0,(function*(){e&&this.configure({interval:e},!1,!1),this.stopPolling(),yield this.detectCollectibles(),this.intervalId=setInterval((()=>n(this,void 0,void 0,(function*(){yield this.detectCollectibles()}))),this.config.interval)}))}detectCollectibles(){return n(this,void 0,void 0,(function*(){if(!this.isMainnet()||this.disabled)return;const{selectedAddress:e,chainId:t}=this.config;e&&(yield s.safelyExecute((()=>n(this,void 0,void 0,(function*(){const r=(yield this.getOwnerCollectibles(e)).map((r=>n(this,void 0,void 0,(function*(){const{token_id:n,num_sales:i,background_color:o,image_url:a,image_preview_url:c,image_thumbnail_url:u,image_original_url:l,animation_url:f,animation_original_url:d,name:h,description:p,external_link:m,creator:g,asset_contract:{address:y,schema_name:b},last_sale:v}=r;let w;const{ignoredCollectibles:_}=this.getCollectiblesState();if(_.length&&(w=_.find((e=>e.address===s.toChecksumHexAddress(y)&&e.tokenId===n))),!w){const r=Object.assign({},{name:h},g&&{creator:g},p&&{description:p},a&&{image:a},i&&{numberOfSales:i},o&&{backgroundColor:o},c&&{imagePreview:c},u&&{imageThumbnail:u},l&&{imageOriginal:l},f&&{animation:f},d&&{animationOriginal:d},b&&{standard:b},m&&{externalLink:m},v&&{lastSale:v});yield this.addCollectible(y,n,r,{userAddress:e,chainId:t})}}))));yield Promise.all(r)})))))}))}}r.CollectibleDetectionController=a,r.default=a}}},{package:"@metamask/controllers",file:"/home/circleci/project/node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/controllers/dist/assets/CollectibleDetectionController.js"}],[1340,{"../BaseController":1322,"../apis/crypto-compare":1326,"../constants":1343,"../util":1370},function(){with(this)return function(){"use strict";return function(e,t,r){var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(r,"__esModule",{value:!0}),r.TokenRatesController=void 0;const i=e("../BaseController"),s=e("../util"),o=e("../constants"),a=e("../apis/crypto-compare"),c={BASE_URL:"https://api.coingecko.com/api/v3",getTokenPriceURL(e,t){return`${this.BASE_URL}/simple/token_price/${e}?${t}`},getPlatformsURL(){return`${this.BASE_URL}/asset_platforms`},getSupportedVsCurrencies(){return`${this.BASE_URL}/simple/supported_vs_currencies`}};function u(e,t){var r;if(!t)return null;const n=null!==(r=t.find((({chain_identifier:t})=>null!==t&&String(t)===e)))&&void 0!==r?r:null;return(null==n?void 0:n.id)||null}class l extends i.BaseController{constructor({onTokensStateChange:e,onCurrencyRateStateChange:t,onNetworkStateChange:r},n,i){super(n,i),this.tokenList=[],this.supportedChains={timestamp:0,data:null},this.supportedVsCurrencies={timestamp:0,data:[]},this.name="TokenRatesController",this.defaultConfig={disabled:!0,interval:18e4,nativeCurrency:"eth",chainId:"",tokens:[],threshold:216e5},this.defaultState={contractExchangeRates:{}},this.initialize(),this.configure({disabled:!1},!1,!1),e((e=>{this.configure({tokens:e.tokens})})),t((e=>{this.configure({nativeCurrency:e.nativeCurrency})})),r((({provider:e})=>{const{chainId:t}=e;this.update({contractExchangeRates:{}}),this.configure({chainId:t})})),this.poll()}poll(e){return n(this,void 0,void 0,(function*(){e&&this.configure({interval:e},!1,!1),this.handle&&clearTimeout(this.handle),yield s.safelyExecute((()=>this.updateExchangeRates())),this.handle=setTimeout((()=>{this.poll(this.config.interval)}),this.config.interval)}))}set chainId(e){!this.disabled&&s.safelyExecute((()=>this.updateExchangeRates()))}get chainId(){throw new Error("Property only used for setting")}set tokens(e){this.tokenList=e,!this.disabled&&s.safelyExecute((()=>this.updateExchangeRates()))}get tokens(){throw new Error("Property only used for setting")}fetchExchangeRate(e,t){return n(this,void 0,void 0,(function*(){const r=`contract_addresses=${this.tokenList.map((e=>e.address)).join(",")}&vs_currencies=${t.toLowerCase()}`;return s.handleFetch(c.getTokenPriceURL(e,r))}))}checkIsSupportedVsCurrency(e){return n(this,void 0,void 0,(function*(){const{threshold:t}=this.config,{timestamp:r,data:n}=this.supportedVsCurrencies;if(Date.now()-r>t){const t=yield s.handleFetch(c.getSupportedVsCurrencies());return this.supportedVsCurrencies={data:t,timestamp:Date.now()},t.includes(e.toLowerCase())}return n.includes(e.toLowerCase())}))}getChainSlug(){return n(this,void 0,void 0,(function*(){const{threshold:e,chainId:t}=this.config,{data:r,timestamp:n}=this.supportedChains;if(Date.now()-n>e){const e=yield s.handleFetch(c.getPlatformsURL());return this.supportedChains={data:e,timestamp:Date.now()},u(t,e)}return u(t,r)}))}updateExchangeRates(){return n(this,void 0,void 0,(function*(){if(0===this.tokenList.length||this.disabled)return;const e=yield this.getChainSlug();let t={};if(e){const{nativeCurrency:r}=this.config;t=yield this.fetchAndMapExchangeRates(r,e)}else this.tokenList.forEach((e=>{const r=s.toChecksumHexAddress(e.address);t[r]=undefined}));this.update({contractExchangeRates:t})}))}fetchAndMapExchangeRates(e,t){return n(this,void 0,void 0,(function*(){const r={};if(yield this.checkIsSupportedVsCurrency(e)){const n=yield this.fetchExchangeRate(t,e);this.tokenList.forEach((t=>{const i=n[t.address.toLowerCase()];r[s.toChecksumHexAddress(t.address)]=i?i[e.toLowerCase()]:0}))}else{let n,i=0;try{[n,{conversionRate:i}]=yield Promise.all([this.fetchExchangeRate(t,o.FALL_BACK_VS_CURRENCY),a.fetchExchangeRate(e,o.FALL_BACK_VS_CURRENCY,!1)])}catch(e){if(e.message.includes("market does not exist for this coin pair"))return{};throw e}for(const[e,t]of Object.entries(n)){const n=t[o.FALL_BACK_VS_CURRENCY.toLowerCase()];r[s.toChecksumHexAddress(e)]=n*i}}return r}))}}r.TokenRatesController=l,r.default=l}}},{package:"@metamask/controllers",file:"/home/circleci/project/node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/controllers/dist/assets/TokenRatesController.js"}],[1323,{immer:4480},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.getPersistentState=r.getAnonymizedState=r.BaseController=void 0;const n=e("immer");n.enablePatches();function i(e,t,r){return Object.keys(e).reduce(((n,i)=>{const s=t[i][r],o=e[i];return"function"==typeof s?n[i]=s(o):s&&(n[i]=o),n}),{})}r.BaseController=class{constructor({messenger:e,metadata:t,name:r,state:n}){this.messagingSystem=e,this.name=r,this.internalState=n,this.metadata=t,this.messagingSystem.registerActionHandler(`${r}:getState`,(()=>this.state))}get state(){return this.internalState}set state(e){throw new Error("Controller state cannot be directly mutated; use 'update' method instead.")}update(e){const[t,r]=n.produceWithPatches(this.internalState,e);this.internalState=t,this.messagingSystem.publish(`${this.name}:stateChange`,t,r)}destroy(){this.messagingSystem.clearEventSubscriptions(`${this.name}:stateChange`)}},r.getAnonymizedState=function(e,t){return i(e,t,"anonymous")},r.getPersistentState=function(e,t){return i(e,t,"persist")}}}},{package:"@metamask/controllers",file:"/home/circleci/project/node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/controllers/dist/BaseControllerV2.js"}],[1329,{"../BaseController":1322,"../util":1370,"async-mutex":1803,"eth-query":2527},function(){with(this)return function(){"use strict";return function(e,t,r){var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.AccountTrackerController=void 0;const s=i(e("eth-query")),o=e("async-mutex"),a=e("../BaseController"),c=e("../util");class u extends a.BaseController{constructor({onPreferencesStateChange:e,getIdentities:t},r,i){super(r,i),this.mutex=new o.Mutex,this.name="AccountTrackerController",this.refresh=()=>n(this,void 0,void 0,(function*(){this.syncAccounts();const{accounts:e}=this.state;for(const t in e)yield c.safelyExecuteWithTimeout((()=>n(this,void 0,void 0,(function*(){const r=yield c.query(this.ethQuery,"getBalance",[t]);e[t]={balance:c.BNToHex(r)},this.update({accounts:Object.assign({},e)})}))))})),this.defaultConfig={interval:1e4},this.defaultState={accounts:{}},this.initialize(),this.getIdentities=t,e((()=>{this.refresh()})),this.poll()}syncAccounts(){const{accounts:e}=this.state,t=Object.keys(this.getIdentities()),r=Object.keys(e),n=t.filter((e=>-1===r.indexOf(e))),i=r.filter((e=>-1===t.indexOf(e)));n.forEach((t=>{e[t]={balance:"0x0"}})),i.forEach((t=>{delete e[t]})),this.update({accounts:Object.assign({},e)})}set provider(e){this.ethQuery=new s.default(e)}get provider(){throw new Error("Property only used for setting")}poll(e){return n(this,void 0,void 0,(function*(){const t=yield this.mutex.acquire();e&&this.configure({interval:e},!1,!1),this.handle&&clearTimeout(this.handle),yield this.refresh(),this.handle=setTimeout((()=>{t(),this.poll(this.config.interval)}),this.config.interval)}))}}r.AccountTrackerController=u,r.default=u}}},{package:"@metamask/controllers",file:"/home/circleci/project/node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/controllers/dist/assets/AccountTrackerController.js"}],[1361,{"../util":1370,"./AbstractMessageManager":1360,uuid:6087},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.MessageManager=void 0;const n=e("uuid"),i=e("../util"),s=e("./AbstractMessageManager");class o extends s.AbstractMessageManager{constructor(){super(...arguments),this.name="MessageManager"}addUnapprovedMessageAsync(e,t){return new Promise(((r,n)=>{i.validateSignMessageData(e);const s=this.addUnapprovedMessage(e,t);this.hub.once(`${s}:finished`,(t=>{switch(t.status){case"signed":return r(t.rawSig);case"rejected":return n(new Error("MetaMask Message Signature: User denied message signature."));default:return n(new Error(`MetaMask Message Signature: Unknown problem: ${JSON.stringify(e)}`))}}))}))}addUnapprovedMessage(e,t){t&&(e.origin=t.origin),e.data=i.normalizeMessageData(e.data);const r=n.v1(),s={id:r,messageParams:e,status:"unapproved",time:Date.now(),type:"eth_sign"};return this.addMessage(s),this.hub.emit("unapprovedMessage",Object.assign(Object.assign({},e),{metamaskId:r})),r}prepMessageForSigning(e){return delete e.metamaskId,Promise.resolve(e)}}r.MessageManager=o,r.default=o}}},{package:"@metamask/controllers",file:"/home/circleci/project/node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/controllers/dist/message-manager/MessageManager.js"}],[1333,{"../BaseControllerV2":1323,"../apis/crypto-compare":1326,"../util":1370,"async-mutex":1803},function(){with(this)return function(){"use strict";return function(e,t,r){var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(r,"__esModule",{value:!0}),r.CurrencyRateController=void 0;const i=e("async-mutex"),s=e("../BaseControllerV2"),o=e("../util"),a=e("../apis/crypto-compare"),c={conversionDate:{persist:!0,anonymous:!0},conversionRate:{persist:!0,anonymous:!0},currentCurrency:{persist:!0,anonymous:!0},nativeCurrency:{persist:!0,anonymous:!0},pendingCurrentCurrency:{persist:!1,anonymous:!0},pendingNativeCurrency:{persist:!1,anonymous:!0},usdConversionRate:{persist:!0,anonymous:!0}},u={conversionDate:0,conversionRate:0,currentCurrency:"usd",nativeCurrency:"ETH",pendingCurrentCurrency:null,pendingNativeCurrency:null,usdConversionRate:null};class l extends s.BaseController{constructor({includeUsdRate:e=!1,interval:t=18e4,messenger:r,state:n,fetchExchangeRate:s=a.fetchExchangeRate}){super({name:"CurrencyRateController",metadata:c,messenger:r,state:Object.assign(Object.assign({},u),n)}),this.mutex=new i.Mutex,this.includeUsdRate=e,this.intervalDelay=t,this.fetchExchangeRate=s}start(){return n(this,void 0,void 0,(function*(){yield this.startPolling()}))}stop(){this.stopPolling()}destroy(){super.destroy(),this.stopPolling()}setCurrentCurrency(e){return n(this,void 0,void 0,(function*(){this.update((t=>{t.pendingCurrentCurrency=e})),yield this.updateExchangeRate()}))}setNativeCurrency(e){return n(this,void 0,void 0,(function*(){this.update((t=>{t.pendingNativeCurrency=e})),yield this.updateExchangeRate()}))}stopPolling(){this.intervalId&&clearInterval(this.intervalId)}startPolling(){return n(this,void 0,void 0,(function*(){this.stopPolling(),yield o.safelyExecute((()=>this.updateExchangeRate())),this.intervalId=setInterval((()=>n(this,void 0,void 0,(function*(){yield o.safelyExecute((()=>this.updateExchangeRate()))}))),this.intervalDelay)}))}updateExchangeRate(){return n(this,void 0,void 0,(function*(){const e=yield this.mutex.acquire(),{currentCurrency:t,nativeCurrency:r,pendingCurrentCurrency:n,pendingNativeCurrency:i}=this.state;let s=null,o=null,a=null;const c=null!=n?n:t,u=null!=i?i:r;try{c&&u&&""!==c&&""!==u&&(({conversionRate:o,usdConversionRate:a}=yield this.fetchExchangeRate(c,u,this.includeUsdRate)),s=Date.now()/1e3)}catch(e){if(!e.message.includes("market does not exist for this coin pair"))throw e}finally{try{this.update((()=>({conversionDate:s,conversionRate:o,nativeCurrency:u,currentCurrency:c,pendingCurrentCurrency:null,pendingNativeCurrency:null,usdConversionRate:a})))}finally{e()}}return this.state}))}}r.CurrencyRateController=l,r.default=l}}},{package:"@metamask/controllers",file:"/home/circleci/project/node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/controllers/dist/assets/CurrencyRateController.js"}],[1337,{"../BaseController":1322,"../util":1370,"ethereumjs-util":2597},function(){with(this)return function(){"use strict";return function(e,t,r){var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(r,"__esModule",{value:!0}),r.TokenBalancesController=r.BN=void 0;const i=e("ethereumjs-util");Object.defineProperty(r,"BN",{enumerable:!0,get:function(){return i.BN}});const s=e("../BaseController"),o=e("../util");class a extends s.BaseController{constructor({onTokensStateChange:e,getSelectedAddress:t,getERC20BalanceOf:r},n,i){super(n,i),this.name="TokenBalancesController",this.defaultConfig={interval:18e4,tokens:[]},this.defaultState={contractBalances:{}},this.initialize(),e((({tokens:e})=>{this.configure({tokens:e}),this.updateBalances()})),this.getSelectedAddress=t,this.getERC20BalanceOf=r,this.poll()}poll(e){return n(this,void 0,void 0,(function*(){e&&this.configure({interval:e},!1,!1),this.handle&&clearTimeout(this.handle),yield o.safelyExecute((()=>this.updateBalances())),this.handle=setTimeout((()=>{this.poll(this.config.interval)}),this.config.interval)}))}updateBalances(){return n(this,void 0,void 0,(function*(){if(this.disabled)return;const{tokens:e}=this.config,t={};for(const r in e){const{address:n}=e[r];try{t[n]=yield this.getERC20BalanceOf(n,this.getSelectedAddress()),e[r].balanceError=null}catch(s){t[n]=new i.BN(0),e[r].balanceError=s}}this.update({contractBalances:t})}))}}r.TokenBalancesController=a,r.default=a}}},{package:"@metamask/controllers",file:"/home/circleci/project/node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/controllers/dist/assets/TokenBalancesController.js"}],[1362,{"../util":1370,"./AbstractMessageManager":1360,uuid:6087},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.PersonalMessageManager=void 0;const n=e("uuid"),i=e("../util"),s=e("./AbstractMessageManager");class o extends s.AbstractMessageManager{constructor(){super(...arguments),this.name="PersonalMessageManager"}addUnapprovedMessageAsync(e,t){return new Promise(((r,n)=>{i.validateSignMessageData(e);const s=this.addUnapprovedMessage(e,t);this.hub.once(`${s}:finished`,(t=>{switch(t.status){case"signed":return r(t.rawSig);case"rejected":return n(new Error("MetaMask Personal Message Signature: User denied message signature."));default:return n(new Error(`MetaMask Personal Message Signature: Unknown problem: ${JSON.stringify(e)}`))}}))}))}addUnapprovedMessage(e,t){t&&(e.origin=t.origin),e.data=i.normalizeMessageData(e.data);const r=n.v1(),s={id:r,messageParams:e,status:"unapproved",time:Date.now(),type:"personal_sign"};return this.addMessage(s),this.hub.emit("unapprovedMessage",Object.assign(Object.assign({},e),{metamaskId:r})),r}prepMessageForSigning(e){return delete e.metamaskId,Promise.resolve(e)}}r.PersonalMessageManager=o,r.default=o}}},{package:"@metamask/controllers",file:"/home/circleci/project/node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/controllers/dist/message-manager/PersonalMessageManager.js"}],[1363,{"../util":1370,"./AbstractMessageManager":1360,uuid:6087},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.TypedMessageManager=void 0;const n=e("uuid"),i=e("../util"),s=e("./AbstractMessageManager");class o extends s.AbstractMessageManager{constructor(){super(...arguments),this.name="TypedMessageManager"}addUnapprovedMessageAsync(e,t,r){return new Promise(((n,s)=>{"V1"===t&&i.validateTypedSignMessageDataV1(e),"V3"===t&&i.validateTypedSignMessageDataV3(e);const o=this.addUnapprovedMessage(e,t,r);this.hub.once(`${o}:finished`,(t=>{switch(t.status){case"signed":return n(t.rawSig);case"rejected":return s(new Error("MetaMask Typed Message Signature: User denied message signature."));case"errored":return s(new Error(`MetaMask Typed Message Signature: ${t.error}`));default:return s(new Error(`MetaMask Typed Message Signature: Unknown problem: ${JSON.stringify(e)}`))}}))}))}addUnapprovedMessage(e,t,r){const i=n.v1(),s=Object.assign(Object.assign({},e),{metamaskId:i,version:t});r&&(e.origin=r.origin);const o={id:i,messageParams:e,status:"unapproved",time:Date.now(),type:"eth_signTypedData"};return this.addMessage(o),this.hub.emit("unapprovedMessage",s),i}setMessageStatusErrored(e,t){const r=this.getMessage(e);r&&(r.error=t,this.updateMessage(r),this.setMessageStatus(e,"errored"))}prepMessageForSigning(e){return delete e.metamaskId,delete e.version,Promise.resolve(e)}}r.TypedMessageManager=o,r.default=o}}},{package:"@metamask/controllers",file:"/home/circleci/project/node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/controllers/dist/message-manager/TypedMessageManager.js"}],[1332,{"../BaseController":1322,"../constants":1343,"../util":1370,"./assetsUtil":1342,"async-mutex":1803,"ethereumjs-util":2597,events:2158},function(){with(this)return function(){"use strict";return function(e,t,r){var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(r,"__esModule",{value:!0}),r.CollectiblesController=void 0;const i=e("events"),s=e("ethereumjs-util"),o=e("async-mutex"),a=e("../BaseController"),c=e("../util"),u=e("../constants"),l=e("./assetsUtil"),f="allCollectibles",d="allCollectibleContracts";class h extends a.BaseController{constructor({onPreferencesStateChange:e,onNetworkStateChange:t,getERC721AssetName:r,getERC721AssetSymbol:n,getERC721TokenURI:s,getERC721OwnerOf:a,getERC1155BalanceOf:c,getERC1155TokenURI:l},f,d){super(f,d),this.mutex=new o.Mutex,this.hub=new i.EventEmitter,this.name="CollectiblesController",this.defaultConfig={networkType:u.MAINNET,selectedAddress:"",chainId:"",ipfsGateway:u.IPFS_DEFAULT_GATEWAY_URL,openSeaEnabled:!1,useIPFSSubdomains:!0},this.defaultState={allCollectibleContracts:{},allCollectibles:{},ignoredCollectibles:[]},this.initialize(),this.getERC721AssetName=r,this.getERC721AssetSymbol=n,this.getERC721TokenURI=s,this.getERC721OwnerOf=a,this.getERC1155BalanceOf=c,this.getERC1155TokenURI=l,e((({selectedAddress:e,ipfsGateway:t,openSeaEnabled:r})=>{this.configure({selectedAddress:e,ipfsGateway:t,openSeaEnabled:r})})),t((({provider:e})=>{const{chainId:t}=e;this.configure({chainId:t})}))}getCollectibleApi(e,t){const{chainId:r}=this.config;return r===u.RINKEBY_CHAIN_ID?`https://testnets-api.opensea.io/api/v1/asset/${e}/${t}`:`https://api.opensea.io/api/v1/asset/${e}/${t}`}getCollectibleContractInformationApi(e){const{chainId:t}=this.config;return t===u.RINKEBY_CHAIN_ID?`https://testnets-api.opensea.io/api/v1/asset_contract/${e}`:`https://api.opensea.io/api/v1/asset_contract/${e}`}updateNestedCollectibleState(e,t,{userAddress:r,chainId:n}={userAddress:this.config.selectedAddress,chainId:this.config.chainId}){const{[t]:i}=this.state,s=i[r],o=Object.assign(Object.assign({},s),{[n]:e}),a=Object.assign(Object.assign({},i),{[r]:o});this.update({[t]:a})}getCollectibleInformationFromApi(e,t){return n(this,void 0,void 0,(function*(){const r=this.getCollectibleApi(e,t);let n;n=this.openSeaApiKey?yield c.handleFetch(r,{headers:{"X-API-KEY":this.openSeaApiKey}}):yield c.handleFetch(r);const{num_sales:i,background_color:s,image_url:o,image_preview_url:a,image_thumbnail_url:u,image_original_url:l,animation_url:f,animation_original_url:d,name:h,description:p,external_link:m,creator:g,last_sale:y,asset_contract:{schema_name:b}}=n;return Object.assign({},{name:h||null},{description:p||null},{image:o||null},g&&{creator:g},i&&{numberOfSales:i},s&&{backgroundColor:s},a&&{imagePreview:a},u&&{imageThumbnail:u},l&&{imageOriginal:l},f&&{animation:f},d&&{animationOriginal:d},m&&{externalLink:m},y&&{lastSale:y},b&&{standard:b})}))}getCollectibleInformationFromTokenURI(e,t){return n(this,void 0,void 0,(function*(){const{ipfsGateway:r,useIPFSSubdomains:n}=this.config,i=yield this.getCollectibleURIAndStandard(e,t);let s=i[0];const o=i[1];s.startsWith("ipfs://")&&(s=c.getFormattedIpfsUrl(r,s,n));try{const e=yield c.handleFetch(s);return{image:e[Object.prototype.hasOwnProperty.call(e,"image")?"image":"image_url"],name:e.name,description:e.description,standard:o,favorite:!1}}catch(e){return{image:null,name:null,description:null,standard:o||null,favorite:!1}}}))}getCollectibleURIAndStandard(e,t){return n(this,void 0,void 0,(function*(){try{return[yield this.getERC721TokenURI(e,t),u.ERC721]}catch(e){}try{const r=yield this.getERC1155TokenURI(e,t);if(!r.includes("{id}"))return[r,u.ERC1155];const n=s.stripHexPrefix(c.BNToHex(new s.BN(t))).padStart(64,"0").toLowerCase();return[r.replace("{id}",n),u.ERC1155]}catch(e){}return["",""]}))}getCollectibleInformation(e,t){var r,i,s,o,a,u,l,f;return n(this,void 0,void 0,(function*(){const d=yield c.safelyExecute((()=>n(this,void 0,void 0,(function*(){return yield this.getCollectibleInformationFromTokenURI(e,t)}))));let h;return this.config.openSeaEnabled&&(h=yield c.safelyExecute((()=>n(this,void 0,void 0,(function*(){return yield this.getCollectibleInformationFromApi(e,t)}))))),Object.assign(Object.assign({},h),{name:null!==(i=null!==(r=d.name)&&void 0!==r?r:null==h?void 0:h.name)&&void 0!==i?i:null,description:null!==(o=null!==(s=d.description)&&void 0!==s?s:null==h?void 0:h.description)&&void 0!==o?o:null,image:null!==(u=null!==(a=d.image)&&void 0!==a?a:null==h?void 0:h.image)&&void 0!==u?u:null,standard:null!==(f=null!==(l=d.standard)&&void 0!==l?l:null==h?void 0:h.standard)&&void 0!==f?f:null})}))}getCollectibleContractInformationFromApi(e){return n(this,void 0,void 0,(function*(){const t=this.getCollectibleContractInformationApi(e);let r;return r=this.openSeaApiKey?yield c.handleFetch(t,{headers:{"X-API-KEY":this.openSeaApiKey}}):yield c.handleFetch(t),r}))}getCollectibleContractInformationFromContract(e){return n(this,void 0,void 0,(function*(){return{collection:{name:yield this.getERC721AssetName(e)},symbol:yield this.getERC721AssetSymbol(e),address:e}}))}getCollectibleContractInformation(e){return n(this,void 0,void 0,(function*(){const t=yield c.safelyExecute((()=>n(this,void 0,void 0,(function*(){return yield this.getCollectibleContractInformationFromContract(e)}))));let r;return this.config.openSeaEnabled&&(r=yield c.safelyExecute((()=>n(this,void 0,void 0,(function*(){return yield this.getCollectibleContractInformationFromApi(e)}))))),t||r?Object.assign(Object.assign(Object.assign({},r),t),{collection:Object.assign(Object.assign({image_url:null},null==r?void 0:r.collection),null==t?void 0:t.collection)}):{address:e,asset_contract_type:null,created_date:null,schema_name:null,symbol:null,total_supply:null,description:null,external_link:null,collection:{name:null,image_url:null}}}))}addIndividualCollectible(e,t,r,i){var s;return n(this,void 0,void 0,(function*(){const n=yield this.mutex.acquire();try{e=c.toChecksumHexAddress(e);const{allCollectibles:o}=this.state;let a,u;i?(a=i.chainId,u=i.userAddress):(a=this.config.chainId,u=this.config.selectedAddress);const d=(null===(s=o[u])||void 0===s?void 0:s[a])||[],h=d.find((r=>r.address.toLowerCase()===e.toLowerCase()&&r.tokenId===t));if(h){if(!l.compareCollectiblesMetadata(r,h))return d;{const r=d.findIndex((r=>r.address.toLowerCase()===e.toLowerCase()&&r.tokenId===t));-1!==r&&d.splice(r,1)}}const p=Object.assign({address:e,tokenId:t,favorite:(null==h?void 0:h.favorite)||!1,isCurrentlyOwned:!0},r),m=[...d,p];return this.updateNestedCollectibleState(m,f,{chainId:a,userAddress:u}),m}finally{n()}}))}addCollectibleContract(e,t){var r;return n(this,void 0,void 0,(function*(){const n=yield this.mutex.acquire();try{e=c.toChecksumHexAddress(e);const{allCollectibleContracts:i}=this.state;let s,o;t?(s=t.chainId,o=t.userAddress):(s=this.config.chainId,o=this.config.selectedAddress);const a=(null===(r=i[o])||void 0===r?void 0:r[s])||[];if(a.find((t=>t.address.toLowerCase()===e.toLowerCase())))return a;const u=yield this.getCollectibleContractInformation(e),{asset_contract_type:l,created_date:f,schema_name:h,symbol:p,total_supply:m,description:g,external_link:y,collection:{name:b,image_url:v}}=u;if(t&&!b||0===Object.keys(u).length)return a;const w=Object.assign({},{address:e},g&&{description:g},b&&{name:b},v&&{logo:v},p&&{symbol:p},null!=m&&{totalSupply:m},l&&{assetContractType:l},f&&{createdDate:f},h&&{schemaName:h},y&&{externalLink:y}),_=[...a,w];return this.updateNestedCollectibleState(_,d,{chainId:s,userAddress:o}),_}finally{n()}}))}removeAndIgnoreIndividualCollectible(e,t){var r;e=c.toChecksumHexAddress(e);const{allCollectibles:n,ignoredCollectibles:i}=this.state,{chainId:s,selectedAddress:o}=this.config,a=[...i],u=((null===(r=n[o])||void 0===r?void 0:r[s])||[]).filter((r=>{if(r.address.toLowerCase()===e.toLowerCase()&&r.tokenId===t){return!a.find((r=>r.address===e&&r.tokenId===t))&&a.push(r),!1}return!0}));this.updateNestedCollectibleState(u,f),this.update({ignoredCollectibles:a})}removeIndividualCollectible(e,t){var r;e=c.toChecksumHexAddress(e);const{allCollectibles:n}=this.state,{chainId:i,selectedAddress:s}=this.config,o=((null===(r=n[s])||void 0===r?void 0:r[i])||[]).filter((r=>!(r.address.toLowerCase()===e.toLowerCase()&&r.tokenId===t)));this.updateNestedCollectibleState(o,f)}removeCollectibleContract(e){var t;e=c.toChecksumHexAddress(e);const{allCollectibleContracts:r}=this.state,{chainId:n,selectedAddress:i}=this.config,s=((null===(t=r[i])||void 0===t?void 0:t[n])||[]).filter((t=>!(t.address.toLowerCase()===e.toLowerCase())));return this.updateNestedCollectibleState(s,d),s}setApiKey(e){this.openSeaApiKey=e}isCollectibleOwner(e,t,r){return n(this,void 0,void 0,(function*(){try{const n=yield this.getERC721OwnerOf(t,r);return e.toLowerCase()===n.toLowerCase()}catch(e){}try{return(yield this.getERC1155BalanceOf(e,t,r))>0}catch(e){}throw new Error("Unable to verify ownership. Probably because the standard is not supported or the chain is incorrect.")}))}addCollectibleVerifyOwnership(e,t){return n(this,void 0,void 0,(function*(){const{selectedAddress:r}=this.config;if(!(yield this.isCollectibleOwner(r,e,t)))throw new Error("This collectible is not owned by the user");yield this.addCollectible(e,t)}))}addCollectible(e,t,r,i){return n(this,void 0,void 0,(function*(){e=c.toChecksumHexAddress(e);const n=yield this.addCollectibleContract(e,i);r=r||(yield this.getCollectibleInformation(e,t));n.find((t=>t.address.toLowerCase()===e.toLowerCase()))&&(yield this.addIndividualCollectible(e,t,r,i))}))}removeCollectible(e,t){var r;e=c.toChecksumHexAddress(e),this.removeIndividualCollectible(e,t);const{allCollectibles:n}=this.state,{chainId:i,selectedAddress:s}=this.config;((null===(r=n[s])||void 0===r?void 0:r[i])||[]).find((t=>t.address.toLowerCase()===e.toLowerCase()))||this.removeCollectibleContract(e)}removeAndIgnoreCollectible(e,t){var r;e=c.toChecksumHexAddress(e),this.removeAndIgnoreIndividualCollectible(e,t);const{allCollectibles:n}=this.state,{chainId:i,selectedAddress:s}=this.config;((null===(r=n[s])||void 0===r?void 0:r[i])||[]).find((t=>t.address.toLowerCase()===e.toLowerCase()))||this.removeCollectibleContract(e)}clearIgnoredCollectibles(){this.update({ignoredCollectibles:[]})}checkAndUpdateSingleCollectibleOwnershipStatus(e,t,{userAddress:r,chainId:i}={userAddress:this.config.selectedAddress,chainId:this.config.chainId}){var s;return n(this,void 0,void 0,(function*(){const{address:n,tokenId:o}=e;let a=e.isCurrentlyOwned;try{a=yield this.isCollectibleOwner(r,n,o)}catch(e){if(!e.message.includes("Unable to verify ownership"))throw e}if(e.isCurrentlyOwned=a,!0===t)return e;const{allCollectibles:c}=this.state,u=(null===(s=c[r])||void 0===s?void 0:s[i])||[],l=u.find((e=>e.tokenId===o&&e.address.toLowerCase()===n.toLowerCase()));return l&&(l.isCurrentlyOwned=a,this.updateNestedCollectibleState(u,f,{userAddress:r,chainId:i})),e}))}checkAndUpdateAllCollectiblesOwnershipStatus(){var e;return n(this,void 0,void 0,(function*(){const{allCollectibles:t}=this.state,{chainId:r,selectedAddress:i}=this.config,s=(null===(e=t[i])||void 0===e?void 0:e[r])||[],o=yield Promise.all(s.map((e=>n(this,void 0,void 0,(function*(){var t;return null!==(t=yield this.checkAndUpdateSingleCollectibleOwnershipStatus(e,!0))&&void 0!==t?t:e})))));this.updateNestedCollectibleState(o,f)}))}updateCollectibleFavoriteStatus(e,t,r){var n;const{allCollectibles:i}=this.state,{chainId:s,selectedAddress:o}=this.config,a=(null===(n=i[o])||void 0===n?void 0:n[s])||[],c=a.findIndex((r=>r.address===e&&r.tokenId===t));if(-1===c)return;const u=Object.assign(Object.assign({},a[c]),{favorite:r});a[c]=u,this.updateNestedCollectibleState(a,f)}}r.CollectiblesController=h,r.default=h}}},{package:"@metamask/controllers",file:"/home/circleci/project/node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/controllers/dist/assets/CollectiblesController.js"}],[1328,{"../BaseControllerV2":1323,"eth-rpc-errors":2531,nanoid:1401},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.ApprovalController=void 0;const n=e("eth-rpc-errors"),i=e("nanoid"),s=e("../BaseControllerV2"),o="ApprovalController",a={pendingApprovals:{persist:!1,anonymous:!0},pendingApprovalCount:{persist:!1,anonymous:!1}};class c extends s.BaseController{constructor({messenger:e,showApprovalRequest:t,state:r={}}){super({name:o,metadata:a,messenger:e,state:Object.assign(Object.assign({},{pendingApprovals:{},pendingApprovalCount:0}),r)}),this._approvals=new Map,this._origins=new Map,this._showApprovalRequest=t,this.registerMessageHandlers()}registerMessageHandlers(){this.messagingSystem.registerActionHandler(`${o}:clearRequests`,this.clear.bind(this)),this.messagingSystem.registerActionHandler(`${o}:addRequest`,((e,t)=>t?this.addAndShowApprovalRequest(e):this.add(e))),this.messagingSystem.registerActionHandler(`${o}:hasRequest`,this.has.bind(this)),this.messagingSystem.registerActionHandler(`${o}:acceptRequest`,this.accept.bind(this)),this.messagingSystem.registerActionHandler(`${o}:rejectRequest`,this.reject.bind(this))}addAndShowApprovalRequest(e){const t=this._add(e.origin,e.type,e.id,e.requestData);return this._showApprovalRequest(),t}add(e){return this._add(e.origin,e.type,e.id,e.requestData)}get(e){return this.state.pendingApprovals[e]}getApprovalCount(e={}){var t,r;if(!e.origin&&!e.type)throw new Error("Must specify origin, type, or both.");const{origin:n,type:i}=e;if(n&&i)return Number(Boolean(null===(t=this._origins.get(n))||void 0===t?void 0:t.has(i)));if(n)return(null===(r=this._origins.get(n))||void 0===r?void 0:r.size)||0;let s=0;for(const e of Object.values(this.state.pendingApprovals))e.type===i&&(s+=1);return s}getTotalApprovalCount(){return this.state.pendingApprovalCount}has(e={}){var t;const{id:r,origin:n,type:i}=e;if(r){if("string"!=typeof r)throw new Error("May not specify non-string id.");return this._approvals.has(r)}if(i&&"string"!=typeof i)throw new Error("May not specify non-string type.");if(n){if("string"!=typeof n)throw new Error("May not specify non-string origin.");return i?Boolean(null===(t=this._origins.get(n))||void 0===t?void 0:t.has(i)):this._origins.has(n)}if(i){for(const e of Object.values(this.state.pendingApprovals))if(e.type===i)return!0;return!1}throw new Error("Must specify a valid combination of id, origin, and type.")}accept(e,t){this._deleteApprovalAndGetCallbacks(e).resolve(t)}reject(e,t){this._deleteApprovalAndGetCallbacks(e).reject(t)}clear(e){for(const t of this._approvals.keys())this.reject(t,e);this._origins.clear(),this.update((()=>({pendingApprovals:{},pendingApprovalCount:0})))}_add(e,t,r=i.nanoid(),s){var o;if(this._validateAddParams(r,e,t,s),null===(o=this._origins.get(e))||void 0===o?void 0:o.has(t))throw n.ethErrors.rpc.resourceUnavailable(((e,t)=>`Request of type '${t}' already pending for origin ${e}. Please wait.`)(e,t));return new Promise(((n,i)=>{this._approvals.set(r,{resolve:n,reject:i}),this._addPendingApprovalOrigin(e,t),this._addToStore(r,e,t,s)}))}_validateAddParams(e,t,r,i){let s=null;if(e&&"string"==typeof e?this._approvals.has(e)?s=`Approval request with id '${e}' already exists.`:t&&"string"==typeof t?r&&"string"==typeof r?i&&("object"!=typeof i||Array.isArray(i))&&(s="Request data must be a plain object if specified."):s="Must specify non-empty string type.":s="Must specify non-empty string origin.":s="Must specify non-empty string id.",s)throw n.ethErrors.rpc.internal(s)}_addPendingApprovalOrigin(e,t){const r=this._origins.get(e)||new Set;r.add(t),this._origins.has(e)||this._origins.set(e,r)}_addToStore(e,t,r,n){const i={id:e,origin:t,type:r,time:Date.now(),requestData:n||null};this.update((t=>{t.pendingApprovals[e]=i,t.pendingApprovalCount=Object.keys(t.pendingApprovals).length}))}_delete(e){this._approvals.delete(e);const{origin:t,type:r}=this.state.pendingApprovals[e];this._origins.get(t).delete(r),this._isEmptyOrigin(t)&&this._origins.delete(t),this.update((t=>{delete t.pendingApprovals[e],t.pendingApprovalCount=Object.keys(t.pendingApprovals).length}))}_deleteApprovalAndGetCallbacks(e){const t=this._approvals.get(e);if(!t)throw new Error(`Approval request with id '${e}' not found.`);return this._delete(e),t}_isEmptyOrigin(e){var t;return!(null===(t=this._origins.get(e))||void 0===t?void 0:t.size)}}r.ApprovalController=c,r.default=c}}},{package:"@metamask/controllers",file:"/home/circleci/project/node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/controllers/dist/approval/ApprovalController.js"}]],[],{});